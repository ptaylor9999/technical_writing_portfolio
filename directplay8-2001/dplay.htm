<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>DirectPlay</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Bookerly;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;}
@font-face
	{font-family:"Bahnschrift Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Bahnschrift;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Light SemiCondensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight SemiConde";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiCondensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold SemiConden";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Light Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiLight Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Bahnschrift SemiBold Condensed";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Candara;
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:"Candara Light";
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:Constantia;
	panose-1:2 3 6 2 5 3 6 3 3 3;}
@font-face
	{font-family:Corbel;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"Corbel Light";
	panose-1:2 11 3 3 2 2 4 2 2 4;}
@font-face
	{font-family:Ebrima;
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;}
@font-face
	{font-family:Gabriola;
	panose-1:4 4 6 5 5 16 2 2 13 2;}
@font-face
	{font-family:Gadugi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;}
@font-face
	{font-family:"Ink Free";
	panose-1:3 8 4 2 0 5 0 0 0 0;}
@font-face
	{font-family:"Javanese Text";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Leelawadee UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Leelawadee UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@Malgun Gothic";}
@font-face
	{font-family:"Malgun Gothic Semilight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Malgun Gothic Semilight";}
@font-face
	{font-family:"Microsoft Himalaya";
	panose-1:1 1 1 0 1 1 1 1 1 1;}
@font-face
	{font-family:"Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei";}
@font-face
	{font-family:"Microsoft JhengHei UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI";}
@font-face
	{font-family:"Microsoft JhengHei Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei Light";}
@font-face
	{font-family:"Microsoft JhengHei UI Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI Light";}
@font-face
	{font-family:"Microsoft New Tai Lue";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft PhagsPa";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Microsoft Tai Le";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei";}
@font-face
	{font-family:"Microsoft YaHei UI";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei UI";}
@font-face
	{font-family:"Microsoft YaHei Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei Light";}
@font-face
	{font-family:"Microsoft YaHei UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei UI Light";}
@font-face
	{font-family:"Microsoft Yi Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU-ExtB";}
@font-face
	{font-family:PMingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@PMingLiU-ExtB";}
@font-face
	{font-family:MingLiU_HKSCS-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_HKSCS-ExtB";}
@font-face
	{font-family:"Mongolian Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"MS UI Gothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS UI Gothic";}
@font-face
	{font-family:"MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS PGothic";}
@font-face
	{font-family:"MV Boli";
	panose-1:2 0 5 0 3 2 0 9 0 0;}
@font-face
	{font-family:"Myanmar Text";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Sans Serif Collection";
	panose-1:2 11 5 2 4 5 4 2 2 4;}
@font-face
	{font-family:"Segoe Fluent Icons";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Segoe MDL2 Assets";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Segoe Print";
	panose-1:2 0 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe Script";
	panose-1:3 11 5 4 2 0 0 0 0 3;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Black";
	panose-1:2 11 10 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Historic";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semibold";
	panose-1:2 11 7 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Variable Small Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small Semilig";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Small Semibol";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Semiligh";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Text Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Semil";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe UI Variable Display Semib";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:NSimSun;
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:"\@NSimSun";}
@font-face
	{font-family:SimSun-ExtB;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtB";}
@font-face
	{font-family:"Sitka Small";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Small Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Text";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Text Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Subheading";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Subheading Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Heading";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Heading Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Display";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Display Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Banner";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Sitka Banner Semibold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:"\@Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI";}
@font-face
	{font-family:"Yu Gothic UI Semibold";
	panose-1:2 11 7 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semibold";}
@font-face
	{font-family:"Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Light";}
@font-face
	{font-family:"Yu Gothic UI Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Light";}
@font-face
	{font-family:"Yu Gothic Medium";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Medium";}
@font-face
	{font-family:"Yu Gothic UI Semilight";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semilight";}
@font-face
	{font-family:"HoloLens MDL2 Assets";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Agency FB";
	panose-1:2 11 5 3 2 2 2 2 2 4;}
@font-face
	{font-family:Algerian;
	panose-1:4 2 7 5 4 10 2 6 7 2;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Arial Rounded MT Bold";
	panose-1:2 15 7 4 3 5 4 3 2 4;}
@font-face
	{font-family:"Baskerville Old Face";
	panose-1:2 2 6 2 8 5 5 2 3 3;}
@font-face
	{font-family:"Bauhaus 93";
	panose-1:4 3 9 5 2 11 2 2 12 2;}
@font-face
	{font-family:"Bell MT";
	panose-1:2 2 5 3 6 3 5 2 3 3;}
@font-face
	{font-family:"Bernard MT Condensed";
	panose-1:2 5 8 6 6 9 5 2 4 4;}
@font-face
	{font-family:"Bodoni MT";
	panose-1:2 7 6 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Black";
	panose-1:2 7 10 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Condensed";
	panose-1:2 7 6 6 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Poster Compressed";
	panose-1:2 7 7 6 8 6 1 5 2 4;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;}
@font-face
	{font-family:"Bradley Hand ITC";
	panose-1:3 7 4 2 5 3 2 3 2 3;}
@font-face
	{font-family:"Britannic Bold";
	panose-1:2 11 9 3 6 7 3 2 2 4;}
@font-face
	{font-family:"Berlin Sans FB";
	panose-1:2 14 6 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Berlin Sans FB Demi";
	panose-1:2 14 8 2 2 5 2 2 3 6;}
@font-face
	{font-family:Broadway;
	panose-1:4 4 9 5 8 11 2 2 5 2;}
@font-face
	{font-family:"Brush Script MT";
	panose-1:3 6 8 2 4 4 6 7 3 4;}
@font-face
	{font-family:"Bookshelf Symbol 7";
	panose-1:5 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Californian FB";
	panose-1:2 7 4 3 6 8 11 3 2 4;}
@font-face
	{font-family:"Calisto MT";
	panose-1:2 4 6 3 5 5 5 3 3 4;}
@font-face
	{font-family:Castellar;
	panose-1:2 10 4 2 6 4 6 1 3 1;}
@font-face
	{font-family:"Century Schoolbook";
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:Centaur;
	panose-1:2 3 5 4 5 2 5 2 3 4;}
@font-face
	{font-family:Chiller;
	panose-1:4 2 4 4 3 16 7 2 6 2;}
@font-face
	{font-family:"Colonna MT";
	panose-1:4 2 8 5 6 2 2 3 2 3;}
@font-face
	{font-family:"Cooper Black";
	panose-1:2 8 9 4 4 3 11 2 4 4;}
@font-face
	{font-family:"Copperplate Gothic Bold";
	panose-1:2 14 7 5 2 2 6 2 4 4;}
@font-face
	{font-family:"Copperplate Gothic Light";
	panose-1:2 14 5 7 2 2 6 2 4 4;}
@font-face
	{font-family:"Curlz MT";
	panose-1:4 4 4 4 5 7 2 2 2 2;}
@font-face
	{font-family:Dubai;
	panose-1:2 11 5 3 3 4 3 3 2 4;}
@font-face
	{font-family:"Dubai Light";
	panose-1:2 11 3 3 3 4 3 3 2 4;}
@font-face
	{font-family:"Dubai Medium";
	panose-1:2 11 6 3 3 4 3 3 2 4;}
@font-face
	{font-family:Elephant;
	panose-1:2 2 9 4 9 5 5 2 3 3;}
@font-face
	{font-family:"Engravers MT";
	panose-1:2 9 7 7 8 5 5 2 3 4;}
@font-face
	{font-family:"Eras Bold ITC";
	panose-1:2 11 9 7 3 5 4 2 2 4;}
@font-face
	{font-family:"Eras Demi ITC";
	panose-1:2 11 8 5 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Light ITC";
	panose-1:2 11 4 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Medium ITC";
	panose-1:2 11 6 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Felix Titling";
	panose-1:4 6 5 5 6 2 2 2 10 4;}
@font-face
	{font-family:Forte;
	panose-1:3 6 9 2 4 5 2 7 2 3;}
@font-face
	{font-family:"Franklin Gothic Book";
	panose-1:2 11 5 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi Cond";
	panose-1:2 11 7 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Heavy";
	panose-1:2 11 9 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Medium Cond";
	panose-1:2 11 6 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Freestyle Script";
	panose-1:3 8 4 2 3 2 5 11 4 4;}
@font-face
	{font-family:"French Script MT";
	panose-1:3 2 4 2 4 6 7 4 6 5;}
@font-face
	{font-family:"Footlight MT Light";
	panose-1:2 4 6 2 6 3 10 2 3 4;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;}
@font-face
	{font-family:Gigi;
	panose-1:4 4 5 4 6 16 7 2 13 2;}
@font-face
	{font-family:"Gill Sans MT";
	panose-1:2 11 5 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT Condensed";
	panose-1:2 11 5 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans Ultra Bold Condensed";
	panose-1:2 11 10 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans Ultra Bold";
	panose-1:2 11 10 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gloucester MT Extra Condensed";
	panose-1:2 3 8 8 2 6 1 1 1 1;}
@font-face
	{font-family:"Gill Sans MT Ext Condensed Bold";
	panose-1:2 11 9 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;}
@font-face
	{font-family:"Goudy Old Style";
	panose-1:2 2 5 2 5 3 5 2 3 3;}
@font-face
	{font-family:"Goudy Stout";
	panose-1:2 2 9 4 7 3 11 2 4 1;}
@font-face
	{font-family:"Harlow Solid Italic";
	panose-1:4 3 6 4 2 15 2 2 13 2;}
@font-face
	{font-family:Harrington;
	panose-1:4 4 5 5 5 10 2 2 7 2;}
@font-face
	{font-family:Haettenschweiler;
	panose-1:2 11 7 6 4 9 2 6 2 4;}
@font-face
	{font-family:"High Tower Text";
	panose-1:2 4 5 2 5 5 6 3 3 3;}
@font-face
	{font-family:"Imprint MT Shadow";
	panose-1:4 2 6 5 6 3 3 3 2 2;}
@font-face
	{font-family:"Informal Roman";
	panose-1:3 6 4 2 3 4 6 11 2 4;}
@font-face
	{font-family:"Blackadder ITC";
	panose-1:4 2 5 5 5 16 7 2 13 2;}
@font-face
	{font-family:"Edwardian Script ITC";
	panose-1:3 3 3 2 4 7 7 13 8 4;}
@font-face
	{font-family:"Kristen ITC";
	panose-1:3 5 5 2 4 2 2 3 2 2;}
@font-face
	{font-family:Jokerman;
	panose-1:4 9 6 5 6 13 6 2 7 2;}
@font-face
	{font-family:"Juice ITC";
	panose-1:4 4 4 3 4 10 2 2 2 2;}
@font-face
	{font-family:"Kunstler Script";
	panose-1:3 3 4 2 2 6 7 13 13 6;}
@font-face
	{font-family:"Wide Latin";
	panose-1:2 10 10 7 5 5 5 2 4 4;}
@font-face
	{font-family:"Lucida Bright";
	panose-1:2 4 6 2 5 5 5 2 3 4;}
@font-face
	{font-family:"Lucida Calligraphy";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:Leelawadee;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Lucida Fax";
	panose-1:2 6 6 2 5 5 5 2 2 4;}
@font-face
	{font-family:"Lucida Handwriting";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:Magneto;
	panose-1:4 3 8 5 5 8 2 2 13 2;}
@font-face
	{font-family:"Maiandra GD";
	panose-1:2 14 5 2 3 3 8 2 2 4;}
@font-face
	{font-family:"Matura MT Script Capitals";
	panose-1:3 2 8 2 6 6 2 7 2 2;}
@font-face
	{font-family:Mistral;
	panose-1:3 9 7 2 3 4 7 2 4 3;}
@font-face
	{font-family:"Modern No\. 20";
	panose-1:2 7 7 4 7 5 5 2 3 3;}
@font-face
	{font-family:"Microsoft Uighur";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;}
@font-face
	{font-family:"Niagara Engraved";
	panose-1:4 2 5 2 7 7 3 3 2 2;}
@font-face
	{font-family:"Niagara Solid";
	panose-1:4 2 5 2 7 7 2 2 2 2;}
@font-face
	{font-family:"OCR A Extended";
	panose-1:2 1 5 9 2 1 2 1 3 3;}
@font-face
	{font-family:"Old English Text MT";
	panose-1:3 4 9 2 4 5 8 3 8 6;}
@font-face
	{font-family:Onyx;
	panose-1:4 5 6 2 8 7 2 2 2 3;}
@font-face
	{font-family:"MS Outlook";
	panose-1:5 1 1 0 1 0 0 0 0 0;}
@font-face
	{font-family:"Palace Script MT";
	panose-1:3 3 3 2 2 6 7 12 11 5;}
@font-face
	{font-family:Papyrus;
	panose-1:3 7 5 2 6 5 2 3 2 5;}
@font-face
	{font-family:Parchment;
	panose-1:3 4 6 2 4 7 8 4 8 4;}
@font-face
	{font-family:Perpetua;
	panose-1:2 2 5 2 6 4 1 2 3 3;}
@font-face
	{font-family:"Perpetua Titling MT";
	panose-1:2 2 5 2 6 5 5 2 8 4;}
@font-face
	{font-family:Playbill;
	panose-1:4 5 6 3 10 6 2 2 2 2;}
@font-face
	{font-family:"Poor Richard";
	panose-1:2 8 5 2 5 5 5 2 7 2;}
@font-face
	{font-family:Pristina;
	panose-1:3 6 4 2 4 4 6 8 2 4;}
@font-face
	{font-family:"Rage Italic";
	panose-1:3 7 5 2 4 5 7 7 3 4;}
@font-face
	{font-family:Ravie;
	panose-1:4 4 8 5 5 8 9 2 6 2;}
@font-face
	{font-family:"MS Reference Sans Serif";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"MS Reference Specialty";
	panose-1:5 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Rockwell Condensed";
	panose-1:2 6 6 3 5 4 5 2 1 4;}
@font-face
	{font-family:Rockwell;
	panose-1:2 6 6 3 2 2 5 2 4 3;}
@font-face
	{font-family:"Rockwell Extra Bold";
	panose-1:2 6 9 3 4 5 5 2 4 3;}
@font-face
	{font-family:"Script MT Bold";
	panose-1:3 4 6 2 4 6 7 8 9 4;}
@font-face
	{font-family:"Showcard Gothic";
	panose-1:4 2 9 4 2 1 2 2 6 4;}
@font-face
	{font-family:"Snap ITC";
	panose-1:4 4 10 7 6 10 2 2 2 2;}
@font-face
	{font-family:Stencil;
	panose-1:4 4 9 5 13 8 2 2 4 4;}
@font-face
	{font-family:"Tw Cen MT";
	panose-1:2 11 6 2 2 1 4 2 6 3;}
@font-face
	{font-family:"Tw Cen MT Condensed";
	panose-1:2 11 6 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Tw Cen MT Condensed Extra Bold";
	panose-1:2 11 8 3 2 2 2 2 2 4;}
@font-face
	{font-family:"Tempus Sans ITC";
	panose-1:4 2 4 4 3 13 7 2 2 2;}
@font-face
	{font-family:"Viner Hand ITC";
	panose-1:3 7 5 2 3 5 2 2 2 3;}
@font-face
	{font-family:Vivaldi;
	panose-1:3 2 6 2 5 5 6 9 8 4;}
@font-face
	{font-family:"Vladimir Script";
	panose-1:3 5 4 2 4 4 7 7 3 5;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;}
@font-face
	{font-family:"M+ 1c bold";
	panose-1:2 11 7 2 2 2 3 2 2 7;}
@font-face
	{font-family:"\@M+ 1c bold";}
@font-face
	{font-family:"M+ 1c medium";
	panose-1:2 11 6 2 2 2 3 2 2 7;}
@font-face
	{font-family:"\@M+ 1c medium";}
@font-face
	{font-family:"M+ 1c regular";
	panose-1:2 11 5 2 2 2 3 2 2 7;}
@font-face
	{font-family:"\@M+ 1c regular";}
@font-face
	{font-family:SimSun-ExtG;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtG";}
@font-face
	{font-family:"Cascadia Code ExtraLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code Light";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code SemiLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Code SemiBold";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono ExtraLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono Light";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono SemiLight";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:"Cascadia Mono SemiBold";
	panose-1:2 11 6 9 2 0 0 2 0 4;}
@font-face
	{font-family:Abadi;}
@font-face
	{font-family:"Abadi Extra Light";}
@font-face
	{font-family:Abel;}
@font-face
	{font-family:"Abril Fatface";}
@font-face
	{font-family:"ADLaM Display";}
@font-face
	{font-family:Aharoni;}
@font-face
	{font-family:"Al Fresco";}
@font-face
	{font-family:"Alasassy Caps";}
@font-face
	{font-family:Aldhabi;}
@font-face
	{font-family:Alef;}
@font-face
	{font-family:Aleo;}
@font-face
	{font-family:"Aleo Light";}
@font-face
	{font-family:"Amasis MT Pro";}
@font-face
	{font-family:"Amasis MT Pro Black";}
@font-face
	{font-family:"Amasis MT Pro Light";}
@font-face
	{font-family:"Amasis MT Pro Medium";}
@font-face
	{font-family:"Amatic SC";}
@font-face
	{font-family:AngsanaUPC;}
@font-face
	{font-family:Anton;}
@font-face
	{font-family:Aparajita;}
@font-face
	{font-family:"Aptos Black";}
@font-face
	{font-family:"Aptos ExtraBold";}
@font-face
	{font-family:"Aptos Light";}
@font-face
	{font-family:"Aptos Mono";}
@font-face
	{font-family:"Aptos Narrow";}
@font-face
	{font-family:"Aptos SemiBold";}
@font-face
	{font-family:"Aptos Serif";}
@font-face
	{font-family:"Arabic Typesetting";}
@font-face
	{font-family:"Aref Ruqaa";}
@font-face
	{font-family:"Arial Nova";}
@font-face
	{font-family:"Arial Nova Cond";}
@font-face
	{font-family:"Arial Nova Cond Light";}
@font-face
	{font-family:"Arial Nova Light";}
@font-face
	{font-family:Assistant;}
@font-face
	{font-family:"Assistant ExtraBold";}
@font-face
	{font-family:"Assistant ExtraLight";}
@font-face
	{font-family:"Assistant Light";}
@font-face
	{font-family:"Assistant SemiBold";}
@font-face
	{font-family:Athiti;}
@font-face
	{font-family:"Athiti ExtraLight";}
@font-face
	{font-family:"Athiti Light";}
@font-face
	{font-family:"Athiti Medium";}
@font-face
	{font-family:"Athiti SemiBold";}
@font-face
	{font-family:"Avenir Next LT Pro";}
@font-face
	{font-family:"Avenir Next LT Pro Demi";}
@font-face
	{font-family:"Avenir Next LT Pro Light";}
@font-face
	{font-family:"Baguet Script";}
@font-face
	{font-family:Barlow;}
@font-face
	{font-family:"Barlow Black";}
@font-face
	{font-family:"Barlow Condensed";}
@font-face
	{font-family:"Barlow Condensed Black";}
@font-face
	{font-family:"Barlow Condensed ExtraBold";}
@font-face
	{font-family:"Barlow Condensed ExtraLight";}
@font-face
	{font-family:"Barlow Condensed Light";}
@font-face
	{font-family:"Barlow Condensed Medium";}
@font-face
	{font-family:"Barlow Condensed SemiBold";}
@font-face
	{font-family:"Barlow Condensed Thin";}
@font-face
	{font-family:"Barlow ExtraBold";}
@font-face
	{font-family:"Barlow ExtraLight";}
@font-face
	{font-family:"Barlow Light";}
@font-face
	{font-family:"Barlow Medium";}
@font-face
	{font-family:"Barlow Semi Condensed";}
@font-face
	{font-family:"Barlow Semi Condensed Black";}
@font-face
	{font-family:"Barlow Semi Condensed ExLight";}
@font-face
	{font-family:"Barlow Semi Condensed ExtraBold";}
@font-face
	{font-family:"Barlow Semi Condensed Light";}
@font-face
	{font-family:"Barlow Semi Condensed Medium";}
@font-face
	{font-family:"Barlow Semi Condensed SemiBold";}
@font-face
	{font-family:"Barlow Semi Condensed Thin";}
@font-face
	{font-family:"Barlow SemiBold";}
@font-face
	{font-family:"Barlow Thin";}
@font-face
	{font-family:BatangChe;}
@font-face
	{font-family:"Bebas Neue";}
@font-face
	{font-family:Bembo;}
@font-face
	{font-family:Bierstadt;}
@font-face
	{font-family:"Bierstadt Display";}
@font-face
	{font-family:BierstadtAlt;}
@font-face
	{font-family:"BierstadtAlt2 Cond";}
@font-face
	{font-family:"BierstadtAlt3 Cond";}
@font-face
	{font-family:"BierstadtAlt4 Cond";}
@font-face
	{font-family:BierstadtAlt5;}
@font-face
	{font-family:Biome;}
@font-face
	{font-family:"Biome Light";}
@font-face
	{font-family:"Boucherie Block";}
@font-face
	{font-family:"Boucherie Sans";}
@font-face
	{font-family:"Browallia New";}
@font-face
	{font-family:BrowalliaUPC;}
@font-face
	{font-family:"Buxton Sketch";}
@font-face
	{font-family:"Caveat Brush";}
@font-face
	{font-family:Cavolini;}
@font-face
	{font-family:"Chamberi Super Display";}
@font-face
	{font-family:Charmonman;}
@font-face
	{font-family:"Chilgok Gwon Anja";}
@font-face
	{font-family:"Chilgok Kim Yeongbun";}
@font-face
	{font-family:"Chilgok Lee Jonghui";}
@font-face
	{font-family:"Chilgok Lee Wonsun";}
@font-face
	{font-family:Chonburi;}
@font-face
	{font-family:"Cochocib Script Latin Pro";}
@font-face
	{font-family:"Concert One";}
@font-face
	{font-family:Cond;}
@font-face
	{font-family:Congenial;}
@font-face
	{font-family:"Congenial Black";}
@font-face
	{font-family:"Congenial Light";}
@font-face
	{font-family:"Congenial SemiBold";}
@font-face
	{font-family:"Congenial UltraLight";}
@font-face
	{font-family:Convection;}
@font-face
	{font-family:"Convection Condensed";}
@font-face
	{font-family:"Convection Extra Bold";}
@font-face
	{font-family:"Convection Symbol";}
@font-face
	{font-family:"Convection UI";}
@font-face
	{font-family:CordiaUPC;}
@font-face
	{font-family:Dante;}
@font-face
	{font-family:DaunPenh;}
@font-face
	{font-family:David;}
@font-face
	{font-family:Daytona;}
@font-face
	{font-family:"Daytona Condensed";}
@font-face
	{font-family:"Daytona Condensed Light";}
@font-face
	{font-family:"Daytona Light";}
@font-face
	{font-family:"DengXian Light";}
@font-face
	{font-family:"Didact Gothic";}
@font-face
	{font-family:DilleniaUPC;}
@font-face
	{font-family:"DM Mono";}
@font-face
	{font-family:"DM Mono Light";}
@font-face
	{font-family:"DM Mono Medium";}
@font-face
	{font-family:"DM Sans";}
@font-face
	{font-family:"DM Sans Medium";}
@font-face
	{font-family:"DM Serif Display";}
@font-face
	{font-family:"DM Serif Text";}
@font-face
	{font-family:DokChampa;}
@font-face
	{font-family:Dosis;}
@font-face
	{font-family:"Dosis ExtraBold";}
@font-face
	{font-family:"Dosis ExtraLight";}
@font-face
	{font-family:"Dosis Light";}
@font-face
	{font-family:"Dosis Medium";}
@font-face
	{font-family:"Dosis SemiBold";}
@font-face
	{font-family:DotumChe;}
@font-face
	{font-family:"Dreaming Outloud Pro";}
@font-face
	{font-family:"Dreaming Outloud Script Pro";}
@font-face
	{font-family:"EB Garamond";}
@font-face
	{font-family:"EB Garamond ExtraBold";}
@font-face
	{font-family:"EB Garamond Medium";}
@font-face
	{font-family:"EB Garamond SemiBold";}
@font-face
	{font-family:"Elephant Pro";}
@font-face
	{font-family:EucrosiaUPC;}
@font-face
	{font-family:Euphemia;}
@font-face
	{font-family:Fahkwang;}
@font-face
	{font-family:"Fahkwang ExtraLight";}
@font-face
	{font-family:"Fahkwang Light";}
@font-face
	{font-family:"Fahkwang Medium";}
@font-face
	{font-family:"Fahkwang SemiBold";}
@font-face
	{font-family:"Fairwater Script";}
@font-face
	{font-family:"Fairwater Script Light";}
@font-face
	{font-family:FangSong;}
@font-face
	{font-family:"Fave Script Bold Pro";}
@font-face
	{font-family:"Fira Code";}
@font-face
	{font-family:"Fira Code Light";}
@font-face
	{font-family:"Fira Code Medium";}
@font-face
	{font-family:"Fira Code Retina";}
@font-face
	{font-family:"Fira Mono";}
@font-face
	{font-family:"Fira Mono Medium";}
@font-face
	{font-family:"Fira Sans";}
@font-face
	{font-family:"Fira Sans Black";}
@font-face
	{font-family:"Fira Sans Condensed";}
@font-face
	{font-family:"Fira Sans Condensed Black";}
@font-face
	{font-family:"Fira Sans Condensed ExtraBold";}
@font-face
	{font-family:"Fira Sans Condensed ExtraLight";}
@font-face
	{font-family:"Fira Sans Condensed Light";}
@font-face
	{font-family:"Fira Sans Condensed Medium";}
@font-face
	{font-family:"Fira Sans Condensed SemiBold";}
@font-face
	{font-family:"Fira Sans Condensed Thin";}
@font-face
	{font-family:"Fira Sans Extra Condensed";}
@font-face
	{font-family:"Fira Sans Extra Condensed Black";}
@font-face
	{font-family:"Fira Sans Extra Condensed Light";}
@font-face
	{font-family:"Fira Sans Extra Condensed Thin";}
@font-face
	{font-family:"Fira Sans ExtraBold";}
@font-face
	{font-family:"Fira Sans ExtraLight";}
@font-face
	{font-family:"Fira Sans Light";}
@font-face
	{font-family:"Fira Sans Medium";}
@font-face
	{font-family:"Fira Sans SemiBold";}
@font-face
	{font-family:"Fira Sans Thin";}
@font-face
	{font-family:"Fjalla One";}
@font-face
	{font-family:"Forte Forward";}
@font-face
	{font-family:"Frank Ruhl Libre";}
@font-face
	{font-family:"Frank Ruhl Libre Black";}
@font-face
	{font-family:"Frank Ruhl Libre Light";}
@font-face
	{font-family:"Frank Ruhl Libre Medium";}
@font-face
	{font-family:FrankRuehl;}
@font-face
	{font-family:"Fredoka One";}
@font-face
	{font-family:FreesiaUPC;}
@font-face
	{font-family:Gabriela;}
@font-face
	{font-family:Gaegu;}
@font-face
	{font-family:"Gaegu Light";}
@font-face
	{font-family:"Georgia Pro";}
@font-face
	{font-family:"Georgia Pro Black";}
@font-face
	{font-family:"Georgia Pro Cond";}
@font-face
	{font-family:"Georgia Pro Cond Black";}
@font-face
	{font-family:"Georgia Pro Cond Light";}
@font-face
	{font-family:"Georgia Pro Cond Semibold";}
@font-face
	{font-family:"Georgia Pro Light";}
@font-face
	{font-family:"Georgia Pro Semibold";}
@font-face
	{font-family:"Gill Sans Nova";}
@font-face
	{font-family:"Gill Sans Nova Cond";}
@font-face
	{font-family:"Gill Sans Nova Cond Lt";}
@font-face
	{font-family:"Gill Sans Nova Cond Ultra Bold";}
@font-face
	{font-family:"Gill Sans Nova Cond XBd";}
@font-face
	{font-family:"Gill Sans Nova Light";}
@font-face
	{font-family:"Gill Sans Nova Ultra Bold";}
@font-face
	{font-family:Gisha;}
@font-face
	{font-family:"Goudy Type";}
@font-face
	{font-family:Grandview;}
@font-face
	{font-family:"Grandview Display";}
@font-face
	{font-family:Grotesque;}
@font-face
	{font-family:"Grotesque Light";}
@font-face
	{font-family:GulimChe;}
@font-face
	{font-family:Gungsuh;}
@font-face
	{font-family:GungsuhChe;}
@font-face
	{font-family:"Hadassah Friedlaender";}
@font-face
	{font-family:"Hammersmith One";}
@font-face
	{font-family:Heebo;}
@font-face
	{font-family:"Heebo Black";}
@font-face
	{font-family:"Heebo ExtraBold";}
@font-face
	{font-family:"Heebo Light";}
@font-face
	{font-family:"Heebo Medium";}
@font-face
	{font-family:"Heebo Thin";}
@font-face
	{font-family:HGGothicE;}
@font-face
	{font-family:HGMaruGothicMPRO;}
@font-face
	{font-family:HGMinchoE;}
@font-face
	{font-family:HGPGothicE;}
@font-face
	{font-family:HGPMinchoE;}
@font-face
	{font-family:HGPSoeiKakugothicUB;}
@font-face
	{font-family:HGSGothicE;}
@font-face
	{font-family:HGSMinchoE;}
@font-face
	{font-family:HGSoeiKakugothicUB;}
@font-face
	{font-family:HGSSoeiKakugothicUB;}
@font-face
	{font-family:Hind;}
@font-face
	{font-family:"Hind Colombo";}
@font-face
	{font-family:"Hind Colombo Light";}
@font-face
	{font-family:"Hind Colombo Medium";}
@font-face
	{font-family:"Hind Colombo SemiBold";}
@font-face
	{font-family:"Hind Guntur";}
@font-face
	{font-family:"Hind Guntur Light";}
@font-face
	{font-family:"Hind Guntur Medium";}
@font-face
	{font-family:"Hind Guntur SemiBold";}
@font-face
	{font-family:"Hind Jalandhar";}
@font-face
	{font-family:"Hind Jalandhar Light";}
@font-face
	{font-family:"Hind Jalandhar Medium";}
@font-face
	{font-family:"Hind Jalandhar SemiBold";}
@font-face
	{font-family:"Hind Kochi";}
@font-face
	{font-family:"Hind Kochi Light";}
@font-face
	{font-family:"Hind Kochi Medium";}
@font-face
	{font-family:"Hind Kochi SemiBold";}
@font-face
	{font-family:"Hind Light";}
@font-face
	{font-family:"Hind Madurai";}
@font-face
	{font-family:"Hind Madurai Light";}
@font-face
	{font-family:"Hind Madurai Medium";}
@font-face
	{font-family:"Hind Madurai SemiBold";}
@font-face
	{font-family:"Hind Medium";}
@font-face
	{font-family:"Hind Mysuru";}
@font-face
	{font-family:"Hind Mysuru Light";}
@font-face
	{font-family:"Hind Mysuru Medium";}
@font-face
	{font-family:"Hind Mysuru SemiBold";}
@font-face
	{font-family:"Hind SemiBold";}
@font-face
	{font-family:"Hind Siliguri";}
@font-face
	{font-family:"Hind Siliguri Light";}
@font-face
	{font-family:"Hind Siliguri Medium";}
@font-face
	{font-family:"Hind Siliguri SemiBold";}
@font-face
	{font-family:"Hind Vadodara";}
@font-face
	{font-family:"Hind Vadodara Light";}
@font-face
	{font-family:"Hind Vadodara Medium";}
@font-face
	{font-family:"Hind Vadodara SemiBold";}
@font-face
	{font-family:"IBM Plex Mono";}
@font-face
	{font-family:"IBM Plex Mono ExtraLight";}
@font-face
	{font-family:"IBM Plex Mono Light";}
@font-face
	{font-family:"IBM Plex Mono Medium";}
@font-face
	{font-family:"IBM Plex Mono SemiBold";}
@font-face
	{font-family:"IBM Plex Mono Thin";}
@font-face
	{font-family:"IBM Plex Sans";}
@font-face
	{font-family:"IBM Plex Sans Condensed";}
@font-face
	{font-family:"IBM Plex Sans Condensed Light";}
@font-face
	{font-family:"IBM Plex Sans Condensed Medium";}
@font-face
	{font-family:"IBM Plex Sans Condensed Thin";}
@font-face
	{font-family:"IBM Plex Sans ExtraLight";}
@font-face
	{font-family:"IBM Plex Sans Light";}
@font-face
	{font-family:"IBM Plex Sans Medium";}
@font-face
	{font-family:"IBM Plex Sans SemiBold";}
@font-face
	{font-family:"IBM Plex Sans Thin";}
@font-face
	{font-family:"IBM Plex Serif";}
@font-face
	{font-family:"IBM Plex Serif ExtraLight";}
@font-face
	{font-family:"IBM Plex Serif Light";}
@font-face
	{font-family:"IBM Plex Serif Medium";}
@font-face
	{font-family:"IBM Plex Serif SemiBold";}
@font-face
	{font-family:"IBM Plex Serif Thin";}
@font-face
	{font-family:Inconsolata;}
@font-face
	{font-family:"Inconsolata Black";}
@font-face
	{font-family:"Inconsolata Bold";}
@font-face
	{font-family:"Inconsolata Condensed";}
@font-face
	{font-family:"Inconsolata Condensed Black";}
@font-face
	{font-family:"Inconsolata Condensed Bold";}
@font-face
	{font-family:"Inconsolata Condensed ExtraBold";}
@font-face
	{font-family:"Inconsolata Condensed Light";}
@font-face
	{font-family:"Inconsolata Condensed Medium";}
@font-face
	{font-family:"Inconsolata Condensed SemiBold";}
@font-face
	{font-family:"Inconsolata Expanded";}
@font-face
	{font-family:"Inconsolata Expanded Black";}
@font-face
	{font-family:"Inconsolata Expanded Bold";}
@font-face
	{font-family:"Inconsolata Expanded ExtraBold";}
@font-face
	{font-family:"Inconsolata Expanded ExtraLight";}
@font-face
	{font-family:"Inconsolata Expanded Light";}
@font-face
	{font-family:"Inconsolata Expanded Medium";}
@font-face
	{font-family:"Inconsolata Expanded SemiBold";}
@font-face
	{font-family:"Inconsolata ExtraBold";}
@font-face
	{font-family:"Inconsolata ExtraCondensed";}
@font-face
	{font-family:"Inconsolata ExtraCondensed Bold";}
@font-face
	{font-family:"Inconsolata ExtraExpanded";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Black";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Bold";}
@font-face
	{font-family:"Inconsolata ExtraExpanded Light";}
@font-face
	{font-family:"Inconsolata ExtraLight";}
@font-face
	{font-family:"Inconsolata Light";}
@font-face
	{font-family:"Inconsolata Medium";}
@font-face
	{font-family:"Inconsolata SemiBold";}
@font-face
	{font-family:"Inconsolata SemiCondensed";}
@font-face
	{font-family:"Inconsolata SemiCondensed Black";}
@font-face
	{font-family:"Inconsolata SemiCondensed Bold";}
@font-face
	{font-family:"Inconsolata SemiCondensed Light";}
@font-face
	{font-family:"Inconsolata SemiExpanded";}
@font-face
	{font-family:"Inconsolata SemiExpanded Black";}
@font-face
	{font-family:"Inconsolata SemiExpanded Bold";}
@font-face
	{font-family:"Inconsolata SemiExpanded Light";}
@font-face
	{font-family:"Inconsolata SemiExpanded Medium";}
@font-face
	{font-family:"Inconsolata UltraCondensed";}
@font-face
	{font-family:"Inconsolata UltraCondensed Bold";}
@font-face
	{font-family:"Inconsolata UltraExpanded";}
@font-face
	{font-family:"Inconsolata UltraExpanded Black";}
@font-face
	{font-family:"Inconsolata UltraExpanded Bold";}
@font-face
	{font-family:"Inconsolata UltraExpanded Light";}
@font-face
	{font-family:IrisUPC;}
@font-face
	{font-family:"Iskoola Pota";}
@font-face
	{font-family:Italianno;}
@font-face
	{font-family:JasmineUPC;}
@font-face
	{font-family:"Josefin Sans";}
@font-face
	{font-family:"Josefin Sans Bold";}
@font-face
	{font-family:"Josefin Sans Light";}
@font-face
	{font-family:"Josefin Sans SemiBold";}
@font-face
	{font-family:"Josefin Sans Thin";}
@font-face
	{font-family:"Josefin Slab";}
@font-face
	{font-family:"Josefin Slab Light";}
@font-face
	{font-family:"Josefin Slab SemiBold";}
@font-face
	{font-family:"Josefin Slab Thin";}
@font-face
	{font-family:Jumble;}
@font-face
	{font-family:KaiTi;}
@font-face
	{font-family:Kalinga;}
@font-face
	{font-family:Karla;}
@font-face
	{font-family:"Karla ExtraBold";}
@font-face
	{font-family:"Karla ExtraLight";}
@font-face
	{font-family:"Karla Light";}
@font-face
	{font-family:"Karla Medium";}
@font-face
	{font-family:"Karla Tamil Inclined";}
@font-face
	{font-family:"Karla Tamil Upright";}
@font-face
	{font-family:Kartika;}
@font-face
	{font-family:Kermit;}
@font-face
	{font-family:"Kermit Condensed";}
@font-face
	{font-family:"Kermit Expanded";}
@font-face
	{font-family:"Kermit Extrabold";}
@font-face
	{font-family:"Kermit Extrabold Condensed";}
@font-face
	{font-family:"Kermit Extrabold Expanded";}
@font-face
	{font-family:"Kermit Extralight";}
@font-face
	{font-family:"Kermit Extralight Condensed";}
@font-face
	{font-family:"Kermit Extralight Expanded";}
@font-face
	{font-family:"Kermit Light";}
@font-face
	{font-family:"Kermit Light Condensed";}
@font-face
	{font-family:"Kermit Light Expanded";}
@font-face
	{font-family:"Kermit Semibold";}
@font-face
	{font-family:"Kermit Semibold Condensed";}
@font-face
	{font-family:"Kermit Semibold Expanded";}
@font-face
	{font-family:"Kermit Thin";}
@font-face
	{font-family:"Kermit Thin Condensed";}
@font-face
	{font-family:"Kermit Thin Expanded";}
@font-face
	{font-family:"Khmer UI";}
@font-face
	{font-family:Kigelia;}
@font-face
	{font-family:"Kigelia Arabic";}
@font-face
	{font-family:"Kigelia Arabic Light";}
@font-face
	{font-family:"Kigelia Light";}
@font-face
	{font-family:"Klee One";}
@font-face
	{font-family:"Klee One SemiBold";}
@font-face
	{font-family:KodchiangUPC;}
@font-face
	{font-family:Kokila;}
@font-face
	{font-family:Krub;}
@font-face
	{font-family:"Krub ExtraLight";}
@font-face
	{font-family:"Krub Light";}
@font-face
	{font-family:"Krub Medium";}
@font-face
	{font-family:"Krub SemiBold";}
@font-face
	{font-family:Lalezar;}
@font-face
	{font-family:"Lao UI";}
@font-face
	{font-family:Lato;}
@font-face
	{font-family:"Lato Black";}
@font-face
	{font-family:"Lato ExtraBold";}
@font-face
	{font-family:"Lato ExtraLight";}
@font-face
	{font-family:"Lato Light";}
@font-face
	{font-family:"Lato Medium";}
@font-face
	{font-family:"Lato SemiBold";}
@font-face
	{font-family:"Lato Thin";}
@font-face
	{font-family:"Levenim MT";}
@font-face
	{font-family:"Libre Barcode 128";}
@font-face
	{font-family:"Libre Barcode 128 Text";}
@font-face
	{font-family:"Libre Barcode 39";}
@font-face
	{font-family:"Libre Barcode 39 Extended";}
@font-face
	{font-family:"Libre Barcode 39 Extended Text";}
@font-face
	{font-family:"Libre Barcode 39 Text";}
@font-face
	{font-family:"Libre Barcode EAN13 Text";}
@font-face
	{font-family:"Libre Baskerville";}
@font-face
	{font-family:"Libre Franklin";}
@font-face
	{font-family:"Libre Franklin Black";}
@font-face
	{font-family:"Libre Franklin ExtraBold";}
@font-face
	{font-family:"Libre Franklin ExtraLight";}
@font-face
	{font-family:"Libre Franklin Light";}
@font-face
	{font-family:"Libre Franklin Medium";}
@font-face
	{font-family:"Libre Franklin SemiBold";}
@font-face
	{font-family:"Libre Franklin Thin";}
@font-face
	{font-family:Ligconsolata;}
@font-face
	{font-family:LilyUPC;}
@font-face
	{font-family:Livvic;}
@font-face
	{font-family:"Livvic Black";}
@font-face
	{font-family:"Livvic ExtraLight";}
@font-face
	{font-family:"Livvic Light";}
@font-face
	{font-family:"Livvic Medium";}
@font-face
	{font-family:"Livvic SemiBold";}
@font-face
	{font-family:"Livvic Thin";}
@font-face
	{font-family:Lobster;}
@font-face
	{font-family:"Lobster Two";}
@font-face
	{font-family:Lora;}
@font-face
	{font-family:"Lora Medium";}
@font-face
	{font-family:"Mangal Pro";}
@font-face
	{font-family:Meddon;}
@font-face
	{font-family:Meiryo;}
@font-face
	{font-family:"Meiryo UI";}
@font-face
	{font-family:Merriweather;}
@font-face
	{font-family:"Merriweather Black";}
@font-face
	{font-family:"Merriweather Light";}
@font-face
	{font-family:"Merriweather Sans";}
@font-face
	{font-family:"Merriweather Sans ExtraBold";}
@font-face
	{font-family:"Merriweather Sans Light";}
@font-face
	{font-family:"Microsoft GothicNeo";}
@font-face
	{font-family:"Microsoft GothicNeo Light";}
@font-face
	{font-family:MingLiU_HKSCS;}
@font-face
	{font-family:MingLiU_MSCS;}
@font-face
	{font-family:MingLiU_MSCS-ExtB;}
@font-face
	{font-family:Miriam;}
@font-face
	{font-family:"Miriam Fixed";}
@font-face
	{font-family:"Miriam Libre";}
@font-face
	{font-family:Mitr;}
@font-face
	{font-family:"Mitr ExtraLight";}
@font-face
	{font-family:"Mitr Light";}
@font-face
	{font-family:"Mitr Medium";}
@font-face
	{font-family:"Mitr SemiBold";}
@font-face
	{font-family:"Modern Love";}
@font-face
	{font-family:"Modern Love Caps";}
@font-face
	{font-family:"Modern Love Grunge";}
@font-face
	{font-family:Montserrat;}
@font-face
	{font-family:"Montserrat Black";}
@font-face
	{font-family:"Montserrat ExtraBold";}
@font-face
	{font-family:"Montserrat ExtraLight";}
@font-face
	{font-family:"Montserrat Light";}
@font-face
	{font-family:"Montserrat Medium";}
@font-face
	{font-family:"Montserrat SemiBold";}
@font-face
	{font-family:"Montserrat Thin";}
@font-face
	{font-family:MoolBoran;}
@font-face
	{font-family:"Mr Gabe";}
@font-face
	{font-family:"MS PMincho";}
@font-face
	{font-family:"Mystical Woods Rough Script";}
@font-face
	{font-family:"Mystical Woods Smooth Script";}
@font-face
	{font-family:"Nanum Brush Script";}
@font-face
	{font-family:"Nanum Pen";}
@font-face
	{font-family:NanumGothic;}
@font-face
	{font-family:NanumGothicCoding;}
@font-face
	{font-family:NanumGothicExtraBold;}
@font-face
	{font-family:NanumMyeongjo;}
@font-face
	{font-family:NanumMyeongjoExtraBold;}
@font-face
	{font-family:Narkisim;}
@font-face
	{font-family:"Neue Haas Grotesk Text Pro";}
@font-face
	{font-family:"News Gothic MT";}
@font-face
	{font-family:Nina;}
@font-face
	{font-family:"Nirmala Text";}
@font-face
	{font-family:"Nirmala Text Semilight";}
@font-face
	{font-family:"Nordique Inline";}
@font-face
	{font-family:"Noto Music";}
@font-face
	{font-family:"Noto Nastaliq Urdu";}
@font-face
	{font-family:"Noto Sans";}
@font-face
	{font-family:"Noto Sans AnatoHiero";}
@font-face
	{font-family:"Noto Sans Avestan";}
@font-face
	{font-family:"Noto Sans Bassa Vah";}
@font-face
	{font-family:"Noto Sans Batak";}
@font-face
	{font-family:"Noto Sans Bhaiksuki";}
@font-face
	{font-family:"Noto Sans Brahmi";}
@font-face
	{font-family:"Noto Sans Buginese";}
@font-face
	{font-family:"Noto Sans Buhid";}
@font-face
	{font-family:"Noto Sans Carian";}
@font-face
	{font-family:"Noto Sans CaucAlban";}
@font-face
	{font-family:"Noto Sans Chakma";}
@font-face
	{font-family:"Noto Sans Coptic";}
@font-face
	{font-family:"Noto Sans Cuneiform";}
@font-face
	{font-family:"Noto Sans Cypriot";}
@font-face
	{font-family:"Noto Sans Deseret";}
@font-face
	{font-family:"Noto Sans Devanagari";}
@font-face
	{font-family:"Noto Sans Devanagari Black";}
@font-face
	{font-family:"Noto Sans Devanagari ExtraBold";}
@font-face
	{font-family:"Noto Sans Devanagari ExtraLight";}
@font-face
	{font-family:"Noto Sans Devanagari Light";}
@font-face
	{font-family:"Noto Sans Devanagari Medium";}
@font-face
	{font-family:"Noto Sans Devanagari SemiBold";}
@font-face
	{font-family:"Noto Sans Devanagari Thin";}
@font-face
	{font-family:"Noto Sans Devanagari UI";}
@font-face
	{font-family:"Noto Sans Devanagari UI Black";}
@font-face
	{font-family:"Noto Sans Devanagari UI Light";}
@font-face
	{font-family:"Noto Sans Devanagari UI Medium";}
@font-face
	{font-family:"Noto Sans Devanagari UI Thin";}
@font-face
	{font-family:"Noto Sans Duployan";}
@font-face
	{font-family:"Noto Sans EgyptHiero";}
@font-face
	{font-family:"Noto Sans Elbasan";}
@font-face
	{font-family:"Noto Sans Elymaic";}
@font-face
	{font-family:"Noto Sans Glagolitic";}
@font-face
	{font-family:"Noto Sans Gothic";}
@font-face
	{font-family:"Noto Sans Grantha";}
@font-face
	{font-family:"Noto Sans Gujarati";}
@font-face
	{font-family:"Noto Sans Gujarati Black";}
@font-face
	{font-family:"Noto Sans Gujarati ExtraBold";}
@font-face
	{font-family:"Noto Sans Gujarati ExtraLight";}
@font-face
	{font-family:"Noto Sans Gujarati Light";}
@font-face
	{font-family:"Noto Sans Gujarati Medium";}
@font-face
	{font-family:"Noto Sans Gujarati SemiBold";}
@font-face
	{font-family:"Noto Sans Gujarati Thin";}
@font-face
	{font-family:"Noto Sans Gujarati UI";}
@font-face
	{font-family:"Noto Sans Gujarati UI Black";}
@font-face
	{font-family:"Noto Sans Gujarati UI ExtraBold";}
@font-face
	{font-family:"Noto Sans Gujarati UI Light";}
@font-face
	{font-family:"Noto Sans Gujarati UI Medium";}
@font-face
	{font-family:"Noto Sans Gujarati UI SemiBold";}
@font-face
	{font-family:"Noto Sans Gujarati UI Thin";}
@font-face
	{font-family:"Noto Sans Gunjala Gondi";}
@font-face
	{font-family:"Noto Sans Hanunoo";}
@font-face
	{font-family:"Noto Sans Hatran";}
@font-face
	{font-family:"Noto Sans ImpAramaic";}
@font-face
	{font-family:"Noto Sans Indic Siyaq Numbers";}
@font-face
	{font-family:"Noto Sans InsPahlavi";}
@font-face
	{font-family:"Noto Sans InsParthi";}
@font-face
	{font-family:"Noto Sans Javanese";}
@font-face
	{font-family:"Noto Sans Kaithi";}
@font-face
	{font-family:"Noto Sans Kharoshthi";}
@font-face
	{font-family:"Noto Sans Khojki";}
@font-face
	{font-family:"Noto Sans Khudawadi";}
@font-face
	{font-family:"Noto Sans Lepcha";}
@font-face
	{font-family:"Noto Sans Limbu";}
@font-face
	{font-family:"Noto Sans Linear A";}
@font-face
	{font-family:"Noto Sans Linear B";}
@font-face
	{font-family:"Noto Sans Lycian";}
@font-face
	{font-family:"Noto Sans Lydian";}
@font-face
	{font-family:"Noto Sans Mahajani";}
@font-face
	{font-family:"Noto Sans Mandaic";}
@font-face
	{font-family:"Noto Sans Manichaean";}
@font-face
	{font-family:"Noto Sans Marchen";}
@font-face
	{font-family:"Noto Sans Masaram Gondi";}
@font-face
	{font-family:"Noto Sans Math";}
@font-face
	{font-family:"Noto Sans Mayan Numerals";}
@font-face
	{font-family:"Noto Sans Mende Kikakui";}
@font-face
	{font-family:"Noto Sans Meroitic";}
@font-face
	{font-family:"Noto Sans Miao";}
@font-face
	{font-family:"Noto Sans Modi";}
@font-face
	{font-family:"Noto Sans Mongolian";}
@font-face
	{font-family:"Noto Sans Mro";}
@font-face
	{font-family:"Noto Sans Multani";}
@font-face
	{font-family:"Noto Sans Myanmar";}
@font-face
	{font-family:"Noto Sans Myanmar Blk";}
@font-face
	{font-family:"Noto Sans Myanmar ExtBd";}
@font-face
	{font-family:"Noto Sans Myanmar ExtLt";}
@font-face
	{font-family:"Noto Sans Myanmar Light";}
@font-face
	{font-family:"Noto Sans Myanmar Med";}
@font-face
	{font-family:"Noto Sans Myanmar SemBd";}
@font-face
	{font-family:"Noto Sans Myanmar Thin";}
@font-face
	{font-family:"Noto Sans Myanmar UI";}
@font-face
	{font-family:"Noto Sans Myanmar UI Black";}
@font-face
	{font-family:"Noto Sans Myanmar UI ExtraBold";}
@font-face
	{font-family:"Noto Sans Myanmar UI ExtraLight";}
@font-face
	{font-family:"Noto Sans Myanmar UI Light";}
@font-face
	{font-family:"Noto Sans Myanmar UI Medium";}
@font-face
	{font-family:"Noto Sans Myanmar UI SemiBold";}
@font-face
	{font-family:"Noto Sans Myanmar UI Thin";}
@font-face
	{font-family:"Noto Sans Nabataean";}
@font-face
	{font-family:"Noto Sans Newa";}
@font-face
	{font-family:"Noto Sans NewTaiLue";}
@font-face
	{font-family:"Noto Sans NKo";}
@font-face
	{font-family:"Noto Sans Nushu";}
@font-face
	{font-family:"Noto Sans Ogham";}
@font-face
	{font-family:"Noto Sans Old Italic";}
@font-face
	{font-family:"Noto Sans Old Permic";}
@font-face
	{font-family:"Noto Sans Old Turkic";}
@font-face
	{font-family:"Noto Sans OldHung";}
@font-face
	{font-family:"Noto Sans OldNorArab";}
@font-face
	{font-family:"Noto Sans OldPersian";}
@font-face
	{font-family:"Noto Sans OldSogdian";}
@font-face
	{font-family:"Noto Sans OldSouArab";}
@font-face
	{font-family:"Noto Sans Oriya";}
@font-face
	{font-family:"Noto Sans Oriya Blk";}
@font-face
	{font-family:"Noto Sans Oriya Thin";}
@font-face
	{font-family:"Noto Sans Oriya UI";}
@font-face
	{font-family:"Noto Sans Oriya UI Blk";}
@font-face
	{font-family:"Noto Sans Oriya UI Thin";}
@font-face
	{font-family:"Noto Sans Osage";}
@font-face
	{font-family:"Noto Sans Osmanya";}
@font-face
	{font-family:"Noto Sans Pahawh Hmong";}
@font-face
	{font-family:"Noto Sans Palmyrene";}
@font-face
	{font-family:"Noto Sans PauCinHau";}
@font-face
	{font-family:"Noto Sans PhagsPa";}
@font-face
	{font-family:"Noto Sans Phoenician";}
@font-face
	{font-family:"Noto Sans PsaPahlavi";}
@font-face
	{font-family:"Noto Sans Rejang";}
@font-face
	{font-family:"Noto Sans Runic";}
@font-face
	{font-family:"Noto Sans Samaritan";}
@font-face
	{font-family:"Noto Sans Saurashtra";}
@font-face
	{font-family:"Noto Sans Sharada";}
@font-face
	{font-family:"Noto Sans Shavian";}
@font-face
	{font-family:"Noto Sans Siddham";}
@font-face
	{font-family:"Noto Sans Sogdian";}
@font-face
	{font-family:"Noto Sans Soyombo";}
@font-face
	{font-family:"Noto Sans Syloti Nagri";}
@font-face
	{font-family:"Noto Sans Symbols2";}
@font-face
	{font-family:"Noto Sans Syriac";}
@font-face
	{font-family:"Noto Sans Syriac Black";}
@font-face
	{font-family:"Noto Sans Syriac Thin";}
@font-face
	{font-family:"Noto Sans Tagalog";}
@font-face
	{font-family:"Noto Sans Tagbanwa";}
@font-face
	{font-family:"Noto Sans Tai Le";}
@font-face
	{font-family:"Noto Sans Tai Viet";}
@font-face
	{font-family:"Noto Sans Takri";}
@font-face
	{font-family:"Noto Sans Tamil Supplement";}
@font-face
	{font-family:"Noto Sans Thai Looped Black";}
@font-face
	{font-family:"Noto Sans Thai Looped Bold";}
@font-face
	{font-family:"Noto Sans Thai Looped ExtLight";}
@font-face
	{font-family:"Noto Sans Thai Looped Extrabold";}
@font-face
	{font-family:"Noto Sans Thai Looped Light";}
@font-face
	{font-family:"Noto Sans Thai Looped Medium";}
@font-face
	{font-family:"Noto Sans Thai Looped Regular";}
@font-face
	{font-family:"Noto Sans Thai Looped Semibold";}
@font-face
	{font-family:"Noto Sans Thai Looped Thin";}
@font-face
	{font-family:"Noto Sans Tifinagh";}
@font-face
	{font-family:"Noto Sans Tirhuta";}
@font-face
	{font-family:"Noto Sans Ugaritic";}
@font-face
	{font-family:"Noto Sans Vai";}
@font-face
	{font-family:"Noto Sans Wancho";}
@font-face
	{font-family:"Noto Sans WarangCiti";}
@font-face
	{font-family:"Noto Sans Yi";}
@font-face
	{font-family:"Noto Sans Zanabazar";}
@font-face
	{font-family:"Noto Serif";}
@font-face
	{font-family:"Noto Serif Ahom";}
@font-face
	{font-family:"Noto Serif Balinese";}
@font-face
	{font-family:"Noto Serif Dogra";}
@font-face
	{font-family:"Noto Serif Grantha";}
@font-face
	{font-family:"Noto Serif Myanmar";}
@font-face
	{font-family:"Noto Serif Myanmar Blk";}
@font-face
	{font-family:"Noto Serif Myanmar ExtBd";}
@font-face
	{font-family:"Noto Serif Myanmar ExtLt";}
@font-face
	{font-family:"Noto Serif Myanmar Light";}
@font-face
	{font-family:"Noto Serif Myanmar Med";}
@font-face
	{font-family:"Noto Serif Myanmar SemBd";}
@font-face
	{font-family:"Noto Serif Myanmar Thin";}
@font-face
	{font-family:"Noto Serif Tangut";}
@font-face
	{font-family:"Noto Traditional Nushu";}
@font-face
	{font-family:Nunito;}
@font-face
	{font-family:"Nunito Black";}
@font-face
	{font-family:"Nunito ExtraBold";}
@font-face
	{font-family:"Nunito ExtraLight";}
@font-face
	{font-family:"Nunito Light";}
@font-face
	{font-family:"Nunito Sans";}
@font-face
	{font-family:"Nunito Sans Black";}
@font-face
	{font-family:"Nunito Sans ExtraBold";}
@font-face
	{font-family:"Nunito Sans ExtraLight";}
@font-face
	{font-family:"Nunito Sans Light";}
@font-face
	{font-family:"Nunito Sans SemiBold";}
@font-face
	{font-family:"Nunito SemiBold";}
@font-face
	{font-family:Nyala;}
@font-face
	{font-family:OCRB;}
@font-face
	{font-family:"Open Sans";}
@font-face
	{font-family:"Open Sans ExtraBold";}
@font-face
	{font-family:"Open Sans Light";}
@font-face
	{font-family:"Open Sans SemiBold";}
@font-face
	{font-family:Oranienbaum;}
@font-face
	{font-family:Oswald;}
@font-face
	{font-family:"Oswald ExtraLight";}
@font-face
	{font-family:"Oswald Light";}
@font-face
	{font-family:"Oswald Medium";}
@font-face
	{font-family:"Oswald SemiBold";}
@font-face
	{font-family:Oxygen;}
@font-face
	{font-family:"Oxygen Light";}
@font-face
	{font-family:"Oxygen Mono";}
@font-face
	{font-family:Pacifico;}
@font-face
	{font-family:Palanquin;}
@font-face
	{font-family:"Palanquin ExtraLight";}
@font-face
	{font-family:"Palanquin Light";}
@font-face
	{font-family:"Palanquin Medium";}
@font-face
	{font-family:"Palanquin SemiBold";}
@font-face
	{font-family:"Palanquin Thin";}
@font-face
	{font-family:"Patrick Hand";}
@font-face
	{font-family:"Patrick Hand SC";}
@font-face
	{font-family:"Petit Formal Script";}
@font-face
	{font-family:"Plantagenet Cherokee";}
@font-face
	{font-family:"Playfair Display";}
@font-face
	{font-family:"Playfair Display Black";}
@font-face
	{font-family:"Playfair Display SC";}
@font-face
	{font-family:"Playfair Display SC Black";}
@font-face
	{font-family:"Poiret One";}
@font-face
	{font-family:Poppins;}
@font-face
	{font-family:"Poppins Black";}
@font-face
	{font-family:"Poppins ExtraBold";}
@font-face
	{font-family:"Poppins ExtraLight";}
@font-face
	{font-family:"Poppins Light";}
@font-face
	{font-family:"Poppins Medium";}
@font-face
	{font-family:"Poppins SemiBold";}
@font-face
	{font-family:"Poppins Thin";}
@font-face
	{font-family:Posterama;}
@font-face
	{font-family:Pridi;}
@font-face
	{font-family:"Pridi ExtraLight";}
@font-face
	{font-family:"Pridi Light";}
@font-face
	{font-family:"Pridi Medium";}
@font-face
	{font-family:"Pridi SemiBold";}
@font-face
	{font-family:Prompt;}
@font-face
	{font-family:"Prompt Black";}
@font-face
	{font-family:"Prompt ExtraBold";}
@font-face
	{font-family:"Prompt ExtraLight";}
@font-face
	{font-family:"Prompt Light";}
@font-face
	{font-family:"Prompt Medium";}
@font-face
	{font-family:"Prompt SemiBold";}
@font-face
	{font-family:"Prompt Thin";}
@font-face
	{font-family:"PT Mono";}
@font-face
	{font-family:"PT Sans";}
@font-face
	{font-family:"PT Sans Caption";}
@font-face
	{font-family:"PT Sans Narrow";}
@font-face
	{font-family:"PT Serif";}
@font-face
	{font-family:"PT Serif Caption";}
@font-face
	{font-family:Quattrocento;}
@font-face
	{font-family:"Quattrocento Sans";}
@font-face
	{font-family:Questrial;}
@font-face
	{font-family:"Quire Sans";}
@font-face
	{font-family:"Quire Sans Light";}
@font-face
	{font-family:"Quire Sans Pro Light";}
@font-face
	{font-family:Raleway;}
@font-face
	{font-family:"Raleway Black";}
@font-face
	{font-family:"Raleway ExtraBold";}
@font-face
	{font-family:"Raleway ExtraLight";}
@font-face
	{font-family:"Raleway Light";}
@font-face
	{font-family:"Raleway Medium";}
@font-face
	{font-family:"Raleway SemiBold";}
@font-face
	{font-family:"Raleway Thin";}
@font-face
	{font-family:"Rastanty Cortez";}
@font-face
	{font-family:"Reem Kufi";}
@font-face
	{font-family:Roboto;}
@font-face
	{font-family:"Roboto Black";}
@font-face
	{font-family:"Roboto Condensed";}
@font-face
	{font-family:"Roboto Condensed Light";}
@font-face
	{font-family:"Roboto Condensed Medium";}
@font-face
	{font-family:"Roboto Light";}
@font-face
	{font-family:"Roboto Medium";}
@font-face
	{font-family:"Roboto Mono";}
@font-face
	{font-family:"Roboto Mono Light";}
@font-face
	{font-family:"Roboto Mono Medium";}
@font-face
	{font-family:"Roboto Mono Thin";}
@font-face
	{font-family:"Roboto Serif 20pt";}
@font-face
	{font-family:"Roboto Serif 20pt Black";}
@font-face
	{font-family:"Roboto Serif 20pt ExtraBold";}
@font-face
	{font-family:"Roboto Serif 20pt ExtraLight";}
@font-face
	{font-family:"Roboto Serif 20pt Light";}
@font-face
	{font-family:"Roboto Serif 20pt Medium";}
@font-face
	{font-family:"Roboto Serif 20pt SemiBold";}
@font-face
	{font-family:"Roboto Serif 20pt Thin";}
@font-face
	{font-family:"Roboto Slab";}
@font-face
	{font-family:"Roboto Slab Black";}
@font-face
	{font-family:"Roboto Slab ExtraBold";}
@font-face
	{font-family:"Roboto Slab ExtraLight";}
@font-face
	{font-family:"Roboto Slab Light";}
@font-face
	{font-family:"Roboto Slab Medium";}
@font-face
	{font-family:"Roboto Slab SemiBold";}
@font-face
	{font-family:"Roboto Slab Thin";}
@font-face
	{font-family:"Roboto Thin";}
@font-face
	{font-family:"Rockwell Light";}
@font-face
	{font-family:"Rockwell Nova";}
@font-face
	{font-family:"Rockwell Nova Cond";}
@font-face
	{font-family:"Rockwell Nova Cond Light";}
@font-face
	{font-family:"Rockwell Nova Extra Bold";}
@font-face
	{font-family:"Rockwell Nova Light";}
@font-face
	{font-family:Rod;}
@font-face
	{font-family:"Sabon Next LT";}
@font-face
	{font-family:Sacramento;}
@font-face
	{font-family:Sagona;}
@font-face
	{font-family:"Sagona Book";}
@font-face
	{font-family:"Sagona ExtraLight";}
@font-face
	{font-family:"Sakkal Majalla";}
@font-face
	{font-family:"Sanskrit Text";}
@font-face
	{font-family:Seaford;}
@font-face
	{font-family:"Seaford Display";}
@font-face
	{font-family:"Secular One";}
@font-face
	{font-family:"Segoe Marker";}
@font-face
	{font-family:"Segoe Pro";}
@font-face
	{font-family:"Segoe Pro Black";}
@font-face
	{font-family:"Segoe Pro Cond";}
@font-face
	{font-family:"Segoe Pro Display";}
@font-face
	{font-family:"Segoe Pro Display Light";}
@font-face
	{font-family:"Segoe Pro Display Semibold";}
@font-face
	{font-family:"Segoe Pro Display SemiLight";}
@font-face
	{font-family:"Segoe Pro Light";}
@font-face
	{font-family:"Segoe Pro Semibold";}
@font-face
	{font-family:"Segoe Pro SemiLight";}
@font-face
	{font-family:"Segoe Sans Display";}
@font-face
	{font-family:"Segoe Sans Display Black";}
@font-face
	{font-family:"Segoe Sans Display ExtraBold";}
@font-face
	{font-family:"Segoe Sans Display Hairline";}
@font-face
	{font-family:"Segoe Sans Display Light";}
@font-face
	{font-family:"Segoe Sans Display Semibold";}
@font-face
	{font-family:"Segoe Sans Display Semilight";}
@font-face
	{font-family:"Segoe Sans Display Thin";}
@font-face
	{font-family:"Segoe Sans Small";}
@font-face
	{font-family:"Segoe Sans Small Black";}
@font-face
	{font-family:"Segoe Sans Small ExtraBold";}
@font-face
	{font-family:"Segoe Sans Small Hairline";}
@font-face
	{font-family:"Segoe Sans Small Light";}
@font-face
	{font-family:"Segoe Sans Small Semibold";}
@font-face
	{font-family:"Segoe Sans Small Semilight";}
@font-face
	{font-family:"Segoe Sans Small Thin";}
@font-face
	{font-family:"Segoe Sans Text";}
@font-face
	{font-family:"Segoe Sans Text Black";}
@font-face
	{font-family:"Segoe Sans Text ExtraBold";}
@font-face
	{font-family:"Segoe Sans Text Hairline";}
@font-face
	{font-family:"Segoe Sans Text Light";}
@font-face
	{font-family:"Segoe Sans Text Semibold";}
@font-face
	{font-family:"Segoe Sans Text Semilight";}
@font-face
	{font-family:"Segoe Sans Text Thin";}
@font-face
	{font-family:"Segoe Serif Banner";}
@font-face
	{font-family:"Segoe Serif Banner Light";}
@font-face
	{font-family:"Segoe Serif Banner Semibold";}
@font-face
	{font-family:"Segoe Serif Banner Semilight";}
@font-face
	{font-family:"Segoe Serif Display";}
@font-face
	{font-family:"Segoe Serif Display Light";}
@font-face
	{font-family:"Segoe Serif Display Semibold";}
@font-face
	{font-family:"Segoe Serif Display Semilight";}
@font-face
	{font-family:"Segoe Serif Text";}
@font-face
	{font-family:"Segoe Serif Text Light";}
@font-face
	{font-family:"Segoe Serif Text Semibold";}
@font-face
	{font-family:"Segoe Serif Text Semilight";}
@font-face
	{font-family:"Segoe UI Emoji L";}
@font-face
	{font-family:"Segoe Xbox Symbol";}
@font-face
	{font-family:Selawik;}
@font-face
	{font-family:"Selawik Light";}
@font-face
	{font-family:"Selawik Semibold";}
@font-face
	{font-family:"Shadows Into Light Two";}
@font-face
	{font-family:"Shonar Bangla";}
@font-face
	{font-family:"Simplified Arabic";}
@font-face
	{font-family:"Simplified Arabic Fixed";}
@font-face
	{font-family:Skeena;}
@font-face
	{font-family:"Skeena Display";}
@font-face
	{font-family:"Source Code Pro";}
@font-face
	{font-family:"Source Code Pro Black";}
@font-face
	{font-family:"Source Code Pro ExtraLight";}
@font-face
	{font-family:"Source Code Pro Light";}
@font-face
	{font-family:"Source Code Pro Medium";}
@font-face
	{font-family:"Source Code Pro Semibold";}
@font-face
	{font-family:"Source Sans Pro";}
@font-face
	{font-family:"Source Sans Pro Black";}
@font-face
	{font-family:"Source Sans Pro ExtraLight";}
@font-face
	{font-family:"Source Sans Pro Light";}
@font-face
	{font-family:"Source Sans Pro SemiBold";}
@font-face
	{font-family:"Source Serif Pro";}
@font-face
	{font-family:"Source Serif Pro Black";}
@font-face
	{font-family:"Source Serif Pro ExtraLight";}
@font-face
	{font-family:"Source Serif Pro Light";}
@font-face
	{font-family:"Source Serif Pro SemiBold";}
@font-face
	{font-family:"Speak Pro";}
@font-face
	{font-family:"Speak Pro Light";}
@font-face
	{font-family:Staatliches;}
@font-face
	{font-family:STCaiyun;}
@font-face
	{font-family:STFangsong;}
@font-face
	{font-family:STHupo;}
@font-face
	{font-family:STKaiti;}
@font-face
	{font-family:STXihei;}
@font-face
	{font-family:STXingkai;}
@font-face
	{font-family:STXinwei;}
@font-face
	{font-family:STZhongsong;}
@font-face
	{font-family:"Suez One";}
@font-face
	{font-family:Tenorite;}
@font-face
	{font-family:"Tenorite Display";}
@font-face
	{font-family:"TH SarabunPSK";}
@font-face
	{font-family:"The Hand";}
@font-face
	{font-family:"The Hand Black";}
@font-face
	{font-family:"The Hand Extrablack";}
@font-face
	{font-family:"The Hand Light";}
@font-face
	{font-family:"The Serif Hand";}
@font-face
	{font-family:"The Serif Hand Black";}
@font-face
	{font-family:"The Serif Hand Extrablack";}
@font-face
	{font-family:"The Serif Hand Light";}
@font-face
	{font-family:"Tisa Offc Serif Pro";}
@font-face
	{font-family:"Tisa Offc Serif Pro Thin";}
@font-face
	{font-family:"Titillium Web";}
@font-face
	{font-family:"Titillium Web Black";}
@font-face
	{font-family:"Titillium Web ExtraLight";}
@font-face
	{font-family:"Titillium Web Light";}
@font-face
	{font-family:"Titillium Web SemiBold";}
@font-face
	{font-family:"Trade Gothic Inline";}
@font-face
	{font-family:"Trade Gothic Next";}
@font-face
	{font-family:"Trade Gothic Next Cond";}
@font-face
	{font-family:"Trade Gothic Next Heavy";}
@font-face
	{font-family:"Trade Gothic Next HvyCd";}
@font-face
	{font-family:"Trade Gothic Next Light";}
@font-face
	{font-family:"Trade Gothic Next Rounded";}
@font-face
	{font-family:"Traditional Arabic";}
@font-face
	{font-family:Trirong;}
@font-face
	{font-family:"Trirong Black";}
@font-face
	{font-family:"Trirong ExtraBold";}
@font-face
	{font-family:"Trirong ExtraLight";}
@font-face
	{font-family:"Trirong Light";}
@font-face
	{font-family:"Trirong Medium";}
@font-face
	{font-family:"Trirong SemiBold";}
@font-face
	{font-family:"Trirong Thin";}
@font-face
	{font-family:Ubuntu;}
@font-face
	{font-family:"Ubuntu Condensed";}
@font-face
	{font-family:"Ubuntu Light";}
@font-face
	{font-family:"Ubuntu Medium";}
@font-face
	{font-family:"Ubuntu Mono";}
@font-face
	{font-family:"UD Digi Kyokasho N-B";}
@font-face
	{font-family:"UD Digi Kyokasho N-R";}
@font-face
	{font-family:"UD Digi Kyokasho NK-B";}
@font-face
	{font-family:"UD Digi Kyokasho NK-R";}
@font-face
	{font-family:"UD Digi Kyokasho NP-B";}
@font-face
	{font-family:"UD Digi Kyokasho NP-R";}
@font-face
	{font-family:Univers;}
@font-face
	{font-family:"Univers Condensed";}
@font-face
	{font-family:"Univers Condensed Light";}
@font-face
	{font-family:"Univers Light";}
@font-face
	{font-family:"Urdu Typesetting";}
@font-face
	{font-family:Utsaah;}
@font-face
	{font-family:Vani;}
@font-face
	{font-family:"Varela Round";}
@font-face
	{font-family:"Verdana Pro";}
@font-face
	{font-family:"Verdana Pro Black";}
@font-face
	{font-family:"Verdana Pro Cond";}
@font-face
	{font-family:"Verdana Pro Cond Black";}
@font-face
	{font-family:"Verdana Pro Cond Light";}
@font-face
	{font-family:"Verdana Pro Cond Semibold";}
@font-face
	{font-family:"Verdana Pro Light";}
@font-face
	{font-family:"Verdana Pro Semibold";}
@font-face
	{font-family:Vijaya;}
@font-face
	{font-family:"Walbaum Display";}
@font-face
	{font-family:"Walbaum Display Heavy";}
@font-face
	{font-family:"Walbaum Display Light";}
@font-face
	{font-family:"Walbaum Display SemiBold";}
@font-face
	{font-family:"Walbaum Heading";}
@font-face
	{font-family:"Walbaum Text";}
@font-face
	{font-family:Wandohope;}
@font-face
	{font-family:"Work Sans";}
@font-face
	{font-family:"Work Sans Black";}
@font-face
	{font-family:"Work Sans ExtraBold";}
@font-face
	{font-family:"Work Sans ExtraLight";}
@font-face
	{font-family:"Work Sans Light";}
@font-face
	{font-family:"Work Sans Medium";}
@font-face
	{font-family:"Work Sans SemiBold";}
@font-face
	{font-family:"Work Sans Thin";}
@font-face
	{font-family:Yesteryear;}
@font-face
	{font-family:"Yu Mincho";}
@font-face
	{font-family:"Yu Mincho Demibold";}
@font-face
	{font-family:"Yu Mincho Light";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
h1
	{margin-top:11.0pt;
	margin-right:6.0pt;
	margin-bottom:11.0pt;
	margin-left:6.0pt;
	line-height:22.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial Narrow",sans-serif;}
h2
	{margin-top:9.0pt;
	margin-right:6.0pt;
	margin-bottom:9.0pt;
	margin-left:6.0pt;
	line-height:19.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:17.0pt;
	font-family:"Arial Narrow",sans-serif;}
h3
	{margin-top:8.0pt;
	margin-right:6.0pt;
	margin-bottom:8.0pt;
	margin-left:6.0pt;
	line-height:17.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:15.0pt;
	font-family:"Arial Narrow",sans-serif;}
h4
	{margin-top:7.0pt;
	margin-right:6.0pt;
	margin-bottom:7.0pt;
	margin-left:6.0pt;
	line-height:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;}
h5
	{margin-top:5.0pt;
	margin-right:6.0pt;
	margin-bottom:5.0pt;
	margin-left:6.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:11.0pt;
	font-family:"Arial Narrow",sans-serif;}
h6
	{margin-top:2.0pt;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:11.9pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Arial Narrow",sans-serif;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:10.5pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Arial",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p.ih, li.ih, div.ih
	{mso-style-name:ih;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:21.0pt;
	margin-left:-1.25in;
	line-height:30.0pt;
	page-break-before:always;
	page-break-after:avoid;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:24.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.headerrule, li.headerrule, div.headerrule
	{mso-style-name:"header rule";
	margin-top:2.5pt;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:4.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:6.0pt;
	font-family:"Arial",sans-serif;}
p.Def1, li.Def1, div.Def1
	{mso-style-name:Def1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Term1, li.Term1, div.Term1
	{mso-style-name:Term1;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Def2, li.Def2, div.Def2
	{mso-style-name:Def2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:30.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Term2, li.Term2, div.Term2
	{mso-style-name:Term2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Ex, li.Ex, div.Ex
	{mso-style-name:Ex;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Exl, li.Exl, div.Exl
	{mso-style-name:Exl;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:.25in;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Exl2, li.Exl2, div.Exl2
	{mso-style-name:Exl2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:30.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Lb1, li.Lb1, div.Lb1
	{mso-style-name:Lb1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-12.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Ln1, li.Ln1, div.Ln1
	{mso-style-name:Ln1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Lb2, li.Lb2, div.Lb2
	{mso-style-name:Lb2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:30.0pt;
	text-indent:-12.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Ln2, li.Ln2, div.Ln2
	{mso-style-name:Ln2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:30.0pt;
	text-indent:-.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Lp1, li.Lp1, div.Lp1
	{mso-style-name:Lp1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Lp2, li.Lp2, div.Lp2
	{mso-style-name:Lp2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:30.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Lbp, li.Lbp, div.Lbp
	{mso-style-name:Lbp;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-12.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Le, li.Le, div.Le
	{mso-style-name:Le;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Proch, li.Proch, div.Proch
	{mso-style-name:Proch;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-12.0pt;
	line-height:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Procp, li.Procp, div.Procp
	{mso-style-name:Procp;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Th, li.Th, div.Th
	{mso-style-name:Th;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.Tp, li.Tp, div.Tp
	{mso-style-name:Tp;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Tsyn, li.Tsyn, div.Tsyn
	{mso-style-name:Tsyn;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Syn, li.Syn, div.Syn
	{mso-style-name:Syn;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	text-indent:-12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Art, li.Art, div.Art
	{mso-style-name:Art;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:6.0pt;
	margin-left:6.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Rmh, li.Rmh, div.Rmh
	{mso-style-name:Rmh;
	margin-top:7.0pt;
	margin-right:0in;
	margin-bottom:7.0pt;
	margin-left:0in;
	line-height:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Thf, li.Thf, div.Thf
	{mso-style-name:Thf;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.Tpf, li.Tpf, div.Tpf
	{mso-style-name:Tpf;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Rh1, li.Rh1, div.Rh1
	{mso-style-name:Rh1;
	margin:6.0pt;
	line-height:22.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Cap, li.Cap, div.Cap
	{mso-style-name:Cap;
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Ch, li.Ch, div.Ch
	{mso-style-name:Ch;
	margin-top:13.0pt;
	margin-right:0in;
	margin-bottom:13.0pt;
	margin-left:0in;
	line-height:27.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:24.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Cn, li.Cn, div.Cn
	{mso-style-name:Cn;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	letter-spacing:3.0pt;}
p.Erm, li.Erm, div.Erm
	{mso-style-name:Erm;
	margin-top:5.0pt;
	margin-right:12.0pt;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:12.0pt;
	page-break-after:avoid;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Erp, li.Erp, div.Erp
	{mso-style-name:Erp;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Arial",sans-serif;}
p.Ermn, li.Ermn, div.Ermn
	{mso-style-name:Ermn;
	margin-top:1.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Exw, li.Exw, div.Exw
	{mso-style-name:Exw;
	margin:0in;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Hn1, li.Hn1, div.Hn1
	{mso-style-name:Hn1;
	margin-top:11.0pt;
	margin-right:6.0pt;
	margin-bottom:11.0pt;
	margin-left:6.0pt;
	line-height:22.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Hn2, li.Hn2, div.Hn2
	{mso-style-name:Hn2;
	margin-top:9.0pt;
	margin-right:6.0pt;
	margin-bottom:9.0pt;
	margin-left:6.0pt;
	line-height:19.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:17.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Hn3, li.Hn3, div.Hn3
	{mso-style-name:Hn3;
	margin-top:8.0pt;
	margin-right:6.0pt;
	margin-bottom:8.0pt;
	margin-left:6.0pt;
	line-height:17.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:15.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.index, li.index, div.index
	{mso-style-name:index;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Arial",sans-serif;
	color:fuchsia;
	display:none;}
p.Leh, li.Leh, div.Leh
	{mso-style-name:Leh;
	margin:0in;
	line-height:4.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Lmc, li.Lmc, div.Lmc
	{mso-style-name:Lmc;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Ne, li.Ne, div.Ne
	{mso-style-name:Ne;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Nei, li.Nei, div.Nei
	{mso-style-name:Nei;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:15.5pt;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Nh, li.Nh, div.Nh
	{mso-style-name:Nh;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Np1, li.Np1, div.Np1
	{mso-style-name:Np1;
	margin-top:0in;
	margin-right:9.0pt;
	margin-bottom:0in;
	margin-left:9.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Nhi, li.Nhi, div.Nhi
	{mso-style-name:Nhi;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Np1i, li.Np1i, div.Np1i
	{mso-style-name:Np1i;
	margin-top:0in;
	margin-right:3.0pt;
	margin-bottom:0in;
	margin-left:17.0pt;
	text-indent:-14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Np2, li.Np2, div.Np2
	{mso-style-name:Np2;
	margin-top:0in;
	margin-right:9.0pt;
	margin-bottom:0in;
	margin-left:9.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Np2i, li.Np2i, div.Np2i
	{mso-style-name:Np2i;
	margin-top:0in;
	margin-right:3.0pt;
	margin-bottom:0in;
	margin-left:17.0pt;
	text-indent:-14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Ns, li.Ns, div.Ns
	{mso-style-name:Ns;
	margin:0in;
	line-height:6.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Arial",sans-serif;}
p.Nsi, li.Nsi, div.Nsi
	{mso-style-name:Nsi;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:15.5pt;
	line-height:6.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Arial",sans-serif;}
p.Synw, li.Synw, div.Synw
	{mso-style-name:Synw;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	text-indent:-12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Tart, li.Tart, div.Tart
	{mso-style-name:Tart;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:6.0pt;
	margin-left:6.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Te, li.Te, div.Te
	{mso-style-name:Te;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Teh, li.Teh, div.Teh
	{mso-style-name:Teh;
	margin:0in;
	line-height:4.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Tes, li.Tes, div.Tes
	{mso-style-name:Tes;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Tex, li.Tex, div.Tex
	{mso-style-name:Tex;
	margin-top:1.0pt;
	margin-right:6.0pt;
	margin-bottom:3.0pt;
	margin-left:6.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Texf, li.Texf, div.Texf
	{mso-style-name:Texf;
	margin-top:1.0pt;
	margin-right:6.0pt;
	margin-bottom:3.0pt;
	margin-left:6.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Tf, li.Tf, div.Tf
	{mso-style-name:Tf;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:3.0pt;
	margin-left:6.0pt;
	line-height:10.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Arial",sans-serif;}
p.Tpi, li.Tpi, div.Tpi
	{mso-style-name:Tpi;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Tpif, li.Tpif, div.Tpif
	{mso-style-name:Tpif;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Tr, li.Tr, div.Tr
	{mso-style-name:Tr;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:4.0pt;
	font-family:"Arial",sans-serif;}
p.Tt, li.Tt, div.Tt
	{mso-style-name:Tt;
	margin-top:1.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:11.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Ttw, li.Ttw, div.Ttw
	{mso-style-name:Ttw;
	margin-top:1.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:11.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.H6p, li.H6p, div.H6p
	{mso-style-name:H6p;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.Rh2, li.Rh2, div.Rh2
	{mso-style-name:Rh2;
	margin:6.0pt;
	line-height:19.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:17.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
span.HTML
	{mso-style-name:HTML;
	font-family:"Times New Roman",serif;
	color:fuchsia;
	display:none;}
p.Rule, li.Rule, div.Rule
	{mso-style-name:Rule;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:4.0pt;
	font-family:"Arial",sans-serif;
	color:white;}
span.Small
	{mso-style-name:*Small;}
p.QiB, li.QiB, div.QiB
	{mso-style-name:QiB;
	margin:0in;
	background:#FFFFBA;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.We, li.We, div.We
	{mso-style-name:We;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Wei, li.Wei, div.Wei
	{mso-style-name:Wei;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Wh, li.Wh, div.Wh
	{mso-style-name:Wh;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Whi, li.Whi, div.Whi
	{mso-style-name:Whi;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:14.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Ws, li.Ws, div.Ws
	{mso-style-name:Ws;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Wsi, li.Wsi, div.Wsi
	{mso-style-name:Wsi;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Ph, li.Ph, div.Ph
	{mso-style-name:Ph;
	margin-top:11.0pt;
	margin-right:6.0pt;
	margin-bottom:11.0pt;
	margin-left:6.0pt;
	line-height:22.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Tpr, li.Tpr, div.Tpr
	{mso-style-name:Tpr;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Cbx, li.Cbx, div.Cbx
	{mso-style-name:*Cbx;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.Cbxe, li.Cbxe, div.Cbxe
	{mso-style-name:*Cbxe;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.hb1, li.hb1, div.hb1
	{mso-style-name:*hb1;
	margin:0in;
	text-align:center;
	line-height:18.0pt;
	page-break-after:avoid;
	background:#9C9CFF;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	color:white;
	position:relative;
	top:-2.0pt;
	font-weight:bold;}
p.hb2, li.hb2, div.hb2
	{mso-style-name:*hb2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:18.0pt;
	page-break-after:avoid;
	background:#9C9CFF;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	color:white;
	position:relative;
	top:-5.0pt;
	font-weight:bold;}
p.ArtSd, li.ArtSd, div.ArtSd
	{mso-style-name:ArtSd;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.CapSd, li.CapSd, div.CapSd
	{mso-style-name:CapSd;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.QiH, li.QiH, div.QiH
	{mso-style-name:QiH;
	margin-top:7.0pt;
	margin-right:0in;
	margin-bottom:7.0pt;
	margin-left:0in;
	line-height:14.0pt;
	background:#FFFFBA;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Mp, li.Mp, div.Mp
	{mso-style-name:Mp;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:3.0pt;
	margin-left:6.0pt;
	line-height:10.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Arial",sans-serif;}
p.Pb, li.Pb, div.Pb
	{mso-style-name:Pb;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Arial",sans-serif;}
p.Sb, li.Sb, div.Sb
	{mso-style-name:Sb;
	margin:0in;
	line-height:9.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Times New Roman",serif;
	color:red;
	display:none;}
p.Sbre, li.Sbre, div.Sbre
	{mso-style-name:Sbre;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.SbrEx, li.SbrEx, div.SbrEx
	{mso-style-name:SbrEx;
	margin-top:0in;
	margin-right:6.0pt;
	margin-bottom:0in;
	margin-left:6.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	font-family:"Lucida Sans Typewriter";}
p.Sbrh, li.Sbrh, div.Sbrh
	{mso-style-name:Sbrh;
	margin-top:9.0pt;
	margin-right:6.0pt;
	margin-bottom:9.0pt;
	margin-left:6.0pt;
	line-height:19.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:17.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.Sbrh2, li.Sbrh2, div.Sbrh2
	{mso-style-name:Sbrh2;
	margin-top:9.0pt;
	margin-right:6.0pt;
	margin-bottom:9.0pt;
	margin-left:6.0pt;
	line-height:19.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:17.0pt;
	font-family:"Arial Narrow",sans-serif;
	font-weight:bold;}
p.SbrLb, li.SbrLb, div.SbrLb
	{mso-style-name:SbrLb;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-12.0pt;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.SbrLe, li.SbrLe, div.SbrLe
	{mso-style-name:SbrLe;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.SbrLp, li.SbrLp, div.SbrLp
	{mso-style-name:SbrLp;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Sbrp, li.Sbrp, div.Sbrp
	{mso-style-name:Sbrp;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.Sbrs, li.Sbrs, div.Sbrs
	{mso-style-name:Sbrs;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	font-family:"Arial",sans-serif;}
p.Tei, li.Tei, div.Tei
	{mso-style-name:Tei;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.Tew, li.Tew, div.Tew
	{mso-style-name:Tew;
	margin:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;}
p.ExSyn, li.ExSyn, div.ExSyn
	{mso-style-name:ExSyn;
	margin:0in;
	line-height:12.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Lucida Sans Typewriter";}
span.Lang
	{mso-style-name:*Lang;
	font-weight:bold;
	text-decoration:underline;}
span.Alt
	{mso-style-name:Alt;
	font-family:"Times New Roman",serif;
	color:olive;
	display:none;}
p.LangBegin, li.LangBegin, div.LangBegin
	{mso-style-name:LangBegin;
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	color:blue;}
p.LangEnd, li.LangEnd, div.LangEnd
	{mso-style-name:LangEnd;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:8.0pt;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	padding:0in;
	font-size:6.0pt;
	font-family:"Times New Roman",serif;
	color:blue;}
p.DefinitionList, li.DefinitionList, div.DefinitionList
	{mso-style-name:"Definition List";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	margin:0in;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:-127.0pt 76.5pt -111.0pt 166.5pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=Ch style='page-break-after:avoid'>DirectPlay</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
application programming interface (API) is the component of Microsoft<span
style='font-size:7.0pt'> </span>DirectX<span style='font-size:7.0pt'></span>
that enables you to write network applications such as multiplayer games.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Like other components of
DirectX, DirectPlay can be used with C, C++, and Microsoft Visual Basic<span
style='font-size:7.0pt'></span>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For an overview of the
organization of the DirectPlay Help, see Roadmap.</p>

<h1 style='page-break-after:avoid'>Roadmap</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>Information on Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
is presented in the following sections. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>What's New in DirectPlay. New
features and functionality of this component in Microsoft DirectX<span
style='font-size:7.0pt'></span> 8. If you've used DirectPlay before, read this
section first because this technology has been completely redesigned since
DirectX 7.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Introduction to DirectPlay. An
overview of what DirectPlay is and what it can do for your application,
together with a first look at some key objects and the steps involved in
creating a network application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Understanding DirectPlay. A
deeper look at the underlying mechanisms. This section won't teach you how to
implement a DirectPlay session, but it will help you understand the application
programming interface (API) when you get into the details. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Using DirectPlay. A guide to
using the API. You'll probably want to familiarize yourself with the table of
contents for this section and then refer to parts of it as you need specific
information. Use it in conjunction with the reference section.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay C++ Samples. A guide
to the C/C++ sample applications in the SDK.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay Visual Basic Samples.
A guide to the Visual Basic sample applications in the SDK.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay C/C++ Reference.
Detailed information for the DirectPlay C++ API. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay Visual Basic
Reference. Detailed information the DirectPlay Visual Basic API. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h1 style='page-break-after:avoid'>What's New in DirectPlay</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>The networking component of
Microsoft<span style='font-size:7.0pt'></span> DirectX<span style='font-size:
7.0pt'></span> has undergone a major revision. Microsoft DirectPlay<span
style='font-size:7.0pt'></span> introduces a new set of interfaces that enable
games to have more direct access to the hardware, providing better performance.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following list describes
some of the new DirectPlay features.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=Term1><b>Interfaces have been completely rewritten.</b></p>

<p class=Def1>The complexity of creating a networked application has been
dramatically simplified by separating the interfaces for creating peer-to-peer
and client/server sessions. The interfaces for creating DirectPlay transport
sessions, which are defined in the Dplay8.h header file, are now:</p>

<p class=Term2><b>IDirectPlay8Peer</b></p>

<p class=Def2>Provides methods for creating peer-to-peer sessions.</p>

<p class=Term2><b>IDirectPlay8Client</b></p>

<p class=Def2>Provides methods for creating the client-side portion of a
client/server application.</p>

<p class=Term2><b>IDirectPlay8Server</b></p>

<p class=Def2>Provides methods for creating the server-side portion of a
client/server application.</p>

<p class=Term1><b>Lobbying is now independent from the rest of DirectPlay.</b></p>

<p class=Def1>DirectPlay has removed the requirement that a lobby client work
only with a DirectPlay application. This will allow for either the lobby
service provider or the application to implement DirectPlay without concern for
the other. Lobby implementation is now separated into two simplified interfaces
that are defined in the Dplobby8.h header file. </p>

<p class=Term2><b>IDirectPlay8LobbyClient</b></p>

<p class=Def2>This interface is used to manage a lobby client and for
enumerating and launching lobby-aware applications.</p>

<p class=Term2><b>IDirectPlay8LobbiedApplication</b></p>

<p class=Def2>This interface is used to register a lobby launchable application
with the system so it can be lobby launched. It also is used to get the
connection information from the lobby to enable game launching without querying
the user.</p>

<p class=Term1><b>Voice transmission has been added.</b></p>

<p class=Def1>DirectPlay Voice provides a set of interfaces to add real-time
voice communication to an application. The following interfaces are defined in
the Dvoice.h header file.</p>

<p class=Term2><b>IDirectPlayVoiceClient</b></p>

<p class=Def2>Provides methods to create and manage clients in a DirectPlay
Voice session.</p>

<p class=Term2><b>IDirectPlayVoiceServer</b></p>

<p class=Def2>Provides methods to host and manage a DirectPlay Voice session.</p>

<p class=Term2><b>IDirectPlayVoiceTest</b></p>

<p class=Def2>Used to test DirectPlay Voice audio configurations.</p>

<p class=Term1><b>Addressing information has moved from GUID-based data to
URL-based data format.</b></p>

<p class=Def1>Previous versions of DirectPlay used binary chunks of data with
GUID addresses that were difficult to implement and that humans could not read.
In DirectX 8.0, DirectPlay introduces the representation of addresses in URL
format. A set of interfaces, defined in Dpaddr.h, is used to create and
manipulate the new addressing format.</p>

<p class=Term2><b>IDirectPlay8Address</b></p>

<p class=Def2>Provides generic addressing methods used to create and manipulate
DirectPlay addresses.</p>

<p class=Term2><b>IDirectPlay8AddressIP</b></p>

<p class=Def2>Provides IP provider-specific addressing services.</p>

<p class=Term1><b>Higher scalability and better memory management have been
added.</b></p>

<p class=Def1>Increases in consumer bandwidth have dramatically affected
network game design and implementation. Improved DirectPlay thread-pool
management makes it easier to for the developer to design scalable, more robust
applications that can support massive multiplayer online applications.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=Term1><b>Objects have been completely rewritten.</b></p>

<p class=Def1>The complexity of creating a networked application has been
dramatically simplified by separating the objects used for creating
peer-to-peer and client/server sessions. The objects for creating DirectPlay
transport sessions are now</p>

<p class=Term2><b>DirectPlay8Peer</b></p>

<p class=Def2>Provides methods for creating peer-to-peer sessions.</p>

<p class=Term2><b>DirectPlay8Client</b></p>

<p class=Def2>Provides methods for creating the client-side portion of a
client/server application.</p>

<p class=Term2><b>DirectPlay8Server</b></p>

<p class=Def2>Provides methods for creating the server-side portion of a
client/server application.</p>

<p class=Term1><b>Lobbying is now independent from the rest of DirectPlay.</b></p>

<p class=Def1>DirectPlay has removed the requirement that a lobby client work
only with a DirectPlay application. This will allow for either the lobby
service provider or the application to implement DirectPlay without concern for
the other. Lobby implementation is now separated into two simplified objects.</p>

<p class=Term2><b>DirectPlay8LobbyClient</b></p>

<p class=Term2>This object is used to manage a lobby client and for enumerating
and launching lobby-aware applications.</p>

<p class=Term2><b>DirectPlay8LobbiedApplication</b></p>

<p class=Def2>This object is used to register a lobby launchable application
with the system so it can be lobby launched. It also is used to get the
connection information from the lobby to enable game launching without querying
the user.</p>

<p class=Term1><b>Voice transmission has been added.</b></p>

<p class=Def1>DirectPlay Voice provides a set of objects to add real-time voice
communication to an application. The following objects are defined in the
Dvoice.h header file.</p>

<p class=Term2><b>DirectPlayVoiceClient</b></p>

<p class=Def2>Provides methods to create and manage clients in a DirectPlay
Voice session.</p>

<p class=Term2><b>DirectPlayVoiceServer</b></p>

<p class=Def2>Provides methods to host and manage a DirectPlay Voice session.</p>

<p class=Term2><b>DirectPlayVoiceTest</b></p>

<p class=Def2>Used to test DirectPlay Voice audio configurations.</p>

<p class=Term1><b>Addressing information has moved from GUID-based data to
URL-based data format.</b></p>

<p class=Def1>Previous versions of DirectPlay used binary chunks of data with
GUID addresses that were difficult to implement and that humans could not read.
In DirectX 8.0, DirectPlay introduces the representation of addresses in URL
format. DirectPlay provides an object that is used to create and manipulate the
new addressing format.</p>

<p class=Term2><b>DirectPlay8Address</b></p>

<p class=Def2>Provides generic addressing methods used to create and manipulate
DirectPlay addresses.</p>

<p class=Term1><b>Higher scalability and better memory management have been
added.</b></p>

<p class=Def1>Increases in consumer bandwidth have dramatically affected
network game design and implementation. Improved DirectPlay thread-pool
management makes it easier to for the developer to design scalable, more robust
applications that can support massive multiplayer online applications.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Term1><b>Better support for Firewalls and Network Address Translators
has been added.</b></p>

<p class=Def1>Writing network games that traverse Network Address Translators
(NATs), Firewalls, and other Internet Connection Sharing (ICS) methods can be
difficult, particularly for non-guaranteed (UDP) traffic. Because DirectPlay
8.0 has been developed with these issues in mind, it will support NAT solutions
where possible. The DirectPlay 8 TCP/IP service provider uses a single,
developer-selectable UDP port for game data, making it possible to configure
firewalls and NATs appropriately. Additionally, DirectPlay makes use of UDP so
that, for client/server games, clients behind some NATs will be able to connect
to games without additional configuration.</p>

<h1 style='page-break-after:avoid'>Introduction To DirectPlay</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
API provides developers with the tools to develop multiplayer applications such
as games or chat clients. For simplicity, this documentation will refer to all
such applications as &quot;games&quot;. A multiplayer application has two basic
characteristics:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Two or more individual users,
each with a game client on their computer.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Network links that enable the
users' computers to communicate with each other, perhaps through a centralized
server.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay provides a layer that
largely isolates your application from the underlying network. For most
purposes, your application can simply use the DirectPlay API, and enable
DirectPlay to handle the details of network communication. DirectPlay provides
many features that simplify the process of implementing many aspects of a
multiplayer application, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Creating and managing both
peer-to-peer and client/server sessions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing users and groups within
a session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing messaging between the
members of a session over different network links and varying network
conditions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Enabling applications to
interact with lobbies</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Enabling users to communicate
with each other by voice</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This documentation provides a
high-level overview of the capabilities of DirectPlay. Subsequent sections will
take you into the details of how to use DirectPlay in your multiplayer game.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Creating and Managing Sessions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Network Communication</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with DirectPlay
Objects</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Lobby Support</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Voice Communication</span></p>

<h2 style='page-break-after:avoid'>Creating and Managing Sessions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A game <i>session</i> is an
instance of a particular multiplayer game. A session has two or more users
playing simultaneously, each with the same game client on his or her computer.
A <i>player</i> is an entity in the game itself, and is defined by the
particular game. Each user may have more than one <i>player</i> in a game.
However, the game application must manage these players itself, using separate
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> interfaces or objects for each player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first step in creating a
session is to collect a group of users. There are two basic approaches:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Many game sessions are arranged
by a <i>lobby</i> application running on a remote computer. This approach is
used by most Internet-based games.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> It is also possible to arrange
games by having the individual users' computers communicate with each other.
This approach is typically limited such situations as a group of potential
users that are all on the same LAN.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the session has been
arranged, the game is launched and gameplay begins. As the session proceeds,
players may be eliminated from the session, or new players added. The details
are up to the individual game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>With a multiplayer game, each
user's UI can be synchronized with that of all the other users in the session.
Managing a multiplayer session thus requires a continual stream of messages to
and from each user. For example, every time a player moves, a message must be
sent to update that player's position on all the other game clients in the
session. The core of DirectPlay is that part of the API that supports efficient
and flexible messaging between all the computers in a session. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are two basic ways to
structure the messaging <i>topology</i> of a session: <i>peer-to-peer</i> and <i>client/server</i>.
Both topologies have their advantages and limitations, so you will need to
evaluate which is most appropriate for your game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Peer-to-Peer Topology</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Client/Server Topology</span></p>

<p class=Leh>&nbsp;</p>

<h3 style='page-break-after:avoid'>Peer-to-Peer Topology</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>A peer-to-peer game consists of
the individual players' computers, connected by network links. Schematically,
the topology of a four-player peer-to-peer game looks like:</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=209
height=157 id="Picture 6" src="dplay_files/image001.gif"></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Gameplay is handled by having
each user's game client communicate directly with the other users' clients. For
instance, when one user moves, the game client must send three update messages,
one to each of the other users' computers.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A peer-to-peer game is normally
arranged and launched through a <i>lobby client</i> application that resides on
the user's computer. There are two basic ways the lobby client can arrange a
session:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The lobby client communicates
directly with other potential users' lobby clients. This approach can be used,
for instance, to arrange a game among users on the same LAN subnet.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The lobby client acts as a link
to lobby server application running on a remote computer. This is the way
Internet-based games are normally arranged.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once a session has been arranged
and launched, most or all of the messaging will be user to user. If a lobby
server is involved, it will only be handling such tasks as updating its list of
session members when a player leaves the game, or enabling a new user to
request entry to the session. Otherwise, the server stays in the background,
and is typically not even aware of most of the messages that are being sent.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because the server is either
non-existent or at least not directly involved with the game play, one user is
designated as the game <i>host</i>. They are responsible for handling
logistical details such as bringing new players into an ongoing session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Peer-to-peer games have the
advantage of simplicity. All that is needed is a collection of players with
game clients, and a way to organize a session. The primary drawback of the
peer-to-peer topology is scalability. As the number of users increase, the number
of messages needed to facilitate game play increases geometrically. The maximum
number of users that can be accommodated depends on the game and the network
bandwidth, but is typically no more than 20-30.</p>

<h3 style='page-break-after:avoid'>Client/Server Topology</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client/server game consists of
the individual players' computers, connected to a central server computer.
Schematically, the topology of a four-player peer-to-peer game looks like:</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=220
height=154 id="Picture 5" src="dplay_files/image002.gif"></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Gameplay is handled by having
each user's game client communicate with the server. The server is responsible
for passing information on to the other users. For instance, when one user
moves, they send a message to the server. The server then sends messages to the
other players to inform them of a change in game state. The server can have a
number of responsibilities:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Act as the session's messaging
hub. Each computer only needs to send messages to the server. The server
handles the logistics of synchronizing all the other users. This arrangement
can substantially reduce message traffic, especially for large games.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Host the game. The server
normally takes care of the tasks that must be handled by the session host in a
peer-to-peer game.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Support many aspects of the
game. The server often does much more than support game logistics. With many
games, especially large ones, much of the processing that maintains the
&quot;game universe&quot; takes place on the server. The game clients are primarily
responsible for handling the user's UI.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client/server game is normally
arranged and launched through a <i>lobby client</i> application that resides on
the user's computer. The lobby client acts as a link to a lobby server
application that is normally running on a the same remote computer that is
hosting the game. Once the game has been launched, the game server application becomes
the host, and handles tasks such as admitting new users to the game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are a number of advantages
to client/server games:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> They are more efficient,
especially for large-scale games. In particular, the scale much better than
peer-to-peer games, because additional players only cause a linear increase in
the messaging traffic. The client/server topology is necessary for massively-multiplayer
games. </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You not limited by the
processing power of your users' computers. You can locate much of the
processing required to maintain a large complex &quot;game universe&quot; on a
single powerful computer, and let the users' computers handle the UI.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You can control key aspects of
your game at a central site. For instance, you can often update the game or fix
bugs by simply modifying the server application, avoiding the need to update
large numbers of game clients.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>However, once you have developed
and shipped a peer-to-peer game, you are essentially finished. The game clients
are largely self-sufficient. With a client/server game, you have an ongoing
commitment to your users that goes beyond providing normal support services.
You must also provide and maintain a game server computer and the associated
software, along with the network links to handle all the messaging, for the
lifetime of the application. In the case of massively multiplayer games, you
may need to operate your servers for extended periods with few or no breaks in
service, or risk angering users by disrupting their gameplay.</p>

<h2 style='page-break-after:avoid'>DirectPlay Network Communication</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The primary function of
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> is to provide you with efficient and flexible
messaging support that largely isolates your application from the underlying
network hardware and software. If you need to send a status update, you can
simply call the relevant DirectPlay API, regardless of what kind of network
link is involved. DirectPlay network service providers support communication
over TCP/IP, IPX, modem, and serial links.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Transport Protocol</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Addresses</span></p>

<p class=Leh>&nbsp;</p>

<h4 style='page-break-after:avoid'>Notes</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay does not support
secure communications.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To use modems on Microsoft
Windows<span style='font-size:7.0pt'></span> 95 systems, you must install
version 2.0 of the Telephony API (TAPI). You can download TAPI 2.0 from
http://www.microsoft.com.</p>

<h3 style='page-break-after:avoid'>DirectPlay Transport Protocol</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The core of the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
networking capabilities is the DirectPlay protocol. This transport-layer
protocol has been completely overhauled for DirectPlay 8, and is now used for
all messaging. The DirectPlay protocol is focused on making it simple for you
to send data from the sending application to the target application, without
needing to worry about what happens in between. The protocol offers a number of
features that are tailored to the needs of multiplayer games, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Reliable and unreliable delivery
of messages. Reliable messages will be resent until the target application
receives them. You can assign the delivery type on a message-by-message basis.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Sequential and non-sequential
delivery of messages. Sequential messages will be passed to the target
application in the order they were sent.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Message fragmentation and
reassembly. If message size exceeds the capacity of a particular network,
DirectPlay automatically fragments and reassembles the message.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Congestion control. DirectPlay
automatically <i>throttles</i> your outgoing messages to a level that can be
handled by the target. This feature prevents you from flooding the target with
more messages than it can process.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send prioritization. To ensure
that the most important messages get sent first, DirectPlay enables you to
designate messages as low, medium, or high priority. The high priority messages
are sent to the front of the output queue, followed by medium and low priority
messages.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Message timeouts. To prevent the
outgoing message queue from being clogged with messages that have been
superseded by more recent messages, DirectPlay enables you to assign a timeout
value to all messages. When a message times out, it is removed from the
outgoing message queue, regardless of whether it has been sent or not.</span></p>

<h3 style='page-break-after:avoid'>DirectPlay Addresses</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In order to deliver messages,
each participant in a multiplayer game must have a unique address. Addresses
can refer either to the computer that your application is running on (<i>device
address</i>), or a computer that your application needs to communicate with (<i>host
address</i>).</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> addresses are
in the form of URL strings. These strings consist of a scheme, scheme
separator, and data string in the following general format.</p>

<p class=Ex>x-directplay:/[<i>data string</i>]</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The data string contains several
elements that specify everything that is needed to enable communication to take
place between sender and target, over a variety of different types of network
link.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In use, the URL strings are
embedded in a DirectPlay address object which is passed to or from DirectPlay
API methods. You have the option of either manipulating the URL string
directly, or using the methods exposed by the address object to handle each element
of the data string separately.</p>

<h2 style='page-break-after:avoid'>Communicating with DirectPlay Objects</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> essentially
consists of a collection of COM objects. Each object exposes one or more
interfaces that enable you to control various aspects of DirectPlay. For
instance, the DirectPlay peer object (CLSID_DirectPlay8Peer) is used to manage
peer-to-peer games.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You communicate with a
DirectPlay object by calling the methods exposed by its interfaces. For
instance, to send some data to another user in a peer-to-peer game, you would
send a message by calling the <b>IDirectPlay8Peer::SendTo</b> method.
DirectPlay then takes care of getting the message to its target.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You communicate with a
DirectPlay object by calling the methods exposed by its interfaces. For
instance, to send some data to another user in a peer-to-peer game, you would
send a message by calling the <b>DirectPlay8Peer.SendTo</b> method. DirectPlay
then takes care of getting the message to its target.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay communicates with
your application through one or more <i>callback functions</i>. These functions
are similar in principle to the familiar Window procedure. Your application
implements the callback function and passes a pointer to the function to
DirectPlay during initialization. When DirectPlay needs to communicate with
your application, it calls the callback function and passes in two key items of
information:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A message ID that identifies the
message type</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A pointer to a block of data,
typically a structure, that provides any needed details.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For instance, when the message
sent in the above example arrives at its target, the target application's
callback function will receive a message with a DPNMSGID_RECEIVE message id,
indicating that a message has arrived from another user. The accompanying
structure contains the data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because much of DirectPlay
messaging is multithreaded, it is critical that callback functions be properly
implemented.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay communicates with
your application through one or more <i>message handlers</i>. A message handler
is an object that DirectPlay calls to notify your application of various
events. The documentation describes the methods that are exposed by the object,
but you must implement all of the objects methods in your application. You then
register the object during startup, and DirectPlay will call the object's
methods to notify you when an event has occurred. Additional information about
the event is passed through the method's parameters. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>DirectPlay Lobby Support</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobby is an application whose
primary purpose is to enable players to meet and arrange games. It is typically
located on a remote computer, and accessed over the Internet. Lobby servers
often also perform a variety of other functions, such as hosting chat rooms,
posting news and information, and selling merchandise. While lobby servers are
convenient and commonly used to arrange multiplayer games, they aren't
required. Multiplayer games can also be arranged by direct communication
between lobby clients.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are normally three
components that are needed to enable a game to interact with a lobby:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A <i>lobby server</i></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A<i> lobby client</i></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A <i>lobbyable</i> game.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
specify how you should implement a lobby server application. Instead,
DirectPlay provides support for a lobby client. A lobby client is an
application that is implemented by a lobby server vendor, and installed on each
user's system. It serves as a link between the user and the lobby. While you
could handle such communication directly, you would have to know the specific
implementation details of every lobby that might launch your game. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client application
handles the details of communicating with its associated lobby server, using
whatever protocols are appropriate. The lobby client communicates with the user
and their game applications through a DirectPlay interface. DirectPlay then
passes messages to the application. The application can also use a DirectPlay
interface to pass messages to the lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobby can launch virtually any
application. However, the application must have some specific lobby-aware
components to take full advantage of lobby-launching. In particular, a
lobbyable application can communicate with the lobby client throughout the course
of the session. If an application is registered as lobbyable, the lobby client
also automatically receives updates for various changes in game status, such as
host migration.</p>

<h2 style='page-break-after:avoid'>DirectPlay Voice Communication</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The current trend toward
team-based multiplayer games makes player-to-player communication an essential
part of gameplay. Historically this has been confined to text-based
communication, where players type out the messages to their teammates. Although
suitable for slower, turn-based games, text-based communication is at best an
inconvenience for real-time games. Not only does it put slow typists at a
disadvantage during gameplay but also it is a significant break in the reality
that games attempt to create for the player. An obvious solution to the problem
is the use of speech as a means for communication. It requires no training and
increases the immersion of the game itself. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The windows platform provides
all the tools required to provide real-time voice conferencing to video game
developers, but it requires a significant amount of effort on the part of the
game developer. This, combined with the cost and difficulty of obtaining the
rights to compression technology capable of handling extremely low bandwidth
situations, has prevented the wide-spread use of voice in games. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> 8.0 provides
the game developer with a robust real-time voice conferencing system that
requires a minimal amount of effort to use.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>Understanding DirectPlay</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section of the Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
documentation provides the basic background you need to understand how to use
the DirectPlay API in your application.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <span style='position:relative;
top:-.5pt'>Peer-to-Peer Sessions</span></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Client/Server Sessions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Lobbies</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Basic Networking</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Callback Functions
and Multithreading Issues</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Understanding DirectPlay Voice</span></p>

<h2 style='page-break-after:avoid'>Peer-to-Peer Sessions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A peer-to-peer session consists
of a collection of users connected by a network. While a lobby server may be
used to arrange and launch the game, the messaging needed to run the game is
sent directly from one user's to another. Any communication with the lobby
server is for such limited purposes as updating the list of participants.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>With a peer-to-peer game,
everything that is needed to run the game is part of the client software. With
no server involved, all the processing needed to create and maintain the game
universe must be handled by the client applications. This document discusses
the basic principles of a lobbyable Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> peer-to-peer game. For a simple working
example of a peer-to-peer application, see the SimplePeer application included
with the SDK.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Initiating a Peer-to-Peer
Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Selecting a Service Provider for
a Peer-to-Peer Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Selecting a Host for a
Peer-to-Peer Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Connecting to a Peer-to-Peer
Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing a Peer-to-Peer Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Host Migration</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Normal Peer-to-Peer Game Play</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Leaving a Peer-to-Peer Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Terminating a Peer-to-Peer
Session</span></p>

<h3 style='page-break-after:avoid'>Initiating a Peer-to-Peer Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>A peer-to-peer game can be
launched directly by the user, or <i>lobby-launched</i> by a <i>lobby client</i>
application that resides on the user's computer. This documentation will assume
that the game is lobbyable, and can communicate with the lobby client. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first steps you
should take is to determine whether your game was lobby-launched. To do so,
create and initialize a lobbied application object (CLSID_DirectPlay8LobbiedApplication).
When you do so, you pass the object a pointer to your lobbied application
message handler. This message handler receives messages directly from the
lobbied application object, and indirectly from the lobby client and the lobby.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the application was
lobby-launched, the <b>IDirectPlay8LobbiedApplication::Initialize</b> method
returns a connection handle for the lobby client and a <b>DPL_MSGID_CONNECT</b>
message is sent to your lobbied application message handler. The <b>pdplConnectionSettings</b>
member of the associated structure points to a <b>DPL_CONNECTION_SETTINGS </b>structure
that contains connection information such as address objects for the members of
the session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the application was not lobby
launched, you will receive neither the connection handle, nor the message.
However, if you call <b>IDirectPlay8LobbiedApplication::SetAppAvailable</b>, a
lobby client can later connect your running application to a session by sending
your lobbied application message handler a <b>DPL_MSGID_CONNECT</b> message.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should also create and
initialize a peer object (CLSID_DirectPlay8Peer). This object will be your
primary means of communicating with Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span>, and the other users in the session. If you
want to have multiple players in the session, you must create a separate
instance of this object for each player.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first steps you
should take is to determine whether your game was lobby-launched. To do so,
create a <b>DirectPlay8LobbiedApplication</b> object and a <b>DirectPlay8LobbyEvent
</b>object. Register the <b>DirectPlay8LobbyEvent</b> object with Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
by calling <b>DirectPlay8LobbiedApplication.RegisterMessageHandler</b>. The <b>DirectPlay8LobbyEvent</b>
object is essentially an event handler that receives notifications directly
from the lobbied application object, and indirectly from the lobby client and
the lobby. It is not provided by DirectPlay and must be implemented by your
application. See the reference documentation for details.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the application was
lobby-launched, DirectPlay will call your <b>DirectPlay8LobbyEvent.Connect</b>
method. The <i>dlNotify</i> parameter will contain a <b>DPL_MESSAGE_CONNECT</b>
type with connection information. such as address objects for the members of
the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should also create a <b>DirectPlay8Peer</b>
object and register a <b>DirectPlay8Event</b> notification handler object by
calling <b>DirectPlay8Peer.RegisterMessageHandler</b>. These objects will be
your primary means of communicating with DirectPlay and the other users in the
session. If you want to have multiple players in the session, you must create a
separate instance of these objects for each player.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Selecting a Service Provider for a
Peer-to-Peer Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The service provider is your
network connection. Most games use either the TCP/IP or modem service provider,
but Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> also provides support for serial and IPX
connections. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your user was connected to
the session by a lobby client, you can determine the appropriate service
provider by examining the <b>DPL_CONNECTION_SETTINGS </b>structure that
accompanies the <b>DPL_MSGID_CONNECT</b> message. Otherwise, you may need to
determine which service provider to use, perhaps by querying the user. You can
use the peer object's <b>IDirectPlay8Peer::EnumServiceProviders</b> method to
enumerate the available service providers. See Using DirectPlay Enumerations
for further discussion.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your user was connected to
the session by a lobby client, you can determine the appropriate service
provider by examining the <b>DPL_MESSAGE_CONNECT </b>structure that accompanies
the <b>DirectPlay8LobbyEvent.Connect</b> method. Otherwise, you may need to
determine which service provider to use, perhaps by querying the user. You can
also use the peer object's <b>DirectPlay8Peer.GetServiceProvider</b> enumerate
the available service providers.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once you have selected a service
provider, you can then create a DirectPlay address object for your user (a <i>device
address)</i>. You will use this address to identify your device with a number
of DirectPlay methods. See DirectPlay Addressing for a detailed discussion of
DirectPlay addresses and address objects.</p>

<h3 style='page-break-after:avoid'>Selecting a Host for a Peer-to-Peer Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although most aspects of
peer-to-peer games can be handled by the various users' communicating directly
with each other, there are some tasks that must have a single owner. These
tasks are handled by the game host. To join a session, you must know the address
of the session's host. A common way to select a host is through a lobby server.
In that case, when a user's application is connected to the session, the
connection settings that you receive with the <b>DPL_MSGID_CONNECT</b> message
include the host's address object. To find out who the session host is:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Check the <b>dwFlags</b> member
of the <b>DPL_CONNECTION_SETTINGS </b>structure that is returned. If that
member is set to DPLCONNECTSETTINGS_HOST, your system is the host.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the DPLCONNECTSETTINGS_HOST
flag is not set, then you can get the address of the host from the <b>pdp8HostAddress</b>
member.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also create a broadcast
session, perhaps on a LAN subnet, by advertising yourself as a session host. To
do so call <b>IDirectPlay8Peer::SetPeerInfo </b>to set the player's name and
then call <b>IDirectPlay8Peer::Host</b> to advertise yourself as a potential
host. You specify the configuration of the game by assigning values the <b>DPN_APPLICATION_DESC</b>
structure that is passed through the <i>pdnAppDesc</i> parameter of <b>IDirectPlay8Peer::Host</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To allow your user to examine
the available sessions and hosts, you can enumerate the available hosts by
calling <b>IDirectPlay8Peer::EnumHosts</b>. Once the user has selected a
session, you can request a connection.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although most aspects of
peer-to-peer games can be handled by the various users' communicating directly
with each other, there are some tasks that must have a single owner. These
tasks are handled by the game host. To join a session, you must know the
address of the session's host. A common way to select a host is through a lobby
server. In that case, when a user's application is connected to the session,
the connection settings that you receive when Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> calls your <b>DirectPlay8LobbyEvent.Connect</b>
method include the host's address object. To find out who the session host is:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Check the <b>dwFlags</b> member
of the <b>DPL_CONNECTION_SETTINGS </b>structure that is contained in the <b>DPL_MESSAGE_CONNECTION_SETTINGS
</b>passed as the <i>dlNotify</i> parameter. If that member is set to
DPLCONNECTSETTINGS_HOST, your system is the host.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the DPLCONNECTSETTINGS_HOST
flag is not set, then you can get the address of the host from the <b>pdp8HostAddress</b>
member.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also create a broadcast
session, perhaps on a LAN subnet, by advertising yourself as a session host. To
do so call <b>DirectPlay8Peer.SetPeerInfo </b>to set the player's name and then
call <b>DirectPlay8Peer.Host</b> to advertise yourself as a potential host. You
specify the configuration of the game by assigning values the <b>DPN_APPLICATION_DESC</b>
type that is passed through the <i>pdnAppDesc</i> parameter of <b>IDirectPlay8Peer.Host</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To allow your user to examine
the available sessions and hosts, you can enumerate the available hosts by
calling <b>DirectPlay8Peer.EnumHosts</b>. Once the user has selected a session,
you can request a connection.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Connecting to a Peer-to-Peer Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unless you are the session host,
you will need to connect your player to the session. To do so, you must have
the address of the session host. If your application was connected by a lobby
client, you can obtain the host's address by calling <b>IDirectPlay8LobbiedApplication::GetConnectionSettings</b>.
You can also obtain the address by enumerating the available hosts. The
information returned by the enumeration includes each host's addresses, and a <b>DPN_APPLICATION_DESC</b>
structure that describes the associated session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To ask to join a session, call <b>IDirectPlay8Peer::SetPeerInfo</b>
to set your player's name, and then call <b>IDirectPlay8Peer::Connect</b> with
the selected host's address to connect to the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a player attempts to join a
session, the host receives a <b>DPN_MSGID_INDICATE_CONNECT</b> message. To
accept the player into the session, return S_OK. Returning any other value
rejects the request. In either case, the player will receive a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message that contains your response. If the host accepted the connection, the <b>hResultCode</b>
member of the associated structure will be set to S_OK. If not, <b>hResultCode</b>
will be set to DPNERR_HOSTREJECTEDCONNECTION.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host can define a player
context value when they receive the <b>DPN_MSGID_INDICATE_CONNECT </b>message,
however the player ID will not yet be defined. The host can also wait to define
a player context value until they receive a <b>DPN_MSGID_CREATE_PLAYER</b>
message, which includes the player ID. Ordinary players to not receive a <b>DPN_MSGID_INDICATE_CONNECT
</b>message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the new player is
connected, each member of the session, including the host, receives a <b>DPN_MSGID_CREATE_PLAYER</b>
message announcing the new player. The structure associated with the message
contains the player ID that you will use to send messages to that player. Peers
that are not hosts must define the player context value when they handle this
message. Once a peer or host has returned from handling this message, that
player context value is set for the session, and cannot be changed. See Using
Player Context Values for more discussion of player context values.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unless you are the session host,
you will need to connect your player to the session. To do so, you must have
the address of the session host. If your application was connected by a lobby
client, you can obtain the host's address by calling <b>DirectPlay8LobbiedApplication.GetConnectionSettings</b>.
You can also obtain the address by enumerating the available hosts. The
information returned by the enumeration includes each host's addresses, and a <b>DPN_APPLICATION_DESC</b>
structure that describes the associated session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To ask to join a session, call <b>DirectPlay8Peer.SetPeerInfo</b>
to set your player's name, and then call <b>DirectPlay8Peer.Connect</b> with
the selected host's address to connect to the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a player attempts to join a
session, the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> calls the host's <b>DirectPlay8Event.IndicateConnect</b>
method. To accept the player into the session, set the method's <i>fRejectMsg</i>
parameter to False before returning. Setting <i>fRejectMsg</i> to True rejects
the request. In either case, the player's <b>DirectPlay8Event.ConnectComplete</b>
method will be called with the response. If the host accepted the connection,
the <b>hResultCode </b>member<b> </b>of the <b>DPNMSG_CONNECT_COMPLETE</b> type
will be set to 0. If the request was rejected or failed for some other reason, <b>hResultCode</b>
will be set to an error code.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the new player is
connected, DirectPlay announces the new player by calling <b>DirectPlay8Event.CreatePlayer</b>
for each member of the session, including the host. The <i>lPlayerID</i>
parameter contains the player ID that you will use to send messages to that
player.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Managing a Peer-to-Peer Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The session host is responsible
for managing the session, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing the list of session
members and their network addresses</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Deciding whether a new user is
allowed to join the session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Notifying all members when a new
user joins the session, and passing them the new user's address.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Providing new users with the
current game state</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Notifying all users when a user
leaves the session</span></p>

<p class=Le>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When players attempt to join a
session, the host will receive a <b>DPN_MSGID_INDICATE_CONNECT</b> message. To
accept the player into the session return S_OK. Returning any other value
rejects the request. In either case, the player will receive a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message that contains your response.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host can remove a player
from the session by calling <b>IDirectPlay8Peer::DestroyPeer</b>. Other members
of the session cannot call this method successfully. If you want to allow
players to request that another player be removed from the session, you must
send the request to the host with normal Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span> messaging, and have the
host handle the request.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When players attempt to join a
session, Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> will call the host's <b>DirectPlay8Event.IndicateConnect</b>
method. To accept the player into the session set <i>fRejectMsg</i> to False.
Setting <i>fRejectMsg</i> to any other value rejects the request. In either
case, DirectPlay calls the player's <b>DirectPlay8Event.ConnectComplete</b>
method with the response to the request.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host can remove a player
from the session by calling <b>DirectPlay8Peer.DestroyPeer</b>. Other members
of the session cannot call this method successfully. If you want to allow
players to request that another player be removed from the session, you must
send the request to the host, and have the host handle the request.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Host Migration</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>While the host must be one of
the initial members of the session, they may choose to leave before session is
finished. When the host leaves the session, there are two possible outcomes :</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session terminates.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The host <i>migrates</i>, and
another user becomes host.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sessions may or may not permit
host migration. To enable host migration, the session organizer must set the
DPNSESSION_MIGRATE_HOST flag in the <b>dwFlags</b> member of the <b>DPN_APPLICATION_DESC
</b>structure when they set up the game. If this flag is not set, the session
terminates when the host leaves.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DPNSESSION_MIGRATE_HOST
flag is set, the host can still force the session to terminate by calling <b>IDirectPlay8Peer::TerminateSession</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If DPNSESSION_MIGRATE_HOST flag
is set and the host leaves the session, Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span> will select a new
session host. All remaining session members will receive a <b>DPN_MSGID_HOST_MIGRATE</b>
message that includes the ID of the new host.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sessions may or may not permit
host migration. To enable host migration, the session organizer must set the
DPNSESSION_MIGRATE_HOST flag in the <b>dwFlags</b> member of the <b>DPN_APPLICATION_DESC
</b>type when they set up the game. If this flag is not set, the session
terminates when the host leaves or loses their connection.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DPNSESSION_MIGRATE_HOST
flag is set, the host can still force the session to terminate by calling <b>DirectPlay8Peer.TerminateSession</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If DPNSESSION_MIGRATE_HOST flag
is set and the host leaves the session, Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span> will select a new
session host. DirectPlay will call the <b>DirectPlay8Event.HostMigrate</b>
method of all remaining session members with the ID of the new host.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Normal Peer-to-Peer Game Play</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>,
a message is essentially a block of game-related data that you send to one or
more members of the session. DirectPlay does not specify the contents or format
of the data block, it just provides a mechanism to transmit the data from one
user to another. Once the game is underway, each session member will normally
send a constant stream of messages to all other members of the session for the
duration of the game. The primary purpose of these messages is to keep the game
state synchronized, so that each user's application displays the same UI.
However, messages can also be used for a variety of other game-specific
purposes.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For many games, especially
rapidly changing ones, you may have to manage your messaging carefully.
DirectPlay throttles outgoing messages to a level that can be handled by the
target. You will have be careful that you do not send messages too rapidly, and
ensure that the most important messages get through. See Basic Networking for a
discussion of how to effectively handle DirectPlay messaging.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to another
session member, call <b>IDirectPlay8Peer::SendTo</b>. That member will receive
a <b>DPN_MSGID_RECEIVE </b>message with the data. To send a message to a
specific player, set the <i>dpnid</i> parameter to the player ID that you
received with the associated <b>DPN_MSGID_CREATE_PLAYER</b> message. You can
also send a message to every player in the session by setting <i>dpnid</i> to
DPNID_ALL_PLAYERS_GROUP. You can also define groups of players, and use a
single <b>SendTo </b>call to send a message to all members of a group.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>You can also use the <b>IDirectPlay8Peer::SetPeerInfo</b> method
to send information to other users. They will receive the information with a <b>DPN_MSGID_PEER_INFO</b>
message. However, this way of transmitting information is not very efficient,
and should not be used for normal messaging.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to another
session member, call <b>DirectPlay8Peer.SendTo</b>. DirectPlay will call that
members <b>DirectPlay8Event.Receive</b> method with the data. To send a message
to a specific player, set the <i>idSend</i> parameter to the player ID that you
when your <b>DirectPlay8Event.CreatePlayer</b> method was called. You can also
send a message to every player in the session by setting <i>idSend</i> to
DPNID_ALL_PLAYERS_GROUP. You can also define groups of players, and use a
single <b>SendTo </b>call to send a message to all members of a group.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>You can also use the <b>DirectPlay8Peer.SetPeerInfo</b> method to
send information to other users. DirectPlay will call their <b>DirectPlay8Event.InfoNotify</b>
method with the information. However, this way of transmitting information is
not very efficient, and should not be used for normal messaging.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>Using Groups</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Many games allow players to be
organized into groups. For instance, strategy games typically allow individual
players to be organized into groups that can then be directed as a single
entity. Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> also allows the formation of groups of
players. DirectPlay groups are essentially a way to simplify your messaging.
Once you have defined a group, you can send a message to every group member
with a single call to <b>IDirectPlay8Peer::SendTo</b>. While DirectPlay groups
normally correspond to the groups that are defined by the game, you are free to
create a group for any reason.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create a DirectPlay group,
call <b>IDirectPlay8Peer::CreateGroup</b> All session members will then receive
a <b>DPN_MSGID_CREATE_GROUP</b> message with the details. The message will
include a group ID that is used to send messages to the group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is created, you
then add players by calling <b>IDirectPlay8Peer::AddPlayerToGroup</b>. Session
members will then receive a <b>DPN_MSGID_ADD_PLAYER_TO_GROUP</b> message with
the IDs of the group and the player that was just added.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is established,
you can send data to the group by calling <b>IDirectPlay8Peer::SendTo</b>, with
the <i>dpnid</i> parameter set to the group ID. All group members will then
receive a <b>DPN_MSGID_RECEIVE</b> message with the data. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To remove a player from a group,
call <b>IDirectPlay8Peer::RemovePlayerFromGroup</b>. The session members will
receive a <b>DPN_MSGID_DESTROY_PLAYER </b>message with the player's ID.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Finally, when you no longer need
the group, you can destroy it by calling <b>IDirectPlay8Peer::DestroyGroup</b>
All session members will then receive a <b>DPN_MSGID_DESTROY_GROUP</b> message
with the group ID.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Many games allow players to be
organized into groups. For instance, strategy games typically allow individual
players to be organized into groups that can then be directed as a single
entity. Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> also allows the formation of groups of
players. DirectPlay groups are essentially a way to simplify your messaging.
Once you have defined a group, you can send a message to every group member
with a single <b>DirectPlay8Peer.SendTo. </b>While DirectPlay groups normally
correspond to the groups that are defined by the game, you are free to create a
group for any reason.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create a DirectPlay group,
call <b>DirectPlay8Peer.CreateGroup</b>. DirectPlay will call all session
members' <b>DirectPlay8Event.CreateGroup</b> method with the details. The
method's <i>lGroupID</i> parameter will be set to the group ID that you can use
to send messages to the group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is created, you
then add players by calling <b>DirectPlay8Peer.AddPlayerToGroup</b>. DirectPlay
will then call all members' <b>DirectPlay8Event.AddRemovePlayerGroup</b> with
the IDs of the group and the player that was just added.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is established,
you can send data to the group by calling <b>DirectPlay8Peer.SendTo</b>, with
the <i>idSend</i> parameter set to the group ID. DirectPlay will call all group
members' <b>DirectPlay8Event.Receive</b> method with the data. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To remove a player from a group,
call <b>DirectPlay8Peer.RemovePlayerFromGroup</b>. DirectPlay will call the
session members' <b>DirectPlay8Event.AddRemovePlayerGroup </b>method with the
player's ID.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Finally, when you no longer need
the group, you can destroy it by calling <b>DirectPlay8Peer.DestroyGroup</b>.
DirectPlay will call all session members' <b>DirectPlay8Event.DestroyGroup</b>
method with the group ID.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Leaving a Peer-to-Peer Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To leave a session, terminate
the connection by calling <b>IDirectPlay8Peer::Close</b>. The session members
will be notified with a<b> DPN_MSGID_DESTROY_PLAYER</b> message.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To leave a session, terminate
the connection by calling <b>DirectPlay8Peer.Close</b>. Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
will call the session members <b>DirectPlay8Event.DestroyPlayer</b> method with
the <i>lPlayerID</i> parameter set to the player's ID.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you are the session host,
leaving also terminates the session unless you configured the session to allow
host migration. See Host Migration for details.</p>

<h3 style='page-break-after:avoid'>Terminating a Peer-to-Peer Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the session is over, the
host should terminate the session by calling <b>IDirectPlay8Peer::TerminateSession</b>.
This method terminates the session even if host-migration is enabled. All
session members will be notified by a <b>DPN_MSGID_TERMINATE_SESSION</b>
message. You should then perform any necessary cleanup. To start another
session, you must first call <b>IDirectPlay8Peer::Close</b>, and then <b>IDirectPlay8Peer::Initialize</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you registered your
application as available for connection by calling <b>IDirectPlay8LobbiedApplication::SetAppAvailable</b>,
a lobby client can offer to connect you to a new session by sending your
lobbied application message handler a <b>DPL_MSGID_CONNECT</b> message. You
must have first called <b>IDirectPlay8Peer::Close</b> and <b>IDirectPlay8Peer::Initialize</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the session is over, the
host should terminate the session by calling <b>DirectPlay8Peer.TerminateSession</b>.
This method terminates the session even if host-migration is enabled. Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
will notify all session members by calling their <b>DirectPlay8Event.TerminateSession</b>
method. You should then perform any necessary cleanup. To start another
session, you must first call <b>DirectPlay8Peer.Close</b>, and then <b>DirectPlay8Peer.RegisterMessageHandler</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you registered your
application as available for connection by calling <b>DirectPlay8LobbiedApplication.SetAppAvailable</b>
a lobby client can offer to connect you to a new session by calling your <b>DirectPlay8LobbyEvent.Connect</b>
method. You must have first called <b>DirectPlay8Peer.Close</b> and <b>DirectPlay8.RegisterMessageHandler</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Client/Server Sessions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client/server session consists
of a collection of players, or clients, connected to a central server. As far
as Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> is concerned, a client has no knowledge of any
other clients, only the server. The messaging needed to run the game is between
the individual clients and the server. DirectPlay does not provide direct
client-to-client messaging, as it does for peer-to-peer sessions.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client/server session requires
two distinctly different applications:.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The server application runs on a
remote server. At a minimum, it serves as a central messaging hub and game
host. The server must receive and handle all incoming messages from the
clients, and send appropriate messages back out. Any transfer of data from one
client to another must be handled by the server application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A client application runs on
each players' computer. The primary function of this application is to handle
the UI, and keep the player's game state synchronized with the server. </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are certain aspects of the
session that can be handled by only one of these applications. For instance,
updating a player's video display can only be done by the client application.
However, many aspects of the processing needed to maintain the game universe
can, at least in principle, be done by either application. Writing an effective
client/server game requires some careful consideration of how to divide the
processing chores between the two applications.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This document describes the
basic principles of client server games, and outlines how to implement client
and server applications.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Initiating a Client/Server
Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Selecting a Service Provider for
a Client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Selecting a Client/Server Host</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Connecting to a Client/Server
Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing a Client/Server Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Normal Client/Server Game Play</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Leaving a Client/Server Session</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Terminating a Client/Server
Session</span></p>

<h3 style='page-break-after:avoid'>Initiating a Client/Server Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client/server game can be
launched through a lobby, or directly by the server application.</p>

<h4 style='page-break-after:avoid'>The Server Application</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>Client/server games are often
arranged through lobbies. The most straightforward way to launch the server is
to implement it as a <i>lobbyable</i> application. This approach provides a way
to launch the server, and supports communication between server and lobby
during the course of the session. See DirectPlay Lobbies for further
discussion.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A server can also be directly
launched, and then advertise itself as available and wait for clients to
connect. See Selecting a Client/Server Host for details.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the server application has
been launched, it should initialize itself by calling <b>IDirectPlay8Server::Initialize</b>.
As with other similar Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> methods, the primary purpose of initialization
is to provide DirectPlay with a pointer to your callback message handler. You
should also call <b>IDirectPlay8Server::SetServerInfo</b> to describe the
current game. Clients cannot connect to a server until this method has been
called.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the server application has
been launched, it should register it's <b>DirectPlay8Event</b> notification
handler object. The <b>DirectPlay8Event</b> object is essentially an event
handler that receives notifications from Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span>. It is not provided by
DirectPlay and must be implemented by your application. See the reference
documentation for details. You should also call <b>DirectPlay8Server.SetServerInfo</b>
to describe the current game. Clients cannot connect to a server until this
method has been called.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>The Client Application</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first steps you
should take is to determine whether your game was lobby-launched. To do so,
create and initialize a lobbied application object
(CLSID_DirectPlay8LobbiedApplication). When you do so, you pass the object a
pointer to your lobbied application message handler. This message handler
receives messages directly from the lobbied application object, and indirectly
from the lobby client and the lobby.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the application was
lobby-launched, the <b>IDirectPlay8LobbiedApplication::Initialize</b> method
returns a connection handle for the lobby client and a <b>DPL_MSGID_CONNECT</b>
message is sent to your lobbied application message handler. The <b>pdplConnectionSettings
</b>member of the associated structure points to a <b>DPL_CONNECTION_SETTINGS </b>structure
that contains connection information such as an address object for the server.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the application was not lobby
launched, you will receive neither the connection handle, nor the message.
However, if you call <b>IDirectPlay8LobbiedApplication::SetAppAvailable</b>, a
lobby client can later connect your running application to a session by sending
your lobbied application message handler a <b>DPL_MSGID_CONNECT</b> message.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should also create and
initialize a client object (CLSID_DirectPlay8Client). This object will be your
primary means of communicating with Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> and the server. If you want to have multiple
players in the session, you must create a separate instance of this object for
each player.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first steps you
should take is to determine whether your game was lobby-launched. To do so,
create a <b>DirectPlay8LobbiedApplication</b> object and a <b>DirectPlay8LobbyEvent
</b>object. Register the <b>DirectPlay8LobbyEvent</b> object with Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
by calling <b>DirectPlay8LobbiedApplication.RegisterMessageHandler</b>. The <b>DirectPlay8LobbyEvent</b>
object is essentially an event handler that receives notifications directly
from the lobbied application object, and indirectly from the lobby client and
the lobby. It is not provided by DirectPlay and must be implemented by your
application. See the reference documentation for details.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the application was
lobby-launched, DirectPlay will call your <b>DirectPlay8LobbyEvent.Connect</b>
method. The <i>dlNotify</i> parameter will contain a <b>DPL_MESSAGE_CONNECT</b>
type with connection information. such as address objects for the members of
the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should also create a <b>DirectPlay8Client</b>
object and register a <b>DirectPlay8Event</b> notification handler object by
calling <b>DirectPlay8Client.RegisterMessageHandler</b>. These objects will be
your primary means of communicating with the server.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Selecting a Service Provider for a Client</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The service provider is your
network connection. Most games use either the TCP/IP or modem service provider,
but Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> also provides support for serial and IPX
connections. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your user was connected to
the session by a lobby client, you can determine the appropriate service
provider by examining the <b>DPL_CONNECTION_SETTINGS </b>structure that
accompanies the <b>DPL_MSGID_CONNECT</b> message. Otherwise, you may need to
determine which service provider to use, perhaps by querying the user. You can
use the client object's <b>IDirectPlay8Client::EnumServiceProviders</b> method
to enumerate the available service providers. See Using DirectPlay Enumerations
for further discussion.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your user was connected to
the session by a lobby client, you can determine the appropriate service
provider by examining the <b>DPL_CONNECTION_SETTINGS </b>type that you receive
when DirectPlay calls your <b>DirectPlay8LobbyEvent.Connect</b>. Otherwise, you
may need to determine which service provider to use, perhaps by querying the
user. You can use the client object's <b>DirectPlay8Client.GetServiceProvider</b>
method to enumerate the available service providers. See Using DirectPlay
Enumerations for further discussion.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once you have selected a service
provider, you can then create a DirectPlay address object for your user (a <i>device
address)</i>. You will use this address to identify your device with a number
of DirectPlay methods. See DirectPlay Addressing for a detailed discussion of
DirectPlay addresses and address objects.</p>

<h3 style='page-break-after:avoid'>Selecting a Client/Server Host</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>By definition, the server
application hosts the session. To join a session, a client application must
determine the host server's address. A common way to select a host is through a
lobby server. In that case, when a user's application is connected to the
session, the connection settings that you receive with the <b>DPL_MSGID_CONNECT</b>
message include the host's address object. The <b>pdp8HostAddress</b> member of
the associate structure points to an address object with the host's address.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Servers using an IP or IPX
service provider can also create a <i>broadcast session,</i> perhaps on a LAN
subnet, by advertising themselves as session hosts. To create a broadcast
session, specify call <b>IDirectPlay8Server::SetServerInfo</b> specify the
server settings. Then call <b>IDirectPlay8Server::Host</b> to advertise the
server as a session host. You specify the configuration of the game by
assigning values the <b>DPN_APPLICATION_DESC</b> structure that is passed
through <i>pdnAppDesc</i> parameter of <b>IDirectPlay8Server::Host</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To allow your user to look at
the available sessions and hosts, a client application can query for available
hosts by calling <b>IDirectPlay8Client::EnumHosts</b>. Once the user has
selected a host, you can request a connection.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>By definition, the server
application hosts the session. To join a session, a client application must
determine the host server's address. A common way to select a host is through a
lobby server. In that case, when a user's application is connected to the
session, the connection settings that you receive when your <b>DirectPlay8LobbyEvent.Connect</b>
method is called includes a connection ID and the host's address.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Servers using an IP or IPX
service provider can also create a <i>broadcast session,</i> perhaps on a LAN
subnet, by advertising themselves as session hosts. To create a broadcast
session, specify call <b>DirectPlay8Server.SetServerInfo</b> specify the server
settings. Then call <b>DirectPlay8Server.Host</b> to advertise the server as a
session host. You specify the configuration of the game by assigning values the
<b>DPN_APPLICATION_DESC</b> structure that is passed through <i>AppDesc</i>
parameter of <b>DirectPlay8Server.Host</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To allow your user to look at
the available sessions and hosts, a client application can query for available
hosts by calling <b>DirectPlay8Client.EnumHosts</b>. Once the user has selected
a host, you can request a connection.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Connecting to a Client/Server Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>All clients must explicitly join
the session by connecting to the host, even if the session has been arranged
through a lobby. A connection establishes the client as a member of the
session, and provides the host with the information it needs to communicate
with the client. The host has the option of accepting or rejecting a connection
request.</p>

<h4 style='page-break-after:avoid'>The Server Application</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a client attempts to join a
session, the host receives a <b>DPN_MSGID_INDICATE_CONNECT</b> message. To
accept the player into the session, return S_OK. Returning any other value
rejects the request. In either case, the client will receive a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message that contains your response. You can define a player context value at
this time, or wait until you receive a <b>DPN_MSGID_CREATE_PLAYER</b> message.
See Using Player Context Values for more discussion of player context values.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the player is successfully
added to the session, all clients and the server will receive a <b>DPN_MSGID_CREATE_PLAYER</b>
message with the new player's ID (DPNID). If you want to define a player
context value, and have not yet done so, you must define it before your message
handler returns from handling this message. Once it has done so, you cannot
change the player context value.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a client attempts to join a
session, the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> calls the server's <b>DirectPlay8Event.IndicateConnect</b>
method. To accept the player into the session, set the method's <i>fRejectMsg</i>
parameter to False before returning. Setting <i>fRejectMsg</i> to True rejects
the request. In either case, the player's <b>DirectPlay8Event.ConnectComplete</b>
method will be called with the response. If the host accepted the connection, <b>hResultCode
</b>member<b> </b>of the <b>DPNMSG_CONNECT_COMPLETE</b> type will be set to 0.
If the request was rejected or failed for some other reason, <b>hResultCode</b>
will be set to an error code.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the player is successfully
added to the session, DirectPlay will call the <b>DirectPlay8Event.CreatePlayer</b>
method for the server and all client's with the new player's ID (DPNID).</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>The Client Application</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To connect to a session, you
must have the address of the session host. If your application was connected by
a lobby client, you can obtain the host's address by calling <b>IDirectPlay8LobbiedApplication::GetConnectionSettings</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you not have the address of a
session host and you are using either an IP or IPX service provider, you can
look for broadcast sessions by calling <b>IDirectPlay8Client::EnumHosts </b>and
enumerating the available hosts. You can also obtain the address by enumerating
the available hosts. The information returned by the enumeration includes each
host's address, the device use to reach the host, and a <b>DPN_APPLICATION_DESC</b>
structure that describes the associated session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To ask to join a session, call <b>IDirectPlay8Client::SetClientInfo</b>
to set your player's name, and then call <b>IDirectPlay8Client::Connect</b>
with the selected host's address to connect to the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Your message handler will
receive a <b>DPN_MSGID_CONNECT_COMPLETE </b>message with the host's response.
If the host accepted the connection, the <b>hResultCode</b> member of the
associated structure will be set to S_OK. If not, <b>hResultCode</b> will be
set to DPNERR_HOSTREJECTEDCONNECTION.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To connect to a session, you
must have the address of the session host. If your application was connected by
a lobby client, you can obtain the host's address by calling <b>DirectPlay8LobbiedApplication.GetConnectionSettings</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you not have the address of a
session host and you are using either an IP or IPX service provider, you can
look for broadcast sessions by calling <b>DirectPlay8Client.EnumHosts </b>and
enumerating the available hosts. You can also obtain the address by enumerating
the available hosts. The information returned by the enumeration includes each
host's address, the device use to reach the host, and a <b>DPN_APPLICATION_DESC</b>
type that describes the associated session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To ask to join a session, call <b>DirectPlay8Client.SetClientInfo</b>
to set your player's name, and then call <b>DirectPlay8Client.Connect</b> with
the selected host's address to connect to the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> will call your
<b>DirectPlay8Event.ConnectComplete</b> method with the host's response. If the
host accepted the connection, the <b>hResultCode </b>member<b> </b>of the <b>DPNMSG_CONNECT_COMPLETE</b>
type will be set to 0. If the request was rejected or failed for some other
reason, <b>hResultCode</b> will be set to an error code.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Managing a Client/Server Session</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>As host, the server is
responsible for managing the course of the session. The details will depend on
how the application is designed, but a session host's duties include, at a
minimum,:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing the list of session
members and their network addresses. Microsoft</span><span style='font-size:
7.0pt;font-family:"Times New Roman",serif'> </span><span style='font-family:
"Times New Roman",serif'>DirectPlay</span><span style='font-size:7.0pt;
font-family:"Times New Roman",serif'></span><span style='font-family:"Times New Roman",serif'>
handles some of this task, but server applications typically need to manage
more player data than is provided by DirectPlay.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Deciding whether a new user is
allowed to join the session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Providing new users with the
current game state.</span></p>

<p class=Le>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a player attempts to join a
session, the host receives a <b>DPN_MSGID_INDICATE_CONNECT</b> message. To
accept the player into the session return S_OK. Returning any other value
rejects the connection request. In either case, the player will receive a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message that contains your response.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host can remove a player
from the session by calling <b>IDirectPlay8Server::DestroyClient</b>. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When a player attempts to join a
session, DirectPlay calls the host's <b>DirectPlay8Event.IndicateConnect</b>
method. To accept the player into the session set <i>fRejectMsg</i> to False.
Setting <i>fRejectMsg</i> to any other value rejects the request. In either
case, DirectPlay calls the player's <b>DirectPlay8Event.ConnectComplete</b>
method with the response to the request.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host can remove a player
from the session by calling <b>DirectPlay8Server.DestroyClient</b>. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Normal Client/Server Game Play</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>,
a message is essentially a block of game-related data that is sent from client
to server or vice versa. DirectPlay does not specify the contents or format of
the data block, it just provides a mechanism to transmit the data. Once the
game is underway, each client will normally send a constant stream of messages
to the server, and vice versa, for the duration of the game. The primary
purpose of these messages is to keep the game state synchronized, so that each
user's application displays the same UI. However, messages can also be used for
a variety of other game-specific purposes.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For many games, especially
rapidly changing ones, you may have to manage your messaging carefully.
DirectPlay throttles outgoing messages to a level that can be handled by the
target. You will have be careful that you do not send messages too rapidly, and
ensure that the most important messages get through. See Basic Networking for a
discussion of how to effectively handle DirectPlay messaging.</p>

<h5 style='page-break-after:avoid'>The Server Application</h5>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to a client,
call <b>IDirectPlay8Server::SendTo</b>. The client will receive a <b>DPN_MSGID_RECEIVE
</b>message with the data. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to a client,
call <b>DirectPlay8Server.SendTo</b>. DirectPlay will call the client's <b>DirectPlay8Event.Receive</b>
method with the data. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h5 style='page-break-after:avoid'>The Client Application</h5>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to the server,
call <b>IDirectPlay8Client::Send</b>. The server will receive a <b>DPN_MSGID_RECEIVE
</b>message with the data. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To send a message to the server,
call <b>DirectPlay8Client.Send</b>. DirectPlay will call the server's <b>DirectPlay8Event.Receive</b>
method with the data. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>DirectPlay does not provide a mechanism for clients to communicate
with other clients, only with the server. Any client-client communication must
be implemented by the server application.</p>

<p class=Ne>&nbsp;</p>

<h4 style='page-break-after:avoid'>Using Groups</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Many games allow players to be
organized into groups. For example, in a squad-based game, every player in the
squad could be a member of a group. DirectPlay allows servers in a
client/server game to create groups of players. While DirectPlay groups
typically correspond to the groups that defined by the game, you are free to
create a group for any reason. DirectPlay groups are essentially a way to
simplify your messaging. Once you have defined a group, you can send a message
to every group member with a single <b>IDirectPlay8Server::SendTo</b> call. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create a DirectPlay group,
call <b>IDirectPlay8Server::CreateGroup</b>. Your message handler will then
receive a <b>DPN_MSGID_CREATE_GROUP</b> message with the details. The message
will include a group ID that is used to send messages to the group. Once the
group is created, you then add players by calling <b>IDirectPlay8Server::AddPlayerToGroup</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is established,
you can send data to the group by calling <b>IDirectPlay8Server::SendTo</b>,
with the <i>dpnid</i> parameter set to the group ID. All group members will
then receive a <b>DPN_MSGID_RECEIVE</b> message with the data. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To remove a player from a group,
call <b>IDirectPlay8Server::RemovePlayerFromGroup</b>. Finally, when you no
longer need the group, you can destroy it by calling <b>IDirectPlay8Server::DestroyGroup</b>
</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Many games allow players to be
organized into groups. For example, in a squad-based game, every player in the
squad could be a member of a group. DirectPlay allows servers in a
client/server game to create groups of players. While DirectPlay groups typically
correspond to the groups that defined by the game, you are free to create a
group for any reason. DirectPlay groups are essentially a way to simplify your
messaging. Once you have defined a group, you can send a message to every group
member with a single <b>DirectPlay8Server.SendTo</b> call. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create a DirectPlay group,
call <b>DirectPlay8Server.CreateGroup</b>. DirectPlay will call your <b>DirectPlay8Event.CreateGroup</b>
method with the details. The notification will include a group ID that is used
to send messages to the group. Once the group is created, you then add players
by calling <b>DirectPlay8Server.AddClientToGroup</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the group is established,
you can send data to the group by calling <b>DirectPlay8Server.SendTo</b>, with
the <i>idSend</i> parameter set to the group ID. DirectPlay will then call the
group members' <b>DirectPlay8Event.Receive</b> method with the data. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To remove a player from a group,
call <b>DirectPlay8Server.RemoveClientFromGroup</b>. Finally, when you no
longer need the group, you can destroy it by calling <b>DirectPlay8Server.DestroyGroup</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Leaving a Client/Server Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client can leave a session by
calling <b>IDirectPlay8Client::Close</b>. The server is notified with a <b>DPN_MSGID_DESTROY_PLAYER</b>
message.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A client can leave a session by
calling <b>DirectPlay8Client.Close</b>. Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> notifies the server by calling
its <b>DirectPlay8Event.DestroyPlayer</b> method.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Terminating a Client/Server Session</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To terminate a client/server
session, the server calls <b>IDirectPlay8Server::Close</b>. There is no host
migration in a client/server session, so this method terminates all connections
and closes the session. The clients are notified of the session end by a <b>DPN_MSGID_TERMINATE_SESSION</b>
message. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The server will then receive a <b>DPN_MSGID_DESTROY_PLAYER</b>
message for each player, including itself. <b>IDirectPlay8Server::Close </b>is
synchronous, and will not return until all the <b>DPN_MSGID_DESTROY_PLAYER</b>
messages have been processed. Once <b>IDirectPlay8Server::Close </b>has
returned, you can safely shut down the server application.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To terminate a client/server
session, the server calls <b>DirectPlay8Server.Close</b>. There is no host
migration in a client/server session, so this method terminates all connections
and closes the session. Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> notifies the clients by
calling their <b>DirectPlay8Event.TerminateSession</b> method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay then calls the
server's <b>DirectPlay8Event.DestroyPlayer</b> method for each player,
including itself. <b>DirectPlay8Server.Close </b>is synchronous, and will not
return until all the <b>DirectPlay8Event.DestroyPlayer </b>method calls<b> </b>have
been processed. Once <b>DirectPlay8Server.Close </b>has returned, you can
safely shut down the server application.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>DirectPlay Lobbies</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobby is an application whose
primary purpose is to help users arrange multiplayer games. The lobby is
usually an application that is hosted on a remote server. The user visits the
lobby, typically through the Internet, and either sets up a game session or
joins a session started by someone else. The lobby application then launches
the group's individual game applications, and the game is underway. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because many multiplayer games
are arranged through lobbies, most games based on Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
must be able to interact with lobby applications. Conversely, because most
lobbies will want to support DirectPlay-based games, the lobby application must
be able to interact with the game application. This document discusses how to
enable a Microsoft DirectX<span style='font-size:7.0pt'></span> game to
interact with a lobby, and vice versa.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Lobby Architecture</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby Servers</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby Clients</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobbyable Applications</span></p>

<h3 style='page-break-after:avoid'>DirectPlay Lobby Architecture</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The process of arranging and
managing a session of a multiplayer game based on Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'> </span>involves
five separate components. The lobby server application is a third-party
application that typically resides on a remote server and is accessed through
the Internet. The remaining four components are installed on each player's
computer.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>Lobby client</i>. The lobby
client is a third-party application that communicates with the lobby server. It
also communicates with the user's game application through the DirectPlay lobby
client object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>Lobbyable</i> <i>game
application</i>. The lobbyable game application is a third-party application
that uses the DirectPlay lobbied application object to communicate with the
lobby client, and through the lobby client with the lobby server.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>DirectPlay lobby client
object</i>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>DirectPlay lobbied
application object</i>.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The two DirectPlay objects act
as links between the game application and the lobby client. They communicate
with each other through private interfaces. The following graphic shows how
these pieces are linked, and how they communicate.:</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=390
height=343 id="Picture 4" src="dplay_files/image003.jpg"></span></p>

<h3 style='page-break-after:avoid'>Lobby Servers</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby server is an
application whose primary purpose is to enable players to meet and arrange
games. It is typically located on a remote computer, and accessed over the
Internet. Lobby servers often perform a variety of other functions such as
hosting chat rooms, posting news and information, and selling merchandise.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To manage multiplayer games, a
lobby server typically handles a variety of tasks, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing the network addresses
of the various game sessions and players.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Launching a session by launching
the associated game applications on the players' computers.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Adding players to an ongoing
session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Connecting the various computers
in a session to the correct network addresses.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Keeping track of changes in the
session, such as players leaving the game or changes in the game's host.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The details of the lobby server
application depend on what kind of services the vendor wants to offer.
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> does not specify how a lobby server should be
implemented nor how it should communicate with its users' computers. However,
lobby vendors must implement and distribute to their users a lobby client that
is compatible with DirectPlay.</p>

<h3 style='page-break-after:avoid'>Lobby Clients</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobby client is an application
that is implemented by the lobby server vendor and installed on each player's
computer. It handles communication between the players and their game
applications, and the lobby server. A common way to install a lobby client is
to have the user download it from the lobby server's Web site as part of the
sign-up procedure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following is a typical
scenario.</p>

<p class=Ln1> 1. A new player goes to the Web site and signs up.</p>

<p class=Ln1> 2. As part of the sign-up procedure, the lobby client is
downloaded to the client's computer.</p>

<p class=Ln1> 3. The player determines which to play and asks to join a
session.</p>

<p class=Ln1> 4. The Web site launches the lobby client on the player's
computer. A typical launch mechanism is a URL that points to the lobby client's
executable file.</p>

<p class=Ln1> 5. The lobby client handles the mechanics of arranging the
session, and then launches the user's game application.</p>

<p class=Ln1> 6. If the game is a lobbyable application, the lobby client
enables the game application to communicate with the lobby server. This
connection enables the lobby server to keep track of events such as players
entering and leaving the game and host migration.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients do not necessarily
have to be linked to a remote server. In another scenario the user launches the
lobby client directly. The lobby client then lists the available games and
sessions, perhaps among the people connected to the user's LAN subnet. Once the
user chooses a game and session, the lobby client launches the game. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses some the
general features of a lobby client. For more information on communicating
between a lobby client and its associated lobby server, see Communicating with
a Lobbyable Game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information on
implementation details, see Implementing a Lobby Client or the LobbyClient
sample application included in the SDK.</p>

<h4 style='page-break-after:avoid'>Communicating with a Lobbyable Game</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>Communication between a lobby
client and its associated lobby server can be handled in any way that is
convenient. Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> specifies only how the lobby client must
communicate with a lobbyable game application.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients do not communicate
directly with game applications. Instead, they communicate with the DirectPlay
lobby client object (CLSID_DirectPlay8LobbyClient) through its <b>IDirectPlay8LobbyClient</b>
interface. If the game application is lobbyable, the lobbied application object
then passes messages to the game. The <b>IDirectPlay8LobbyClient</b> interface
enables the lobby client to do the following.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Enumerate the lobbyable
applications on the user's system.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Launch the application, if it is
not already running, and connect it to the session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Release the application from a
session, and close the link with the lobby client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send a message to a lobbied
application that was launched or connected by the lobby client.</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients do not communicate
directly with game applications. Instead, they communicate with the <b>DirectPlay8LobbyClient</b>
object. If the game application is lobbyable, the lobbied application object
then passes messages to the game. The <b>DirectPlay8LobbyClient</b> object
enables the lobby client to do the following.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Enumerate the lobbyable
applications on the user's system.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Launch the application, if it is
not already running, and connect it to the session.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Release the application from a
session, and close the link with the lobby client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send a message to a lobbied
application that was launched or connected by the lobby client.</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Nh>Note</p>

<p class=Np1>A DirectPlay lobby client can launch any application, whether or
not it is lobbyable. However, only lobbyable applications can use DirectPlay to
communicate back to the lobby client during the course of the game.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client object
communicates with the lobby client through a callback function that is
implemented by the lobby client. A function pointer is passed to the lobby
client object during initialization. This callback function enables the lobby
client object to send the lobby client information such as:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client object
communicates with the lobby client through a <b>DirectPlay8LobbyEvent</b>
message handler object. The <b>DirectPlay8LobbyEvent</b> object is essentially
an event handler that receives notifications directly from the lobby client
object, and indirectly from the application. It is not provided by DirectPlay
and must be implemented by your application. See the reference documentation for
details. You must register this object with DirectPlay by calling <b>DirectPlay8LobbyClient.RegisterMessageHandler</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8LobbyEvent</b>
object enables the lobby client object to send the lobby client information
such as:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Connection information.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Connection status.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Session status, including
connection, disconnection, and host migration.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Messages from the application to
the lobby client.</span></p>

<h5 style='page-break-after:avoid'>Launching an Application</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you launch an application,
you can attempt to pass a block of game-specific information to the
application. When a lobbyable application is launched by a lobby client, the
application creates and initializes a lobbied application object. The information
is passed to the game through the initialization method. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the lobbied application
object is initialized, the lobby client receives a message indicating that the
user has been connected. One primary purpose of this message is to notify the
lobby client that the application is lobbyable. If the lobby client has not
received a connect message after a reasonable period of time following the
launch, the game is not lobbyable and you can stop attempting to make this
connection.</p>

<h5 style='page-break-after:avoid'>After Launching an Application</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client has relatively
little to do once a lobbyable game is in progress. Depending on the game
topology, most of the user's messages are sent directly to the other players or
to the game server,. However, DirectPlay sends the lobby client messages in
response to events such as disconnection and host migration. These messages
enable the lobby client to pass such status changes to the lobby server. For
instance, if the host migrates, the lobby server can update its UI to indicate
the new host. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The application can also pass
messages to the lobby client. This message can contain virtually anything, and
it can be used for any purpose. The lobby client typically passes the data to
the lobby server for processing. For example, at the end of the game, the
application might send a message that enables the lobby server to update its
high-score list.</p>

<h3 style='page-break-after:avoid'>Lobbyable Applications</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobbyable applications are
designed to work with a lobby client based on Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>. While a lobby
client can use DirectPlay to launch any application, lobbyable applications
have a number of advantages.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The lobby client receives
automatic updates when game status changes.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The lobby client can use a
standard API to communicate with the application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The application can use a
standard API to communicate with the lobby client.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In short, DirectPlay virtually
eliminates the need for game-specific or lobby client-specific communication
code. You can use a standard API for everything with little or no modification
for the particular game or lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses some of
the general features of a lobbyable application. For more information, see
Launching a Lobbyable Application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a discussion of
implementation details, see Implementing a Lobbyable Application or SDK samples
such as SimplePeer, or StagedPeer.</p>

<h4 style='page-break-after:avoid'>Launching a Lobbyable Application</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first things a
lobbyable application should do after it is launched is create a lobbied
application object. Among other things, this object enables your application to
determine whether it was lobby-launched. A lobbied application must also
implement a message-handler callback function to receive messages from the
lobby client. The basic procedure is:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a lobbied application
object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Initialize the object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the initialization method
returns a valid connection handle, your application was lobby launched.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Examine the user context value
that is returned by the initialization method. This value might contain
game-specific information from the lobby client.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Examine the connection message
received through the lobbied application message handler. This message carries
with it a variety of information, including the ID that you will use to send
messages to the lobby client.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once an application has been
successfully lobby launched, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> can automatically send status
updates to the lobby client when events such as host migration occur. To enable
automatic status updates, call the <b>RegisterLobby</b> method of the <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, or <b>IDirectPlay8Server</b> interface. You can also
use the lobbied application interface to send messages to the lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Be aware that your message
handler function might receive messages from the lobby client before the
initialization method returns. In addition to the connection message, the
callback function receives messages when the lobby client changes connection
settings, or it breaks the connection. The lobby client can also send messages
directly to your message handler that contain game-specific information.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>It is possible to receive messages from more than one thread. To
handle messaging properly, your lobbied application callback function should be
re-entrant.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the first things a
lobbyable application should do after it is launched is create a <b>DirectPlay8LobbiedApplication</b>
object. Among other things, this object enables your application to determine
whether it was lobby-launched. A lobbied application must also implement a
message-handler callback function to receive messages from the lobby client.
The basic procedure is:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a <b>DirectPlay8LobbiedApplication</b>
object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Register a <b>DirectPlay8LobbyEvent</b>
message handler object by calling <b>DirectPlay8LobbiedApplication.RegisterMessageHandler</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the application was
lobby-launched, DirectPlay will call your <b>DirectPlay8LobbyEvent.Connect</b>
method. The <i>dlNotify</i> parameter will contain a <b>DPL_MESSAGE_CONNECT</b>
type with connection information. such as address objects for the members of
the session.</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The <b>DirectPlay8LobbyEvent</b> object is essentially an event
handler that receives notifications directly from the lobbied application
object, and indirectly from the lobby client and the lobby. It is not provided
by DirectPlay and must be implemented by your application. See the reference
documentation for details.</p>

<p class=Ne>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once an application has been
successfully lobby launched, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> automatically sends status
updates to the lobby client when events such as host migration occur. You can
also use the lobbied application interface to send messages to the lobby
client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Be aware that your message
handler object might be called by the lobby client before the initialization
method returns. In addition to the connection message, the DirectPlay calls the
object when the lobby client changes connection settings, or it breaks the
connection. The lobby client can also send messages directly to your message
handler that contain game-specific information.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Basic Networking</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section covers some basic
networking technology topics that you need to understand to write Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
applications. For a general discussion of networking technology, see one of the
standard texts on the subject, such as <i>Computer Networks</i> by Andrew
Tannenbaum.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <span style='position:relative;
top:-.5pt'>DirectPlay Service Providers</span></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Addressing</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Protocol</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Optimizing Network Usage</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Using the DirectX Protocol in an
Application</span></p>

<h3 style='page-break-after:avoid'>DirectPlay Service Providers</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> provides your
application with a virtual network connection that enables you to communicate
with other computers in the same way, regardless of type of network involved.
To provide this level of abstraction, network connections are made through a
service provider. Once you have selected a service provider, your application
uses the appropriate DirectPlay methods to communicate with other computers in
a session. The service provider handles the details of communicating over the
selected network hardware.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay includes service
providers for four types of network connections: TCP/IP, IPX, modem, and
serial. See DirectPlay Addressing for a discussion of how to select a service
provider.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic</p>

</div>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>To use modems on Microsoft Windows<span style='font-size:7.0pt'></span>
95 systems, you must install version 2.0 of the Telephony API (TAPI). You can
download TAPI 2.0 from http://www.microsoft.com.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>DirectPlay uses the telephony API (TAPI) to handle modem
communication. The use of this API means that the code that is used to answer
the phone must be in the message loop's thread. To use modems on Microsoft
Windows<span style='font-size:7.0pt'></span> 95 systems, you must install
version 2.0 of the Telephony API (TAPI). You can download TAPI 2.0 from
http://www.microsoft.com.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>DirectPlay Addressing</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>To deliver messages, each
participant in a multiplayer game must have a unique address. Addresses can
refer either to the computer that your application is running on (<i>device
address</i>), or a computer that your application needs to communicate with (<i>host
address</i>). </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> 8.0 represents
addresses in the form of a URL string. That address string is then encapsulated
in a DirectPlay address object that is passed as a parameter in or out of
methods such as <b>IDirectPlay8Peer::Connect</b>. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section describes two ways
to handle DirectPlay addresses.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay URLs discusses how to
construct the address string directly.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Address Objects
discusses how to manipulate the address string using the methods exposed by the
address object's IDirectPlay8Address interface.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> 8.0 represents
addresses in the form of a URL string. That address string is then encapsulated
in a <b>DirectPlay8Address</b> object that is passed as a parameter in or out
of methods such as <b>DirectPlay8Peer.Connect</b>. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section describes two ways
to handle DirectPlay addresses.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay URLs discusses how to
construct the address string directly.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Address Objects
discusses how to manipulate the address string using the methods exposed by the
address object's IDirectPlay8Address interface.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>DirectPlay URLs</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> represents
addresses as URLs. In general, URLs are strings that consist of three basic
components in the following order: scheme, scheme separator, and data string.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All DirectPlay addresses use
&quot;x-directplay&quot; as the scheme, and &quot;:/&quot; (a colon followed by
a forward slash) as the scheme separator. Using &quot;:/&quot; as a separator
implies that the data that follows is <i>opaque.</i> In other words, the data
string does not conform to any Internet standard and should be passed to the
receiving application without modification. All DirectPlay URLs thus have the
following general form.</p>

<p class=Ex>x-directplay:/[<i>data string</i>]</p>

<p class=Ex>&nbsp;</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Do not use &quot;://&quot; (a colon followed by two forward
slashes) as a scheme separator. That separator implies that the data that
follows conforms to an Internet standard and can be interpreted as such. To
prevent confusion, DirectPlay flags any URL containing&quot;://&quot; as
invalid.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Data Strings</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Data Values</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Data Value Summary</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Sample URLs</span></p>

<p class=Le>&nbsp;</p>

<p class=Ne>&nbsp;</p>

<h5 style='page-break-after:avoid'>Data Strings</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The data string holds address
information. The first part of a data string consists of a series of <i>keyname</i>=<i>value</i>
elements separated by semicolons (;). You can include optional user data by
putting a number sign (#) after the last value, followed by an
application-defined string. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The key name is a lowercase
string that identifies the data and implicitly indicates what type of data is
contained in the value. For instance, the &quot;provider&quot; key name
indicates that the value contains a Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> service provider GUID, in the
form of a GUID string. The following characters are reserved and should not be
used in value strings.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Ampersand (&amp;)</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>Forward slash (/)</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>At sign (@)</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>Number sign (#)</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Colon (:)</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>Question mark (?)</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Equal sign (=)</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>Semicolon (;)</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first element in the data
string must be the provider. Other elements can follow in any order. A generic
URL looks something like this.</p>

<p class=Ex>x-directplay:/provider=%<i>provider GUID%;</i>[<i>keyname1=value1</i>];[<i>keyname2=value2</i>][...]#[<i>user
defined string</i>]</p>

<h5 style='page-break-after:avoid'>Data Values</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The values that need to be
included in the data string depend on the particular service provider. Modem
providers, for instance, need a telephone number in their address, whereas LAN
providers might need a port number. This section provides a detailed description
of the standard data values. It also includes a key name that can be used in
place of the literal string. These names are defined in Dpaddr.h.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Application Instance</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Baud</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Device</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Flow Control</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Host Name</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Parity</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Phone Number</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Port</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Program</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Provider</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Stop Bits</span></p>

<h6 style='page-break-after:avoid'>Application Instance</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>An optional GUID that identifies
an application instance. This value is used when specifying the game that is to
be connected to.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_APPLICATION_INSTANCE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;applicationinstance&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: GUID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: All</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
application instance GUID</p>

<h6 style='page-break-after:avoid'>Baud</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>The baud rate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i> DPNA_KEY_BAUD</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>: &quot;baud&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: DWORD</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: Modem and
serial</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
baud rate. You can set this value to the appropriate integer, or you can use
one of the following predefined values from Dpaddr.h.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_BAUD_RATE_9600</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_BAUD_RATE_14400</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_BAUD_RATE_19200</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_BAUD_RATE_38400</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_BAUD_RATE_56000</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<h6 style='page-break-after:avoid'>Device</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>A GUID that identifies the
device on the local computer that will be used. If the service provider
supports all adapters, you do not need to specify a device.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i> DPNA_KEY_DEVICE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;device&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: GUID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: All, but for
device addresses only, not host addresses</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
device GUID.</p>

<h6 style='page-break-after:avoid'>Flow Control</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>The type of flow control to be
used</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_FLOWCONTROL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;flowcontrol&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: String</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: Serial and
modem</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any of the
following predefined values from Dpaddr.h.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_FLOW_CONTROL_NONE</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>DPNA_FLOW_CONTROL_DTR</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_FLOW_CONTROL_XONXOFF</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>DPNA_FLOW_CONTROL_RTSDTR</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_FLOW_CONTROL_RTS</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<h6 style='page-break-after:avoid'>Host Name</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>The name of a remote host
computer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_HOSTNAME</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;hostname&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: String</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: All, but for
host addresses only, not device addresses</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: A
fully-qualified host name, or a dotted address.</p>

<h6 style='page-break-after:avoid'>Parity</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>The parity of the connection</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i> DPNA_KEY_PARITY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;parity&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: String</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: Serial and
modem</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any of the
following predefined values from Dpaddr.h.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_PARITY_NONE</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>DPNA_PARITY_MARK</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_PARITY_EVEN</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>DPNA_PARITY_SPACE</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_PARITY_ODD</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<h6 style='page-break-after:avoid'>Phone Number</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>A phone number</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_PHONENUMBER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;phonenumber&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: String</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: Modem</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
phone number</p>

<h6 style='page-break-after:avoid'>Port</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>An optional port number</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i> DPNA_KEY_PORT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;port&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: DWORD</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: IP and IPX</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any 16-bit
integer. Only the lower 16 bits of the value are valid. If you do not specify a
port, DirectPlay will choose one for you.</p>

<h6 style='page-break-after:avoid'>Program</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>An optional application GUID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_PROGRAM</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;program&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: GUID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: All</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
application GUID</p>

<h6 style='page-break-after:avoid'>Provider</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>A GUID that identifies the
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> service provider that will be used</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_PROVIDER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;provider&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: GUID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: All.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any valid
service provider GUID </p>

<h6 style='page-break-after:avoid'>Stop Bits</h6>

<p class=MsoNormal style='margin-bottom:6.0pt'>The number of stop bits</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key Name:</i>
DPNA_KEY_STOPBITS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Key String</i>:
&quot;stopbits&quot;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Data Type</i>: String</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Providers</i>: Serial and
modem</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>Valid Values</i>: Any of the
following predefined values from Dpaddr.h.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_STOP_BITS_ONE</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>DPNA_STOP_BITS_TWO</p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNA_STOP_BITS_ONE_FIVE</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<h5 style='page-break-after:avoid'>Data Value Summary</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following two tables outline
the standard data values, and they indicate which values are used by each type
service provider for both host and device addresses.</p>

<h6 style='page-break-after:avoid'>Host Addresses</h6>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Thf>&nbsp;</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Th>IP</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Th>IPX</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Th>Serial</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Th>Modem</p>
  </td>
 </tr>
 <tr>
  <td width=464 colspan=5 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tr><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Application Instance</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Baud</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Device</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Flow Control</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Host Name</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Parity</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Phone Number</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Port</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Program</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Provider</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
 </tr>
 <tr>
  <td width=84 valign=top style='width:63.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Stop Bits</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=Teh>&nbsp;</p>

<h6 style='page-break-after:avoid'>Device Addresses</h6>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Thf>&nbsp;</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Th>IP</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Th>IPX</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Th>Serial</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Th>Modem</p>
  </td>
 </tr>
 <tr>
  <td width=464 colspan=5 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tr><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>Application Instance</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Baud</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Flow Control</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Host Name</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Device</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Parity</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Phone Number</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Port</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Program</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Optional</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Provider</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
 </tr>
 <tr>
  <td width=80 valign=top style='width:60.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>Stop Bits</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Required</p>
  </td>
  <td width=96 valign=top style='width:1.0in;padding:0in 0in 0in 0in'>
  <p class=Tp>Not used</p>
  </td>
 </tr>
</table>

<p class=Teh>&nbsp;</p>

<h5 style='page-break-after:avoid'>Sample URLs</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following sample URLs
illustrate what a Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> URL might look like for the four standard
service providers.</p>

<h6 style='page-break-after:avoid'>Local IP Address</h6>

<p class=Ex>x-directplay:/provider=%7BEBFE7BA0-628D-11D2-AE0F-006097B01411%7D;device=%7BIP
ADAPTER GUID%7D;port=0000230034#IPUserData</p>

<p class=Ex>&nbsp;</p>

<h6 style='page-break-after:avoid'>Local IPX Address</h6>

<p class=Ex>x-directplay:/provider=%7B53934290-628D-11D2-AE0F-006097B01411%7D;device=%7BIPX
ADAPTER GUID%7D;port=00230#IPXUserData </p>

<p class=Ex>&nbsp;</p>

<h6 style='page-break-after:avoid'>Local Serial Address</h6>

<p class=Ex>x-directplay:/provider=%7B743B5D60-628D-11D2-AE0F-006097B01411%7D;device=%7BCOM
PORT
GUID%7D;baud=57600;stopbits=1;parity=NONE;flowcontrol=RTSDTR#SerialUserData</p>

<p class=Ex>&nbsp;</p>

<h6 style='page-break-after:avoid'>Remote Modem Address</h6>

<p class=Ex>x-directplay:/provider=%7B6D4A3650-628D-11D2-AE0F-006097B01411%7D;device=%7BMODEM
DEVICE GUID%7D;phonenumber=555-1212#ModemUserData</p>

<p class=Ex>&nbsp;</p>

<h4 style='page-break-after:avoid'>Handling Addresses</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you call the <b>Host</b>, <b>EnumHosts</b>,
or <b>Connect</b> methods exposed by the <b>IDirectPlay8Peer</b>, <b>IDirectPlay8Client</b>,
or <b>IDirectPlay8Server</b> you must pass address objects as parameters. If
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> does not have sufficient address information,
the method that you called will fail, and it will return DPNERR_ADDRESSING.
However, it is not necessary to have all the information in the address object
at the time you call the method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All address objects must have
the service provider GUID set. However, it is possible to omit other data
values.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You can omit the device if the
service provider supports all adapters.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You can omit the port number for
IP and IPX service providers for the <b>Host</b>, <b>EnumHosts</b>, and<b>
Connect</b> methods. DirectPlay will assign a port number. This number may
vary.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If you set the
OKTOQUERYFORADDRESSING flag, the service provider can display a dialog box
asking the user for the information needed to complete the address. If the user
does not supply sufficient information, the method will fail. If the
OKTOQUERYFORADDRESSING flag is not set, no dialog box will be displayed. If the
address you pass to the method is insufficient, the method will fail. In the
last two cases, the error value that is returned will be DPNERR_ADDRESSING.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are two important issues
for IP and IPX service providers that you need to be aware of. Failing to
handle them properly may cause your application to fail.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If you set the
NOBROADCASTFALLBACK flag when you call an enumeration method, you must supply a
hostname. If you do not do so, the method will fail and return
DPNERR_ADDRESSING.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If you do not specify a port, do
not assume that DirectPlay will always choose the same port number. The only
way to be certain of the port number is to specify it in your address. If you
do not specify a port number, you must retrieve the actual value later, after
the command is in progress.</span></p>

<h4 style='page-break-after:avoid'>DirectPlay Address Objects</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
handle URL strings directly. Instead, the string must be encapsulated in a
DirectPlay address object (CLSID_DirectPlayAddress). This object exposes the <b>IDirectPlay8Address</b>
interface that enables you to insert URL information into, or extract it from,
the address object.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create DirectPlay address,
you must call <b>CoCreateInstance</b> to create a DirectPlay address object.
You can then define the address in one of two ways:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create the URL string directly.
Then use either <b>IDirectPlay8Address::BuildFromURLA</b> or <b>IDirectPlay8Address::BuildFromURLW</b>
to insert the complete string.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use <b>IDirectPlay8Address</b>
methods to insert the various pieces of data that make up the string directly
into the object.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you receive an address
object, you have a similar pair of options.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Extract the entire URL string
with either <b>IDirectPlay8Address::GetURLA</b> or <b>IDirectPlay8Address::GetURLW</b>.
Then parse the string and extract the needed information</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use other <b>IDirectPlay8Address</b>
methods to extract the particular data you are interested in from the address
object.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
handle URL strings directly. Instead, the string must be encapsulated in a <b>DirectPlay8Address</b>
object. This object exposes a number of methods that enable you to insert URL
information into, or extract it from, the object.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To create DirectPlay address,
you must first create a <b>DirectPlay8Address</b> object. You can then define
the address in one of two ways:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create the URL string directly.
Then use <b>DirectPlay8Address.BuildFromURL</b> to insert the complete string.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use other <b>DirectPlay8Address</b>
methods to insert the various pieces of data that make up the string directly
into the object.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you receive an address
object, you have a similar pair of options.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Extract the entire URL string
with <b>DirectPlay8Address.GetURL</b>. Then parse the string and extract the
needed information</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use other <b>DirectPlay8Address</b>
methods to extract the particular data you are interested in from the address
object.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>DirectPlay Protocol</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Multiplayer games require
efficient and flexible network messaging services for optimal performance. The
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> protocol is a transport-layer messaging
protocol that is used for all DirectPlay messaging. The protocol has been
substantially reworked for DirectPlay 8.0. It provides your application with
the messaging support it needs to make everything run smoothly. The DirectPlay
protocol includes the following messaging support.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Reliable and unreliable delivery
of messages</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Sequential and non-sequential
delivery of messages</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Message fragmentation and
reassembly</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Congestion control</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send prioritization</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Message timeouts</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>With previous versions of DirectPlay, the DirectPlay protocol was
optional, and had to be specified explicitly. With DirectPlay 8.0, this
protocol is used for all DirectPlay messaging.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This document provides a general
description of how the DirectX protocol works, and how you can use it in your
application.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <span style='position:relative;
top:-.5pt'>Basic Message Handling</span></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Message Categories</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Congestion Control</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send Prioritization</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Monitoring Messaging Statistics</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Monitoring the Pending Message
Queues</span></p>

<h4 style='page-break-after:avoid'>Basic Message Handling</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>A message, as the term is used
in this document, is a block of data that needs to be sent to another computer.
A network protocol creates a <i>packet</i> by adding some bits to the data
block that hold information such as the target's network address. This packet
is the basic unit of network data. When the target receives the packet, the
target's network protocol removes the extra bits and passes the data block to
the receiving application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although similar in usage, the
terms <i>message</i> and <i>packet</i> are not strictly interchangeable. This
document uses the term <i>message</i> to refer to the unit of information that
is passed to and received from the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> API. <i>Packet</i> refers to
the unit of information handled by the network. DirectPlay handles packets
internally. With rare exceptions, DirectPlay applications need to deal only
with messages.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The primary reason for the
distinction between <i>message</i> and <i>packet</i> is that networks generally
limit the maximum size of the packets they handle. This size is referred to as
a Maximum Transmission Unit (MTR). If a message is small, it is sent in a
single packet and the two terms are effectively synonymous. However, large
messages might need to be fragmented into two or more packets and then be
reassembled by the receiver. The DirectPlay protocol automatically handles
fragmentation and reassembly of messages as needed. As far as your application
is concerned, you send a message, and the target receives it.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>DirectPlay delivers messages of any size. However, the more
packets that are required for a single message, the greater the odds that one
or more packets will be lost and have to be retransmitted. Messages that are
large enough to require fragmentation and reassembly thus typically have more
network latency than single-packet messages. If you need to keep network
latency to a minimum, avoid sending large messages, especially on lossy
networks. You can determine the maximum size that your connection can accommodate
in a single packet by calling the <b>GetSPCaps</b> method exposed by the <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b> interfaces.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>DirectPlay delivers messages of any size. However, the more
packets that are required for a single message, the greater the odds that one
or more packets will be lost and have to be retransmitted. Messages that are
large enough to require fragmentation and reassembly thus typically have more
network latency than single-packet messages. If you need to keep network
latency to a minimum, avoid sending large messages, especially on lossy
networks. You can determine the maximum size that your connection can accommodate
in a single packet by calling the <b>GetSPCaps</b> method exposed by the <b>DirectPlay8Peer</b>,
<b>DirectPlay8Client</b>, and <b>DirectPlay8Server</b> interfaces.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>Message Categories</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
protocol is designed to handle the following two basic types of network
messaging.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>Reliable</i> versus <i>unreliable</i>
messaging determines whether messages are guaranteed to be delivered to the
target application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <i>Non-sequential</i> versus <i>sequential</i>
messaging determines whether messages are received by the target application in
the same order they are sent.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Games use messaging for a
variety of purposes, each with different demands. To support this range of
messaging needs, the DirectPlay protocol enables you to designate a message as
belonging to one of four categories:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Reliable and sequential</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Unreliable and sequential</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Reliable and non-sequential</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Unreliable and non-sequential</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay protocol enables
you to optimize your messaging strategy by assigning categories on a
message-by-message basis.</p>

<h5 style='page-break-after:avoid'>Reliable and Unreliable Messaging</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages are sometimes lost in
transit. <i>Reliable</i> messaging provides a guarantee that the target will
receive every message. This type of messaging is required when data loss cannot
be tolerated. Most reliable messaging schemes require the target to acknowledge
receipt of each message. If the sender does not receive an acknowledgment
within a specified timeout period, it resends the message. This process
typically continues until the sender receives an acknowledgment, confirming
that the message has arrived.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay protocol imposes
a limit on the number of resend attempts. If no acknowledgment is received
after a reasonable number of attempts, DirectPlay assumes that the connection
has been lost, and closes it.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unreliable messaging is the
simplest form of network communication. It might be faster than reliable
messaging because there is no guarantee that the message will be delivered to
the target. The sender transmits the message. If the target does not receive
the message, the sender will not transmit the message again, and the packet is
lost.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unreliable messaging is used
primarily when speed or bandwidth is more important than an occasional lost
message. For example, high-bandwidth streaming media applications often use
unreliable messaging. They cannot afford to take up bandwidth with acknowledgments
and retransmissions, nor can they wait for a lost message to be retransmitted.
An occasional lost message normally has only a minor impact on quality, so it
can be ignored.</p>

<h5 style='page-break-after:avoid'>Sequential and Non-Sequential Messaging</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages leave the sender in a
particular sequence. However, there is no guarantee that messages will arrive
at the target's computer in the same order that they are sent. For example, if
a message is lost and must be retransmitted, that message will typically arrive
later than messages that followed it in the original sequence.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sequential messaging uses
sequencing information embedded in the message to ensure that the messages are
presented to the target application in the correct order. This type of
messaging is required when the target application must receive messages in the
correct order. Out-of-order messages are buffered until the missing messages
arrive.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Non-sequential messaging
presents the received messages to the target as soon as they arrive at the
target computer, regardless of the order in which they were sent. Because there
is no need to wait for a missing packet, applications often use non-sequential
messaging when speed is more important than an occasional out-of-order message.
The out-of-order message is ignored.</p>

<h5 style='page-break-after:avoid'>Choosing the Best Message Category</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>Choosing the best category for
messages is a core issue for multiplayer game developers. While DirectPlay
provides the tools to manage your messaging, the choice of a message category
ultimately depends on the semantic content of the message and the nature of the
game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following are general
guidelines for choosing the best message category.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use non-guaranteed messaging
whenever the content permits. For example, your game might send frequent
player-location updates. Each update is independent, and it supersedes any
previous updates. If an update is lost, the next update is sufficient to
maintain the player's game state. A lost and retransmitted message might arrive
later than the subsequent update message.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use guaranteed messaging when
data loss cannot be tolerated. For example, a text-based chat feature depends
on every character being delivered to its target.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use sequential messaging when
the order of the messages is important. For example, streaming media typically
uses sequential-unreliable messaging. An occasional dropped message can be
tolerated, but an out-of-order message would cause problems.</span></p>

<h4 style='page-break-after:avoid'>Congestion Control</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>In an ideal world, your game can
send messages as often as it needs to. They arrive at the target immediately
and are processed instantaneously. If all of the computers in your game have
ample processing power and are connected by a lightly used high-bandwidth
network link, you might approach this ideal situation. You can then send
messages as often as you like. However, a number of factors can create <i>congestion</i>
and cause messaging to work more slowly than this ideal:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Network latency. Even under
ideal conditions, messages take a finite time to traverse the network from
sender to target, especially over the Internet. There might be further delays
for acknowledgments, retransmission of lost packets, or reassembly of
out-of-order packets.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Network bandwidth. The network
bandwidth controls the rate at which a message can be sent or received by a
computer. Network links have a wide range of bandwidths, and even
high-bandwidth networks might be slowed by high traffic levels. If one or more
of your players has a low-bandwidth connection, they will be able to send and
receive messages only at a limited rate.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Processing speed. Even if
network bandwidth is high and latency low, the target application still needs
some time to process a received message. If one or more of the players in a
session is using a relatively slow computer, the rate at which they can process
received messages might be below the rate at which messages can be sent.</span></p>

<h5 style='page-break-after:avoid'>Message Throttling</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>If there is no control over the
rate at which messages are sent, a target can be flooded by more messages than
it can handle. To prevent this situation, the Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> protocol <i>throttles</i>
the rate at which messages are sent. The net effect of throttling is that the
rate at which messages are sent is controlled by the rate at which the target
can handle them. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Throttling is implemented with a
<i>sliding window</i> mechanism. The sliding window is basically a queue with a
limited number of slots that holds messages that have been sent but not yet
received. All outgoing messages are placed in this queue, regardless of their
category. Once the sent-message queue is full, it accepts no more outgoing
messages until one of the messages in the queue has been received.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For optimal performance, the
size of the sliding window must be matched to current network conditions. The
DirectPlay protocol automatically monitors such factors as the number of
messages and the total number of bytes in the sent-message queue. This information
is then used to dynamically adjust the size of the sliding window to optimize
messaging for the current network conditions. </p>

<h5 style='page-break-after:avoid'>Connection Checking</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>If there is no activity on a
link, the DirectPlay protocol periodically tests the connection by sending an
empty reliable packet. If no acknowledgment is received from the target after a
reasonable number of attempts, DirectPlay concludes that the link has been
disconnected. </p>

<h4 style='page-break-after:avoid'>Send Prioritization</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages often vary widely in
importance. Some are time-critical, and must be delivered as quickly as
possible. Others can be delayed if necessary, or possibly not sent at all. One
issue with congestion control algorithms is that an application might create
messages faster than they can be sent. Unsent messages must then be held in a
queue until an outgoing slot opens up. If all unsent messages are held in a
single pending-message queue, high priority messages might be blocked while
waiting for lower priority messages to be sent first.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
protocol solves this problem by having three pending message queues: low,
medium, and high priority. When a slot opens up in the sent-message queue, the
protocol selects the next message to be sent as follows:</p>

<p class=Ln1 style='margin-left:23.4pt'><span style='font-family:"Arial",sans-serif'>1.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>Send the
oldest message in the high-priority queue.</p>

<p class=Ln1 style='margin-left:23.4pt'><span style='font-family:"Arial",sans-serif'>2.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>If there
are no messages in the high-priority queue, send the oldest message in the
medium-priority queue.</p>

<p class=Ln1 style='margin-left:23.4pt'><span style='font-family:"Arial",sans-serif'>3.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>If there
are no messages in the medium-priority queue, send the oldest message in the
low-priority queue.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This priority mechanism enables
you to get your time-critical messages out as quickly as possible, even though
other less important messages have already been submitted.</p>

<h5 style='page-break-after:avoid'>Send Timeouts</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>One of the consequences of
throttling is that messages might spend a relatively long amount of time in a
pending-message queue, especially if they are low priority. Some messages might
stay long enough to have been superseded by subsequent messages. These messages
are no longer relevant. For example, your application might periodically send
player-location update messages. Each update is independent of the others, and
supersedes any previous updates. If you have two player-location updates in the
pending message queue, only the most recent one needs to be sent.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay protocol enables
you to handle the problem of outdated messages by adding an optional timeout
value to the message. If the message is still in a pending-message queue when
the timeout expires, the message will be canceled.</p>

<h5 style='page-break-after:avoid'>Disconnection</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>When an application sends a
disconnect message, the message is placed at the end of the low-priority
pending-message queue, and the protocol stops accepting outgoing messages. This
practice guarantees that all pending messages are sent before the link is
disconnected. The disconnect message is sent as a reliable sequential message
to guarantee that it arrives, but not before all other messages in the queue
have been delivered.</p>

<h4 style='page-break-after:avoid'>Monitoring Messaging Statistics</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>While the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
protocol handles many aspects of messaging automatically, your application
should still monitor messaging behavior. For example, if you are consistently
sending messages faster than they can be delivered, you might need to modify
your messaging scheme.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because network conditions
change continuously, your application should periodically check the behavior of
the network and adjust its messaging scheme accordingly. To do so, call the <b>GetConnectionInfo</b>
method that is exposed by every DirectPlay 8.0 interface that supports
messaging. <b>GetConnectionInfo</b> returns a structure that contains a wide
variety of statistical information that you can use to refine your messaging
scheme, including the following:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because network conditions
change continuously, your application should periodically check the behavior of
the network and adjust its messaging scheme accordingly. To do so, call the <b>GetConnectionInfo</b>
method that is exposed by every DirectPlay 8.0 object that supports messaging. <b>GetConnectionInfo</b>
returns a type that contains a wide variety of statistical information that you
can use to refine your messaging scheme, including the following:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Round trip latency</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Throughput</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Packets sent</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Packets received</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Packets resent</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Packets dropped</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Messages transmitted at
different priority levels</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The messaging statistics are obtained by monitoring the actual
network traffic. If you call <b>GetConnectionInfo</b> immediately after you
initialize the connection, there will have been little time to collect data and
the statistics might be misleading.</p>

<h4 style='page-break-after:avoid'>Monitoring the Pending Message Queues</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should monitor your pending
message queues to ensure that they do not become too large. The <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b> interfaces all expose
a <b>GetSendQueueInfo</b> method that can be used to check the number of
messages and the number of bytes currently in the queue. By default, the method
returns the total for all three queues, but you can also obtain values for each
of the three priority levels.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should monitor your pending
message queues to ensure that they do not become too large. The <b>DirectPlay8Peer</b>,
<b>DirectPlay8Client</b>, and <b>DirectPlay8Server</b> objects all expose a <b>GetSendQueueInfo</b>
method that can be used to check the number of messages and the number of bytes
currently in the queue. By default, the method returns the total for all three
queues, but you can also obtain values for each of the three priority levels.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Optimizing Network Usage</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Providing the best gaming
experience normally means sending updates and other information as rapidly as
possible without flooding the target with more messages than it can handle. The
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> protocol combined with asynchronous messaging
enables you to dynamically optimize your messaging strategy to provide your
users with the best possible game experience.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The bulk of your messaging will
use the <b>IDirectPlay8Peer::SendTo</b>, <b>IDirectPlay8Client::Send</b>, or <b>IDirectPlay8Server::SendTo</b>
methods. These methods normally work asynchronously for all message categories.
They return immediately, and your message handler receives a <b>DPNMSG_SEND_COMPLETE</b>
message when the message is actually sent. You can choose to send messages
synchronously by setting the DPNSEND_SYNC flag. If you do so, the method will
block until the message is actually sent.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The bulk of your messaging will
use the <b>DirectPlay8Peer.SendTo</b>, <b>DirectPlay8Client.Send</b>, or <b>DirectPlay8Server.SendTo</b>
methods. These methods normally work asynchronously for all message categories.
They return immediately, and DirectPlay calls your message handler's <b>DirectPlay8Event.SendComplete</b>
method when the message is actually sent. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can choose to send messages
synchronously by setting the DPNSEND_SYNC flag. If you do so, the <b>Send/SendTo</b>
method will block until the message is actually sent.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay protocol's
throttling mechanism guarantees that the client will not receive messages
faster than they can be handled. However, the throttling protocol does not
control how frequently you submit messages to the outgoing queue. You can easily
end up with a large backlog of messages in your unsent message queues. You can
avoid this situation by sending messages as infrequently as possible, but then
you might unnecessarily degrade the user's experience. An optimal messaging
strategy sends messages as fast as possible without exceeding the target's
ability to handle them.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following are tips for
optimizing your messaging strategy.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Send most if not all of your
messages asynchronously. If you send a message synchronously, the method will
block until the throttling mechanism allows the message to be sent. </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Monitor the pending message
queues and the network statistics. If there are few or no messages in the
queue, you can increase your transmission rate. If the queues are large or
growing rapidly, decrease your transmission rate and perhaps cancel some messages.
See the discussion of send timeouts in Send Prioritization for further
discussion.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Analyze the pending message
queues on a player-by-player basis. Some players might be able to receive
messages at a much higher rate than others. The bulk statistics might be
misleading. Consider using directed sends rather than group sends.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Choose the appropriate category
for each message. Reserve the categories with the highest overhead for the most
important messages.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Prioritize your messages, so
that the most important are assured of being sent promptly and not delayed by
relatively unimportant messages.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Do not let the pending message
queues grow too large. In addition to delaying the transmission of your
messages, a large number of pending messages might consume significant memory
resources.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use the timeout feature of the <b>Send</b>
and <b>SendTo</b> methods to automatically clear outdated messages from the
pending message queue.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Minimize the amount of data per
message. It is usually better to send frequent small messages than a smaller
number of large messages.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Do not loop tightly when
checking the pending message queue. Doing so wastes CPU cycles. Instead, use a
sleep period based on how long it typically takes the queue to get down to the
level that it will be ready for another send.</span></p>

<h3 style='page-break-after:avoid'>Using the DirectX Protocol in an Application</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section covers how you can
use the features of the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> protocol in your application.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use five DirectPlay
interfaces to send messages.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> IDirectPlay8Peer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> IDirectPlay8Client</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> IDirectPlay8Server</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> IDirectPlay8LobbyClient</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> IDirectPlay8LobbiedApplication</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Depending on which interface
your application is using to send messages, you send a message by calling a
method named either <b>Send</b>, or <b>SendTo</b>. While the usage of these
five methods is similar, they vary in detail. Refer to the appropriate
reference pages for further discussion. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use five DirectPlay
objects to send messages.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8Peer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8Client</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8Server</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8LobbyClient</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8LobbiedApplication</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Depending on which object your
application is using to send messages, you send a message by calling a method
named either <b>Send</b>, or <b>SendTo</b>. While the usage of these five
methods is similar, they vary in detail. Refer to the appropriate reference
pages for further discussion. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>Send/Sendto </b>method's
parameters might allow you to control many of the DirectPlay protocol's
features. For example, the <i>dwFlags</i> field of <b>IDirectPlay8Peer::SendTo</b>
allows you to specify:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The message's priority level.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the message is reliable
or unreliable.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the message is
sequential or non-sequential.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Refer to the appropriate method
reference for further details.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When your application receives a
message, your callback function will receive a DPN_RECEIVE message. The
associated structure contains a pointer to the data block, along with
information such as the source of the message. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>Send/Sendto </b>method's
parameters might allow you to control many of the DirectPlay protocol's
features. For example, the <i>lFlags</i> field of <b>DirectPlay8Peer.SendTo</b>
allows you to specify:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The message's priority level.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the message is reliable
or unreliable.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the message is
sequential or non-sequential.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Refer to the appropriate method
reference for further details.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When your application receives a
message, DirectPlay will call your message handler's <b>DirectPlay8Event.Receive</b>
method. The associated type contains a pointer to the data block, along with
information such as the source of the message. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>DirectPlay Callback Functions and
Multithreading Issues</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> and DirectPlay
Voice both require you to implement and register several callback functions to
handle the events fired by DirectPlay. DirectPlay is multithreaded and will
fire multiple events concurrently. It is possible that your application will
receive multiple overlapping callbacks.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay maintains a thread
pool to service callback indications, and your callback is invoked on a thread
from the pool of threads maintained by DirectPlay. The size of this thread pool
is configurable on a per process basis in Microsoft Windows 2000. Also,
DirectPlay will use I/O completion ports when running on Windows 2000. I/O
completion ports is an advanced topic beyond the scope of this document, and it
is recommended that you look in the Microsoft Developer Network documents or in
one of the Win32 multithreading references currently available.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In order to correctly and
reliably access data in DirectPlay callbacks, you are required to implement a
method of multithreading synchronization. This is known as making your callback
<i>re-entrant</i> or <i>threadsafe</i>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft Windows family of
operating systems currently offers three methods of synchronizing data in
multithreaded environments:</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> </span></b><span
style='font-family:"Times New Roman",serif'>Mutex Objects</span></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> </span></b><span
style='font-family:"Times New Roman",serif'>Semaphore Objects</span></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> </span></b><span
style='font-family:"Times New Roman",serif'>Critical Section Objects</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay voice samples
that ship with the DirectX 8.0 SDK demonstrate synchronization using Critical
Section Objects. If you wish to implement a Mutex or Semaphore Object, these
topics are discussed in the Microsoft Platform SDK as well as in many reference
books. Implementing any of these synchronization methods requires an expert
knowledge level in these areas due of the level of complexity and difficulty in
debugging should any issues arise.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay threading model
is optimized for maximum efficiency and there are no thread context switches
during &quot;send&quot; operations and during &quot;indication&quot; messages,
including receive messages.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses
DirectPlay Networking Callbacks.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See Implementing a Callback
Function in DirectPlay and DirectPlay Voice for more information.</p>

<h3 style='page-break-after:avoid'>DirectPlay Networking Callbacks</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> networking
callback functions are of type PFNDPNMESSAGEHANDLER. Depending on the type of
networking session, you register the address of your callback function with
IDirectPlay8Peer::Initialize, IDirectPlay8Client::Initialize, or
IDirectPlay8Server::Initialize.</p>

<h5 style='page-break-after:avoid'>Synchronization Issues</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must employ one of the three
thread synchronization objects in order to maintain the integrity of your game
data during processing in a DirectPlay callback.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In order to understand how your
game data could be corrupted, consider that your callback inserts a packet of
game data into a structure. If another thread enters the callback reentrantly
before the first callback has completed, it is possible that this thread could
also attempt to access the structure at the same location in memory and change
the data. Therefore, the data placed in the structure by the first thread is
overwritten by the data placed in the structure by the second thread. Please
note that this is an oversimplified example of multithreading and there are
many other implications to not properly synchronizing multiple threads. Again,
it is advisable to achieve an expert level of knowledge in implementing
multithreaded callbacks before you attempt to create your own.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See Implementing a DirectPlay
Networking Callback Using Critical Section Objects for an example of how to
synchronize data in a DirectPlay networking session.</p>

<h5 style='page-break-after:avoid'>Worker Threads</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>You have the option of creating
your own &quot;worker threads&quot;. A worker thread is another multithreaded
application defined callback that is created to process game data independently
of the DirectPlay callbacks. The most common way of accomplishing this is to
buffer data received during a DirectPlay networking callback thread. Then, a
new thread is created and a message is sent to your worker thread callback to
notify it to process the buffered data.</p>

<h5 style='page-break-after:avoid'>Multithreading Performance Issues and
Asynchronous Operations</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>It is important to carefully
consider how much time is spent processing messages in DirectPlay callbacks. If
you process a lot of data within the DirectPlay callbacks and you employ a data
locking mechanism to synchronize threads, you will run into blocking problems
as other threads wait to enter the callback.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you choose to implement a
worker thread and offset the processing of game data to another callback, you
run the risk of adding a lot of overhead processing time as the CPU switches
context between the threads you create and the threads created by DirectPlay.
This should be done only if the game data requires a large amount of processing
time, and the data is not critical to the real time operation of the game. For
example, it is not recommended to process player location data in a worker
thread because this data is critical to positioning players in real time within
the game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also return <b>DPNSUCCESS_PENDING</b>
from the callback, create a pointer to the data buffer, and make that pointer
available the worker thread. When the worker thread is finished processing the
game data, it calls the ReturnBuffer method of either IDirectPlay8Peer or
IDirectPlay8Client, depending on the topology used.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Understanding DirectPlay Voice</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> Voice is a
full-voice communications API that is integrated with DirectPlay for network
session management and network transport. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay Voice is also
integrated with DirectPlay Sound for voice recording and playback, and all
DirectPlay Sound audio features are inherited including the ability to target
voice data to different playback buffers and the use of special audio effects
such as three-dimensional sound positioning.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay Voice Networking</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay Voice Topologies</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Voice Host Migration</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Audio Device Testing</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Voice Codecs</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Automatic Gain Control</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission Control</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Capture Focus</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Jitter Buffers</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Working Set Guidelines</p>

<h3 style='page-break-after:avoid'>DirectPlay Voice Networking</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> Voice uses a
DirectPlay session for media-independent network transport and player
management. The DirectPlay Voice API does not duplicate session control
features from DirectPlay. A DirectPlay network transport session must also be
created before DirectPlay Voice can transmit and receive voice communications.
DirectPlay Voice can use either the IDirectPlay4 object or IDirectPlay8 object
for network transport.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Note that if DirectPlay Voice is
being used in-process with a multiplayer game, the game will most likely also
use the transport session to exchange its game-specific data. This makes it
possible to optimize the use of network resources between the game and voice
data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>It is also acceptable to create
and use a transport session specifically for the voice session, as would be the
case for a standalone voice conferencing application.</p>

<h3 style='page-break-after:avoid'>DirectPlay Voice Topologies</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> Voice sessions
require a DirectPlay network session to transport voice communication. Once the
network session has been created, a DirectPlay Voice object can be created to
use one of three topologies.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Peer-to-Peer Voice Topology</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Forwarding Server Voice Topology</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Mixing Server Sessions</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The choice of topology is
dependent on several factors, and these factors are discussed in the individual
DirectPlay Voice topology topics. Note that not all voice topologies can be
transported over all types of DirectPlay networking sessions.</p>

<h4 style='page-break-after:avoid'>Peer-to-Peer Voice Topology</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session using a peer-to-peer topology, each voice-session client streams
its voice audio data directly to every other voice-session client. Each client
receives all individual incoming voice audio streams, mixes the received
streams, and plays the resulting mixed signal on the client's computer.</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=370
height=232 id="Picture 3" src="dplay_files/image004.gif"></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The advantage of using a
peer-to-peer topology is that no computer in the voice session requires high
bandwidth or processor power. However, the bandwidth and processor usage on
each client's computer varies according to the number of incoming and outgoing
audio streams. The number of outgoing voice audio streams is equal to the
number of targets participating in the voice session, unless the network
provider is capable of true multicasting, as noted below. The number of
incoming voice audio streams depends on how many other voice-session clients
are targeting the client in question and also on how many of the other clients
are speaking.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>As a game design consideration,
it is not useful for a voice-session client to be the target of more than about
six to eight other clients. If all six to eight clients are speaking at once,
the conversation can become confusing, and communication between clients can be
difficult.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DirectPlay network
session supports true multicasting, the number of outgoing voice audio streams
can be reduced considerably. If all clients are part of a multicast network and
the target of the voice stream is a DirectPlay group, there is only one
outgoing stream.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A DirectPlay voice session using
a peer-to-peer voice topology supports 3-D spatialization of the voice data
using the <b>IDirectPlayVoiceClient::Create3DSoundBuffer</b> method.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A DirectPlay voice session using
a peer-to-peer voice topology supports 3-D spatialization of the voice data
using the <b>DirectPlay8VoiceClient.Create3DSoundBuffer</b> method.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>It is important to note that a
voice session using a peer-to-peer voice topology cannot be used if the network
transport is a client/server session.</p>

<h4 style='page-break-after:avoid'>Forwarding Server Voice Topology</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
voice session using a forwarding server topology, one computer in the session
acts as a forwarding server. Each client in the voice session streams voice
data to the forwarding server, which then forwards the voice data to all other
clients in the session. Each client receives all incoming audio streams
forwarded from the forwarding server. Each client's computer then mixes the
incoming streams and plays them back.</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=442
height=255 id="Picture 2" src="dplay_files/image005.gif"></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The outgoing bandwidth
requirement on each client in a voice session using a forwarding server
topology is constant because there is only one outgoing voice audio stream. The
incoming bandwidth and processor requirements are identical to the requirements
of a voice session using a peer-to-peer topology, but they vary depending on
the number of incoming voice audio streams. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The server has much higher
bandwidth requirements than the individual clients in a forwarding server
DirectPlay voice session. However, the processor requirements are not high
because no compression or decompression of voice data occurs on the server. This
reduced load on the computer's processor also means that an individual client's
computer with a high bandwidth connection can host the forwarding server
without adversely affecting the performance of the individual client's computer
or the performance of a game server and/or client program running on the same
computer.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Note that in a voice session
using a peer-to-peer topology, the outgoing bandwidth requirements on the
individual clients are usually much higher than the incoming bandwidth
requirements. Therefore, reducing the outgoing bandwidth requirement to a
single stream of audio can result in a significant reduction in total bandwidth
usage. For example, if a client is taking part in an eight-person voice session
in which all clients can hear one another, the client has seven outgoing voice
streams each time voice data is captured and transmitted on his or her
computer. However, it is rare that all clients talk at once, so there are most
likely fewer than two or three incoming voice streams at any one time.</p>

<h4 style='page-break-after:avoid'>Mixing Server Sessions</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>In mixing server sessions, one
computer in the session acts as a mixing server. Each client streams its voice
data to the mixing server. The mixing server examines the targets of each voice
stream, performs decompression, mixing, and recompression as appropriate to
generate a mixed stream of audio data for each client. Each client receives
this single stream of pre-mixed audio data and plays it back.</p>

<p class=Art><span style='font-family:"Times New Roman",serif'><img width=442
height=255 id="Picture 1" src="dplay_files/image006.gif"></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The outgoing bandwidth, incoming
bandwidth, and CPU requirement on the client in a mixing server session is
easily predictable because each client has only one outgoing stream of audio to
compress and send, and one incoming stream of audio to decompress and play
back.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The mixing server has much
higher bandwidth and CPU requirements than do the clients. Typically, the
mixing server is either a completely dedicated computer, or it shares a
computer with a dedicated game server.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Mixing server voice sessions do
not support 3-D spatialization of the voice data through the <b>IDirectPlayVoiceClient::Create3DSoundBuffer</b>
method.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Mixing server voice sessions do
not support 3-D spatialization of the voice data through the
DirectPlayVoiceClient8.Create3DSoundBuffer method.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can run mixing server voice
sessions using either a peer-to-peer or a client/server transport session.</p>

<h3 style='page-break-after:avoid'>Voice Host Migration</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a peer-to-peer Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
network session, one client of the networking session acts as host. If that
host should exit the session or stop responding for any reason, another client
in the session is elected as host.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a DirectPlay voice session, a
similar process of host migration occurs in peer-to-peer voice sessions, except
that the voice host migrates independently of the DirectPlay network session.
The voice host migrates when the server calls <b>IDirectPlayVoiceServer::StopSession</b>
or if the voice host stops responding. When the voice host migrates, each
client in the voice session receives a DVMSG_HOSTMIGRATED callback. The
structure passed to the new host has a valid <b>pdvServerInterface</b> pointer
and can begin making <b>IDirectPlayVoiceServer</b> calls.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a DirectPlay voice session, a
similar process of host migration occurs in peer-to-peer voice sessions, except
that the voice host migrates independently of the DirectPlay network session.
The voice host migrates when the server calls <b>DirectPlayVoiceServer8.StopSession</b>
or if the voice host stops responding. When the voice host migrates, the <b>DirectPlayVoiceEvent8.HostMigrated</b>
method is called on each of the clients. If the local client has become the new
voice session host, the <i>NewServer</i> parameter will point to the newly
created <b>DirectPlayVoiceServer8</b> object that can be used by the local
client for providing host services. If the local client is not the new host,
the NewServer parameter will be NULL.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Audio Device Testing</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microphone setup is supported by
the <b>IDirectPlayVoiceTest</b> interface. This interface has one method, <b>IDirectPlayVoiceTest::CheckAudioSetup</b>,
that can be used to run the test wizard. This wizard confirms that your system
properly supports full duplex operation and ensures your microphone and
playback settings are correct. You need to run the wizard only once for each
combination of playback and capture device you select. Each time your
application starts, you should test the configuration by calling <b>IDirectPlayVoiceTest::CheckAudioSetup</b>
with the <i>dwFlags</i> parameter set to DVFLAGS_QUERYONLY. This enables you to
quickly test whether the device configuration has changed since you last tested
them. If your devices have not been tested, you should run <b>IDirectPlayVoiceTest::CheckAudioSetup</b>
again to invoke the wizard. If you do not do so, then <b>IDirectPlayVoiceClient::Connect</b>
will return DVERR_RUNSETUP, and you will not be able to initialize DirectPlay
Voice. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the user's sound card does
not have full duplex capability, it can only listen to voice communications. It
cannot send voice communications because the game typically holds the audio
card in playback mode. To prevent problems, DirectX 8.0 does not enable
switching dynamically between playback and capturing. The DirectX audio setup
wizard provides feedback to the user on the duplexing capabilities of the
system.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microphone setup is supported by
the <b>DirectPlayVoiceTest8.CheckAudioSetup</b> method. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Calling this method invokes the
DirectX audio setup wizard, which runs tests and confirms that the system
properly supports full duplex operation and ensures microphone and playback
settings are correct. You need to run the wizard only once for each combination
of playback and capture device you select. Each time your application starts,
you should test the configuration by calling <b>DirectPlayVoiceTest8.CheckAudioSetup</b>
with the <i>lFlags</i> parameter set to DVFLAGS_QUERYONLY. This enables you to
quickly test whether the device configuration has changed since your devices
were last tested. If your devices have not been tested, you should run <b>DirectPlayVoiceTest8.CheckAudioSetup</b>
again to invoke the wizard. If the configuration has changed since the last
test and you have not run the wizard again, <b>DirectPlayVoiceClient8.Connect</b>
will return DVERR_RUNSETUP, and you will not be able to initialize DirectPlay
Voice. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the user's sound card does
not have full duplex capability, it can only listen to voice communications. It
cannot send voice communications because the game typically holds the audio
card in playback mode. To prevent problems, DirectX 8.0 does not enable
switching dynamically between playback and capturing. The DirectX audio setup
wizard provides feedback to the user on the duplexing capabilities of the
system.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Note that there are still many
computer systems in active use that do not include a full duplex sound card.
Full duplex sound cards came into popular use in 1998, although at the time few
of the audio card drivers had full duplex operation enabled. Customers who
purchased new systems in 1999 or upgraded drivers in 1999 are more likely to
have full duplex capability. </p>

<h3 style='page-break-after:avoid'>Voice Codecs</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The compression/decompression
(codec) algorithms provided specifically with Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> are
voice-quality codecs. They are all 8 kHz, 16-bit mono-formatbased algorithms.
Third-party codecs are not supported, and you cannot write proprietary codecs
for use with DirectPlay Voice.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>It is important to note that as
the bandwidth requirements drop, the audio quality of the voice data also
drops. The following table describes the sound quality of each codec.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Codecs cannot be dynamically
switched during a game voice session, and all users must use the same codec in
a voice session. However, a game could possibly create an appropriate user
interface to force codec switching by dropping a current session and creating a
new session using a different codec. This would be appropriate if the game
application's users were jumping from a lobby chat to a game.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>As with all other game setup
parameters, the host should control the codec used. The voice-session host does
not necessarily have to be the same as the game-data host. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>As with any form of network
communication, it is important to analyze the cost of the voice communication
to ensure that adequate bandwidth is available to support communication of the
game data and voice data. Analyzing the voice bandwidth consumption is
straightforward. Estimate the number of simultaneous voice streams that you
anticipate and multiply that number by the sum of the bandwidth required by the
codec and the protocol overhead.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>CPU consumption is another
factor to consider when choosing a codec. Even low bandwidth codecs typically
require about 8 percent of a 200 megahertz (MHz) Pentium processor's resources
to encode a voice stream and an additional 4 percent to decode. As with network
bandwidth, CPU resource consumption is additive per stream.</p>

<h3 style='page-break-after:avoid'>Automatic Gain Control</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
offers functionality to adjust the hardware input volume on the sound card
automatically to provide the best recording input level possible. To enable
Automatic Gain Control, set the DVCLIENTCONFIG_AUTORECORDVOLUME flag in the <i>dwFlags</i>
member of the <b>DVCLIENTCONFIG</b> structure when you set the client
configuration. Automatic Gain Control can be activated or deactivated at any
time during the voice session.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
offers functionality to adjust the hardware input volume on the sound card
automatically to provide the best recording input level possible. To enable
Automatic Gain Control, set the DVCLIENTCONFIG_AUTORECORDVOLUME flag in the <i>lFlags</i>
member of the DVCLIENTCONFIG structure when you set the client configuration.
Automatic Gain Control can be activated or deactivated at any time during the
voice session.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most game applications should
use automatic gain control because it requires a negligible amount of game
resources and prevents the need for an in-game volume recording control. Users
are not required to set the level themselves, yet they experience the highest
quality of voice transmission and reception possible.</p>

<h3 style='page-break-after:avoid'>Transmission Control</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>To keep the performance
requirements of Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice low, voice data should be transmitted
only when the user is speaking. There are two methods to control voice data
transmission. The choice of which method to use depends on your game's design
considerations.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Voice Activation</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Push to Talk</span></p>

<p class=Leh>&nbsp;</p>

<h4 style='page-break-after:avoid'>Voice Activation</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>With voice activated
transmission control, the microphone input is constantly analyzed to determine
if the user is speaking. Voice activation has two benefits. It does not require
the user to do anything more than speak into the microphone. Also, it is easily
coded because it requires only setting the <i>dwFlags</i> parameter of the
DVCLIENTCONFIG structure to DVCLIENTCONFIG_AUTOVOICEACTIVATED when the voice
session is connected.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>With voice-activated
transmission control, the microphone input is constantly analyzed to determine
if the user is speaking. Voice activation has two benefits. It does not require
the user to do anything more than speak into the microphone. Also, it is easily
coded because it requires only setting the <i>lFlags</i> parameter of the
DVCLIENTCONFIG structure to DVCLIENTCONFIG_AUTOVOICEACTIVATED when the voice
session is connected.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>However, one drawback of voice
activation is that sounds such as the user breathing directly on the
microphone, high levels of ambient sound caused by a noisy environment, or set
of external speakers playing back the game's audio could cause unwanted voice
activation. In addition, low-quality microphones exaggerate this possibility. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>Push to Talk</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>Push-to-talk transmission
control requires users to actively select when they want to transmit voice
data. With this transmission control method, there is no danger that anything
besides voice data will be transmitted. This method is analogous to pushing the
Talk button on a two-way radio, and this functionality adds reality to certain
game genres such as first-person shooters. Another benefit of using this method
is that requiring users to actively select when they want to speak reduces the
number of users speaking at once. This transmission control requires more
design and development than voice activation because user-control functionality
is required.</p>

<h3 style='page-break-after:avoid'>Capture Focus</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The concept of capturing focus
is integral to creating lobbyable game applications and lobby applications with
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice support. If your game application does
not properly implement focus capture, it is possible that voice communication
will not function if your game was launched from a lobby application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To illustrate this point,
consider two players who meet in a lobby application that has DirectPlay Voice
support. The two players agree to launch the game. After the game is launched,
the lobby application loses focus on each player's computer, and each copy of
the game application gains focus. If the game application does not properly
gain focus from the lobby application, it is possible that the lobby
application can still have focus while the game application is running.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For example, this will occur if
the first player's lobby application retains focus while the game session is
running while the second player's game session gains focus from the lobby
application. From the second player's perspective, the first player's voice
session has fallen back to half-duplex. The second player can hear the first
player, but the first player cannot hear the second player. From the first
player's perspective, the voice session has ended because the second player
does not seem to be speaking. Also, the first player does not know that the
second player can hear him or her.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Note that this behavior is by
design. Consider the same scenario as above, but when the first player attempts
to start the game session from the lobby application, there is a problem and
the session fails to start. If the second player's session starts successfully,
that player can hear the voice of the first player and the first player can
inform the second player that their game session failed. Both players might
then drop back to the lobby and attempt to start the session once again.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To handle capture focus
properly, your game application must set the <i>hwndAppWindow</i> parameter in
the DVSOUNDDEVICECONFIG structure to the window handle that will have focus
when the game is running. The DirectPlay Voice session can then be created
through a call to Connect. The game application must then handle the
DVMSGID_LOSTFOCUS and DVMSGID_GAINFOCUS messages.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See <b>Implementing Capture
Focus</b> for more information.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to applications
written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Jitter Buffers</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> Voice features
a jitter buffer, an adaptive buffering algorithm that provides optimal voice
quality with the least amount of latency. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>On busy networks, individual
packets of voice data information might arrive in a different sequence from
that in which they were encoded on the host computer. Because voice data is
sequential in nature, these incoming packets must be queued for a period of
time so that delayed packets have an opportunity to arrive and be played back
in order.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the jitter buffer is set to
maximize the quality voice communication, it takes longer for the required
number of voice packets to arrive and be queued for play. The result is voice
latency, and the effect is that voice communication is not heard in real time.
Instead, the voice data might be heard anywhere from a fraction of a second to
several seconds after it was recorded. This can introduce problems during
cooperative gameplay because events can occur in the game but players will not
be able to communicate information based on those events in real time. For
example, if a player in a first-person shooter is about to be attacked from
behind and a teammate attempts to warn the player, the voice communication
might not be heard until after the player has been attacked.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the jitter buffer is set to a
reduce latency, the number of packets required to fill the queue is reduced.
However, it is possible that not all sequential packets will arrive in time
and, as a result, voice data will be missing from the buffer when it is played.
The voice communication will be heard much closer to the actual time it was
recorded. However, it will have a &quot;broken-up&quot; quality.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay jitter buffer
uses two methods to determine how to provide the best quality of voice
communication with the least amount of latency. First, network conditions are
monitored to determine the amount of lag or network congestion. The size of the
jitter buffer, or queue, is then dynamically sized to keep latency as low as
possible while providing the least amount of voice break up. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The default behavior of
DirectPlay Voice jitter buffer is to automatically adjust to network
conditions. You can manually adjust how closely the algorithm tracks network
conditions using the <i>dwBufferAggressiveness</i> and <i>dwBufferQuality</i>
members of the <b>DVCLIENTCONFIG</b> structure. The higher the level of
&quot;aggressiveness&quot;, the more closely the algorithm monitors network
conditions. In general, the higher the quality value, the higher the quality of
the voice but the higher the latency. The lower the quality value, the lower
the latency but the lower the quality of the voice. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The default behavior of
DirectPlay Voice jitter buffer is to automatically adjust to network
conditions. You can manually adjust how closely the algorithm tracks network
conditions using the <i>lBufferAggressiveness</i> and <i>lBufferQuality</i>
members of the DVCLIENTCONFIG structure. The higher the level of
aggressiveness, the more closely the algorithm monitors network conditions. In
general, the higher the quality value, the higher the quality of the voice but
the higher the latency. The lower the quality value, the lower the latency but
the lower the quality of the voice. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>It is important to choose an
appropriate level of aggressiveness for network conditions when your game
application is running because selecting a high level of aggressiveness during
times of steady network performance can cause the algorithm to misinterpret a
transitory problem and overcompensate for a problem that might not exist. </p>

<h3 style='page-break-after:avoid'>Working Set Guidelines</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Determining the best
configuration of transport topology, voice topology, transmission control, and
codec depends on the type or genre of game you are creating, the number of
players that will participate in a single game session, and the type of connection
that will be targeted.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>It's important to note that the
number of players participating in the voice session is not necessarily the
number of players actually participating in the game session. For example, if
your game is a first-person shooter, voice communication can be represented in
the game as a radio or communicator that is offered as a time-limited powerup.
Also, the radio metaphor can be used to limit communication to radios in either
vehicles or stationary command stations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A second example to consider is
an online bridge game, which involves four players at one time. Because this is
a small working set, it is appropriate to choose a peer-to-peer voice topology
transported over a peer-to-peer network topology. This small working set also
allows for the use of voice activation as the mode of transmission control. The
peer-to-peer voice topology is easily implemented and does not require any
player to act as a server. If all four players use the Voxware SC6 codec, the
maximum resulting bandwidth is 4.2 Kbps per speech stream, including the codec
protocol overhead. Further assuming that game data requires negligible
bandwidth, the outgoing maximum bandwidth requirement for an individual speaker
is three independent streams to the other three players, or 12.6 Kbps. The
incoming stream to any client ranges from 0 if no other players are talking, to
12.6 Kbps if all three other players speak simultaneously. The CPU requirement
is 8 percent for encoding and 0 to 12 percent for decoding. This results in a
worst-case requirement of 25.2 Kbps. Therefore each player must have a minimum
of a 14,400-baud modem. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Another example is a squad
combat game that can involve up to 32 players split between 2 teams. Assume
that the game data requires a 28,800 baud modem. In this example, there is a
larger number of players and it is appropriate to choose a forwarding server
voice topology. Again, if all players use the Voxware SC6 codec, the bandwidth
requirements are the same as the bridge game above: 4.2 Kbps. In this example
we see that there is 4.2 Kbps outgoing when speaking, and a maximum of 12.6
Kbps incoming from the squad. The maximum CPU requirement is 8 percent of a
Pentium 200 for encode and 12 percent receiving. Therefore, each player
requires 28.8 Kbps for game data, and the greater incoming bandwidth of 12.6
Kbps requires a minimum 41,400 baud rate from each player's modem.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The worst-case scenario for the
forwarding server itself is if all 32 players talk at once, requiring 134.4
Kbps. The server CPU use is minimal because the server is not encoding or
decoding the streams. It is merely redirecting them. More typically, there
might be 16 players talking simultaneously for 67.2 Kbps. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To illustrate the difference
between choosing a mixing server voice topology and a forwarding server voice
topology, consider the same 32-player squad combat game discussed above. If a
mixing server voice topology is used, each client requires 4.2 Kbps to send and
4.2 Kbps to receive. The worst-case bandwidth requirements drop to 8.4 Kbps and
12 percent of the Pentium processor running at 200 MHz. This reduces the modem
requirement to a 33,600 Kbps baud rate for the client. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For the server, the CPU burden
changes. The server is now decoding and re-encoding all incoming streams and is
also mixing the streams as required. The CPU burden mix the stream is
relatively low and is considered negligible. The worst case is the decoding and
encoding of 32 simultaneous streams. This results in a requirement of at least
a Pentium II processor running at 400 MHz for the voice service alone.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>Using DirectPlay</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section of the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
documentation is designed to show you how to use the DirectPlay API to
implement a number of important aspects of multiplayer applications.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Using DirectPlay Enumerations</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd> Using
Player Context Values</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a Lobby Client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a Lobbyable
Application</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Monitoring DirectPlay Network
Traffic with Netmon</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a Callback Function
in DirectPlay and DirectPlay Voice</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a DirectPlay
Networking Callback Using Critical Section Objects</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Using the DirectPlay DPNSVR
Application</span></p>

<h2 style='page-break-after:avoid'>Using DirectPlay Enumerations</h2>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumeration is one of the ways
that Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> provides information to applications.
Enumerations are used to collect data associated with a number of similar
elements. For instance, you can use an enumeration to obtain information about
each player in a session. To perform an enumeration, an application queries
DirectPlay for a particular type of information, and DirectPlay returns a data
structure for each related element, typically as an array of structures.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most applications will need to
perform at least one and often several enumeration operations. Each DirectPlay
interface supports a different set of enumerations. Thus the details will vary
from application to application. The following is a list of available
enumerations, along with the interfaces that support each type of enumeration.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Session hosts (<b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Service providers (<b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client, IDirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Players (<b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Groups (<b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Group members (<b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Local programs (<b>IDirectPlay8LobbyClient</b>)</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see
Implementing a DirectPlay Enumeration.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumeration is one of the ways
that Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> provides information to applications.
Enumerations are used to collect data associated with a number of similar
elements. For instance, you can use an enumeration to obtain information about
each player in a session. To perform an enumeration, an application queries
DirectPlay for a particular type of information, and DirectPlay returns a data
type for each related element, typically as an array of types.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most applications will need to
perform at least one and often several enumeration operations. Each DirectPlay
object supports a different set of enumerations. Thus the details will vary
from application to application. The following is a list of available
enumerations, along with the objects that support each type of enumeration.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Session hosts (<b>DirectPlay8Peer</b>,
<b>DirectPlay8Client</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Service providers (<b>DirectPlay8Peer</b>,
<b>DirectPlay8Client, DirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Players (<b>DirectPlay8Peer</b>,
<b>DirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Groups (<b>DirectPlay8Peer</b>, <b>DirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Group members (<b>DirectPlay8Peer</b>,
<b>DirectPlay8Server</b>)</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Local programs (<b>DirectPlay8LobbyClient</b>)</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see
Implementing a DirectPlay Enumeration.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Implementing a DirectPlay Enumeration</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
enumerations follow a standard pattern: call the appropriate enumeration
method, and examine the returned data array. The exception to this pattern is
host enumerations, which are discussed separately.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before you can call the method
to obtain the data, you must allocate enough memory to contain the returned
data block. However, you typically do not know, in advance, how large that
array will be. Allocating a large enough block of memory to hold any conceivable
array will work, but is inefficient. Instead DirectPlay is allows you query for
the required array size, and then repeat the query to obtain the structure
itself. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following procedure outlines
how to enumerate the members of a group in a peer-to-peer game. The same
general procedure is followed by all other types of enumeration, except for
host enumerations. Because enumerations are often used to obtain a snapshot of
information that might be changing, you should perform enumerations in a loop
until you are successful.</p>

<p class=Ln1> 1. Call <b>IDirectPlay8Peer::EnumGroupMembers</b>. This method
returns an integer array in the <i>prgdpnid</i> parameter that contains the ID
of each player in the group. The <i>pcdpnid</i> parameter is used to indicate
the number of elements in the array. Set the <i>pcdpnid</i> parameter to 0 to
request the appropriate value. Set <i>prgdpnid</i> to NULL.</p>

<p class=Ln1> 2. When the method returns, <i>pcdpnid</i> will point to the
number of elements that will be in the array.</p>

<p class=Ln1> 3. Allocate your array using the returned <i>pcdpnid</i>
value, and assign the array to the <i>prgdpnid</i> parameter.</p>

<p class=Ln1> 4. Set <i>pcdpnid</i> to the value that was returned in the
first method call.</p>

<p class=Ln1> 5. Call IDirectPlay8Peer::EnumGroupMembers again.</p>

<p class=Ln1> 6. When the method returns the second time, check the return
value. If successful, the method will return S_OK, and the array will contain
the player's IDs.</p>

<p class=Ln1> 7. If the method returns DPNERR_BUFFERTOOSMALL again, the
number of players has increased since the previous method call. Return to step
three and use the new <i>pcdpnid</i> value to increase the array size. Be
careful not to leak memory.</p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In some cases, the method
returns an array of structures. In that case, you follow the same procedure,
but the value returned from the first method call gives you the size of the
array in bytes, instead of the number of elements in the array. Refer to the
individual method references for details.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see
Enumerating Hosts.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most DirectPlay enumerations
follow a standard pattern: determine how many items are to be enumerated and
call the appropriate enumeration method. The exception to this pattern is host
enumerations, which are discussed separately.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following procedure outlines
how to enumerate the members of a group in a peer-to-peer game. The same
general procedure is followed by all other types of enumeration, except for
host enumerations.</p>

<p class=Ln1> 1. Call<b> DirectPlay8Peer.GetCountGroupMembers</b>. This
method returns the number of members in the group.</p>

<p class=Ln1 style='margin-left:24.0pt'><span style='font-family:"Arial",sans-serif'>2.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>Call <b>DirectPlay8Peer.GetGroupMember</b>
once for each member in the group. The method returns the ID of the specified
player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see
Enumerating Hosts.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>Enumerating Hosts</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>One way to arrange a session is
to have session hosts advertise themselves as available. This type of session
is referred to as a <i>broadcast session.</i> Peers or clients can look for a
game to join by enumerating the available hosts, selecting one, and then join
the game by sending a connection request. See <span style='position:relative;
top:-.5pt'>Peer-to-Peer Sessions</span>or Client/Server Sessions for a
detailed discussion.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unlike other enumerations, the
information needed to respond to a request for available hosts is not stored on
the local computer. Instead, a client or peer must broadcast a request, for
instance on their local subnet, and wait for available hosts to respond. Hosts,
on the other hand, must wait for these requests, and then respond
appropriately. There are thus two slightly different procedures, depending on
whether you are a potential session member, or a session host.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following procedure
illustrates how enumerate the available hosts for a peer-to-peer session. The
procedure for a client/server session is essentially the same. <b>IDirectPlay8Peer::EnumHosts</b>
is the method that starts the enumeration. The key parameters to set are <i>pApplicationDesc</i>,
<i>pdpaddrDeviceinfo, </i>and <i>pdpaddrHost.</i></p>

<p class=Ln1> 1. Assign the GUID of the game you are interested in playing
to the <b>guidApplication</b> member of the <b>DPN_APPLICATION_DESC</b>
structure and assign the structure pointer to the <i>pApplicationDesc</i>
parameter.</p>

<p class=Ln1> 2. Create an address object for your device and assign its
pointer to <i>pdpaddrDeviceinfo.</i> This object contains the information
needed to make a network connection.</p>

<p class=Ln1> 3. To query a specific computer for available hosts, create a
host address object for that computer and assign its pointer to <i>pdpaddrHost</i>.
If you set this parameter to NULL, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> will create an address object
from the information contained in <i>pdpaddrDeviceinfo. </i>See DirectPlay
Addressing for further discussion of address objects. If you are using an IP or
IPX service provider, the query will then normally be broadcast to your local
subnet. If you set the DPNENUMHOSTS_OKTOQUERYFORADDRESSING flag, the service
provider may display a dialog box to the user to request address information.</p>

<p class=Ln1> 4. Call <b>IDirectPlay8Peer::EnumHosts</b>.</p>

<p class=Ln1> 5. Your callback message handler will then receive a series of
<b>DPN_MSGID_ENUM_HOSTS_RESPONSE </b>messages, one for each host that responds.</p>

<p class=Ln1 style='margin-left:23.4pt'><span style='font-family:"Arial",sans-serif'>6.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>Examine
the information returned to your message handler, select a session, and ask to
join it by calling <b>IDirectPlay8Peer::Connect</b>.</p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to be the host of a
broadcast session, advertise yourself as available, and wait for queries or
connection requests. The following procedure applies to peer-to-peer hosts, but
is essentially similar to the procedure for client/server hosts.</p>

<p class=Ln1> 1. Call <b>IDirectPlay8Peer::SetPeerInfo</b> to specify the
static settings for your player.</p>

<p class=Ln1> 2. Specify the configuration of the game by assigning values
the <b>DPN_APPLICATION_DESC</b> structure.</p>

<p class=Ln1> 3. Call <b>IDirectPlay8Peer::Host</b> to advertise yourself as
a potential host. Set the <i>pdnAppDesc</i> parameter to the <b>DPN_APPLICATION_DESC</b>
structure defined in the previous step.</p>

<p class=Ln1> 4. Wait for enumeration requests. They will take the form of a
<b>DPN_MSGID_ENUM_HOSTS_QUERY</b> message sent to your callback message
handler. If you wish to respond to the enumeration request, fill in the
DPN_APPLICATION_DESC and return S_OK. The peer will receive a <b>DPN_MSGID_ENUM_HOSTS_RESPONSE
</b>message with the information.</p>

<p class=Ln1> 5. If the peer decides that they would like to join your
session, you will receive a <b>DPN_MSGID_INDICATE_CONNECT</b> message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See the Peer-to-Peer Sessions
and Client/Server Sessions sections for further discussion of how to arrange
and launch a game.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following procedure
illustrates how enumerate the available hosts for a peer-to-peer session. The
procedure for a client/server session is essentially the same. <b>DirectPlay8Peer.EnumHosts</b>
is the method that starts the enumeration. The key parameters to set are <i>ApplicationDesc</i>,
<i>Deviceinfo, </i>and Addr<i>Host.</i></p>

<p class=Ln1> 1. Assign the GUID of the game you are interested in playing
to the <b>guidApplication</b> member of the <b>DPN_APPLICATION_DESC</b> type
and assign assign it to the <i>ApplicationDesc</i> parameter.</p>

<p class=Ln1> 2. Create a <b>DirectPlay8Address</b> object for your device
and assign it to <i>Deviceinfo.</i> This object contains the information needed
to make a network connection.</p>

<p class=Ln1> 3. To query a specific computer for available hosts, create a <b>DirectPlay8Address
</b>object for the host computer and assign it to <i>pdpaddrHost</i>. If you
set leave the object empty, DirectPlay will create an address from the
information contained in <i>pdpaddrDeviceinfo. </i>See DirectPlay Addressing
for further discussion of address objects. If you are using an IP or IPX
service provider, the query will then normally be broadcast to your local
subnet.</p>

<p class=Ln1> 4. Call <b>DirectPlay8Peer.EnumHosts</b>.</p>

<p class=Ln1> 5. DirectPlay will then make a series of calls to your message
handler's <b>DirectPlay8Event.EnumHostsResponse</b> method, once for each host
that responds.</p>

<p class=Ln1 style='margin-left:23.4pt'><span style='font-family:"Arial",sans-serif'>6.
<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span>Examine
the information returned to your message handler, select a session, and ask to
join it by calling <b>DirectPlay8Peer.Connect</b>.</p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to be the host of a
broadcast session, advertise yourself as available, and wait for queries or
connection requests. The following procedure applies to peer-to-peer hosts, but
is essentially similar to the procedure for client/server hosts.</p>

<p class=Ln1> 1. Call <b>DirectPlay8Peer.SetPeerInfo</b> to specify the
static settings for your player.</p>

<p class=Ln1> 2. Specify the configuration of the game by assigning values
the <b>DPN_APPLICATION_DESC</b> type.</p>

<p class=Ln1> 3. Call <b>DirectPlay8Peer.Host</b> to advertise yourself as a
potential host. Set the <i>AppDesc</i> parameter to the <b>DPN_APPLICATION_DESC</b>
type defined in the previous step.</p>

<p class=Ln1> 4. Wait for enumeration requests. They will take the form of a
call to your message handlers <b>DirectPlay8Peer.EnumHostsQuery</b> method. If
you wish to respond to the enumeration request, fill in the <b>DPN_APPLICATION_DESC</b>
type and set <i>fRejectMsg</i> to False. </p>

<p class=Ln1> 5. If the peer decides that they would like to join your
session, DirectPlay will call your message handler's <b>DirectPlay8Event.IndicateConnect</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See the Peer-to-Peer Sessions
and Client/Server Sessions sections for further discussion of how to arrange
and launch a game.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Using Player Context Values</h2>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most applications will want to
associate some data with each player. However, when you receive a message that
is associated to a player, you need some way to access that data quickly.
Player context values are designed to provide you with an efficient way to
access your player data. </p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Only the <b>IDirectPlay8Peer</b> and <b>IDirectPlay8Server</b>
interfaces use player context values. They are not needed for the <b>IDirectPlay8Client</b>
interface because clients use this interface to communicate only with the
server, not other clients.</p>

<p class=Ne>&nbsp;</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Defining a Player Context Value</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd> Managing
Player Context Data</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Defining a Player Context Value</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To user player context values,
you need to have a block of data on your system for each player, typically in
the form of a structure. A player context value is normally an index into an
array of pointers to the various players' data blocks. When you receive a
message from a player, there is no need for time-consuming operations such as
searching for the player's ID in a table. The index contained in the player
context value allows you to quickly obtain the necessary pointer. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You define a player context
value when you handle the <b>DPN_MSGID_CREATE_PLAYER</b> message that notifies
you that a player has been added to the game. Host's can also define a player
context value when they handle the <b>DPN_MSGID_INDICATE_CONNECT</b> message.
That player context value will be set in the subsequent <b>DPN_MSGID_CREATE_PLAYER</b>
message. When the host processes that message, it has the option of changing
the player context value. To create a player context value:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Allocate a structure to hold the
player's data.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Add the structure pointer to
your player data array.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Assign the index of that pointer
to the <b>pvPlayerContext</b> member of the message's <b>DPNMSG_CREATE_PLAYER</b>
structure.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
specify how you should obtain the data to populate the structure. Each game is
responsible for handling that issue in its own way.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The only place you can define a player context value is in a <b>DPN_MSGID_CREATE_PLAYER</b>
or <b>DPN_MSGID_INDICATE_CONNECT </b>message handler. Once the <b>DPN_MSGID_CREATE_PLAYER</b>
message handler returns, the player context value is set. For each subsequent
message associated with that player, the player context value will be the same
value that was set by the <b>DPN_MSGID_CREATE_PLAYER</b> message handler. You
can modify the contents of the associated data structure, but you cannot change
the player context value itself.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Managing Player Context Data</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>While player context values are
fairly straightforward to handle, there are a couple of issues that you need to
be careful with.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The player context value
provides you with a quick way to obtain a valid memory address that will
presumably be accessed each time a message arrives. However, you must be
careful that different parts of your application do not access the data at the
same time. Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> serializes messages associated with a
particular player, which guarantees that you will never be handling two
messages from the same player at the same time. As long as you only access the
data structure from your callback message handler, you can safely access the
structure. However, most applications will need to access player data outside
the message handler.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your application accesses the
data outside the callback message handler, you must prevent concurrent access
by providing some sort of global mechanism to lock the structure. Even if your
application does not require such locking in the early stages of development,
you should assume that locking will eventually be required, and build it in
from the beginning. If your player context values that are indexes into an
array, you should also make sure that you read and update that array safely.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Don't deallocate a player's data
structure prematurely. When a player leaves the game, you will normally want to
deallocate their data structure and free the associated memory. However, be
careful about deallocating the structure as soon as you receive a <b>DPN_MSGID_DESTROY_PLAYER</b>
message. If your application accesses that structure outside the callback
message handler, that data may still be in use when the message arrives. If you
simply deallocate the structure as soon as the message arrives, you may cause other
parts of your application to fail.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To avoid prematurely
deallocating the structure, you should not only provide an application-level
locking mechanism, you should also implement some sort of reference counting.
Increment this reference count when you create the structure, and every time you
use it. Decrement the reference count every time you have finished with the
structure, including in your <b>DPN_MSGID_DESTROY_PLAYER </b>message handler.
As long as the reference count is non-zero, some part of your application is
accessing the structure. Do not deallocate the structure until the reference
count drops to zero.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Implementing a Lobby Client</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobby client is an application
that resides on a user's computer. It typically serves as a link between a game
application on the user's computer and a lobby server on a remote computer.
However, lobby clients can also function as stand-alone applications. For
instance, they can be used to arrange a game session among the users of a
particular LAN subnet.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients typically consist
of three primary components that handle the following tasks:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with the outside
world, either a lobby server or other lobby clients.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with the user,
typically through a graphical user interface (GUI).</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with Microsoft</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> DirectPlay</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'>.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay does not specify how
the first two items should be implemented. Lobby client vendors should use
whatever approach is suitable to their product. What DirectPlay provides is a
standard API that a lobby client can use to communicate with DirectPlay, and
through DirectPlay with the user's lobbyable game applications.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses the
following essential details of lobby client implementation. </p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Initializing a Lobby Client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Launching a Lobbied Application</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a Lobby Client
Message Handler</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with a Lobbied
Application</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Closing Down a Lobby Client</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See the LobbyClient sample
application for a fully implemented example of a simple lobby client.</p>

<h3 style='page-break-after:avoid'>Initializing a Lobby Client</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients are either
launched by a lobby server or directly by a user. Once a lobby client is
launched, it must be initialized before it can launch an application.
Initialization involves the following tasks.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>CoCreateInstance</b> to
create a lobby client object (CLSID_DirectPlay8LobbyClient). Use the <i>riid</i>
parameter to request a <b>IDirectPlay8LobbyClient</b> interface (<b>IID_IDirectPlay8LobbyClient)</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call the lobby client's <b>IDirectPlay8LobbyClient::Initialize</b>
method. Pass the method a pointer to your lobby client's callback message
handler. </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use the <b>IDirectPlay8LobbyClient::EnumLocalPrograms</b>
method to enumerate the lobbyable applications on the user's system.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first two steps create the
lobby client object, and set up a communication link between that object and
your lobby client. The final step determines what lobbyable applications are
available on the user's system. You need this information in order to launch
the selected application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following code sample
illustrates how to enumerate local applications. It is a simplified version of
the <b>EnumRegisteredApplications</b> function in the SDK's LobbyClient sample.
Error handling and dialog-box-related code has been deleted for clarity. See
the LobbyClient sample in the SDK for the complete code.</p>

<p class=Ex>HRESULT EnumRegisteredApplications()</p>

<p class=Ex>{</p>

<p class=Ex> HRESULT hr;</p>

<p class=Ex> DWORD dwSize = 0;</p>

<p class=Ex> DWORD dwPrograms = 0;</p>

<p class=Ex> DWORD iProgram;</p>

<p class=Ex> BYTE* pData = NULL;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>//g_pLobbyClient is a pointer to an IDirectPlay8LobbyClient
interface</p>

<p class=Ex>//Start with a NULL data buffer. The required buffer size is</p>

<p class=Ex>//returned through dwSize.</p>

<p class=Ex> hr = g_pLobbyClient-&gt;EnumLocalPrograms( NULL, pData,
&amp;dwSize, &amp;dwPrograms, 0 );</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> if( dwSize == 0 )</p>

<p class=Ex> {</p>

<p class=Ex>//No registered applications.</p>

<p class=Ex> }</p>

<p class=Ex>//Set the data buffer to the appropriate size</p>

<p class=Ex> pData = new BYTE[dwSize];</p>

<p class=Ex> hr = g_pLobbyClient-&gt;EnumLocalPrograms( NULL, pData,
&amp;dwSize, &amp;dwPrograms, 0 )</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>//Cast the returned data to the appropriate structure type</p>

<p class=Ex> DPL_APPLICATION_INFO* pAppInfo = (DPL_APPLICATION_INFO*) pData;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>//Enumerate the names of the registered applications</p>

<p class=Ex> for( iProgram=0; iProgram&lt;dwPrograms; iProgram++ )</p>

<p class=Ex> {</p>

<p class=Ex> TCHAR strAppName[MAX_PATH];</p>

<p class=Ex> DXUtil_ConvertWideStringToGeneric( strAppName,
pAppInfo-&gt;pwszApplicationName );</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> }</p>

<p class=Ex> SAFE_DELETE_ARRAY( pData );</p>

<p class=Ex> return S_OK;</p>

<p class=Ex>}</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Lobby clients are either
launched by a lobby server or directly by a user. Once a lobby client is
launched, it must be initialized before it can launch an application.
Initialization involves the following tasks.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a <b>DirectPlay8LobbyClient</b>
object.</span></p>

<p class=Lb1><span style='font-family:"Times New Roman",serif'>Create a <b>DirectPlay8LobbyEvent</b>
object. The <b>DirectPlay8LobbyEvent</b> object is essentially a message
handler that receives messages directly from the lobby client object, and
indirectly from the application. It is not provided by Microsoft</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> DirectPlay</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> and must be implemented by your
application. </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You must register this object
with DirectPlay by calling <b>DirectPlay8LobbyClient.RegisterMessageHandler</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use the <b>DirectPlay8LobbyClient.GetLocalProgram</b>
method to enumerate the lobbyable applications on the user's system.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first two steps create the
lobby client object, and set up a communication link between that object and
your lobby client. The final step determines what lobbyable applications are
available on the user's system. You need this information in order to launch
the selected application. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should store the application
GUIDs of the registered applications because you need them to launch the
application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Depending on the design of your
lobby client, you may also want to do one or more of the following tasks.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Perform any initialization that
is not related to Microsoft</span><span style='font-size:7.0pt;font-family:
"Times New Roman",serif'></span><span style='font-family:"Times New Roman",serif'>
DirectPlay</span><span style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'>, such as establishing a link with
the lobby server.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a DirectPlay peer or
DirectPlay client object (CLSID_DirectPlay8Peer or CLSID_DirectPlay8Client,
respectively).</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a <b>DirectPlay8Peer</b>
or <b>DirectPlay8Client</b> object.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use the peer or client object's
enumeration methods to enumerate available service providers, adapters, and so
on.</span></p>

<h3 style='page-break-after:avoid'>Launching a Lobbied Application</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the user has selected an
application, and your lobby client has verified that it has been registered on
the user's system, you can launch the application. To do so, call <b>IDirectPlay8LobbyClient::ConnectApplication</b>.
The first parameter is a <b>DPL_CONNECT_INFO</b> structure that contains a
variety of information needed to launch the application including the
following:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The GUID that identifies the
application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The connection settings,
including the user's Microsoft</span><span style='font-size:7.0pt;font-family:
"Times New Roman",serif'></span><span style='font-family:"Times New Roman",serif'>
DirectPlay</span><span style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> address. See DirectPlay Addressing
for a discussion of DirectPlay addresses.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the application will be
a host.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8LobbyClient::ConnectApplication</b>
method returns an application handle that is used to identify the application
in all further communication. Once the application has launched and the
connection successfully established, your message handler receives a
DPL_MESSAGE_CONNECT message.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Your message handler may receive the DPL_MESSAGE_CONNECT before
the <b>IDirectPlay8LobbyClient::ConnectApplication</b> method has confirmed the
connection by returning a success code. Your message handler should be prepared
to handle the message even if the method has not yet returned.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the user has selected an
application, and your lobby client has verified that it has been registered on
the user's system, you can launch the application. To do so, call <b>DirectPlay8LobbyClient.ConnectApplication</b>.
The first parameter is a <b>DPL_CONNECT_INFO</b> structure that contains a
variety of information needed to launch the application including the
following:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The GUID that identifies the
application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The connection settings,
including the user's Microsoft</span><span style='font-size:7.0pt;font-family:
"Times New Roman",serif'></span><span style='font-family:"Times New Roman",serif'>
DirectPlay</span><span style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> address. See DirectPlay Addressing
for a discussion of DirectPlay addresses.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Whether the application will be
a host.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8LobbyClient.ConnectApplication</b>
method returns an application handle that is used to identify the application
in all further communication. Once the application has launched and the
connection successfully established, DirectPlay will call your message handlers
<b>DirectPlay8LobbyEvent.Connect</b> method. </p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Your message handler's <b>DirectPlay8LobbyEvent.Connect</b> method
may be called before the <b>DirectPlay8LobbyClient.ConnectApplication</b>
method has confirmed the connection by returning a success code. Your message
handler should be prepared to handle the message even if the method has not yet
returned.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Implementing a Lobby Client Message Handler</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The message handler is a
callback function that is used by the lobby client object to communicate with
the lobby client. The lobby client message handler has three parameters that
pass in the following information.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A message ID that indicates the
message type.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A pointer to a message data
block. You must cast this parameter to the structure that is used by the
particular message.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A pointer to an optional
application-defined user-context data block. </span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The user context value is
defined by the lobby client when it calls <b>IDirectPlay8LobbyClient::Initialize</b>.
It can be used for such purposes as differentiating between messages that are
sent from different objects. See <b>PFNDPNMESSAGEHANDLER</b> for a complete
description the message handler function.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Your message handler must be
able to handle the following five lobby client-specific messages.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECTION_SETTINGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_DISCONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_RECEIVE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_SESSION_STATUS</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most of these messages are
generated by the lobby client object in response to changes in the game status,
or when the lobby client requests information. The exception is <b>DPL_MESSAGE_RECEIVE</b>.
This message is used to pass data directly from the game application to the
lobby client.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> message handlers must be written to work
properly in a multithreaded environment, or your application may not function
well. </p>

<h4 style='page-break-after:avoid'>DPL_MSGID_CONNECT</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent by the
lobby client following the launch of a lobbyable application. The message
indicates that the application has been successfully connected. The associated <b>DPL_MESSAGE_CONNECT
</b>structure holds a variety of information, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A connection ID. Use this ID
when your lobby client needs to send data to the application with <b>IDirectPlay8LobbyClient::Send</b>,
or release the connection with <b>IDirectPlay8LobbyClient::ReleaseApplication</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby connection data.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> An optional connection context
value. </span></p>

<h4 style='page-break-after:avoid'>DPL_MSGID_CONNECTION_SETTINGS</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent by
DirectPlay whenever an associated lobbyable application calls its <b>IDirectPlay8LobbiedApplication::SetConnectionSettings</b>
method to modify the session connections. The associated <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
structure contains the updated connection information.</p>

<h4 style='page-break-after:avoid'>DPL_MSGID_DISCONNECT</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent when the
lobbyable application disconnects from the session by calling <b>IDirectPlay8LobbiedApplication::Close</b>.
Your lobby client application should delete the connection from its list and
free any data that is associated with the application.</p>

<h4 style='page-break-after:avoid'>DPL_MSGID_RECEIVE</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message enables an
application to pass data to the lobby client. DirectPlay passes the data block
from the application to the lobby client in a <b>DPL_MESSAGE_RECEIVE</b>
structure. It is up to the lobby client to process the data.</p>

<h4 style='page-break-after:avoid'>DPL_MSGID_SESSION_STATUS</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent by
DirectPlay whenever one of the following six changes in the session's status
occurs. </p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session is connected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session could not connect.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been
disconnected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been terminated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session host has migrated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> This computer has become the
session host.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The type of status change is
indicated by the value of the dwStatus field in the associated <b>DPL_MESSAGE_SESSION_STATUS</b>
structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see A
Sample Lobby Client Message Handler.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The message handler is a <b>DirectPlay8LobbyEvent</b>
object, that receives messages directly from the lobby client object, and
indirectly from the application. It is not provided by DirectPlay and must be
implemented by your application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Your message handler must
implement all of the following methods:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Connect</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.ConnectionSettings</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Disconnect</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Receive</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.SessionStatus</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most of these methods are called
by DirectPlay in response to changes in the game status, or when the lobby
client requests information. The exception is <b>DirectPlay8LobbyEvent.Receive</b>.
This method is called to pass data directly from the game application to the
lobby client.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Connect</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is called by
DirectPlay following the launch of a lobbyable application. The message
indicates that the application has been successfully connected. The associated <b>DPL_MESSAGE_CONNECT
</b>type holds a variety of information, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A connection ID. Use this ID
when your lobby client needs to send data to the application with <b>DirectPlay8LobbyClient.Send</b>,
or release the connection with <b>DirectPlay8LobbyClient.ReleaseApplication</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby connection data.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> An optional connection context
value. </span></p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.ConnectionSettings</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is called by
DirectPlay whenever an associated lobbyable application calls its <b>DirectPlay8LobbiedApplication.SetConnectionSettings</b>
method to modify the session connections. The associated <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
type contains the updated connection information.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Disconnect</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent when the
lobbyable application disconnects from the session by calling <b>DirectPlay8LobbiedApplication.Close</b>.
Your lobby client application should delete the connection from its list and
free any data that is associated with the application.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Receive</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message enables an
application to pass data to the lobby client by calling <b>DirectPlay8LobbiedApplication.Send</b>.
DirectPlay passes the data block from the application to the lobby client in a <b>DPL_MESSAGE_RECEIVE</b>
type. It is up to the lobby client to process the data.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.SessionStatus</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent by
DirectPlay whenever one of the following six changes in the session's status
occurs. </p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session is connected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session could not connect.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been
disconnected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been terminated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session host has migrated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> This computer has become the
session host.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The type of status change is
indicated by the value of the method's <i>status</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see A
Sample Lobby Client Message Handler.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>A Sample Lobby Client Message Handler</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following code is a
simplified version of the message handler from the SDK's LobbyClient sample.
Error handling code has been removed for clarity. See the sample for a complete
version.</p>

<p class=Ex>HRESULT WINAPI DirectPlayLobbyMessageHandler( PVOID pvUserContext, </p>

<p class=Ex> DWORD dwMessageId, </p>

<p class=Ex> PVOID pMsgBuffer )</p>

<p class=Ex>{</p>

<p class=Ex> switch( dwMessageId )</p>

<p class=Ex> {</p>

<p class=Ex> case DPL_MSGID_DISCONNECT:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_DISCONNECT pDisconnectMsg;</p>

<p class=Ex> pDisconnectMsg = (PDPL_MESSAGE_DISCONNECT)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // Free any data associated with the application and</p>

<p class=Ex> // Remove the connection from the list</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> case DPL_MSGID_RECEIVE:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_RECEIVE pReceiveMsg;</p>

<p class=Ex> pReceiveMsg = (PDPL_MESSAGE_RECEIVE)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // The lobby application sent data. Process the data and</p>

<p class=Ex> // Respond appropriately</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> case DPL_MSGID_SESSION_STATUS:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_SESSION_STATUS pStatusMsg;</p>

<p class=Ex> pStatusMsg = (PDPL_MESSAGE_SESSION_STATUS)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> switch( pStatusMsg-&gt;dwStatus )</p>

<p class=Ex> {</p>

<p class=Ex> case DPLSESSION_CONNECTED: //Session connected</p>

<p class=Ex> break;</p>

<p class=Ex> case DPLSESSION_COULDNOTCONNECT: //Session could not
connect</p>

<p class=Ex> break;</p>

<p class=Ex> case DPLSESSION_DISCONNECTED: //Session disconnected</p>

<p class=Ex> break;</p>

<p class=Ex> case DPLSESSION_TERMINATED: //Session terminated</p>

<p class=Ex> break;</p>

<p class=Ex> case DPLSESSION_HOSTMIGRATED: //Host migrated</p>

<p class=Ex> break;</p>

<p class=Ex> case DPLSESSION_HOSTMIGRATEDHERE: //Host migrated here</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> case DPL_MSGID_CONNECTION_SETTINGS:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_CONNECTION_SETTINGS pConnectionStatusMsg;</p>

<p class=Ex> pConnectionStatusMsg =
(PDPL_MESSAGE_CONNECTION_SETTINGS)pMsgBuffer;</p>

<p class=Ex> // The application has changed the connection settings. </p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> }</p>

<p class=Ex> return S_OK;</p>

<p class=Ex>}</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Communicating with a Lobbied Application</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Much of the lobby client's
interaction with an associated application is indirect. The lobby client does
something that affects the application, and Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> sends an
appropriate message, and vice versa. For instance, if the lobby client changes
the connection settings, DirectPlay notifies the application and provides the
new settings. However, the <b>IDirectPlay8LobbyClient::Send</b> method enables
the lobby client to send a message directly to the application. DirectPlay
passes the data to the application without modification. It is the
responsibility of the application to process that data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobbied application can also
send data directly to the lobby client. The data is passed to the lobby
client's message handler with a DPL_MSGID_RECEIVE message. DirectPlay passes
the data to the lobby client without modification. It is up to the lobby client
to process the data.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Much of the lobby client's
interaction with an associated application is indirect. The lobby client does
something that affects the application, and Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> sends an
appropriate message, and vice versa. For instance, if the lobby client changes
the connection settings, DirectPlay notifies the application and provides the
new settings. However, the <b>DirectPlay8LobbyClient.Send</b> method enables
the lobby client to send a message directly to the application. DirectPlay
passes the data to the application without modification. It is the
responsibility of the application to process that data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobbied application can also
send data directly to the lobby client. DirectPlay transmits the data by
calling the lobby client message handler's <b>DirectPlay8LobbyEvent.Receive</b>
method. DirectPlay passes the data to the lobby client without modification. It
is up to the lobby client to process the data.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Closing Down a Lobby Client</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you are ready to close the
session, disconnect the application by calling <b>IDirectPlay8LobbyClient::ReleaseApplication</b>.
The application receives a <b>DPL_MSGID_DISCONNECT</b> message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>After releasing the application,
perform any cleanup that is necessary, and close the session by calling <b>IDirectPlay8LobbyClient::Close</b>.
You should then free the lobby client object by calling <b>IDirectPlay8LobbyClient::Release</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you are ready to close the
session, disconnect the application by calling <b>DirectPlay8LobbyClient.ReleaseApplication</b>.
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> will call notification by calling its message
handler's <b>DirectPlay8LobbyEvent.Disconnect</b> method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>After releasing the application,
perform any cleanup that is necessary, and close the session by calling <b>DirectPlay8LobbyClient.Close</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Implementing a Lobbyable Application</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobbyable application must be
designed to work properly with a lobby client. While a lobby client can launch
any application, only <i>lobby-launched</i> applications can receive messages
from Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> and from the lobby client. To be lobby
launched, an application must be appropriately registered, and it must be able
to use a DirectPlay lobbied application object to communicate with DirectPlay
and the lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section discusses how to
implement lobbyable applications.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Registering a Lobbyable
Application</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Handling Lobby Launching</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Implementing a Lobbied
Application Callback Message Handler</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Communicating with a Lobby
Client</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Closing Down a Lobbied
Application</span></p>

<h3 style='page-break-after:avoid'>Registering a Lobbyable Application</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobbyable application must be
registered before it can be lobby launched. This registration needs to be done
only once and is typically handled by the application's setup procedure. Do not
attempt to modify the registry directly to register an application as
lobbyable. Instead, do the following:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>CoCreateInstance</b> to
create a lobbied application object (CLSID_DirectPlay8LobbiedApplication). Set
the <i>riid</i> parameter to IID_IDirectPlay8LobbiedApplication to request an <b>IDirectPlay8LobbiedApplication</b>
interface.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>IDirectPlay8LobbiedApplication::RegisterProgram</b>.This
method takes the information and creates appropriate registry keys and values.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must provide <b>IDirectPlay8LobbiedApplication::RegisterProgram</b>
with a variety of information, including the following:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>A lobbyable application must be
registered before it can be lobby launched. This registration needs to be done
only once and is typically handled by the application's setup procedure. Do not
attempt to modify the registry directly to register an application as
lobbyable. Instead, do the following:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a
DirectPlay8LobbiedApplication object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>DirectPlay8LobbiedApplication.RegisterProgram</b>.This
method takes the information and creates appropriate registry keys and values.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must provide <b>DirectPlay8LobbiedApplication.RegisterProgram</b>
with a variety of information, including the following:</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A GUID that is used to identify
the application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A friendly name for the
application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The location and name of the
application's executable file.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The location and name of an
optional <i>launcher</i> application.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Any command-line arguments that
need to be passed to the executable file when it is launched.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Instead of launching the game
application, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> launches a launcher application. The launcher
application then launches the game. Launcher applications can be used, for
example, as an anti-piracy measure.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To unregister a registered
program, call <b>IDirectPlay8LobbiedApplication::UnregisterProgram</b>. This
method removes the registry entries created by <b>IDirectPlay8LobbiedApplication::RegisterProgram</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To unregister a registered
program, call <b>DirectPlay8LobbiedApplication.UnregisterProgram</b>. This
method removes the registry entries created by <b>DirectPlay8LobbiedApplication.RegisterProgram</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Handling Lobby Launching</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first thing your lobbyable
application should do when it is launched is to create and initialize a
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> lobbied application object. To do this,
perform the following tasks.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>CoCreateInstance</b> to
create a lobbied application object (CLSID_DirectPlay8LobbiedApplication). Set
the <i>riid</i> parameter to IID_IDirectPlay8LobbiedApplication to request an <b>IDirectPlay8LobbiedApplication</b>
interface.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Call <b>IDirectPlay8LobbiedApplication::Initialize</b>
to initialize the lobbied application object. Pass the object a pointer to your
lobbied application callback message handler.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Next, determine whether your
application was lobby launched. If so, your application needs to set up a
communication channel with DirectPlay so that you can effectively manage the
session. Do the following to detect whether your application was lobby launched.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> When the <b>IDirectPlay8LobbiedApplication::Initialize</b>
method returns, examine the <i>pdpnhConnection</i> parameter. If this parameter
is set to a valid connection handle, the game was lobby launched.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Examine the DPL_MSGID_CONNECT
message you receive through your message handler. This message carries with it
a variety of information, including the ID that you use to send messages to the
lobby client.</span></p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Your message handler may receive the DPL_MSGID_CONNECT message
before the <b>IDirectPlay8LobbiedApplication::Initialize</b> method returns.
Your message handler should be prepared to handle the message appropriately.</p>

<p class=Ne>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your application was not
lobby launched, you can indicate that your application is available to lobby
clients for connection by calling <b>IDirectPlay8LobbiedApplication::SetAppAvailable</b>.
This method is typically called when the application has been launched by the
user. However, it can also be used if the user has closed one session but the
application is still running and available for another session. In either case,
your message handler receives a DPL_MSGID_CONNECT message when the lobby client
connects your application to a session.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The first thing your lobbyable
application should do when it is launched is to create and initialize a
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> lobbied application object. To do this,
perform the following tasks.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a <b>DirectPlay8LobbiedApplication</b>
object.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Create a <b>DirectPlay8LobbyEvent</b>
message handler object</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Register the message handler
object by calling <b>DirectPlay8LobbiedApplication.RegisterMessageHandler</b>.</span></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the application was
lobby-launched, DirectPlay will call your <b>DirectPlay8LobbyEvent.Connect</b>
method. The <i>dlNotify</i> parameter will contain a <b>DPL_MESSAGE_CONNECT</b>
type with connection information. such as address objects for the members of
the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If your application was not
lobby launched, you can indicate that your application is available to lobby
clients for connection by calling <b>DirectPlay8LobbiedApplication.SetAppAvailable</b>.
This method is typically called when the application has been launched by the
user. However, it can also be used if the user has closed one session but the
application is still running and available for another session. In either case,
DirectPlay will call your message handler's <b>DirectPlay8LobbyEvent.Connect</b>
method when the lobby client connects your application to a session.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following sample code
illustrates how to initialize a lobbied application, and how to detect whether
an application was lobby launched. It is a simplified version of the <b>InitDirectPlay</b>
function used by the SDK's SimplePeer application. Refer to that sample
application for the complete code. In particular, error-handling code has been
deleted for clarity. The <i>g_bWasLobbyLaunched</i> variable is a global
variable that is set to TRUE if the application was lobby launched.</p>

<p class=Ex>HRESULT InitDirectPlay()</p>

<p class=Ex>{</p>

<p class=Ex> DPNHANDLE hLobbyLaunchedConnection = NULL;</p>

<p class=Ex> HRESULT hr;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // Create IDirectPlay8LobbiedApplication</p>

<p class=Ex> hr = CoCreateInstance( CLSID_DirectPlay8LobbiedApplication, NULL,
</p>

<p class=Ex> CLSCTX_INPROC_SERVER,</p>

<p class=Ex> IID_IDirectPlay8LobbiedApplication, </p>

<p class=Ex> (LPVOID*) &amp;g_pLobbiedApp );</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // Initialize IDirectPlay8LobbiedApplication</p>

<p class=Ex> hr = g_pLobbiedApp-&gt;Initialize( NULL,</p>

<p class=Ex> DirectPlayLobbyMessageHandler, </p>

<p class=Ex> &amp;hLobbyLaunchedConnection,</p>

<p class=Ex> 0 );</p>

<p class=Ex> //Check for a valid connection handle. If it is non-NULL</p>

<p class=Ex> //the application was lobby launched.</p>

<p class=Ex> g_bWasLobbyLaunched = ( hLobbyLaunchedConnection != NULL );</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> return S_OK;</p>

<p class=Ex>}</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Implementing a Lobbied Application Callback
Message Handler</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The message handler is a
callback function that is used by the lobbied application object to communicate
with a lobbied application. The lobbied application message handler has three
parameters that pass in the following information.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A message ID that indicates the
message type.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A pointer to a message data
block. You must cast this parameter to the structure that is used by the
particular message.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A pointer to an optional
application-defined user-context data block. </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The user context value is
defined by the lobby client when it calls <b>IDirectPlay8LobbyClient::Initialize</b>.
It can be used for such purposes as differentiating between messages that are
sent from different objects. See <b>PFNDPNMESSAGEHANDLER</b> for a complete
description the message handler function.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Your message handler must to be
able to handle the following four lobbied application-specific messages.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECTION_SETTINGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_DISCONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_RECEIVE</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most of these messages are
generated by the lobbied application object in response to changes in the
connection, or when the lobbied application requests connection information.
The exception is <b>DPL_MESSAGE_RECEIVE</b>. This message is used to pass data
directly from the lobby client to the game application.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> message handlers must be written to work
properly in a multithreaded environment, or your application may not function
well. </p>

<h4 style='page-break-after:avoid'>DPL_MSGID_CONNECT</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent by the
lobbied application object when the lobby client calls <b>IDirectPlay8LobbyClient::ConnectApplication</b>
to connect an application to a session. The associated <b>DPL_MESSAGE_CONNECT </b>structure
includes the following information.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A connection ID. Use this ID
when your application needs to send data to the lobby client with <b>IDirectPlay8LobbiedApplication::Send</b>,
or update the session status with <b>IDirectPlay8LobbiedApplication::UpdateStatus</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby connection data.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> An optional connection context
value.</span></p>

<h4 style='page-break-after:avoid'>DPL_MSGID_CONNECTION_SETTINGS</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay sends this message
whenever an associated lobby client calls its <b>IDirectPlay8LobbyClient::SetConnectionSettings</b>
method to modify the session connections. The associated <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
structure contains the updated connection information.</p>

<h4 style='page-break-after:avoid'>DPL_MSGID_DISCONNECT</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent when the
lobby client disconnects the application from the session by calling <b>IDirectPlay8LobbyClient::ReleaseApplication</b>.
Your application should delete the connection from its list, and free any data
that is associated with the session.</p>

<h4 style='page-break-after:avoid'>DPL_MSGID_RECEIVE</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message enables a lobby
client to pass data to an application. DirectPlay passes the data block from
the lobby client to the application in a <b>DPL_MESSAGE_RECEIVE</b> structure.
It is up to the application to process the data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see A
Sample Lobbied Application Message Handler.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The message handler is a <b>DirectPlay8LobbyEvent</b>
object, that receives messages directly from the lobby client object, and
indirectly from the application. It is not provided by Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
and must be implemented by your application. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Your message handler must
implement all of the following methods:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Connect</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.ConnectionSettings</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Disconnect</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.Receive</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent.SessionStatus</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Most of these methods are called
by DirectPlay in response to changes in the game status, or when the lobbied
application requests information. The exception is <b>DirectPlay8LobbyEvent.Receive</b>.
This method is called to pass data directly from the lobby client to the game
application.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Connect</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is called when the
lobby client calls <b>DirectPlay8LobbyClient.ConnectApplication</b> to connect
an application to a session. The associated <b>DPL_MESSAGE_CONNECT </b>type
holds a variety of information, including:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> A connection ID. Use this ID
when your lobby client needs to send data to the application with <b>DirectPlay8LobbyClient.Send</b>,
or release the connection with <b>DirectPlay8LobbyClient.ReleaseApplication</b>.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Lobby connection data.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> An optional connection context
value. </span></p>

<p class=Lb1><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.ConnectionSettings</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay calls this method
whenever an associated lobby client calls its <b>DirectPlay8LobbyClient.SetConnectionSettings</b>
method to modify the session connections. The associated <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
type contains the updated connection information.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Disconnect</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message is sent when the
lobby client disconnects the application from the session by calling <b>DirectPlay8LobbyClient.ReleaseApplication</b>.
Your application should delete the connection from its list, and free any data
that is associated with the session.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Receive</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message enables a lobby
client to pass data to an application. When the lobby client calls <b>DirectPlay8LobbyClient.Send</b>,
DirectPlay passes the data to the application by calling <b>DirectPlay8LobbyEvent.Receive</b>.
It is up to the application to process the data.</p>

<h4 style='page-break-after:avoid'>DirectPlay8LobbyEvent.SessionStatus</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay does not call this
method for lobbyable application message handlers. You must implement this
method, but it can simply return 0. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h4 style='page-break-after:avoid'>A Sample Lobbied Application Message Handler</h4>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following code is a
simplified version of the message handler from the SDK's SimplePeer sample.
Error handling code has been removed for clarity. See the sample for a complete
version.</p>

<p class=Ex>HRESULT WINAPI DirectPlayLobbyMessageHandler( PVOID pvUserContext, </p>

<p class=Ex> DWORD dwMessageId, </p>

<p class=Ex> PVOID pMsgBuffer )</p>

<p class=Ex>{</p>

<p class=Ex> switch( dwMessageId )</p>

<p class=Ex> {</p>

<p class=Ex> case DPL_MSGID_CONNECT:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_CONNECT pConnectMsg;</p>

<p class=Ex> pConnectMsg = (PDPL_MESSAGE_CONNECT)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // Connected. Start the session.</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> case DPL_MSGID_DISCONNECT:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_DISCONNECT pDisconnectMsg;</p>

<p class=Ex> pDisconnectMsg = (PDPL_MESSAGE_DISCONNECT)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // Disconnected. Free any data associated with</p>

<p class=Ex> // the lobby client.</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> case DPL_MSGID_RECEIVE:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_RECEIVE pReceiveMsg;</p>

<p class=Ex> pReceiveMsg = (PDPL_MESSAGE_RECEIVE)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // The lobby client sent data. Process the data and</p>

<p class=Ex> // respond appropriately.</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> case DPL_MSGID_CONNECTION_SETTINGS:</p>

<p class=Ex> {</p>

<p class=Ex> PDPL_MESSAGE_CONNECTION_SETTINGS pConnectionStatusMsg;</p>

<p class=Ex> pConnectionStatusMsg =
(PDPL_MESSAGE_CONNECTION_SETTINGS)pMsgBuffer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex> // The lobby client has changed the connection settings. </p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> }</p>

<p class=Ex> return S_OK;</p>

<p class=Ex>}</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Communicating with a Lobby Client</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Much of the lobbied
application's interaction with an associated lobby client is indirect. The
application does something that affects the lobby client, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
sends an appropriate message, and vice versa. For instance, if the application
changes the connection settings, DirectPlay notifies the lobby client, and
provides the new settings. However, there are two methods that provide
information directly to the lobby client: <b>IDirectPlay8LobbiedApplication::UpdateStatus</b>
and <b>IDirectPlay8LobbiedApplication::Send</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Much of the lobbied
application's interaction with an associated lobby client is indirect. The
application does something that affects the lobby client, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
sends an appropriate message, and vice versa. For instance, if the application
changes the connection settings, DirectPlay notifies the lobby client, and
provides the new settings. However, there are two methods that provide
information directly to the lobby client: <b>DirectPlay8LobbiedApplication.UpdateStatus</b>
and <b>DirectPlay8LobbiedApplication.Send</b>.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must notify the lobby client
when any of the following changes in the game status take place.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session is connected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session could not connect.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been
disconnected.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session has been terminated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The session host has migrated.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> This computer has become the
session host.</span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To notify the lobby client of
one of these status changes, call <b>IDirectPlayLobbiedApplication::UpdateStatus</b>,
and set the <i>dwStatus</i> parameter to the appropriate value. The lobby
client receives a DPL_MSGID_SESSION_STATUS message to notify it of the status
change.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8LobbiedApplication::Send</b>
method enables the application to send a message directly to the lobby client.
DirectPlay passes the data to the lobby client without modification. It is the
responsibility of the lobby client to process that data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client can also send
data directly to the application. The data is passed to the lobby client's
message handler with a DPL_MSGID_RECEIVE message. DirectPlay passes the data to
the application without modification. The lobby client must process the data.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To notify the lobby client of
one of these status changes, call <b>DirectPlay8LobbiedApplication.UpdateStatus</b>,
and set the <i>lStatus</i> parameter to the appropriate value. DirectPlay will
call the lobby client message handler's <b>DirectPlay8LobbyEvent.SessionStatus</b>
method to notify it of the status change.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8LobbiedApplication.Send</b>
method enables the application to send a message directly to the lobby client.
DirectPlay passes the data to the lobby client without modification. It is the
responsibility of the lobby client to process that data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The lobby client can also send
data directly to the application. DirectPlay passes the data to the lobby
client's message handler by calling its <b>DirectPlay8LobbyEvent.Receive</b>
method. DirectPlay passes the data to the application without modification. The
lobby client must process the data.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h3 style='page-break-after:avoid'>Closing Down a Lobbied Application</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To close a session, call <b>IDirectPlay8LobbiedApplication::Close</b>.
The lobby client receives a DPL_MSGID_DISCONNECT message to notify it of the
disconnection. If you want to keep the application running and connect to
another session, indicate that your application is available by calling <b>IDirectPlay8LobbiedApplication::SetAppAvailable</b>.
Otherwise, call <b>IDirectPlay8LobbiedApplication::Release</b> to free the
lobbied application object, and shut the application down.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To close a session, call <b>DirectPlay8LobbiedApplication.Close</b>.
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> calls the lobby client message handler's <b>DirectPlay8LobbyEvent.Disconnect</b>
method to notify it of the disconnection. If you want to keep the application
running and connect to another session, indicate that your application is
available by calling <b>DirectPlay8LobbiedApplication.SetAppAvailable</b>. </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Monitoring DirectPlay Network Traffic with
Netmon</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>During game development, you may
find it useful to monitor Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> network traffic, especially
when trying understand bugs. The network monitor (netmon) is a standard utility
for analyzing network traffic. DirectPlay includes a set of parsers, that allow
you to use netmon to analyze four components of DirectPlay messaging: the
service provider layer, the transport layer, the session layer, and the voice
layer.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> How Netmon Works With DirectPlay</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Configuring Netmon for
DirectPlay</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Capturing DirectPlay Network
Traffic</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Tips for Using Netmon with
DirectPlay</span></p>

<h3 style='page-break-after:avoid'>How Netmon Works With DirectPlay</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
protocol stack has three basic layers.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The voice and session layers
share the top level of the stack. Normal messaging passes through the session
layer, and voice-related messaging passes through the voice layer.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The transport layer is the
middle of the stack. Both voice and session traffic passes through this layer,
which is responsible for such tasks as fragmentation and reassembly of messages
and retransmission of lost packets.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The service provider layer is at
the bottom of the stack. All messaging is handled by this layer, which is
responsible for communicating with the network. For example, for TCP/IP
networking, the service provider uses the Winsock API to communicate with the
network stack. Netmon can only parse network traffic that is carried on an IP
or IPX service provider.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>By installing the DirectPlay
parsers, you can use Netmon to analyze the network traffic as it passes through
any of these four layers. You can see all DirectPlay traffic by selecting the
service provider parser. However, by selecting one of the higher level parsers,
you can filter out traffic that may not be of interest.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>With the transport layer parser,
you see all voice and session traffic, but not low-level traffic such as
connection handshaking. Be aware that the transport layer breaks messages that
are longer than the network's Maximum Transfer Unit (MTU) into one or more
fragments.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The session and voice layer
parsers allow you to analyze session and voice-related traffic separately. Both
of these parsers are aware of fragmentation, and notify the user, but cannot
parse fragmented packets.</p>

<h3 style='page-break-after:avoid'>Configuring Netmon for DirectPlay</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you have a Windows 2000
Server system, Netmon is already installed. For Windows 2000 Professional, you
must purchase a copy of Systems Management Server (SMS). See the Netmon
documentation for a general discussion of how to use Netmon. To configure Netmon
to handle Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> traffic:</p>

<p class=Ln1> 1. Copy Dp8parser.dll to the appropriate folder. The Netmon
root folder is normally installed in the \Winnt\System32 folder. If you have
installed SMS, the root folder will be called NetMonFull. For Windows 2000
Server, the root folder will be called NetMon. Depending on which version of
Netmon you are using, copy the parser DLL to either the ...\NetMonFull\Parsers,
or ...\NetMon\parsers folder.</p>

<p class=Ln1> 2. Start Netmon</p>

<p class=Ln1> 3. Set the adapter to capture from (Capture|Networks...|Local
Computer). Be sure to choose the adapter with the &quot;Dial-up
Connection&quot; property set to FALSE.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You are now ready to start
capturing traffic.</p>

<h3 style='page-break-after:avoid'>Capturing DirectPlay Network Traffic</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>To start the capture process,
click the Start Capture button on the Netmon toolbar to open the capture view.
Initially, you will see all the traffic that is passing through your adapter.
You can filter that raw traffic stream to focus on only those packets that are
of interest. By installing the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> parsers, you essentially add
four DirectPlay-oriented filters to Netmon that allow you to filter everything
but DirectPlay traffic from your capture view.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To select a filter:</p>

<p class=Ln1> 1. Click the Edit Display Filter button on the Netmon toolbar.</p>

<p class=Ln1> 2. Double-click &quot;Protocol == Any&quot;.</p>

<p class=Ln1> 3. Click &quot;Disable All&quot;.</p>

<p class=Ln1> 4. Under &quot;Disabled Protocols&quot;, double-click
DPLAYSESSION, DPLAYSP, DPLAYTRANSPORT, and DPLAYVOICE.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Click OK twice to return to the
capture view, and you are ready to start viewing DirectPlay traffic.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also apply a filter to
the capture process itself, rather than to the capture view. This allows you,
for instance, to capture only IP packets with specified source and destination
ports. See the Netmon documentation for details.</p>

<h3 style='page-break-after:avoid'>Tips for Using Netmon with DirectPlay</h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Here are a few tips to using
Netmon with Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span>:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> By default, Netmon only captures
1MB of the most recent traffic. You will probably want to increase this value
to at least 10-20 MB.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Netmon doesn't stream to the
hard drive, so all you can see is what is in the capture buffer. To stream
captured traffic to a hard drive, you will need to implement your own capturer.
See MSDN for details.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> By default, DirectPlay parsing
uses the [2302,2400]U{6073} port/socket range to filter IP and IPX packets. If
you are using non-standard port/socket ranges, you can have the parsers
recognize user-defined port/socket values. To do so, add two DWORD values,
MinUserPort and MaxUserPort, to the
\HKEY_CURRENT_USER\Software\Microsoft\DirectX\DirectPlay\Parsers registry key.
This allows you to extend the port/socket range to
[2302,2400]U{6073}U[MinUserPort,MaxUserPort].</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Because the DirectPlay and RTP
protocols are both layered on top of the UDP protocol, their parsers may
conflict. You should disable the RTP parser when analyzing DirectPlay traffic,
and vice versa.</span></p>

<h2 style='page-break-after:avoid'>Implementing a Callback Function in
DirectPlay and DirectPlay Voice</h2>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> and DirectPlay
Voice both require you to implement and register several callback functions to
handle the events fired by DirectPlay. DirectPlay is multithreaded and will
fire multiple events concurrently. Therefore, in order to correctly and
reliably access data in DirectPlay callbacks, you are required to implement a
method of multithreading synchronization. This is known as making your callback
<i>re-entrant</i> or <i>threadsafe</i>.</p>

<h5 style='page-break-after:avoid'>Callback Function Structure</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>The structure of the callback
follows standard Microsoft Windows Win32 API programming guidelines.</p>

<p class=Ex>HRESULT WINAPI Callback(</p>

<p class=Ex> PVOID pvUserContext,</p>

<p class=Ex> DWORD dwMessageType,</p>

<p class=Ex> PVOID pMessage );</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>pvUserContext</i> is the a
context value you supply when you register the callback function with
DirectPlay. If you pass this value to DirectPlay when you register your
callback, the context value will be returned when DirectPlay invokes your
callback.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>dwMessageType</i> is one of
the ID values passed to your callback by DirectPlay.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><i>pMessage</i> will contain the
message passed by DirectPlay.</p>

<h5 style='page-break-after:avoid'>Registering Your Callback</h5>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay networking
callback functions are of type PFNDPNMESSAGEHANDLER. Depending on the type of
networking session, you register the address of your callback function with
IDirectPlay8Peer::Initialize, IDirectPlay8Client::Initialize, or IDirectPlay8Server::Initialize.
If you are registering a DirectPlay voice callback function, register the
address of your callback with IDirectPlayVoiceClient::Initialize or
IDirectPlayVoiceServer::Initialize, depending on the type of DirectPlay voice
session you wish to create.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following code snippet
demonstrates how to register a callback function with the IDirectPlay8Peer
interface.</p>

<p class=Ex>HRESULT WINAPI Callback(PVOID, DWORD, PVOID);</p>

<p class=Ex>IDirectPlay8Peer* pdp8Peer;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>// Get the server interface</p>

<p class=Ex>hr = CoCreateInstance( CLSID_DirectPlay8Peer, ...)</p>

<p class=Ex>...</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>// Register the callback</p>

<p class=Ex>hr = pdp8Peer-&gt;Initialize(NULL, Callback, 0);</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Implementing a DirectPlay Networking
Callback Using Critical Section Objects</h2>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> networking and
voice callback are multithreaded. Therefore, in order to correctly and reliably
access data in DirectPlay callbacks, you are required to implement a method of
multithreading synchronization.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Currently, there are three
methods of synchronizing mulithreaded callback data.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Mutex Objects</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Semaphore Objects</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Critical Section Objects</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DirectPlay voice samples
that ship with the DirectX 8.0 SDK demonstrate synchronization using Critical
Section Objects, and the following topics will also demonstrate how Critical
Section Objects are used. If you wish to implement a Mutex or Semaphore Object,
these topics are discussed in the Microsoft Platform Software Development Kit
(SDK) as well as in many reference books. Implementing any of these
synchronization methods requires an expert knowledge level in these areas due
of the level of complexity and difficulty in debugging should any issues arise.</p>

<p class=Ex>CRITICAL_SECTION g_csPlayerContext;</p>

<p class=Ex>InitializeCriticalSection(&amp;g_csPlayerContext);</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Next, implement the DirectPlay
message callback handler. </p>

<p class=Ex>HRESULT WINAPI DirectPlayMessageHandler( PVOID pvUserContext, </p>

<p class=Ex> DWORD dwMessageId, </p>

<p class=Ex> PVOID pMsgBuffer )</p>

<p class=Ex>{</p>

<p class=Ex> switch( dwMessageId )</p>

<p class=Ex> {</p>

<p class=Ex> case DPN_MSGID_CREATE_PLAYER:</p>

<p class=Ex> {</p>

<p class=Ex> EnterCriticalSection( &amp;g_csPlayerContext );</p>

<p class=Ex> //callback is now locked</p>

<p class=Ex> //perform operation on player data</p>

<p class=Ex> LeaveCriticalSection( &amp;g_csPlayerContext );</p>

<p class=Ex> }</p>

<p class=Ex> }</p>

<p class=Ex>}</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Finally, during application
exit, ensure that you call the <b>DeleteCriticalSection</b> function to free
the memory associated with your critical section object.</p>

<p class=Ex>DeleteCriticalSection( &amp;g_csPlayerContext );</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>Multithreaded callbacks are not
used in Visual Basic.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Using the DirectPlay DPNSVR Application</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft Windows does not allow
multiple processes to share a single IP or IPX port. Each application that
wants to act as a communication host must use a separate port. This restriction
creates several issues, especially when doing such tasks as enumerating running
games:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Avoiding port conflicts. You
must choose a port that does not conflict with other applications.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Managing multiple communications
hosts on a single system. Each instance of a host must use a different port.
Client applications then have to determine which port a particular host is
using.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Avoiding ports that are already
in use. If your preferred port is in use, your application must be able to use
another port.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DPNSVR application addresses
these issues by acting as a forwarding service for enumeration requests. When
an application begins hosting, it informs DPNSVR which port it is running on.
DPNSVR listens on a well-known port, and forwards any enumeration requests to
all Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> hosts on the system. Responses to enumeration
requests contain the actual port that the host is connected to. DPNSVR offers
developers the following advantages:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You can write generic
enumeration routines that enumerate all the games running on a particular
system.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You can use DirectPlay to select
the host's port. Client applications can use the services of DPNSVR to
enumerate the running games on a well-known port, and the responses will
contain the actual port that the host is connected to.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You do not have to allow for the
situation where your application does not get the port it requests.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You do not need to be concerned
about conflicts with other applications on the system</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>While most applications will
want to use the services of DPNSVR, there are some circumstances where you may
want to disable it. Two examples are:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You know what port you want to
use, and only one instance of your application will be running on the computer.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> You want to restrict the ability
of players to enumerate your session. If you disable DPNSVR, only those players
that know the port that your host is connected to will be able to enumerate
your host.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information, see How to
Use DPNSVR.</p>

<h3 style='page-break-after:avoid'>How to Use DPNSVR</h3>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To determine whether DPNSVR is
supported by your service provider, call the <b>GetSPCaps</b> methods supported
by the <b>IDirectPlay8Peer</b>, <b>IDirectPlay8Client</b>, or <b>IDirectPlay8Server</b>.
If the service provider supports DPNSVR, the DPNSPCAPS_SUPPORTSDPNSRV flag will
be set in the <b>dwFlags </b>member or the returned <b>DPN_SP_CAPS</b>
structure. Only IP and IPX service providers currently support DPNSVR.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Using DPNSVR requires no special
effort, because it is selected by default. If you do not want enumeration
requests forwarded to your host, you must explicitly disable DPNSVR by setting
the DPNSESSION_NODPNSVR flag in the <b>dwFlags</b> member of the <b>DPN_APPLICATION_DESC</b>
structure.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Applications can always enumerate your host if they know the port
that it is running on, even if the DPNSESSION_NODPNSVR flag is set.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>To determine whether DPNSVR is
supported by your service provider, call the <b>GetSPCaps</b> methods supported
by the <b>DirectPlay8Peer</b>, <b>DirectPlay8Client</b>, or <b>DirectPlay8Server</b>.
If the service provider supports DPNSVR, the DPNSPCAPS_SUPPORTSDPNSRV flag will
be set in the <b>dwFlags </b>member or the returned <b>DPN_SP_CAPS</b> type.
Only IP and IPX service providers currently support DPNSVR.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Using DPNSVR requires no special
effort, because it is selected by default. If you do not want enumeration
requests forwarded to your host, you must explicitly disable DPNSVR by setting
the DPNSESSION_NODPNSVR flag in the <b>dwFlags</b> member of the <b>DPN_APPLICATION_DESC</b>
type.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Applications can always enumerate your host if they know the port
that it is running on, even if the DPNSESSION_NODPNSVR flag is set.</p>

<p class=Ne>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<h2 style='page-break-after:avoid'>Implementing Capture Focus</h2>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[C++]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>The concept of capturing focus
is integral to creating lobbyable game applications and lobby applications with
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice support. If your game application does
not properly implement focus capture, it is possible that voice communication
will not function if your game was launched from a lobby application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before the DirectPlay voice
session is created, there are several initialization steps to be completed:</p>

<p class=Ex>// Create a DirectPlay voice client interface</p>

<p class=Ex>hr = CoCreateInstance( CLSID_DirectPlayVoiceClient,</p>

<p class=Ex> NULL, </p>

<p class=Ex> CLSCTX_INPROC_SERVER,</p>

<p class=Ex> IID_IDirectPlayVoiceClient, </p>

<p class=Ex> (LPVOID*) &amp;m_pVoiceClient )</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>// Set the hwndAppWindow member to the window that will have</p>

<p class=Ex>// focus when your game application is running</p>

<p class=Ex>DVSOUNDDEVICECONFIG dvSoundDeviceConfig;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>dvSoundDeviceConfig.hwndAppWindow = hWnd;</p>

<p class=Ex>// Set dwFlags to DVSOUNDCONFIG_STRICTFOCUS so that only
application</p>

<p class=Ex>// windows that are in the foreground will gain focus</p>

<p class=Ex>dvSoundDeviceConfig.dwFlags = DVSOUNDCONFIG_STRICTFOCUS;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>// Connect to the voice session</p>

<p class=Ex>hr = m_pVoiceClient-&gt;Connect( &amp;dvSoundDeviceConfig, </p>

<p class=Ex> pdvClientConfig, </p>

<p class=Ex> DVFLAGS_SYNC )</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Once the application is
connected to the session, message will be received by your DirectPlay voice
callback. The two messages which you must handle to properly implement capture
focus are <b>DVMSGID_GAINFOCUS</b> and <b>DVMSGID_LOSTFOCUS</b>.</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>HRESULT CALLBACK DirectPlayVoiceClientMessageHandler(</p>

<p class=Ex> LPVOID lpvUserContext,</p>

<p class=Ex> DWORD dwMessageType,</p>

<p class=Ex> LPVOID lpMessage )</p>

<p class=Ex>{</p>

<p class=Ex> switch( dwMessageType )</p>

<p class=Ex> {</p>

<p class=Ex> case DVMSGID_GAINFOCUS:</p>

<p class=Ex> // the game application has gained focus in the system</p>

<p class=Ex> break;</p>

<p class=Ex> case DVMSGID_LOSTFOCUS:</p>

<p class=Ex> // the game application has lost focus in the system</p>

<p class=Ex> break;</p>

<p class=Ex> }</p>

<p class=Ex> ...</p>

<p class=Ex>}</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If recording is muted, focus
will be lost. DirectPlay voice will send a DVMSGID_LOSTFOCUS message to your
callback. When recording is unmuted, focus will be regained, with the exception
that applications using DVSOUNDCONFIG_STRICTFOCUS will only gain focus is the
application window is in the foreground.</p>

<p class=Ex>DVCLIENTCONFIG dvClientConfig;</p>

<p class=Ex>dvClientConfig.dwFlags = DVCLIENTCONFIG_RECORDMUTE;</p>

<p class=Ex>&nbsp;</p>

<p class=Ex>// Mute recording, DVMSGID_LOSTFOCUS is sent to DirectPlay</p>

<p class=Ex>// voice callback function</p>

<p class=Ex>m_pVoiceClient-&gt;SetClientConfig(dvClientConfig);</p>

<p class=Ex>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:3.0pt 0in 0in 0in'>

<p class=LangBegin>[Visual Basic]</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>This topic pertains only to
applications written in C++.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=LangEnd>&nbsp;</p>

</div>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>DirectPlay C++ Samples</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following sample
applications demonstrate the use and capabilities of the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
application programming interface for the C++ programming language. Refer to
the Readme.txt file in each sample folder for details. All sample folders can
be found under the SDK root directory, typically C:\mssdk.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> AddressOverride</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> ChatPeer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DataRelay</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> LobbyClient</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Maze</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimpleClientServer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimplePeer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> StagedPeer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> VoiceClientServer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> VoiceConnect</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> VoiceGroup</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> VoicePosition</span></p>

<p class=Leh>&nbsp;</p>

<h2 style='page-break-after:avoid'>AddressOverride</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>AddressOverride demonstrates how
to override the Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> addressing in order to host or connect to
another session on the network.</p>

<p class=Term1><b>Path</b></p>

<p class=Def1>(SDK Root)\Samples\Multimedia\DirectPlay\AddressOverride </p>

<h2 style='page-break-after:avoid'>ChatPeer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The ChatPeer sample is similar
in form to SimplePeer. Once a player hosts or connects to a session, the
players can chat with each other by passing text strings.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\ChatPeer </p>

<h2 style='page-break-after:avoid'>DataRelay</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DataRelay sample is similar
to SimplePeer but differs by sending a single target (or everyone) a packet of
data with options specified in the dialog box's UI.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\DataRelay </p>

<h2 style='page-break-after:avoid'>LobbyClient</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>LobbyClient is a simple lobby
client application. It displays all registered Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> applications
on the local system. It enables the user to launch one or more of these
applications using a chosen service provider. A launched lobbied application
may be told to either join or host a game.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\LobbyClient </p>

<h2 style='page-break-after:avoid'>Maze</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The maze sample is a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
client/server application. The client comes in two flavors: a console-based
version and a D3D client. The D3D client can optionally be run as screen saver
by copying Mazeclient.exe to your \winnt\system32\ folder and renaming it
Mazeclient.scr. Doing so will make it a screen saver that can be detected by
the display control panel application. </p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\Maze </p>

<h2 style='page-break-after:avoid'>SimpleClientServer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimpleClientServer sample is
a simple client/server application.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\SimpleClientServer </p>

<h2 style='page-break-after:avoid'>SimplePeer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimplePeer sample
illustrates how to implement a simple peer-to-peer application. After joining
or creating a session, the game begins immediately. Other players may join the
session in progress at any time. </p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\SimplePeer</p>

<h2 style='page-break-after:avoid'>StagedPeer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The StagedPeer sample connects
players together with two dialog boxes that prompt users on the connection
settings needed to join or create a session. After the user connects to a
session, the sample displays a multiplayer stage that enables all players connected
to the same session to chat. Players can start a new game when everyone is
ready and the host decides to begin. The host may reject players or close
player slots.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\StagedPeer </p>

<h2 style='page-break-after:avoid'>VoiceClientServer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The VoiceClientServer sample is
a simple Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> voice-based client/server application.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\VoiceClientServer</p>

<h2 style='page-break-after:avoid'>VoiceConnect</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The VoiceConnect sample shows
how to network other players to start a Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice chat session. After
joining or creating a session, the players may use a microphone to talk to one
other. Other players may join the session in progress at any time.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\VoiceConnect </p>

<h2 style='page-break-after:avoid'>VoiceGroup</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The VoiceGroup sample shows how
use Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> voice to enable users to talk to a specific
group of players.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\VoiceGroup </p>

<h2 style='page-break-after:avoid'>VoicePosition</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The VoicePosition sample shows
how use Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice with 3-D positioning. The sample uses a
simple 2-D grid to represent a playing field. Players can move around the
playing field to hear the effects of 3-D spatialization.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\DirectPlay\VoicePosition </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>DirectPlay Visual Basic Samples</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following sample
applications demonstrate the use and capabilities of the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
application programming interface for the Visual Basic programming language.
Refer to the Readme.txt file in each sample folder for details. All sample
folders can be found under the SDK root directory, typically C:\mssdk.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Chat</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Conferencer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DataRelay</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DXVB Messenger</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Memory</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimpleClient</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimplePeer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimpleServer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> SimpleVoice</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> StagedPeer</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> VoiceGroup</span></p>

<p class=Leh>&nbsp;</p>

<h2 style='page-break-after:avoid'>Chat</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Chat sample is similar in
form to SimplePeer. Once a player hosts or connects to a session, the players
can chat with either other by passing text strings.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK Root)\Samples\Multimedia\VBSamples\DirectPlay\Chat</p>

<h2 style='page-break-after:avoid'>Conferencer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Conferencer sample is
similar in form to Microsoft NetMeeting.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\Conferencer</p>

<h2 style='page-break-after:avoid'>DataRelay</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DataRelay sample is similar
to SimplePeer but differs by sending a packet of data to a single target (or
everyone) with options specified in the dialog box's UI. </p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\DataRelay </p>

<h2 style='page-break-after:avoid'>DXVB Messenger</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DXVBMessenger sample is a
simple client/server instant messaging application.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\DXVBMessenger</p>

<h2 style='page-break-after:avoid'>Memory</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Memory is a simple game in which
you match 'tiles' and try to score the most points.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\Memory</p>

<h2 style='page-break-after:avoid'>SimpleClient</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimpleClient sample is a
simple application that can connect to a server, and make funny faces to other
players on that server.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\SimpleClient</p>

<h2 style='page-break-after:avoid'>SimplePeer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimplePeer sample allows
players to make funny faces. Players can either be peers, or the session host.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\SimplePeer</p>

<h2 style='page-break-after:avoid'>SimpleServer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimpleServer sample is a
simple Server application that can connect and route client messages.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\SimpleServer</p>

<h2 style='page-break-after:avoid'>SimpleVoice</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The SimpleVoice sample is
similar in form to SimplePeer. Once a player hosts or connects to a session,
the players can chat with either other.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\SimpleVoice</p>

<h2 style='page-break-after:avoid'>StagedPeer</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The StagedPeer sample connects
players together with two dialog boxes that prompt users on the connection
settings needed to join or create a session. After the user connects to a
session, the sample displays a multiplayer stage that allows all players connected
to the same session to chat. Players can start a new game when everyone is
ready and the host decides to begin. The host may reject players or close
player slots.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\StagedPeer</p>

<h2 style='page-break-after:avoid'>VoiceGroup</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The VoiceGroup sample is similar
in form to SimpleVoice. Once a player hosts or connects to a session, the
players can chat with either other.</p>

<p class=Term1><b>Path</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>(SDK
Root)\Samples\Multimedia\VBSamples\DirectPlay\VoiceGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>y</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>DirectPlay C/C++ Reference</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>Reference material for the
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> C/C++ application programming interface is
divided into the following categories.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Interfaces</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Functions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Callback Functions </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> System Messages </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Structures </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Return Values </span></p>

<p class=Leh>&nbsp;</p>

<h2 style='page-break-after:avoid'>Interfaces</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section contains references
for methods of the following Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> interfaces.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8Peer</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8Client</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8Server</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlayVoiceClient</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlayVoiceServer</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlayVoiceTest</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8LobbyClient</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8LobbiedApplication</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8Address</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>IDirectPlay8AddressIP</b></span></p>

<p class=Leh>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8Peer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the methods of
the <b>IDirectPlay8Peer</b> interface to create a peer-to-peer Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlay8Peer</b>
interface can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHosts</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Host</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>&nbsp;</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>TerminateSession</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Message Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ReturnBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SendTo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Player Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyPeer</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPeerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetPeerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPlayerContext</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Group Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddPlayerToGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumPlayersAndGroups</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumGroupMembers</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupContext</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RemovePlayerFromGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetLocalHostAddresses</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPeerAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::AddPlayerToGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Adds a peer to a group. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, all
peers connected to the application receive a <b>DPN_MSGID_ADD_PLAYER_TO_GROUP</b>
message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT AddPlayerToGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group to add the peer to.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the peer that is added to the group.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNADDPLAYERTOGROUP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method runs
asynchronously and usually returns DPNSUCCESS_PENDING. It may also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any peer can add itself or
another peer to an existing group. Once the peer is successfully added to the
group, all messages sent to the group are also sent to the peer.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Cancels asynchronous requests.
For instance, several methods of the <b>IDirectPlay8Peer</b> interface run
asynchronously by default. Depending on the situation, you might want to cancel
requests before they are processed. All the methods of this interface that can
run asynchronously return an <i>hAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>hAsyncHandle</i> of the request in this methods <i>hAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, specifying NULL in the <i>hAsyncHandle </i>parameter, and
specifying DPNCANCEL_ALL_OPERATIONS in the <i>dwFlags </i>parameter. If a
specific handle is provided to this method, no flags should be set.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CancelAsyncOperation(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. You receive this
handle when you call one of several methods that support asynchronous
operations. This value can be set to NULL to stop all operations or a
particular type of asynchronous request. If you specify a particular handle for
the request, the <i>dwFlags</i> parameter must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request is to be canceled.
One of the following flags can be set. </p>

<p class=Term2>DPNCANCEL_ENUM</p>

<p class=Def2>Cancel all asynchronous <b>IDirectPlay8Peer::EnumHosts</b>
requests. A single <b>EnumHosts</b> request can be canceled by specifying the
handle returned from the <b>EnumHosts</b> method.</p>

<p class=Term2>DPNCANCEL_CONNECT</p>

<p class=Def2>Cancel an asynchronous <b>IDirectPlay8Peer::Connect</b> request.</p>

<p class=Term2>DPNCANCEL_SEND</p>

<p class=Def2>Cancel an asynchronous <b>IDirectPlay8Peer::SendTo</b> request.</p>

<p class=Term2>DPNCANCEL_ALL_OPERATIONS</p>

<p class=Def2>Cancel all asynchronous <b>Connect, Send, and SentTo </b>operations.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
cancel an asynchronous operation for the <b>IDirectPlay8Peer::Connect</b>, <b>IDirectPlay8Peer::SendTo</b>,
and <b>IDirectPlay8Peer::EnumHosts</b> methods. Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not support cancellation of other asynchronous operations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a send request by
providing the handle returned from the <b>IDirectPlay8Peer::SendTo</b> method.
A <b>DPN_MSGID_SEND_COMPLETE</b>, or <b>DPN_CONNECT_COMPLETE </b>system message
is still posted to the applications message handler for each asynchronous send
request that is sent without the DPNSEND_NOCOMPLETE flag set. Send requests
that are canceled by this method return DPNERR_USERCANCEL in the <b>hResultCode</b>
member of the <b>DPN_MSGID_SEND_COMPLETE</b> message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNCANCEL_ALL_OPERATIONS, DPN_CANCELCONNECT, DPN_CANCELSEND, or DPNCANCEL_ENUM
flags in <i>dwFlags</i>, DirectPlay will attempt to cancel all matching
operations. This method will return an error if any attempted cancellation
fails, even though some cancellations may have been successful.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The completion message might not arrive until after this method
returns. Do not assume that the operation has been terminated until you have
received a <b>DPN_MSGID_SEND_COMPLETE</b>, <b>DPN_MSGID_CONNECT_COMPLETE</b>,
or <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> message.</p>

<p class=Ne>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Closes the open connection with
a session. This method must be called on any object successfully initialized
with <b>IDirectPlay8Peer::Initialize</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Close(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method will cancel any
operations still outstanding. It will block until all callback indications on
other threads have returned.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Establishes the connection to
all the peers in a peer-to-peer session. Once a connection is established, the
communication channel on the interface is open and the application should
expect messages to arrive immediately. No messages can be sent by way of the <b>IDirectPlay8Peer::SendTo</b>
method until the connection has completed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before this method is called,
you can obtain application descriptions and the addresses of the associated
hosts by calling <b>IDirectPlay8Peer::EnumHosts</b>. The <b>EnumHosts</b>
method returns a <b>DPN_APPLICATION_DESC</b> structure for each currently
hosted application. The structure describes the application, including the
instance GUID of the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
asynchronously (which is the default choice) and returns DPNSUCCESS_PENDING,
when the connection completes a <b>DPN_MSGID_CONNECT_COMPLETE</b> message is
sent to the applications message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Connect(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pdnAppDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pHostAddr</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_DESC *const</b> <i>pdnSecurity</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_CREDENTIALS
*const</b> <i>pdnCredentials</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const void *const</b> <i>pvUserConnectData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwUserConnectDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvPlayerContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdnAppDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application. Only some of the members of this structure are used by this
method. The only members that you must set are <b>dwSize </b>and <b>guidApplication</b>.
You can also set <b>guidInstance</b>,<b> pwszPassword</b>,<b> </b>and <b>dwFlags</b>.</p>

<p class=Term1><i>pHostAddr</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> interface that specifies
the addressing information to use to connect to the computer that is hosting.</p>

<p class=Term1><i>pDeviceInfo</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> interface that specifies
the network adapter (for example, NIC, modem, and so on) to use to connect to
the server.</p>

<p class=Term1><i>pdnSecurity</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pdnCredentials</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pvUserConnectData</i></p>

<p class=Def1>Pointer to application-specific data provided to the host or
server to further validate the connection. This data is sent to the <b>DPN_MSGID_INDICATE_CONNECT</b>
message in the <b>pvUserConnectData</b> member. This parameter is optional and
may be set to NULL if no additional connection validation is provided by the
user code.</p>

<p class=Term1><i>dwUserConnectDataSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
contained in the <i>pvUserConnectData</i> parameter.</p>

<p class=Term1><i>pvPlayerContext</i></p>

<p class=Def1>Pointer to the context value of the local player. This value is
preset when the local computer handles the <b>DPN_MSGID_CREATE_PLAYER</b>
message. This parameter is optional and may be set to NULL.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_CONNECT_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Peer::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNCONNECT_SYNC flag in <i>dwFlags. </i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that describes the connection mode. You can set the
following flags.</p>

<p class=Term2>DPNCONNECT_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
dialog box, which queries the user for more information if not enough
information is passed in this method.</p>

<p class=Term2>DPNCONNECT_SYNC</p>

<p class=Def2>Process the connection request synchronously. Your message
handler still receives a DPN_MSGID_CONNECT_COMPLETE message, so that you can
process any connection reply data from the host. You will receive this message
before <b>IDirectPlay8Peer::Connect</b> returns.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method runs
asynchronously and normally returns DPNSUCCESS_PENDING. It may also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_HOSTREJECTEDCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDDEVICEADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHOSTADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINSTANCE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINTERFACE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPASSWORD</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SESSIONFULL</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although multiple enumerations
can be run concurrently and can be run across the duration of a connection,
only one connection is allowed per interface. To establish a connection to more
than one application, you must create another interface. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
asynchronously (which is the default choice), when the connection completes a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message is posted to the applications message handler. If this method returns
an error, no completion message is posted.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, a <b>DPN_MSGID_INDICATE_CONNECT</b>
message is posted to the hosts message handler. When the host handles this
message, it can specify connection reply data that the player will receive with
the <b>DPN_MSGID_CONNECT_COMPLETE</b> message. If the host accepts the
connection, the connection reply data might contain custom startup information.
If the connection was rejected, the connection reply data might contain an
explanation of the rejection.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call <b>IDirectPlay8Peer::Close</b>
to end the connection to the host.</p>

<p class=Nh>Note</p>

<p class=Np1>If you set the DPNCONNECT_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>,
the service provider may attempt to display a dialog box to ask the user to
complete the address information. You must have a visible window present when
the service provider tries to display the dialog box, or your application will
lock.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::CreateGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Creates a group in the current
session. A group is a logical collection of players.</p>

<p class=Nh>Note</p>

<p class=Np1>Multicasting is not supported for this release.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, all
peers connected to the application receive a <b>DPN_MSGID_CREATE_GROUP</b>
system message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CreateGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvGroupContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that contains the
group description.</p>

<p class=Term1><i>pvGroupContext</i></p>

<p class=Def1>Pointer to the groups context value. This value is preset when
the local applications message handler receives the associated
DPN_MSGID_CREATE_GROUP message. This parameter is optional and may be set to
NULL.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNCREATEGROUP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return the
following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
maintain hierarchical groups because these can easily be implemented with flat
groups and expeditious use of the group data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All peers receive a <b>DPN_MSGID_CREATE_GROUP</b>
message when this method is called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::DestroyPeer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes a peer from the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT DestroyPeer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnidClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pDestroyInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwDestroyInfoSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnidClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the peer to delete.</p>

<p class=Term1><i>pDestroyInfo</i></p>

<p class=Def1>Pointer to a value that describes additional delete data
information.</p>

<p class=Term1><i>dwDestroyInfoSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
contained in the <i>pDestroyInfo</i> parameter.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A player can only be deleted by
the session host. The deleted player will be notified through a <b>DPN_MSGID_TERMINATE_SESSION</b>
message. The structure associated with the message will contain the data passed
through the <i>pDestroyInfo </i>parameter. If any other session member calls
this method, it will fail, and return DPNERR_NOTHOST.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::DestroyGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes a group created by the <b>IDirectPlay8Peer::CreateGroup</b>
method. This method can be called by any peer in the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT DestroyGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID</b> <b>const </b><i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that should be set to the
identifier of the group to be deleted.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNDESTROYGROUP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::EnumPlayersAndGroups</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a list of all the
player and/or group identifiers for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumPlayersAndGroups(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNID *const</b> <i>prgdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>prgdpnid</i></p>

<p class=Def1>Pointer to an array that will be filled with the sessions group
and/or player identifiers.</p>

<p class=Term1><i>pcdpnid</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of identifiers that can be contained in the buffer pointed to by <i>prgdpnid</i>.
If the buffer is too small, this method returns DPNERR_BUFFERTOOSMALL and this
parameter contains the number of entries that are required.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that describes enumeration behavior. You can set one or both
of the following flags. </p>

<p class=Term2>DPNENUM_PLAYERS</p>

<p class=Def2>Return a list of player identifiers.</p>

<p class=Term2>DPNENUM_GROUPS</p>

<p class=Def2>Return a list of group identifiers.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because group and player
information changes frequently, the required buffer size returned may change
between subsequent calls. Check and reallocate the buffer until the method
succeeds.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::EnumGroupMembers</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a list of all players
in a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumGroupMembers(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNID *const</b> <i>prgdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the group that
contains the players to enumerate.</p>

<p class=Term1><i>prgdpnid</i></p>

<p class=Def1>Pointer to an array that will contain the identifiers of the
groups players.</p>

<p class=Term1><i>pcdpnid</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of identifiers that can be contained in the buffer pointed to by <i>dpnid</i>.
If the buffer is too small, this method returns DPNERR_BUFFERTOOSMALL and this
parameter contains the number of entries that are required.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because player information
changes frequently, the required buffer size returned may change between
subsequent calls. Check and reallocate the buffer until the method succeeds.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::EnumHosts</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates applications that
host Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> games. When an application is found that meets
the enumeration criteria, the applications message handler is called with a <b>DPN_MSGID_ENUM_HOSTS_RESPONSE</b>
system message. The message contains a <b>DPN_APPLICATION_DESC</b> structure
describing the applications found.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any number of enumerations can
be run concurrently. The <i>pvUserContext</i> value is provided in the message
handler to help differentiate replies to different enumerations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because of the variation in the
number of ways enumeration can happen, an application should not attempt to
specify <i>dwEnumPeriod, dwRetryInterval,</i> or <i>dwTimeOut</i> unless the
application has some specific media knowledge.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The default enumeration count
and timeout values will cause <b>EnumHosts</b> to complete within a reasonable
amount of time. These values are set by the service provider, and can be
obtained by calling <b>IDirectPlay8Peer::GetSPCaps</b>. Asynchronous
enumerations can be stopped at any time by calling <b>IDirectPlay8Peer::CancelAsyncOperation
</b>and either passing the handle returned in the <i>pAsyncHandle </i>parameter
or setting the DPENUM_CANCEL flag in the <i>dwFlags</i> parameter. An
enumeration can also be stopped by returning anything other than S_OK from the
message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumHosts(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDPN_APPLICATION_DESC const</b> <i>pApplicationDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pdpaddrHost</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pdpaddrDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwUserEnumDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwEnumCount</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwRetryInterval</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HANDLE *const</b> <i>pAsyncHandle</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pApplicationDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that specifies
which application hosts to enumerate. You must set the <i>pApplicationDesc</i>.dwSize
member to the appropriate value. To reduce the number of responses, set <i>pApplicationDesc</i>.guidApplication
to the GUID of the application to be found. If this member is not set, the
search will include all applications. </p>

<p class=Term1><i>pdpaddrHost</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> object that specifies
the address of the computer that is hosting the application. If you specify
NULL, DirectPlay will create an address. By default, DirectPlay will create the
address from the <i>pdpaddrDeviceInfo</i> parameter. If you set the
DPNENUMHOSTS_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the user can be
queried for address information.</p>

<p class=Term1><i>pdpaddrDeviceInfo</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> object that specifies
the service provider and local device settings to use when enumerating.</p>

<p class=Term1><i>pvUserEnumData</i></p>

<p class=Def1>Pointer to a block of data that is sent in the enumeration
request to the host. The size of the data is limited depending on the network
type. Call <b>IDirectPlay8Peer::GetSPCaps</b> to obtain the exact value.</p>

<p class=Term1><i>dwUserEnumDataSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
pointed at in the <i>pvUserEnumData</i> parameter.</p>

<p class=Term1><i>dwEnumCount</i></p>

<p class=Def1>Value specifying how many times that the enumeration data will be
sent. Set this parameter to zero to use the default value. You can obtain the
default value for <i>dwEnumCount</i> by calling <b>IDirectPlay8Peer::GetSPCaps</b>.
If <i>dwEnumCount </i>is set to INFINITE, the enumeration will continue until
canceled.</p>

<p class=Term1><i>dwRetryInterval</i></p>

<p class=Def1>Value specifying how many milliseconds between enumeration
retries. Set this parameter to zero to use the default value. You can obtain
the default value for <i>dwRetryInterval </i>by calling <b>IDirectPlay8Peer::GetSPCaps</b>.</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the number of
milliseconds that DirectPlay will wait for replies after the last enumeration
is sent. Set this parameter to zero to use the default value. You can obtain
the default value for <i>dwTimeOut </i>by calling <b>IDirectPlay8Peer::GetSPCaps</b>.
If INFINITE is specified, the enumeration continues until it is canceled. </p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Context that is provided in the peers message handler when it is
called with responses to the enumeration. This can be useful to differentiate
replies from concurrent enumerations.</p>

<p class=Term1><i>pAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Peer::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNENUMHOSTS_SYNC flag in <i>dwFlags.</i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flags can be set.</p>

<p class=Term2>DPNENUMHOSTS_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Term2>DPNENUMHOSTS_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard DirectPlay<span
style='font-size:7.0pt'></span> dialog box, which queries the user for more
information if not enough information is passed in this method.</p>

<p class=Term2>DPNENUMHOSTS_NOBROADCASTFALLBACK</p>

<p class=Def2>If the service provider supports broadcasting, setting this flag
will disable the broadcast capabilities. Check to see if broadcasting is
supported by examining the <b>DPN_SP_CAPS</b> structure before setting this
flag.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDDEVICEADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHOSTADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ENUMQUERYTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNENUMHOSTS_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the service
provider may attempt to display a dialog box to ask the user to complete the
address information. You must have a visible window present when the service
provider tries to display the dialog box, or your application will lock.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::EnumServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates all the registered
service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumServiceProviders(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidServiceProvider</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SERVICE_PROVIDER_INFO
*const</b> <i>pSPInfoBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcbEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcReturned</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>constDWORD</b> <i>dwFlags</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidServiceProvider</i></p>

<p class=Def1>Pointer to a variable of type GUID that specifies a service
provider. This optional parameter forces the enumeration of subdevices for the
specified service provider. You should normally set this value to NULL, to
enumerate all available service providers.</p>

<p class=Term1><i>pguidApplication</i></p>

<p class=Def1>Pointer to a variable of type GUID that specifies an application.
If a pointer is passed in this parameter, only service providers who can be
connected by the application are enumerated. You can also pass NULL to
enumerate all the registered service providers for the system.</p>

<p class=Term1><i>pSPInfoBuffer</i></p>

<p class=Def1>Pointer to an array of <b>DPN_SERVICE_PROVIDER_INFO</b>
structures that will be filled with service provider information.</p>

<p class=Term1><i>pcbEnumData</i></p>

<p class=Def1>Pointer to <b>DWORD</b> that is filled with the size of the <i>pEnumData</i>
buffer if the buffer is too small.</p>

<p class=Term1><i>pcReturned</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of <b>DPN_SERVICE_PROVIDER_INFO</b> structures returned in the <i>pcbEnumData</i>
array.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPNENUMSERVICEPROVIDERS_ALL</p>

<p class=Def2>Enumerates all the registered service providers for the system,
including those that are not available to the application or do not have
devices installed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
specifying NULL in the <i>pguidServiceProvider</i> parameter to determine the
base service providers available to the system. Specific devices for a service
provider can then be obtained by passing a pointer to a service provider GUID
in the <i>pguidServiceProvider</i>. This is useful, for example, when using the
Modem Connection for Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> service provider. You can choose different
modems for dialing out and specific modems for hosting.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the <i>pcbEnumData </i>buffer
is not big enough to hold the requested service provider information, the
method returns DPNERR_BUFFERTOOSMALL and the p<i>cbEnumData</i> parameter
contains the required buffer size. Typically, the best strategy is to call the
method once with a zero-length buffer to determine the required size. Then call
it again with the appropriate-sized buffer. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Normally, this method will
return only those service providers that can be used by the application. For
example, if the IPX networking protocol is not installed, DirectPlay will not
return the IPX service provider. To have DirectPlay return all service providers,
even those that cannot be used by the application, set the
DPNENUMSERVICEPROVIDERS_ALL flag in <i>dwFlags.</i></p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the full application
description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetApplicationDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_APPLICATION_DESC *const</b> <i>pAppDescBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcbDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pAppDescBuffer</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure where the
application description data is to be written. Set this parameter to NULL to
request only the size of data. If <i>pAppDescBuffer </i>is not set to NULL, you
must set the <i>pAppDescBuffer.</i>dwSize member to an appropriate value. The <i>pcbDataSize</i>
parameter is set to the size required to hold the data. </p>

<p class=Term1><i>pcbDataSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that is initialized to
the size of the buffer before calling this method. After the method returns,
this parameter is set to the size, in bytes, of the session data. If the buffer
is too small, this method returns the DPNERR_BUFFERTOOSMALL error value, and
this parameter is set to the buffer size required. If this parameter is NULL,
the method returns DPNERR_INVALIDPARAM. </p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
passing NULL in the <i>pAppDescBuffer</i> parameter to obtain the size of the
required buffer. When you call the method a second time to fill the buffer, be
sure to set the structures <b>dwSize</b> member to the appropriate value.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The returned
DPN_APPLICATION_DESC structure will have the <b>guidInstance</b>, <b>guidApplication</b>,
and <b>pwszSessionName</b> members set. It will not contain information about
other clients that are connected to the session. That information, if
available, can be obtained only from the server application. In particular, the
<b>dwCurrentPlayers</b> member will always be set to 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_CAPS *const</b> <i>pdpnCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure to receive caps
information. You must set the <b>dwSize</b> member of this structure to an
appropriate value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves statistical
information about the connection between the local application and the
specified remote player.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetConnectionInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnidEndPoint,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_CONNECTION_INFO *const</b> <i>pdnConnectInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnidEndPoint</i></p>

<p class=Def1>The DPNID of the remote player whose connection information will
be retrieved.</p>

<p class=Term1><i>pdnConnectInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_CONNECTION_INFO</b> structure to retrieve
information about the specified connection. The <b>dwSize</b> member of this
structure must be set to the size of a <b>DPN_CONNECTION_INFO</b> structure.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Host</b> or <b>Connect</b> call has completed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetGroupContext</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the group context
value for the specified group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetGroupContext(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID *const</b> <i>ppvGroupContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group to retrieve context data for.</p>

<p class=Term1><i>ppvGroupContext</i></p>

<p class=Def1>Pointer to the context value of the group.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Group context values are set by
pointing the <b>pvGroupContext</b> member of the <b>DPN_MSGID_CREATE_GROUP</b>
system message to the context value data.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a block of data
associated with a group, including the group name.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is typically called
after a <b>DPN_MSGID_GROUP_INFO</b> system message is received indicating that
the group data has been modified.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetGroupInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group whose data block will be retrieved.</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that describes the
group data. If <i>pdwSize</i> is not set to NULL, you must set <i>pdpnGroupInfo.</i>dwSize
to the size of a <b>DPN_GROUP_INFO</b> structure.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that returns the size
of the data in the <i>pdpnGroupInfo</i> parameter. If the buffer is too small,
this method returns DPNERR_BUFFERTOOSMALL and this parameter contains the
required size.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Set to 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> returns the <b>DPN_GROUP_INFO</b>
structure, and the pointers assigned to the structures <b>pwszName</b> and <b>pvData</b>
members in a contiguous buffer. If the two pointers were set, you must have
allocated enough memory for the structure, plus the two pointers. The most
robust way to use this method is to first call it with <i>pdwSize</i> set to
NULL. When the method returns, <i>pdwSize </i>will point to the correct value.
Use that value to allocate memory for your structure and call the method a
second time to retrieve the information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the method returns, the <b>dwInfoFlags</b>
member of the <b>DPN_GROUP_INFO</b> structure will always have the DPNINFO_DATA
and DPNINFO_NAME flags set, even if the corresponding pointers are set to NULL.
These flags are used when calling <b>IDirectPlay8Peer::SetGroupInfo</b>, to
notify DirectPlay which values have changed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Peer::SendTo</b> method
because of the high cost of using the <b>IDirectPlay8Peer::SetGroupInfo</b>
method.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetLocalHostAddresses</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the local addresses
being used to host the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetLocalHostAddresses(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const</b> <i>prgpAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>prgpAddress</i></p>

<p class=Def1>A pointer to an array of <b>IDirectPlay8Address</b> objects that
specify the local host addresses. You must release these objects when you no
longer need them, or you will create memory leaks.</p>

<p class=Term1><i>pcAddress</i></p>

<p class=Def1>The maximum number of address objects that can be returned in the
array pointed to by <i>prgpAddress</i>. If the buffer is too small, this method
returns DPNERR_BUFFERTOOSMALL and this parameter contains the required size.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The most robust way to use this
method is to call it first with <i>pcAddress </i>set to 0. When the method
returns, <i>pcAddress </i>will point to the correct value, and you can use that
value to call the method a second time to retrieve the information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the caller is not the session
host, the method returns DPNERR_NOTHOST. Use <b>IDirectPlay8Peer::GetPeerAddress</b>
to retrieve the address of a remote player.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetPeerAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the address for the
specified player in the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetPeerAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID </b><i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const </b><i>pAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> specifying the identification of
the player.</p>

<p class=Term1><i>pAddress</i></p>

<p class=Def1>Address of a pointer to an <b>IDirectPlay8Address</b> object that
specifies the address of the peer. You must release this object when you no
longer need it.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Use <b>IDirectPlay8Peer::GetLocalHostAddresses</b>
to retrieve addresses that can be used to connect to the session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetPeerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves peer information set
for the specified peer.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetPeerInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the peer whose information will be retrieved.</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure to fill with peer
information. If <i>pdwSize</i> is not set to NULL, you must set <i>pdpnPlayerInfo.</i>dwSize
to the size of a <b>DPN_PLAYER_INFO </b>structure.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the size
of the peer data returned in the <i>pdpnPlayerInfo </i>parameter. If the buffer
is too small this method returns DPNERR_BUFFERTOOSMALL and this parameter
contains the size of the required buffer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Set to 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after the peer
receives a <b>DPN_MSGID_PEER_INFO</b> message from the application, which
indicates a peer has updated their information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> returns the <b>DPN_PLAYER_INFO</b>
structure, and the pointers assigned to the structures <b>pwszName</b> and <b>pvData</b>
members in a contiguous buffer. If the two pointers were set, you must have
allocated enough memory for the structure, plus the two pointers. The most
robust way to use this method is to first call it with <i>pdwSize</i> set to
NULL. When the method returns, <i>pdwSize </i>will point to the correct value.
Use that value to allocate memory for the structure and call the method a
second time to retrieve the information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the method returns, the <b>dwInfoFlags</b>
member of the <b>DPN_PLAYER_INFO</b> structure will always have the
DPNINFO_DATA and DPNINFO_NAME flags set, even if the corresponding pointers are
set to NULL. These flags are used when calling <b>IDirectPlay8Peer::SetPeerInfo</b>,
to notify DirectPlay of which values have changed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Peer::SendTo</b> method
because of the high cost of using the <b>IDirectPlay8Peer::SetPeerInfo</b>
method.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetPlayerContext</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the player context
value for the specified peer.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetPlayerContext(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID *const</b> <i>ppvPlayerContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the player to get context data for.</p>

<p class=Term1><i>ppvPlayerContext</i></p>

<p class=Def1>Pointer to the context data of the peer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Player context values are set by
pointing the <b>pvPlayerContext</b> member of the <b>DPN_MSGID_CREATE_PLAYER</b>
system message to the context value data.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used by the application to
monitor the size of the send queue. Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> will not send messages faster
than the receiving computer can process them. As a result, if the sending
computer is sending faster than the receiver can receive, messages accumulate
in the senders queue. If the application registers that the send queue is
growing too large, it should slow the rate that messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSendQueueInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumMsgs</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumBytes</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1><b>DPNID</b> of the player to get send queue information for.</p>

<p class=Term1><i>pdwNumMsgs</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the
number of messages currently queued. This value is optional, and may be set to
NULL.</p>

<p class=Term1><i>pdwNumBytes</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
total number of bytes of data of the messages currently queued. This value is
optional, and may be set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the DPNGETSENDQUEUEINFO_PRIORITY_NORMAL,
DPNGETSENDQUEUEINFO_PRIORITY_HIGH, or DPNGETSENDQUEUEINFO_PRIORITY_LOW flag to
inquire about specific messages of that priority.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You cannot set both <i>pdwNumMsgs
</i>and <i>pdwNumBytes</i> to NULL. At least one of them must be set to a valid
pointer.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT</b> <b>GetSPCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_SP_CAPS *const</b> <i>pdpnSPCaps,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to get
information about.</p>

<p class=Term1><i>pdpnSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to receive the
information about the specified service provider. You must set the <i>pdpnSPCaps.</i>dwSize
member of the structure.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method retrieves
information about the specified service provider. A successful call to <b>IDirectPlay8Peer::Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::Host</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Creates a new peer-to-peer
session, hosted by the local computer.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Host(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pdnAppDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const</b> <i>prgpDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>cDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_DESC *const</b> <i>pdpSecurity</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_CREDENTIALS
*const</b> <i>pdpCredentials</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvPlayerContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdnAppDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application.</p>

<p class=Term1><i>prgpDeviceInfo</i></p>

<p class=Def1>A pointer to an array of <b>IDirectPlay8Address</b> objects
containing the device addresses that should be used to host the application.
You must release these objects when you no longer need them.</p>

<p class=Term1><i>cDeviceInfo</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the number of device
address objects in the array pointed to by <i>prgpDeviceInfo</i>.</p>

<p class=Term1><i>pdpSecurity</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pdpCredentials</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pvPlayerContext</i></p>

<p class=Def1>Pointer to the context value of the local player. This value is
preset when the local computer handles the <b>DPN_MSGID_CREATE_PLAYER</b>
message. This parameter is optional and may be set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPNHOST_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
dialog box, which queries the user for more information if not enough
information is passed in this method.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DATATOOLARGE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDDEVICEADDRESS</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNHOST_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the service provider may
attempt to display a dialog box to ask the user to complete the address
information. You must have a visible window present when the service provider
tries to display the dialog box, or your application will lock.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The maximum size of the
application data that you assign to the <b>pvApplicationReservedData</b> member
of the <b>DPN_APPLICATION_DESC</b> structure is limited by the service
provider's Maximum Transmission Unit. If your application data is too large,
the method will fail and return DPNERR_DATATOOLARGE.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers an entry point in the
peers code that receives all the messages from the <b>IDirectPlay8Peer</b>
interface and from remote peers. This method must be called before calling any
other methods of this interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PFNDPNMESSAGEHANDLER</b> <i>pfn</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the user-provided context value in calls to the
message handler. A user-provided context value can be used to differentiate
messages coming from multiple interfaces to a common message handler.</p>

<p class=Term1><i>pfn</i></p>

<p class=Def1>Pointer to a <b>PFNDPNMESSAGEHANDLER</b> callback function that
is used to receive all messages from remote peers and indications of session
changes from the <b>IDirectPlay8Peer</b> interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the following flag.</p>

<p class=Term2>DPNINITIALIZE_DISABLEPARAMVAL</p>

<p class=Def2>Passing this flag will disable parameter validation for the current
object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method first after
using <b>CoCreateInstance</b> to obtain the <b>IDirectPlay8Peer</b> interface.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Allows launched applications to
automatically propagate game status to the lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RegisterLobby(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE </b><i>dpnHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8LobbiedApplication
*const</b> <i>pIDP8LobbiedApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnHandle</i></p>

<p class=Def1>The connection handle used when making the calls to <b>IDirectPlay8LobbiedApplication::UpdateStatus</b>.</p>

<p class=Term1><i>pIDP8LobbiedApplication</i></p>

<p class=Def1>Pointer to the <b>IDirectPlay8LobbiedApplication</b> object that
specifies the application.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>One of the following flags:</p>

<p class=Term2>DPNLOBBY_REGISTER</p>

<p class=Def2>Registers the lobby with the application.</p>

<p class=Term2>DPNLOBBY_UNREGISTER</p>

<p class=Def2>Unregisters the lobby with the application.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::RemovePlayerFromGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Removes a peer from a group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called all
peers connected to the application receive a <b>DPN_MSGID_REMOVE_PLAYER_FROM_GROUP</b>
message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RemovePlayerFromGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group that the peer will be removed from.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the peer that will be removed from the group.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNREMOVEPLAYERFROMGROUP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::ReturnBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves message buffers
provided to the application through the <b>pReceiveData</b> member of the <b>DPN_MSGID_RECEIVE</b>
system message. If the users message handler returns DPNSUCCESS_PENDING to the
RECEIVE callback, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> assumes that ownership of the buffer is
transferred to the application, and neither frees nor modifies it until
ownership is returned to DirectPlay through this call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT ReturnBuffer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hBufferHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hBufferHandle</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the buffer
handle for the message. This is obtained in the <b>hBufferHandle</b> member of
the <b>DPN_MSGID_RECEIVE</b> system message.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SendTo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmits data to another peer
or group within the session by sending a message to the appropriate message
handlers. The message can be sent synchronously or asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SendTo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_BUFFER_DESC *const</b> <i>pBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>cBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Identifier of the peer or group that receives data. Set this
parameter to DPNID_ALL_PLAYERS_GROUP to send a message to all players in the
session.</p>

<p class=Term1><i>pBufferDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_BUFFER_DESC</b> structure that contains the
data to be sent.</p>

<p class=Term1><i>cBufferDesc</i></p>

<p class=Def1>The number of <b>DPN_BUFFER_DESC</b> structures pointed to by <i>pBufferDesc</i>.
There can only be one buffer in this version of Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>.
</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to send. If the
message has not been sent by the <i>dwTimeOut</i> value, the message is not
sent. If you do not want a time out for message sends, set this parameter to 0.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_SEND_COMPLETE</b> system message. This parameter is
optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Peer::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNSEND_SYNC flag in <i>dwFlags. </i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
following flags.</p>

<p class=Term2>DPNSEND_SYNC</p>

<p class=Def2>Process the <b>SendTo</b> request synchronously.</p>

<p class=Term2>DPNSEND_NOCOPY</p>

<p class=Def2>Use the data in the <b>DPN_BUFFER_DESC</b> structure and do not
make an internal copy. This may be a more efficient method of sending data.
However, it is less robust because the sender might be able to modify message
before the receiver has processed it. This flag cannot be combined with DPNSEND_NOCOMPLETE.</p>

<p class=Term2>DPNSEND_NOCOMPLETE</p>

<p class=Def2>Does not send the <b>DPN_MSGID_SEND_COMPLETE</b> to the message
handler. This flag may not be used with DPNSEND_NOCOPY or DPNSEND_GUARANTEED.
Additionally, when using this flag the <i>pvAsyncContext</i> must be NULL.</p>

<p class=Term2>DPNSEND_COMPLETEONPROCESS</p>

<p class=Def2>Sends the <b>DPN_MSGID_SEND_COMPLETE</b> to the message handler
when this message has been delivered to the target and the targets message
handler returns from indicating its reception. There is additional internal
message overhead when this flag is set, and the message transmission process may
become significantly slower. If you set this flag, DPNSEND_GUARANTEED must also
be set.</p>

<p class=Term2>DPNSEND_GUARANTEED</p>

<p class=Def2>Sends the message by a guaranteed method of delivery.</p>

<p class=Term2>DPNSEND_PRIORITY_HIGH</p>

<p class=Def2>Sets the priority of the message to high. This flag cannot be
used with DPNSEND_PRIORITY_LOW.</p>

<p class=Term2>DPNSEND_PRIORITY_LOW</p>

<p class=Def2>Sets the priority of the message to low. This flag cannot be used
with DPNSEND_PRIORITY_HIGH.</p>

<p class=Term2>DPNSEND_NONSEQUENTIAL</p>

<p class=Def2>If this flag is set, the target application will receive the
messages in the order that they arrive at the users computer. If this flag is
not set, messages are delivered sequentially, and will be received by the
target application in the order that they were sent. Doing so may require
buffering incoming messages until missing messages arrive.</p>

<p class=Term2>DPNSEND_NOLOOPBACK</p>

<p class=Def2>Suppresses the <b>DPN_MSGID_RECEIVE</b> system message to your
message handler when you are sending to a group that includes the local player.
For example, this flag is useful if you are broadcasting to the entire session.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CONNECTIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method generates a <b>DPN_MSGID_RECEIVE</b>
system message in the receivers message handler. The data buffer is contained
in the <b>pReceiveData</b> member of the associated structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages can have one of three
priorities: low, normal, and high. To specify a low or high priority for the
message, set the appropriate flag in <i>dwFlags. </i>If neither of the priority
flags is set, the message will have normal priority. See Basic Networking for a
discussion of send priorities.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the <b>SendTo</b> request
is completed, a <b>DPN_MSGID_SEND_COMPLETE</b> system message is normally
posted to the senders message handler. The success or failure of the request
is contained in the <b>hResultCode</b> member of the associated structure. You
can suppress send completions by setting the DPNSEND_NOCOMPLETE flag in <i>dwFlags.</i>
</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Send completions are typically
posted on the source computer as soon as the message is sent. In other words, a
send completion does not necessarily mean that the message has been processed
on the target. It may still be in a queue. If you want to be certain that the
message has been processed by the target, set the DPNSEND_COMPLETEONPROCESS
flag in <i>dwFlags. </i>This flag ensures that the send completion will not be
sent until the targets message handler has processed the message, and
returned. </p>

<p class=Nh>Note</p>

<p class=Np1>Do not assume that resources such as the data buffer will remain
valid until the method has returned. If you call this method asynchronously,
the <b>DPN_MSGID_SEND_COMPLETE</b> message may be received and processed by
your message handler before the call has returned. If your message handler
deallocates or otherwise invalidates a resource such as the data buffer, that
resource may become invalid at any time after the method has been called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Changes the settings for the
application that is being hosted. Only some settings can be changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetApplicationDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pad</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pad</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application settings to modify.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DATATOOLARGE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
modify only the following members of the <b>DPN_APPLICATION_DESC</b> structure:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>dwMaxPlayers</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pwszSessionName</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pwszPassword</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pvApplicationReservedData</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>dwApplicationReservedDataSize</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The maximum size of the
application data that you assign to the <b>pvApplicationReservedData</b> member
of the <b>DPN_APPLICATION_DESC</b> structure is limited by the service
provider's Maximum Transmission Unit. If your application data is too large,
the method will fail and return DPNERR_DATATOOLARGE.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_CAPS *const</b> <i>pdpCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure used to set the
information about the current interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets a block of data associated
with a group, including the name of the group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Calling this method generates a <b>DPN_MSGID_GROUP_INFO</b>
message, which is sent to all the peers connected to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetGroupInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID </b>that specifies the identifier of
the group whose data block will be modified.</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that describes the
group data to set. To change the values of the <b>pwszName</b> or <b>pvData</b>
members, you must set the corresponding DPNINFO_NAME or DPNINFO_DATA flags in
the <b>dwInfoFlags</b> member.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method:</p>

<p class=Term2>DPNSETGROUPINFO_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Peer::SendTo</b> method
because of the high cost of using the <b>IDirectPlay8Peer::SetGroupInfo</b>
method.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SetPeerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the static settings of the
local peer. Call this method before connecting to relay basic player
information with the application. Once the peer successfully connects with the
application, information set through this method can be retrieved by other
players by calling the <b>IDirectPlay8Peer::GetPeerInfo</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetPeerInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure that contains the
peer information to set.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNSETPEERINFO_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and normally returns DPNSUCCESS_PENDING. It can also return one
of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called at any
time during the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Peer::SendTo</b> method
because of the high cost of using the <b>IDirectPlay8Peer::SetPeerInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the peer
information with this method after connecting to the application. Calling this
method after connection generates a <b>DPN_MSGID_PEER_INFO</b> system message
to all players, informing them that data has been updated.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT </b><b><span
style='font-family:"Times New Roman",serif'>SetSPCaps(</span></b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SP_CAPS *const</b> <i>pdpSPCaps</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to set
information about.</p>

<p class=Term1><i>pdpSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to set the information
about the specified service provider.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. Currently only the <i>dwNumThreads</i>
field can be set by this call, the <i>dwFlags</i> field must be 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Peer::TerminateSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Terminates the current Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT TerminateSession(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void </b>*<b>const</b> <i>pvTerminateData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTerminateDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvTerminateData</i></p>

<p class=Def1>Pointer to termination data. This data is also sent in the <b>pvTerminateData</b>
member of the <b>DPN_MSGID_TERMINATE_SESSION</b> system message.</p>

<p class=Term1><i>dwTerminateDataSize</i></p>

<p class=Def1>Size of data contained in the <i>pvTerminateData</i> parameter.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called only
by the host player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, the <b>DPN_MSGID_TERMINATE_SESSION</b>
will be sent to the message handler of each player in the session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8Client</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the methods of
the <b>IDirectPlay8Client</b> interface to create and manage client
applications for client/server sessions.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlay8Client</b>
interface can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHosts</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Message Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ReturnBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Client Information</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetClientInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Server Information</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServerAddress</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Cancels asynchronous requests.
Many methods of the <b>IDirectPlay8Client</b> interface run asynchronously by
default. Depending on the situation, you might want to cancel requests before
they are processed. All the methods of this interface that can be run
asynchronously return a <i>hAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>hAsyncHandle</i> of the request in this methods <i>hAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, specifying NULL in the <i>hAsyncHandle </i>parameter, and
specifying DPNCANCEL_ALL_OPERATIONS in the <i>dwFlags </i>parameter. If a
specific handle is provided to this method, no flags should be set.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CancelAsyncOperation(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const</b> <b>DPNHANDLE</b> <i>hAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. You receive this
handle when you call one of several methods that support asynchronous
operations. This value can be set to NULL to stop all requests or a particular
type of asynchronous request. If a particular handle is specified, the <i>dwFlags</i>
parameter must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request to canceled. You
can set one of the following flags.</p>

<p class=Term2>DPNCANCEL_ENUM</p>

<p class=Def2>Cancel all asynchronous <b>IDirectPlay8Client::EnumHosts</b>
requests. A single <b>EnumHosts</b> request can be canceled by specifying the
handle returned from the <b>EnumHosts</b> method.</p>

<p class=Term2>DPNCANCEL_CONNECT</p>

<p class=Def2>Cancel an asynchronous <b>IDirectPlay8Client::Connect</b>
request.</p>

<p class=Term2>DPNCANCEL_SEND</p>

<p class=Def2>Cancel an asynchronous <b>IDirectPlay8Client::Send</b> request.</p>

<p class=Term2>DPNCANCEL_ALL_OPERATIONS</p>

<p class=Def2>Cancel all asynchronous requests.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNSUCCESS_PENDING</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
cancel an asynchronous operation for the <b>IDirectPlay8Client::Connect</b>, <b>IDirectPlay8Client::Send</b>,
and <b>IDirectPlay8Client::EnumHosts</b> methods. Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not support cancellation of other asynchronous operations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a send by
providing the handle returned from <b>IDirectPlay8Client::Send</b> method. A <b>DPN_MSGID_SEND_COMPLETE</b>
system message is still posted to the applications message handler for each
asynchronous send that is sent without the DPNSEND_NOCOMPLETE flag set. Sends
that are canceled by this method return DPNERR_USERCANCEL in their <b>hResultCode</b>
member of the <b>DPN_MSGID_SEND_COMPLETE</b> message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNCANCEL_ALL_OPERATIONS, DPN_CANCELCONNECT, DPN_CANCELSEND, or DPNCANCEL_ENUM
flags in <i>dwFlags</i>, DirectPlay will attempt to cancel all matching
operations. This method will return an error if any attempted cancellation
fails, even though some cancellations may have been successful.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The completion message might not arrive until after this method
returns. Do not assume that the operation has been terminated until you have
received a <b>DPN_MSGID_SEND_COMPLETE</b>, <b>DPN_MSGID_CONNECT_COMPLETE</b>,
or <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Closes the open connection with
a session. This method must be called on any object that is successfully
initialized with a call to the <b>IDirectPlay8Client::Initialize</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Close(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Establishes the connection to
the server. After a connection is established, the communication channel on the
interface is open and the application should expect messages to arrive
immediately. No messages can be sent by means of the <b>IDirectPlay8Client::Send</b>
method until the connection has completed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before this method is called,
you can obtain an application description by calling <b>IDirectPlay8Client::EnumHosts</b>.
The <b>EnumHosts</b> method returns a <b>DPN_APPLICATION_DESC</b> structure for
each hosted application. The structure describes the application, including the
GUID of the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
asynchronously (by default), when the connection completes a <b>DPN_MSGID_CONNECT_COMPLETE</b>
message is sent to the applications message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Connect(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pdnAppDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pHostAddr</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_DESC *const</b> <i>pdnSecurity</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_CREDENTIALS
*const</b> <i>pdnCredentials</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const void *const</b> <i>pvUserConnectData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwUserConnectDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdnAppDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application. The only member of this structure that you must set is the <b>guidApplication</b>
member. Only some of the members of this structure are used by this method. The
only member that you must set is <b>guidApplication</b>. You can also set <b>guidInstance</b>,<b>
pwszPassword</b>,<b> dwFlags</b>,<b> </b>and <b>dwSize</b>.</p>

<p class=Term1><i>pHostAddr</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> interface that specifies
the addressing information to use to connect to the computer that is hosting.</p>

<p class=Term1><i>pDeviceInfo</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> object that specifies
what network adapter (for example, NIC, modem, and so on) to use to connect to
the server.</p>

<p class=Term1><i>pdnSecurity</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pdnCredentials</i></p>

<p class=Def1>Reserved. Must be NULL.</p>

<p class=Term1><i>pvUserConnectData</i></p>

<p class=Def1>Pointer to application-specific data provided to the host or
server to further validate the connection. This data is sent to the <b>DPN_MSGID_INDICATE_CONNECT</b>
message in the <b>pvUserConnectData</b> member. This parameter is optional and
you may pass NULL to bypass the connection validation provided by the user
code.</p>

<p class=Term1><i>dwUserConnectDataSize</i></p>

<p class=Def1>Variable of type <b>DWORD </b>that specifies the size of the data
contained in <i>pvUserConnectData</i>.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_CONNECT_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Client::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNCONNECT_SYNC flag in <i>dwFlags. </i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that describes the connection mode. You can set the
following flag.</p>

<p class=Term2>DPNCONNECT_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
dialog box, which queries the user for more information if not enough
information is passed in this method.</p>

<p class=Term2>DPNCONNECT_SYNC</p>

<p class=Def2>Process the connection request synchronously. Setting this flag
does not generate a <b>DPN_MSGID_CONNECT_COMPLETE</b> system message.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. If the request is processed
asynchronously, S_OK will be returned if the method is instantly processed. By
default, this method is run asynchronously and generally returns DPNSUCCESS_PENDING
or one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_HOSTREJECTEDCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDDEVICEADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHOSTADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINSTANCE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINTERFACE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPASSWORD</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SESSIONFULL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYCONNECTED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although multiple enumerations
can be run concurrently, and can be run across the duration of a connection,
only one connection is allowed per interface. To establish a connection to more
than one application, you must create another interface. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, a <b>DPN_MSGID_INDICATE_CONNECT</b>
message is posted to the servers message handler. On retrieval of this
message, the host can pass back connection reply data to the <b>Connect</b>
method. Connection reply data can send a message indicating that the host does
not approve the connection. The calling application can then handle this reply
appropriately.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The hResultCode on the
completion will indicate S_OK if the Connect() attempt was successful, or an
error otherwise. If the Host player returned anything other than S_OK from the <b>DPN_MSGID_INDICATE_CONNECT</b>
message, the likely error code in the completion will be
DPNERR_HOSTREJECTEDCONNECTION.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the connection completes, a
<b>DPN_MSGID_CONNECT_COMPLETE</b> message is sent to the applications message
handler.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To close the connection
established with this method, call the <b>IDirectPlay8Client::Close</b> method.</p>

<p class=Nh>Note</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNCONNECT_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the service provider
may attempt to display a dialog box to ask the user to complete the address
information. You must have a visible window present when the service provider
tries to display the dialog box, or your application will lock.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::EnumHosts</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates applications that
host Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> games. When an application is found that meets
the enumeration criteria, the applications message handler is called with a <b>DPN_MSGID_ENUM_HOSTS_RESPONSE</b>
system message. The message contains a <b>DPN_APPLICATION_DESC</b> structure
describing the applications found.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any number of enumerations can
be run concurrently. The <i>pvUserContext</i> value is provided in the message
handler to help differentiate replies to different enumerations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because of the variation in the
number of ways enumeration can happen, it is not recommended that an
application attempt to specify <i>dwEnumPeriod, dwRetryInterval,</i> or <i>dwTimeOut</i>
unless the application has some specific media knowledge.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The default enumeration count
and timeout values will cause <b>EnumHosts</b> to complete within a reasonable
amount of time. These values are set by the service provider, and can be
obtained by calling <b>IDirectPlay8Client::GetSPCaps</b>. Asynchronous
enumerations can be stopped at any time by calling <b>IDirectPlay8Client::CancelAsyncOperation
</b>and either passing the handle returned in the <i>pAsyncHandle </i>parameter
or setting the DPENUM_CANCEL flag in the <i>dwFlags</i> parameter. An
enumeration can also be stopped by returning anything other than S_OK from the
message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumHosts(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDPN_APPLICATION_DESC const</b> <i>pApplicationDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pdpaddrHost</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address *const</b> <i>pdpaddrDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwUserEnumDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwEnumCount</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwRetryInterval</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HANDLE *const</b> <i>pAsyncHandle,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pApplicationDesc</i></p>

<p class=Def2>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that specifies
which application hosts to enumerate. You must set the <i>pApplicationDesc</i>.dwSize
member to the appropriate value. To reduce the number of responses, set <i>pApplicationDesc</i>.guidApplication
to the GUID of the application to be found. If this member is not set, the
search will include all applications. </p>

<p class=Term1><i>pdpaddrHost</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> object that specifies
the address of the computer that is hosting the application. If you specify
NULL. DirectPlay will create an address. By default, DirectPlay will create the
address from the <i>pdpaddrDeviceInfo</i> parameter. If you set the
DPNENUMHOSTS_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the user can be
queried for address information.</p>

<p class=Term1><i>pdpaddrDeviceInfo</i></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> object that specifies
the service provider and local device settings to use when enumerating.</p>

<p class=Term1><i>pvUserEnumData</i></p>

<p class=Def1>Pointer to a block of data that is sent in the enumeration
request to the host. The size of the data is limited depending on the network
type. Call <b>IDirectPlay8Client::GetSPCaps</b> to obtain the exact value.</p>

<p class=Term1><i>dwUserEnumDataSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
pointed at in the <i>pvUserEnumData</i> parameter.</p>

<p class=Term1><i>dwEnumCount</i></p>

<p class=Def1>Value specifying how many times the enumeration data will be
sent. Set this parameter to zero to use the default value. You can obtain the
default value for <i>dwEnumCount</i> by calling <b>IDirectPlay8Client::GetSPCaps</b>.<b>
</b>If <i>dwEnumCount </i>is set to INFINITE, the enumeration will continue
until canceled.</p>

<p class=Term1><i>dwRetryInterval</i></p>

<p class=Def1>Value specifying how many milliseconds between enumeration
retries. Set this parameter to zero to use the default value. You can obtain
the default value for <i>dwRetryInterval </i>by calling <b>IDirectPlay8Client::GetSPCaps</b>.</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the number of
milliseconds that DirectPlay will wait for replies after the last enumeration
is sent. Set this parameter to zero to use the default value. You can obtain
the default value for <i>dwTimeOut </i>by<i> </i>calling <b>IDirectPlay8Client::GetSPCaps</b>
If INFINITE is specified, the enumeration continues until it is canceled. </p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Context that is provided in the clients message handler when it
is called with responses to the enumeration. This can be useful to
differentiate replies from concurrent enumerations.</p>

<p class=Term1><i>pAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Client::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNENUMHOSTS_SYNC flag in <i>dwFlags.</i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flags can be set.</p>

<p class=Term2>DPNENUMHOSTS_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Term2>DPNENUMHOSTS_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard DirectPlay dialog box,
which queries the user for more information if not enough information is passed
in this method.</p>

<p class=Term2>DPNENUMHOSTS_NOBROADCASTFALLBACK</p>

<p class=Def2>If the service provider supports broadcasting, setting this flag
will disable the broadcast capabilities. Check to see if broadcasting is
supported by examining the <b>DPN_SP_CAPS</b> structure before setting this
flag.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. If the request is processed
asynchronously, S_OK can return if the method is instantly processed. By
default, this method is run asynchronously and generally returns DPNSUCCESS_PENDING
or one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDDEVICEADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHOSTADDRESS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ENUMQUERYTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNENUMHOSTS_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the service
provider may attempt to display a dialog box to ask the user to complete the
address information. You must have a visible window present when the service
provider tries to display the dialog box, or your application will lock.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::EnumServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates the registered
service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumServiceProviders(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidServiceProvider</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_SERVICE_PROVIDER_INFO *const</b>
<i>pSPInfoBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD const</b> <i>pcbEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD const</b> <i>pcReturned</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidServiceProvider</i></p>

<p class=Def1>Pointer to a variable of type <b>GUID </b>that specifies a
service provider. This optional parameter forces the enumeration of subdevices
for the specified service provider. You should normally set this value to NULL,
to enumerate all available service providers. </p>

<p class=Term1><i>pguidApplication</i></p>

<p class=Def1>Pointer to a variable of type <b>GUID </b>that specifies an
application. If a pointer is passed in this parameter, only service providers
who can be connected to the application are enumerated. You can also pass NULL
to enumerate the registered service providers for the system.</p>

<p class=Term1><i>pSPInfoBuffer</i></p>

<p class=Def1>Pointer to an array of <b>DPN_SERVICE_PROVIDER_INFO</b>
structures that will be filled with service provider information.</p>

<p class=Term1><i>pcbEnumData</i></p>

<p class=Def1>Pointer to <b>DWORD</b>, which is filled with the size of the <i>pEnumData</i>
buffer if the buffer is too small.</p>

<p class=Term1><i>pcReturned</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of <b>DPN_SERVICE_PROVIDER_INFO</b> structures returned in the <i>pEnumData</i>
array.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPNENUMSERVICEPROVIDERS_ALL</p>

<p class=Def2>Enumerates all the registered service providers for the system,
including those that are not available to the application or do not have
devices installed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
specifying NULL in the <i>pguidServiceProvider</i> parameter to determine the
base service providers available to the system. Specific devices for a service
provider can be obtained by passing a pointer to a service provider GUID in the
<i>pguidServiceProvider</i>. This is useful, for example, when using the Modem
Connection for Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> service provider. You can choose among
different modems for dialing out and select specific modems for hosting.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the <i>pEnumData </i>buffer
is not big enough to hold the requested service provider information, the
method returns DPNERR_BUFFERTOOSMALL and the <i>cbEnumData</i> parameter
contains the required buffer size. Typically, the best strategy is to call the
method once with a zero-length buffer to determine the required size. Then call
the method again with the appropriate-sized buffer. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Normally, this method will
return only those service providers that can be used by the application. For
example, if the IPX networking protocol is not installed, DirectPlay will not
return the IPX service provider. To have DirectPlay return all service providers,
even those that cannot be used by the application, set the
DPNENUMSERVICEPROVIDERS_ALL flag in <i>dwFlags.</i></p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the full application
description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetApplicationDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_APPLICATION_DESC *const</b> <i>pAppDescBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcbDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pAppDescBuffer</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure where the
application description data is written. Set this parameter to NULL to request
only the size of data. If <i>pAppDescBuffer </i>is not set to NULL, you must
set the <i>pAppDescBuffer.</i>dwSize member to an appropriate value. The <i>pcbDataSize</i>
parameter is set to the size required to hold the data. </p>

<p class=Term1><i>pcbDataSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that is initialized to
the size of the buffer before calling this method. After the method returns,
this parameter is set to the size, in bytes, of the session data. If the buffer
is too small, this method returns the DPNERR_BUFFERTOOSMALL error value, and
this parameter is set to the buffer size required. If this parameter is NULL,
the method returns DPNERR_INVALIDPARAM. </p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
passing NULL in the <i>pvData</i> parameter to obtain the size of the required
buffer. When you call the method a second time to fill the buffer, be sure to
set the structures <b>dwSize</b> member to the appropriate value.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The returned
DPN_APPLICATION_DESC structure will have the <b>guidInstance</b>, <b>guidApplication</b>,
and <b>pwszSessionName</b> members set. It will not contain information about
other clients that are connected to the session. That information, if
available, can be obtained only from the server application. In particular, the
<b>dwCurrentPlayers</b> member will always be set to 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_CAPS *const</b> <i>pdpCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure to receive caps
information. You must set the <b>dwSize</b> member of this structure to an
appropriate value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves statistical
information about the connection between the local client and the server.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetConnectionInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_CONNECTION_INFO *const</b> <i>pdnConnectInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdnConnectInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_CONNECTION_INFO</b> structure to retrieve
information about the specified connection. You must set the <b>dwSize</b>
member of this structure to an appropriate value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Connect</b> call has completed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used by the application to
monitor the size of the send queue. Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> does not send messages faster
than the receiving computer can process them. As a result, if the sending
computer is sending faster than the receiver can receive, messages accumulate
in the senders queue. If the application registers that the send queue is
growing too large, it should decrease the rate that messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSendQueueInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumMsgs</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumBytes</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdwNumMsgs</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD </b>that contains the
number of messages currently queued. This value is optional, and may be set to
NULL.</p>

<p class=Term1><i>pdwNumBytes</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD </b>that specifies the
total number of bytes of data of the messages currently queued. This value is
optional, and may be set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the DPNGETSENDQUEUEINFO_PRIORITY_NORMAL,
DPNGETSENDQUEUEINFO_PRIORITY_HIGH, or DPNGETSENDQUEUEINFO_PRIORITY_LOW flag to
inquire about specific messages of that priority.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You cannot set both <i>pdwNumMsgs
</i>and <i>pdwNumBytes</i> to NULL. At least one of them must be set to a valid
pointer.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetServerAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the address of the
server for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetServerAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const</b> <i>ppAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>ppAddress</i></p>

<p class=Def1>Address of a pointer to an <b>IDirectPlay8Address</b> object that
specifies the address of the server. You must release this object when you no
longer need it.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetServerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the data set for the
server set by the call to the <b>IDirectPlay8Server::SetServerInfo</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetServerInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure to be filled with
the server's information. If <i>pdwSize</i> is not set to NULL, you must set <i>pdpnPlayerInfo.</i>dwSize
to the size of a <b>DPN_PLAYER_INFO</b> structure.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the size
of the data returned in the <i>pdpnPlayerInfo </i>parameter. If this value is
too small, the method returns DPNERR_BUFFERTOOSMALL, and this parameter is set
to the required size of the buffer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be set to 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after the
client receives a DPN_MSGID_SERVER_INFO message, indicating that the server has
updated its information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> returns the <b>DPN_PLAYER_INFO</b>
structure and the pointers assigned to the structures <b>pwszName</b> and <b>pvData</b>
members in a contiguous buffer. If the two pointers were set, you must have
allocated enough memory for the structure, plus the two pointers. The most
robust way to use this method is to first call it with <i>pdwSize</i> set to
NULL. When the method returns, <i>pdwSize </i>will point to the correct value.
Use that value to allocate memory for your structure and call the method a
second time to retrieve the information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the method returns, the <b>dwInfoFlags</b>
member of the <b>DPN_PLAYER_INFO</b> structure will always have the
DPNINFO_DATA and DPNINFO_NAME flags set, even if the corresponding pointers are
set to NULL. These flags are used when calling <b>IDirectPlay8Server::SetServerInfo</b>,<b>
</b>to notify DirectPlay of which values have changed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Server::SendTo</b> method
because of the high cost of using the <b>IDirectPlay8Server::SetServerInfo</b>
method.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT</b> <b>GetSPCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_SP_CAPS *const</b> <i>pdpnSPCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to get
information about.</p>

<p class=Term1><i>pdpnSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to receive the
information about the specified service provider. You must set the <i>pdpnSPCaps.</i>dwSize
member to the size of a <b>DPN_SP_CAPS</b> structure.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method retrieves
information about the specified service provider. A successful call to <b>Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers an entry point in the
clients code that receives the messages from the <b>IDirectPlay8Client</b>
interface and from the server. This method must be called before calling any
other methods of this interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PFNDPNMESSAGEHANDLER</b> <i>pfn</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the user-provided context value in calls to the
message handler. Providing a user-context value can be useful to differentiate
messages coming from multiple interfaces to a common message handler.</p>

<p class=Term1><i>pfn</i></p>

<p class=Def1>Pointer to a <b>PFNDPNMESSAGEHANDLER</b> callback function that
receives all messages from the server, and receives indications of session
changes from the <b>IDirectPlay8Client</b> interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the following flag.</p>

<p class=Term2>DPNINITIALIZE_DISABLEPARAMVAL</p>

<p class=Def2>Disable parameter validation for the current object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This is the first method you
should call after using <b>CoCreateInstance</b> to obtain the <b>IDirectPlay8Client</b>
interface.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Allows launched applications to
automatically propagate game status to the lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RegisterLobby(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE </b><i>dpnHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8LobbiedApplication
*const</b> <i>pIDP8LobbiedApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnHandle</i></p>

<p class=Def1>Connection handle used when making the calls to <b>IDirectPlay8LobbiedApplication::UpdateStatus</b>.</p>

<p class=Term1><i>pIDP8LobbiedApplication</i></p>

<p class=Def1>Pointer to the <b>IDirectPlay8LobbiedApplication</b> object that
specifies the application.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>One of the following flags:</p>

<p class=Term2>DPNLOBBY_REGISTER</p>

<p class=Def2>Registers the lobby with the application.</p>

<p class=Term2>DPNLOBBY_UNREGISTER</p>

<p class=Def2>Unregisters the lobby with the application.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::ReturnBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves message buffers
provided to the application through the <b>pReceiveData</b> member of the <b>DPN_MSGID_RECEIVE</b>
system message. If the users message handler returns DPNSUCCESS_PENDING to the
RECEIVE callback, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> assumes ownership of the buffer has been
transferred to the application, and neither frees nor modifies it until
ownership is returned to DirectPlay through this call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT ReturnBuffer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE </b><i>hBufferHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hBufferHandle</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the buffer
handle for the message. This is obtained in the <b>hBufferHandle</b> member of
the <b>DPN_MSGID_RECEIVE</b> system message.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmits data to the server.
The message can be sent synchronously or asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Send(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_BUFFER_DESC *const</b> <i>pBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>cBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pBufferDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_BUFFER_DESC</b> structure that describes the
data to send.</p>

<p class=Term1><i>cBufferDesc</i></p>

<p class=Def1>Number of <b>DPN_BUFFER_DESC</b> structures pointed to by <i>pBufferDesc</i>.
There can only be one buffer in this version of Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>.
</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to be sent. If the
message has not been sent by the <i>dwTimeOut</i> value, the message is not
sent. If you do not want a time out for message sends, set this parameter to 0.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_SEND_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Client::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNSEND_SYNC flag in <i>dwFlags. </i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
following flags. </p>

<p class=Term2>DPNSEND_SYNC</p>

<p class=Def2>Process the <b>Send</b> request synchronously.</p>

<p class=Term2>DPNSEND_NOCOPY</p>

<p class=Def2>Use the data in the <b>DPN_BUFFER_DESC</b> structure and do not
make an internal copy. This may be a more efficient method of sending data to
the server. However, it is less robust, because the sender might be able to
modify the message before the receiver has processed it. This flag cannot be combined
with DPNSEND_NOCOMPLETE.</p>

<p class=Term2>DPNSEND_NOCOMPLETE</p>

<p class=Def2>Does not send <b>DPN_MSGID_SEND_COMPLETE</b> to the message
handler. This flag may not be used with DPNSEND_NOCOPY or DPNSEND_GUARANTEED.
Additionally, when using this flag <i>pvAsyncContext</i> must be NULL.</p>

<p class=Term2>DPNSEND_COMPLETEONPROCESS</p>

<p class=Def2>Send <b>DPN_MSGID_SEND_COMPLETE</b> to the message handler when
this message has been delivered to the target and the targets message handler
returns from indicating its reception. There is additional internal message
overhead when this flag is set, and the message transmission process may become
significantly slower. If you set this flag, DPNSEND_GUARANTEED must also be
set.</p>

<p class=Term2>DPNSEND_GUARANTEED</p>

<p class=Def2>Send the message by a guaranteed method of delivery.</p>

<p class=Term2>DPNSEND_PRIORITY_HIGH</p>

<p class=Def2>Sets the priority of the message to high. This flag cannot be
used with DPNSEND_PRIORITY_LOW.</p>

<p class=Term2>DPNSEND_PRIORITY_LOW</p>

<p class=Def2>Sets the priority of the message to low. This flag cannot be used
with DPNSEND_PRIORITY_HIGH.</p>

<p class=Term2>DPNSEND_NOLOOPBACK</p>

<p class=Def2>Suppress the <b>DPN_MSGID_RECEIVE</b> system message to your
message handler if you are sending to yourself.</p>

<p class=Term2>DPNSEND_NONSEQUENTIAL</p>

<p class=Def2>If the flag is not set, messages are delivered to the target
application in the order that they are sent, which may necessitate buffering
out of sequence messages until the missing messages arrive. Messages are simply
delivered to the target application in the order that they are received.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method generates a <b>DPN_MSGID_RECEIVE</b>
system message in the servers message handler. The data buffer is contained in
the <b>pReceiveData</b> member of the associated structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages can have one of three
priorities: low, normal, and high. To specify a low or high priority for the
message, set the appropriate flag in <i>dwFlags. </i>If neither of the priority
flags is set, the message will have normal priority. See Basic Networking for a
discussion of send priorities.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the <b>Send</b> request is
completed, a <b>DPN_MSGID_SEND_COMPLETE</b> system message is posted to the
senders message handler. The success or failure of the request is contained in
the <b>hResultCode</b> member of the associate structure. You can suppress the
send completion by setting the DPN_NOCOMPLETE flag in <i>dwflags</i>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Send completions are typically
posted on the source computer as soon as the message is sent. In other words, a
send completion does not necessarily mean that the message has been processed
on the target. It may still be in a queue. If you want to be certain that the
message has been processed by the target, set the DPN_COMPLETEONPROCESS flag in
<i>dwFlags. </i>This flag ensures that the send completion will not be sent
until the targets message handler has processed the message, and returned. </p>

<p class=Nh>Note</p>

<p class=Np1>Do not assume that resources such as the data buffer will remain
valid until the method has returned. If you call this method asynchronously,
the <b>DPN_MSGID_SEND_COMPLETE</b> message may be received and processed by
your message handler before the call has returned. If your message handler
deallocates or otherwise invalidates a resource such as the data buffer, that
resource may become invalid at any time after the method has been called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_CAPS *const</b> <i>pdpCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure used to set the
information about the current interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::SetClientInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the static settings of a
client with an application. Call this method before connecting to relay basic
player information to the application. Once the client successfully connects
with the application, the server can retrieve information obtained through this
method by calling the <b>IDirectPlay8Server::GetClientInfo</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetClientInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure that contains the
client information to set.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNSETCLIENTINFO_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. If the request is processed
asynchronously, S_OK can return if the method is instantly processed. By
default, this method is run asynchronously and generally returns DPNSUCCESS_PENDING
or one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called at any
time during the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Client::Send</b> method
because of the high cost of using the <b>IDirectPlay8Client::SetClientInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the client
information with this method after connecting to the application. Calling this
method after connection generates a <b>DPN_MSGID_CLIENT_INFO</b> system message
to all players, informing them that data has been updated.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Client::SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT </b><b><span
style='font-family:"Times New Roman",serif'>SetSPCaps(</span></b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>constDPN_SP_CAPS *const</b> <i>pdpnSPCaps</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to set
information about.</p>

<p class=Term1><i>pdpnSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to set the information
about the specified service provider.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. Currently only the <i>dwNumThreads</i>
member can be set by this call; <i>dwFlags</i> must be 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8Server</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the methods of
the <b>IDirectPlay8Server</b> interface to create and manage the server for a
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> client/server transport session </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlay8Server</b>
interface can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Host</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ReturnBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SendTo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetServerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Client Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyClient</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPlayerContext</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Group Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddPlayerToGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumPlayersAndGroups</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumGroupMembers</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupContext</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RemovePlayerFromGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetLocalHostAddresses</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::AddPlayerToGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Adds a client to a group. After
the client is successfully added to the group, all messages sent to the group
are sent to the client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT AddPlayerToGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group to add the client to.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the client to add to the group.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message. This parameter
is optional and can be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNADDPLAYERTOGROUP_SYNC</p>

<p class=Def2>Causes this method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The server can add itself or a
client to an existing group. After a player is successfully added to a group,
all messages sent to the group will be received by the player.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Cancels asynchronous requests.
Many methods of the <b>IDirectPlay8Server</b> interface run asynchronously by
default. Depending on the situation, you might want to cancel requests before
they are processed. All the methods of this interface that can be run
asynchronously return an <i>hAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>hAsyncHandle</i> of the request in this methods <i>hAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, specifying NULL in the <i>hAsyncHandle </i>parameter, and
specifying DPNCANCEL_ALL_OPERATIONS in the <i>dwFlags </i>parameter. If a
specific handle is provided to this method, no flags should be set.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CancelAsyncOperation(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. This value can be
NULL to stop all requests or a particular type of asynchronous request. If a
specific handle for the request to be canceled is specified, the <i>dwFlags</i>
parameter must be 0. You will receive this handle when you call one of several
methods that support asynchronous operations.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request to cancel. You can
set one of the following flags.</p>

<p class=Term2>DPNCANCEL_SEND</p>

<p class=Def2>Cancel an asynchronous <b>IDirectPlay8Server::SendTo</b> request.</p>

<p class=Term2>DPNCANCEL_ALL_OPERATIONS</p>

<p class=Def2>Cancel all asynchronous requests.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNSUCCESS_PENDING</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
cancel an asynchronous operation for the <b>IDirectPlay8Server::SendTo </b>method.
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> 8.0 does not support cancellation of other
asynchronous operations.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a <b>Send</b>
request by providing the handle returned from <b>IDirectPlay8Server::SendTo</b>
method. A <b>DPN_MSGID_SEND_COMPLETE</b> system message is still posted to the
applications message handler for each asynchronous <b>Send</b> request that is
sent without the DPNSEND_NOCOMPLETE flag set. Send requests that are canceled
by this method return DPNERR_USERCANCEL in their <b>hResultCode</b> member of
the <b>DPN_MSGID_SEND_COMPLETE</b> message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNCANCEL_ALL_OPERATIONS or DPNCANCEL_SEND flags in <i>dwFlags</i>, DirectPlay
will attempt to cancel all matching operations. This method will return an
error if any attempted cancellation fails, even though some cancellations may
have been successful.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The completion message might not arrive until after this method
returns. Do not assume that the operation has been terminated until you have
received a <b>DPN_MSGID_SEND_COMPLETE</b>, <b>DPN_MSGID_CONNECT_COMPLETE</b>,
or <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Closes the open connection with
a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Close(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method must be called on
any object successfully initialized with <b>IDirectPlay8Server::Initialize</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is a counterpart to <b>IDirectPlay8Server::Host</b>.
It closes all active network connections hosted by the server. This method is
synchronous, and will not return until the server has processed all
DPN_MSGID_DESTROY_PLAYER messages. This feature guarantees that when <b>Close </b>returns,
you can safely shut down the server application.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::CreateGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Creates a group in the current
session. When this method is called, the servers message handler receives a
DPN_MSGID_CREATE_GROUP message.</p>

<p class=Nh>Note</p>

<p class=Np1>Multicasting is not supported for this release.</p>

<p class=Ne>&nbsp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CreateGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvGroupContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that contains the
group description.</p>

<p class=Term1><i>pvGroupContext</i></p>

<p class=Def1>Pointer to the context value for the group. This value is preset
when the local application's message handler processes the
DPN_MSGID_CREATE_GROUP message. This parameter is optional and may be set to
NULL.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNCREATEGROUP_SYNC</p>

<p class=Def2>Causes this method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or the following error
value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> does not
maintain hierarchical groups because these can easily be implemented with flat
groups and expeditious use of the group data.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::DestroyClient</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes a client from the
session. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT DestroyClient(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnidClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const VOID *const</b> <i>pDestroyInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwDestroyInfoSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnidClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the client to delete.</p>

<p class=Term1><i>pDestroyInfo</i></p>

<p class=Def1>Pointer that describes additional delete data information.</p>

<p class=Term1><i>dwDestroyInfoSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
in the <i>pDestroyInfo</i> parameter.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::DestroyGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes a group created by the <b>IDirectPlay8Server::CreateGroup</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT DestroyGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>DPNID</b> of the group to delete.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message. This parameter
is optional and may be set to NULL.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNDESTROYGROUP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::EnumPlayersAndGroups</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a list of all the
player and/or group identifiers for the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumPlayersAndGroups(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNID *const</b> <i>prgdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>prgdpnid</i></p>

<p class=Def1>Pointer to an array that will be filled with the session's group
and/or player identifiers.</p>

<p class=Term1><i>pcdpnid</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of identifiers in the <i>prgdpnid</i> parameter. If the buffer is too
small, this method returns DPNERR_BUFFERTOOSMALL and this parameter contains
the number of entries that are required.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that describes enumeration behavior. You can set one or both
of the following flags.</p>

<p class=Term2>DPNENUM_PLAYERS</p>

<p class=Def2>Return a list of player identifiers.</p>

<p class=Term2>DPNENUM_GROUPS</p>

<p class=Def2>Return a list of group identifiers.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because group and player
information changes frequently, the required buffer size returned may change
between subsequent calls. Check and reallocate the buffer until the method
succeeds.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::EnumGroupMembers</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a list of all players
in a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumGroupMembers(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNID *const</b> <i>prgdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcdpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the group that
contains the players to enumerate.</p>

<p class=Term1><i>prgdpnid</i></p>

<p class=Def1>Pointer to an array that contains the identifiers of the group's
players.</p>

<p class=Term1><i>pcdpnid</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the
number of player identifiers in the <i>prgdpnid</i> parameter. If the buffer is
too small, this method returns DPNERR_BUFFERTOOSMALL and this parameter is set
to the number of entries that are required.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::EnumServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates the registered
service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumServiceProviders(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidServiceProvider</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_SERVICE_PROVIDER_INFO *const</b>
<i>pSPInfoBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD const</b> <i>pcbEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD const</b> <i>pcReturned</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidServiceProvider</i></p>

<p class=Def1>Pointer to a variable of type GUID that specifies a service
provider. This optional parameter forces the enumeration of subdevices for the
specified service provider. You should normally set this value to NULL, to
enumerate all available service providers.</p>

<p class=Term1><i>pguidApplication</i></p>

<p class=Def1>Pointer to a variable of type GUID that specifies an application.
If a pointer is passed in this parameter, only service providers who can be
connected to the application are enumerated. You can also pass NULL to
enumerate the registered service providers for the system.</p>

<p class=Term1><i>pSPInfoBuffer</i></p>

<p class=Def1>Pointer to an array of <b>DPN_SERVICE_PROVIDER_INFO</b>
structures that will be filled with service provider information.</p>

<p class=Term1><i>pcbEnumData</i></p>

<p class=Def1>Pointer to <b>DWORD</b>, which is filled with the size of the <i>pEnumData</i>
buffer if the buffer is too small.</p>

<p class=Term1><i>pcReturned</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
number of <b>DPN_SERVICE_PROVIDER_INFO</b> structures returned in the <i>pEnumData</i>
array.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPNENUMSERVICEPROVIDERS_ALL</p>

<p class=Def2>Enumerates all the registered service providers for the system
including those that are not available to the application or do not have
devices installed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
specifying NULL in the <i>pguidServiceProvider</i> parameter to determine the
base service providers available to the system. Specific devices for a service
provider can be obtained by passing a pointer to a specific service provider
GUID in the <i>pguidServiceProvider</i>. This is useful, for example, when
using the Modem Connection for Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> service provider. You can
choose between different modems for dialing out and select specific modems for
hosting.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the <i>pEnumData </i>buffer
is not big enough to hold the requested service provider information, the
method returns DPNERR_BUFFERTOOSMALL and the <i>cbEnumData</i> parameter
contains the required buffer size. Typically, the best strategy is to call the
method once with a zero-length buffer to determine the required size. Then call
the method again with the appropriate sized buffer. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Normally, this method will
return only those service providers that can be used by the application. For
example, if the IPX networking protocol is not installed, DirectPlay will not
return the IPX service provider. To have DirectPlay return all service providers,
even those that cannot be used by the application, set the
DPNENUMSERVICEPROVIDERS_ALL flag in <i>dwFlags.</i></p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the full application
description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetApplicationDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_APPLICATION_DESC *const</b> <i>pAppDescBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcbDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pAppDescBuffer</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure where the
application description data is to be written. Set this parameter to NULL to
request only the size of data. If <i>pAppDescBuffer </i>is not set to NULL, you
must set the <i>pAppDescBuffer.</i>dwSize member to an appropriate value. The <i>pcbDataSize</i>
parameter is set to the size required to hold the data. </p>

<p class=Term1><i>pcbDataSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that is initialized to
the size of the buffer before calling this method. After the method returns,
this parameter is set to the size, in bytes, of the session data. If the buffer
is too small, this method returns the DPNERR_BUFFERTOOSMALL error value, and
this parameter is set to the buffer size required. If this parameter is NULL,
the method returns DPNERR_INVALIDPARAM. </p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method initially by
passing NULL in the <i>pvData</i> parameter to obtain the size of the required
buffer. When you call the method a second time to fill the buffer, be sure to
set the structures <b>dwSize</b> member to the appropriate value.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNCAPS *const</b> <i>pdpnCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure to receive caps
information. You must set the <b>dwSize</b> member of this structure to an
appropriate value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetClientAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the address for the
specified player in the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetClientAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID </b><i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const </b><i>pAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> specifying the identification of
the player.</p>

<p class=Term1><i>pAddress</i></p>

<p class=Def1>Address of a pointer to an <b>IDirectPlay8Address</b> object that
specifies the address of the client. You must release this object when you no
longer need it.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Use the <b>IDirectPlay8Server::GetLocalHostAddresses</b>
method to retrieve addresses that can be used to connect to the session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetClientInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the client information
set for the specified client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetClientInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the client to retrieve the information for.</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure that is filled with
client information. If <i>pdwSize</i> is not set to NULL, you must set <i>pdpnPlayerInfo.</i>dwSize
to an appropriate value.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the size
of the client data returned in the <i>pdpnPlayerInfo </i>parameter. If the
buffer is too small, this method returns DPNERR_BUFFERTOOSMALL and this
parameter contains the size of the required buffer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags describing the information returned for the client.
Currently, both of the following flags are returned.</p>

<p class=Term2>DPNINFO_NAME</p>

<p class=Def2>The <b>DPN_PLAYER_INFO</b> structure contains the name set for
the client.</p>

<p class=Term2>DPNINFO_DATA</p>

<p class=Def2>The <b>DPN_PLAYER_INFO</b> structure contains the data set for
the client.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after the
server receives a <b>DPN_MSGID_CLIENT_INFO</b> message from the application.
This message indicates that a client has updated its information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> returns the <b>DPN_PLAYER_INFO</b>
structure, and the pointers assigned to the structures <b>pwszName</b> and <b>pvData</b>
members in a contiguous buffer. If the two pointers were set, you must have
allocated enough memory for the structure, plus the two pointers. The most
robust way to use this method is to first call it with <i>pdwSize</i> set to
NULL. When the method returns, <i>pdwSize </i>will point to the correct value.
Use that value to allocate memory for the structure and call the method a
second time to retrieve the information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the method returns, the <b>dwInfoFlags</b>
member of the <b>DPN_PLAYER_INFO</b> structure will always have the
DPNINFO_DATA and DPNINFO_NAME flags set, even if the corresponding pointers are
set to NULL. These flags are used when calling <b>IDirectPlay8Client::SetClientInfo</b>,<b>
</b>to notify DirectPlay of which values have changed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>IDirectPlay8Client::Send</b> method
because of the high cost of using the <b>IDirectPlay8Client::SetPeerInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The player sets the information
by calling <b>IDirectPlay8Client::SetClientInfo</b>.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves statistical
information about the connection between the local server and the specified
remote client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetConnectionInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnidEndPoint,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_CONNECTION_INFO *const</b> <i>pdnConnectInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnidEndPoint</i></p>

<p class=Def1><b>DPNID</b> of the player whose connection information will be
retrieved.</p>

<p class=Term1><i>pdnConnectInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_CONNECTION_INFO</b> structure to retrieve
information about the specified connection. The dwSize member of this structure
must be set to the size of a <b>DPN_CONNECTION_INFO </b>structure.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Host</b> call has completed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetGroupContext</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the group context
value for a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetGroupContext(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID *const</b> <i>ppvGroupContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group to get context data for.</p>

<p class=Term1><i>ppvGroupContext</i></p>

<p class=Def1>Pointer to the context value of the group.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Group context values are set by
pointing the <b>pvGroupContext</b> member of the <b>DPN_MSGID_CREATE_GROUP</b>
system message to the context value data.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a block of data
associated with a group, including the group name.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is typically called
after a <b>DPN_MSGID_GROUP_INFO</b> system message is received, indicating that
the group data has been modified.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetGroupInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group whose data block will be retrieved.</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that describes the
group data. If pdwSize is not set to NULL, you must set <i>pdpnGroupInfo</i>.dwSize
to the size of a <b>DPN_GROUP_INFO</b> structure.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that returns the size
of the data in the <i>pdpnGroupInfo</i> parameter. If the buffer is too small,
this method returns DPNERR_BUFFERTOOSMALL and this parameter contains the
required size.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags describing the information returned for the group.
Currently, both of the following flags are returned.</p>

<p class=Term2>DPNINFO_NAME</p>

<p class=Def2>The <b>DPN_PLAYER_INFO</b> structure contains the name set for
the client.</p>

<p class=Term2>DPNINFO_DATA</p>

<p class=Def2>The <b>DPN_PLAYER_INFO</b> structure contains the data set for
the client.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> returns the <b>DPN_GROUP_INFO</b>
structure, and the pointers assigned to the structures <b>pwszName</b> and <b>pvData</b>
members in a contiguous buffer. If the two pointers were set, you must have
allocated enough memory for the structure, plus the two pointers. The most
robust way to use this method is to first call it with <i>pdwSize</i> set to
NULL. When the method returns, <i>pdwSize </i>will point to the correct value.
Use that value to allocate memory for the structure and call the method a
second time to retrieve the information.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetLocalHostAddresses</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the local addresses
being used to host the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetLocalHostAddresses(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const</b> <i>prgpAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pcAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>constDWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>prgpAddress</i></p>

<p class=Def1>Address of a pointer to an array of <b>IDirectPlay8Address</b>
objects that specify the local host addresses. You must release these objects
when you no longer need them or you will create memory leaks.</p>

<p class=Term1><i>pcAddress</i></p>

<p class=Def1>Maximum number of address objects that can be contained in the
array pointed to by <i>prgpAddress. </i>If the buffer is too small, the method
returns DPNERR_BUFFERTOOSMALL, and <i>pcAddress</i> will be set to the required
value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The most robust way to use this
method is to first call it with <i>pcAddress</i> set to 0. When the method
returns, <i>pcAddress</i> will point to the required value. You can use that
value when you call the method for a second time to retrieve the information.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetPlayerContext</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the player context
value for a client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetPlayerContext(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID *const</b> <i>ppvPlayerContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the player to get context data for.</p>

<p class=Term1><i>ppvPlayerContext</i></p>

<p class=Def1>Pointer to the context data of the client.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Player context values are set by
pointing the <b>pvPlayerContext</b> member of the <b>DPN_MSGID_CREATE_PLAYER</b>
system message to the context value data.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used by the application to
monitor the size of the send queue. Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> does not send messages faster
than the receiving computer can process them. As a result, if the sending
computer is sending faster than the receiver can receive, messages accumulate
in the senders queue. If the application registers that the send queue is
growing too large, it should slow the rate that messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSendQueueInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID </b><i>dpnid,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumMsgs</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwNumBytes</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the player to get the send-queue information for.</p>

<p class=Term1><i>pdwNumMsgs</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the
number of messages currently queued. This value is optional, and may be set to
NULL.</p>

<p class=Term1><i>pdwNumBytes</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that specifies the
total number of bytes of data of the messages currently queued. This value is
optional, and may be set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the DPNGETSENDQUEUEINFO_PRIORITY_NORMAL,
DPNGETSENDQUEUEINFO_PRIORITY_HIGH, or DPNGETSENDQUEUEINFO_PRIORITY_LOW flag to
inquire about specific messages of that priority.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You cannot set both <i>pdwNumMsgs</i>
and <i>pdwNumBytes</i> to NULL. At least one of them must be set to a valid
pointer.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT</b> <b>GetSPCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_SP_CAPS *const</b> <i>pdpnSPCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to get
information about.</p>

<p class=Term1><i>pdpnSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to receive the
information about the specified service provider. You must set the <i>pdpnSPCaps.</i>dwSize
member of this structure to an appropriate value.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method retrieves
information about the specified service provider. A successful call to <b>Initialize</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::Host</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Creates a new client/server
session, hosted by the local computer.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Host(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pdnAppDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8Address **const</b> <i>prgpDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>cDeviceInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_DESC *const</b> <i>pdpSecurity</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SECURITY_CREDENTIALS
*const</b> <i>pdpCredentials</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>VOID *const</b> <i>pvPlayerContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdnAppDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application.</p>

<p class=Term1><i>prgpDeviceInfo</i></p>

<p class=Def1>Pointer to an array of <b>IDirectPlay8Address</b> objects
containing device addresses that should be used to host the application.</p>

<p class=Term1><i>cDeviceInfo</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the number of device
address objects in the array pointed to by <i>prgpDeviceInfo</i>.</p>

<p class=Term1><i>pdpSecurity</i></p>

<p class=Def1>Reserved. Must be set to NULL.</p>

<p class=Term1><i>pdpCredentials</i></p>

<p class=Def1>Reserved. Must be set to NULL.</p>

<p class=Term1><i>pvPlayerContext</i></p>

<p class=Def1>Pointer to the context value of the player. This value is preset
when the local computer handles the <b>DPN_MSGID_CREATE_PLAYER</b> message.
This parameter is optional, and may be set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPNHOST_OKTOQUERYFORADDRESSING</p>

<p class=Def2>Setting this flag will display a standard Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
dialog box, which queries the user for more information if not enough
information is passed in this method.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DATATOOLARGE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set the
DPNHOST_OKTOQUERYFORADDRESSING flag in <i>dwFlags</i>, the service provider may
attempt to display a dialog box to ask the user to complete the address
information. You must have a visible window present when the service provider
tries to display the dialog box, or your application will lock.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The maximum size of the
application data that you assign to the <b>pvApplicationReservedData</b> member
of the <b>DPN_APPLICATION_DESC</b> structure is limited by the service
provider's Maximum Transmission Unit. If your application data is too large,
the method will fail and return DPNERR_DATATOOLARGE.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers an entry point in the
servers code that receives the messages from the <b>IDirectPlay8Server</b>
interface and from remote clients. This method must be called before calling
any other methods of this interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PFNDPNMESSAGEHANDLER</b> <i>pfn</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the user-provided context value in calls to the
message handler. Providing a user-context value is useful to differentiate
messages from multiple interfaces to a common message handler.</p>

<p class=Term1><i>pfn</i></p>

<p class=Def1>Pointer to a <b>PFNDPNMESSAGEHANDLER</b> callback function that
receives all messages from remote clients and indications of session changes
from the <b>IDirectPlay8Server</b> interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>You may specify the following flag.</p>

<p class=Term2>DPNINITIALIZE_DISABLEPARAMVAL</p>

<p class=Def2>Passing this flag will disable parameter validation for the
current object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method first after
using <b>CoCreateInstance</b> to obtain the <b>IDirectPlay8Server</b>
interface.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Allows launched applications to
automatically propagate game status to the lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RegisterLobby(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE </b><i>dpnHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IDirectPlay8LobbiedApplication
*const</b> <i>pIDP8LobbiedApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnHandle</i></p>

<p class=Def1>Connection handle used when making the calls to <b>IDirectPlay8LobbiedApplication::UpdateStatus</b>.</p>

<p class=Term1><i>pIDP8LobbiedApplication</i></p>

<p class=Def1>Pointer to the <b>IDirectPlay8LobbiedApplication</b> object that
specifies the application.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>One of the following flags.</p>

<p class=Term2>DPNLOBBY_REGISTER</p>

<p class=Def2>Registers the lobby with the application.</p>

<p class=Term2>DPNLOBBY_UNREGISTER</p>

<p class=Def2>Unregisters the lobby with the application.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::RemovePlayerFromGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Removes a client from a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RemovePlayerFromGroup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idGroup</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>idClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group to remove the client from.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the client to remove from the group.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNREMOVEPLAYERFROMGROUP_SYNC</p>

<p class=Def2>Causes this method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, the
servers message handler receives a <b>DPN_MSGID_REMOVE_PLAYER_FROM_GROUP </b>message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::ReturnBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves message buffers
provided to the application through the <b>pReceiveData</b> member of the <b>DPN_MSGID_RECEIVE</b>
system message. If the users message handler returns DPNSUCCESS_PENDING to the
RECEIVE callback, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> assumes ownership of the buffer has been
transferred to the application, and neither frees nor modifies it until
ownership is returned to DirectPlay through this call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT ReturnBuffer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hBufferHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hBufferHandle</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the buffer
handle for the message. This is obtained in the <b>hBufferHandle</b> member of
the <b>DPN_MSGID_RECEIVE</b> system message.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SendTo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmits data to a client or
group within the session. The message can be sent synchronously or
asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SendTo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_BUFFER_DESC *const</b> <i>pBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>cBufferDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void *const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Identifier of the client or group to receive data. Set this
parameter to DPNID_ALL_PLAYERS_GROUP to send a message to all players in the
session.</p>

<p class=Term1><i>pBufferDesc</i></p>

<p class=Def1>Pointer to a <b>DPN_BUFFER_DESC</b> structure that describes the
data to send.</p>

<p class=Term1><i>cBufferDesc</i></p>

<p class=Def1>Number of <b>DPN_BUFFER_DESC</b> structures pointed to by <i>pBufferDesc</i>.
There can be only one buffer in this version of Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>.
</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to be sent. If the
message has not been sent by the <i>dwTimeOut</i> value, the message is not
sent. If you do not want a time out for message sends, set this parameter to 0.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_SEND_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>.<b> </b>When the method returns, <i>phAsyncHandle</i>
will point to a handle that you can pass to <b>IDirectPlay8Server::CancelAsyncOperation</b>
to cancel the operation. This parameter must be set to NULL if you set the
DPNSEND_SYNC flag in <i>dwFlags. </i></p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
following flags.</p>

<p class=Term2>DPNSEND_SYNC</p>

<p class=Def2>Process the <b>SendTo</b> request synchronously.</p>

<p class=Term2>DPNSEND_NOCOPY</p>

<p class=Def2>Use the data in the <b>DPN_BUFFER_DESC</b> structure and do not
make an internal copy. This may be a more efficient method of sending data.
However, it is less robust because the sender might be able to modify the
message before the receiver has processed it. This flag cannot be used with
DPNSEND_NOCOMPLETE.</p>

<p class=Term2>DPNSEND_NOCOMPLETE</p>

<p class=Def2>Do not send the <b>DPN_MSGID_SEND_COMPLETE</b> structure to the
message handler. This flag may not be used with DPNSEND_NOCOPY or
DPNSEND_GUARANTEED. Additionally, when using this flag <i>pvAsyncContext</i>
must be NULL.</p>

<p class=Term2>DPNSEND_COMPLETEONPROCESS</p>

<p class=Def2>Send the <b>DPN_MSGID_SEND_COMPLETE</b> to the message handler
when this message has been delivered to the target and the targets message
handler returns from indicating its reception. There is additional internal
message overhead when this flag is set, and the message transmission process may
become significantly slower. If you set this flag, DPNSEND_GUARANTEED must also
be set.</p>

<p class=Term2>DPNSEND_GUARANTEED</p>

<p class=Def2>Send the message by a guaranteed method of delivery.</p>

<p class=Term2>DPNSEND_PRIORITY_HIGH</p>

<p class=Def2>Sets the priority of the message to high. This flag cannot be
used with DPNSEND_PRIORITY_LOW.</p>

<p class=Term2>DPNSEND_PRIORITY_LOW</p>

<p class=Def2>Sets the priority of the message to low. This flag cannot be used
with DPNSEND_PRIORITY_HIGH.</p>

<p class=Term2>DPNSEND_NOLOOPBACK</p>

<p class=Def2>Suppress the <b>DPN_MSGID_RECEIVE</b> system message to your
message handler when you are sending to a group that includes the local player.
For example, this flag is useful if you are broadcasting to the entire session.</p>

<p class=Term2>DPNSEND_NONSEQUENTIAL</p>

<p class=Def2>If this flag is set, the target application will receive the
messages in the order that they arrive at the users computer. If this flag is
not set, messages are delivered sequentially, and will be received by the
target application in the order that they were sent. Doing so may require
buffering incoming messages until missing messages arrive.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CONNECTIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method generates a <b>DPN_MSGID_RECEIVE</b>
system message in the receivers message handler. The data is contained in the <b>pReceiveData</b>
member of the associated structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Messages can have one of three
priorities: low, normal, and high. To specify a low or high priority for the
message set the appropriate flag in <i>dwFlags. </i>If neither of the priority
flags is set, the message will have normal priority. See Basic Networking for a
discussion of send priorities.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the <b>SendTo</b> request
is completed, a <b>DPN_MSGID_SEND_COMPLETE</b> system message is posted to the
senders message handler. The success or failure of the request is contained in
the <b>hResultCode</b> member of the associated structure. You can suppress the
send completion by setting the DPNSEND_NOCOMPLETE flag in <i>dwflags</i>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Send completions are typically
posted on the source computer as soon as the message is sent. In other words, a
send completion does not necessarily mean that the message has been processed
on the target. It may still be in a queue. If you want to be certain that the
message has been processed by the target, set the DPNSEND_COMPLETEONPROCESS
flag in <i>dwFlags. </i>This flag ensures that the send completion will not be
sent until the targets message handler has processed the message, and
returned. </p>

<p class=Nh>Note</p>

<p class=Np1>Do not assume that resources such as the data buffer will remain
valid until the method has returned. If you call this method asynchronously,
the <b>DPN_MSGID_SEND_COMPLETE</b> message may be received and processed by
your message handler before the call has returned. If your message handler
deallocates or otherwise invalidates a resource such as the data buffer, that
resource may become invalid at any time after the method has been called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Changes the settings for the
application that is being hosted. Only some settings can be changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetApplicationDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_APPLICATION_DESC *const</b>
<i>pad</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pad</i></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure that describes
the application settings to modify.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DATATOOLARGE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
modify only the following members of the <b>DPN_APPLICATION_DESC</b> structure:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>dwMaxPlayers</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pwszSessionName</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pwszPassword</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>pvApplicationReservedData</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>dwApplicationReservedDataSize</b></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The maximum size of the
application data that you assign to the <b>pvApplicationReservedData</b> member
of the <b>DPN_APPLICATION_DESC</b> structure is limited by the service
provider's Maximum Transmission Unit. If your application data is too large,
the method will fail and return DPNERR_DATATOOLARGE.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_CAPS</b>
structure for the current interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNCAPS *const</b> <i>pdpCaps</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_CAPS</b> structure used to set the
information about the current interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets a block of data associated
with a group, including the name of the group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetGroupInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNID</b> <i>dpnid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPN_GROUP_INFO *const</b> <i>pdpnGroupInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dpnid</i></p>

<p class=Def1>Variable of type <b>DPNID</b> that specifies the identifier of
the group whose data block will be modified.</p>

<p class=Term1><i>pdpnGroupInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_GROUP_INFO</b> structure that describes the
group data to set. To change the values of the <b>pwszName</b> or <b>pvData</b>
members of this structure, you must set the corresponding DPNINFO_NAME OR
DPNINFO_DATA flag in the <b>dwInfoFlags</b> member.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNSETGROUPINFO_SYNC</p>

<p class=Def2>Causes this method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. By default, this method is run
asynchronously and generally returns DPNSUCCESS_PENDING or one of the following
error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SetServerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the static settings of a
server with an application. After clients successfully connect to the server,
they can retrieve the information set by this method by calling the<b>IDirectPlay8Client::GetServerInfo</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetServerInfo(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_PLAYER_INFO *const</b> <i>pdpnPlayerInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID const</b> <i>pvAsyncContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phAsyncHandle</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpnPlayerInfo</i></p>

<p class=Def1>Pointer to a <b>DPN_PLAYER_INFO</b> structure that contains the
server information to set.</p>

<p class=Term1><i>pvAsyncContext</i></p>

<p class=Def1>Pointer to the user-supplied context, which is returned in the <b>pvUserContext</b>
member of the <b>DPN_MSGID_ASYNC_OP_COMPLETE</b> system message.</p>

<p class=Term1><i>phAsyncHandle</i></p>

<p class=Def1>A <b>DPNHANDLE</b>. A value will be returned. However, Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
8.0 does not permit cancellation of this operation, so the value cannot be
used.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNSETSERVERINFO_SYNC</p>

<p class=Def2>Causes this method to process synchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if this method is
processed synchronously and is successful. If the request is processed
asynchronously, S_OK can return if the method is instantly processed. By
default, this method is run asynchronously and generally returns DPNSUCCESS_PENDING
or one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called before
calling <b>IDirectPlayServer::Host</b>, and at any time during the session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Handle transmission of nonstatic
information with the <b>IDirectPlay8Server::SendTo</b> method because of the
high cost of using the <b>IDirectPlay8Server::SetServerInfo</b> method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the server
information with this method after clients have connected to the application.
Calling this method after connection generates a <b>DPN_MSGID_SERVER_INFO</b>
system message to all players, informing them that data has been updated.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Server::SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the <b>DPN_SP_CAPS</b>
structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT </b><b><span
style='font-family:"Times New Roman",serif'>SetSPCaps(</span></b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const </b><i>pguidSP</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPN_SP_CAPS *const</b> <i>pdpnSPCaps</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID specifying the service provider you want to set
information about.</p>

<p class=Term1><i>pdpnSPCaps</i></p>

<p class=Def1>Pointer to a <b>DPN_SP_CAPS</b> structure to set the information
about the specified service provider.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sets parameters for
the specified service provider. A successful call to <b>Initialize</b> must be
made before this method can be called. Currently only the <i>dwNumThreads</i>
member can be set by this call; the <i>dwFlags</i> member must be 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlayVoiceClient</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the methods of
the <b>IDirectPlayVoiceClient</b> interface to manage clients in a voice
session. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlayVoiceClient</b>
interface can be organized into the following groups. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Buffer management</b> </p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Create3DSoundBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Delete3DSoundBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous </b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionTypes</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSoundDeviceConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetNotifyMask</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session management</b> </p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Disconnect</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSessionDesc</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetTransmitTargets</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetClientConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetTransmitTargets</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Connects the client to a
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Connect(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSOUNDDEVICECONFIG</b> <i>pSoundDeviceConfig</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVCLIENTCONFIG</b> <i>pdvClientConfig</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pSoundDeviceConfig</i></p>

<p class=Def1>Pointer to a <b>DVSOUNDDEVICECONFIG</b> structure that describes
the sound device configuration.</p>

<p class=Term1><i>pdvClientConfig</i></p>

<p class=Def1>Pointer to a <b>DVCLIENTCONFIG</b> structure that describes the
general configuration of the client.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag. You can specify the following flag.</p>

<p class=Term2>DVFLAGS_SYNC</p>

<p class=Def2>The method does not return until the operation is completed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method is processed
synchronously and is successful, it returns DV_OK. By default, this method is
run asynchronously and returns DVERR_PENDING. On error, this method will return
one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_COMPRESSIONNOTSUPPORTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INCOMPATIBLEVERSION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDBUFFER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDDEVICE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_OUTOFMEMORY</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_RUNSETUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SENDERROR</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SOUNDINITFAILURE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TIMEOUT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOSESSION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_CONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOVOICESESSION</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must test the sound devices
selected for playback and capture by invoking the setup wizard before
connecting the client to the DirectPlay Voice session. On application startup,
check the audio configuration by using <b>IDirectPlayVoiceTest::CheckAudioSetup</b>.
If this method returns DVERR_RUNSETUP, the sound configuration specified has
not been tested. The setup wizard needs to be run only once for any
configuration.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you specify a buffer that is
not the right format, the method will return DVERR_INVALIDBUFFER.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer or a portion of
the buffer is locked when DirectPlay Voice attempts to write to it, the method
will return DVERR_INVALIDBUFFER, and DirectPlay Voice will disconnect from the
session. You will also receive a DVMSGID_SESSIONLOST message. The <b>hResult</b>
member of the associated structure will be set to DVERR_LOCKEDBUFFER.
Subsequent method calls will return a DVERR_NOTCONNECTED error code.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If full duplex operation is not
supported, DirectPlay Voice falls back to half duplex (listen only) mode. To
determine if you are in half-duplex mode, call <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>
after you have completed the connection. If you are in half-duplex mode, the <b>dwFlags</b>
member of the <b>DVSOUNDDEVICECONFIG</b> structure will have the
DVSOUNDCONFIG_HALFDUPLEX flag set.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Regardless of how the interfaces
are obtained, the <b>DirectPlayVoiceClient</b> object maintains a reference,
through a call to <b>AddRef</b>, to the <b>IDirectSound</b> and <b>IDirectSoundCapture</b>
interfaces it uses until <b>IDirectPlayVoiceClient::Disconnect</b> is called.
When <b>Disconnect</b> is called, the <b>DirectPlayVoiceClient</b> object calls
<b>Release</b> on both interfaces.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
synchronously by setting the DVFLAGS_SYNC flag, the <b>DVMSG_CONNECTRESULT</b>
message is not sent to the message handler. In this case, the connection result
is determined by the return value of this method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
asynchronously (by default), calling this method immediately returns a
DVERR_PENDING error value and proceeds to process the connection request in the
background. The status of the connection is not be known until the DirectPlay Voice
client generates a <b>DVMSG_CONNECTRESULT</b> message with the connection
result.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any calls to <b>IDirectPlayVoiceClient::Connect</b>
while a connection is pending return DVERR_ALREADYPENDING. Additionally, only
one connection can be pending at a time.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A transport session must be
started on the specified DirectPlay object before calling this method. A
successful call to <b>IDirectPlayVoiceClient::Initialize</b> must be made
before calling the <b>Connect</b> method.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::Create3DSoundBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a 3-D sound buffer for
a player or group. You can use the methods of the 3-D sound buffer object to
change the virtual 3-D position of incoming voice transmissions from the
specified group or player.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Create3DSoundBuffer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DVID</b> <i>dvID</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPDIRECTSOUNDBUFFER </b><i>lpdsSourceBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwPriority</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPDIRECTSOUND3DBUFFER*</b> <i>lpUserBuffer</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dvID</i></p>

<p class=Def1>Variable of type <b>DVID</b> that specifies the identification of
the player or group that the user wants to reserve a buffer for. You can also
specify DVID_REMAINING to create a 3-D user buffer for all players or groups
that do not have a user buffer. If DVID_REMAINING is specified, the <i>lpdsBufferDesc</i>
must be NULL and the <i>dwPriority</i> and <i>dwFlags</i> parameters must be
set to 0.</p>

<p class=Term1><i>lpdsSourceBuffer</i></p>

<p class=Def1>Pointer to an <b>IDirectSoundBuffer </b>interface, which is used
to create the Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice main buffer. This can be either NULL or
a user-created Microsoft DirectSound<span style='font-size:7.0pt'></span>
buffer. If this member is set to NULL, then DirectPlay Voice creates a buffer
for you.</p>

<p class=Term1><i>dwPriority</i></p>

<p class=Def1>Direct pass-through. This value is passed in the <i>dwPriority </i>parameter
when the call to <b>IDirectSoundBuffer::Play</b> is made. For more information,
see <b>IDirectSoundBuffer8::Play</b>. This parameter must be 0 if <i>lpdsMainBufferDesc
</i>is NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Direct pass-through. This value is passed to the <i>dwFlags </i>parameter
when the call to <b>IDirectSoundBuffer::Play</b><i> </i>is made. For more
information, see <b>IDirectSoundBuffer8::Play</b>. This parameter must be 0 if <i>lpdsMainBufferDesc</i>
is NULL.</p>

<p class=Term1><i>lpUserBuffer</i></p>

<p class=Def1>Pointer to memory where the reserved buffer is placed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_OUTOFMEMORY</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DirectPlay voice session
is a mixing server session, this method fails and returns DVERR_NOTALLOWED. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although you can access all the
member functions of the 3-D sound buffer object, because the DirectPlay voice
client uses the buffer to stream incoming audio, do not use the <b>Lock</b>, <b>UnLock</b>,
or <b>Play</b> methods of the DirectSound3DBuffer object.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the user specifies a buffer,
DirectPlay uses that buffer for the player's or group's buffer. User-created
buffers have the following restrictions.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The buffer must be 22 kilohertz,
16-bit, Mono format.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The buffer must be at least 1
second in length.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The buffer must have been
created with the DSBCAPS_GETCURRENTPOSITION2 and DSBCAPS_CTRL3D flags.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The buffer must not be a primary
buffer.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The buffer must not be playing
when it is passed to DirectPlay.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer is not the right
format, the method will return DVERR_INVALIDBUFFER.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The buffer must not be locked
when you pass it to DirectPlay. When the buffer for the individual user is no
longer required or when a player leaves the voice session, it is important to
call <b>IDirectPlayVoiceClient::Delete3DSoundBuffer</b> to free up resources. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer or a portion of
the buffer is locked when DirectPlay Voice attempts to write to it, the method
will return DVERR_INVALIDBUFFER. If you lock the buffer after the method has
returned, you will receive a DVMSGID_SESSIONLOST message. The <b>hResult</b>
member of the associated structure will be set to DVERR_LOCKEDBUFFER.
Subsequent method calls will return a DVERR_NOTCONNECTED error code.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::Delete3DSoundBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns exclusive control of the
3-D sound buffer object to the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> voice client object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Delete3DSoundBuffer(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DVID </b><i>dvID</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPDIRECTSOUND3DBUFFER*</b> <i>lpUserBuffer</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dvID</i></p>

<p class=Def1>DVID of the player or group that the user wants to delete a
buffer for.</p>

<p class=Term1><i>lpUserBuffer</i></p>

<p class=Def1>Pointer to the user buffer to delete. This must be a user buffer
obtained through the <b>IDirectPlayVoiceClient::Create3DSoundBuffer</b> method.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DirectPlay Voice session
is a mixing server session, this method fails and returns DVERR_NOTALLOWED. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::Disconnect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Disconnects the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice client from the existing DirectPlay Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Disconnect(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag. You can specify the following flag.</p>

<p class=Def1>DVFLAGS_SYNC</p>

<p class=Def1>Do not return until the operation is completed.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_CONNECTABORTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_PENDING </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TIMEOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>On calling this method, all
recording and playback is stopped. If a connection is being processed, it is
canceled by this call.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unless the DVFLAGS_SYNC is
specified, calling this method immediately returns a DVERR_PENDING error value
and proceeds to process the disconnection request in the background. The status
of the disconnection is not known until the DirectPlay Voice client generates a
<b>DVMSG_DISCONNECTRESULT</b> message that contains the disconnection result.
Only one disconnection can be pending at a time. If you call <b>IDirectPlayVoiceClient::Disconnect</b>
while a disconnect is pending, DirectPlay will return a DVERR_ALREADYPENDING error
value. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
synchronously by setting the DVFLAGS_SYNC flag, the method does not return
until the <b>Disconnect</b> method completes. The result of the disconnection
is the return value from this method. No <b>DVMSGID_DISCONNECTRESULT</b>
message is generated.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice capabilities.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVCAPS</b> <i>pCaps</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pCaps</i></p>

<p class=Def1>Pointer to the <b>DVCAPS</b> structure that contains the
capabilities of the DirectPlayVoiceClient object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetClientConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the client
configuration.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetClientConfig(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVCLIENTCONFIG</b> <i>pClientConfig</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pClientConfig</i></p>

<p class=Def1>Pointer to a <b>DVCLIENTCONFIG</b> structure that contains the
configuration of the local client.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before calling this member, you
must set the <b>dwSize</b> member of the <b>DVCLIENTCONFIG</b> structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetCompressionTypes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the available
compression types on the system.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCompressionTypes(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID </b><i>pData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD </b><i>pdwDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumElements</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pData</i></p>

<p class=Def1>Pointer to buffer that receives an array of <b>DVCOMPRESSIONINFO</b>
structures, one structure for every compression type supported through this
object.</p>

<p class=Term1><i>pdwDataSize</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> that contains the size of the buffer,
in bytes, passed in the <i>pData</i> parameter.</p>

<p class=Term1><i>pdwNumElements</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> where the method writes the number of
elements returned in the array of <b>DVCOMPRESSIONINFO</b> structures. This
contains the number of structures only if the buffer specified in the <i>pData</i>
is large enough to hold the information.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DP_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer passed is not
large enough to store the list of compression types, the method returns
DVERR_BUFFERTOOSMALL and the <i>pdwDataSize </i>parameter is set to the minimum
required size. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the session
properties.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSessionDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSESSIONDESC</b> <i>pvSessionDesc</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvSessionDesc</i></p>

<p class=Def1>Pointer to a <b>DVSESSIONDESC</b> structure to receive the
session description. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before calling this method, make
sure to set the <b>dwSize</b> member of the <b>DVSESSIONDESC</b> structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetSoundDeviceConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the sound device
configuration of the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSoundDeviceConfig(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSOUNDDEVICECONFIG </b><i>pSoundDeviceConfig</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwSize</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pSoundDeviceConfig</i></p>

<p class=Def1>Pointer to a <b>DVSOUNDDEVICECONFIG</b> structure that is filled
with the configuration of the sound device.</p>

<p class=Term1><i>pdwSize</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> that specifies the size of the buffer
in <i>pSoundDeviceConfig</i> parameter. If the buffer is too small, the method
returns DVERR_BUFFERTOOSMALL and this parameter contains the size of the
required buffer.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::GetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the transmit targets,
if any, of the voice stream from this client. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetTransmitTargets(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVID</b> <i>pdvIDTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdvIDTargets</i></p>

<p class=Def1>Member to fill with an array of DVIDs that specify the targets
that were set by the <b>IDirectPlayVoiceClient::SetTransmitTargets</b> or <b>IDirectPlayVoiceServer::SetTransmitTargets</b>
method. You can retrieve the number of targets by specifying NULL for this
parameter. </p>

<p class=Term1><i>pdwNumTargets</i></p>

<p class=Def1>Number of DVIDs in the array. When you call this method, this
should be the same value as the number of targets set in the <b>IDirectPlayVoiceClient::SetTransmitTargets</b>
method. If the call is successful, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> returns the number of elements
written to the <i>pdvIDTargets</i> array.</p>

<p class=Def1>If <i>pdvIDTargets</i> is NULL, this must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFfERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The value returned in the <i>pdvIDTargets</i>
parameter can be player or group DVIDs or the DVID_ALLPLAYERS constant.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer specified in <i>pdvIDTargets</i>
is not large enough to store the list of targets, this method returns
DVERR_INVALIDPOINTER and <i>pdwNumTargets</i> is set to the required number of
elements.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If there is no target specified,
<i>pdwNumTargets</i> is set to 0 and the return value is DV_OK.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Initializes the
DirectPlayVoiceClient object by associating it with a DirectPlay object.
Additionally, this method registers a message handler with the
DirectPlayVoiceClient object.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method must be called
successfully before <b>IDirectPlayVoiceClient::Connect</b> method is called.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID</b> <i>pVoid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVMESSAGEHANDLER</b> <i>pMessageHandler</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID</b> <i>pUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwMessageMask</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwMessageMaskElements</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pVoid</i></p>

<p class=Def1>Pointer to the <b>IUnknown</b> interface for the DirectPlay
object that this DirectPlayVoiceClient object should use.</p>

<p class=Term1><i>pMessageHandler</i></p>

<p class=Def1>User-defined callback function that is called when there is a
DirectPlayVoiceClient message to be processed. Threads within the
DirectPlayVoiceClient object call the callback function, so it will not be
called in the context of your processs main thread.</p>

<p class=Term1><i>pUserContext</i></p>

<p class=Def1>Pointer to an application-defined structure that is passed to the
callback function each time the function is called.</p>

<p class=Term1><i>pdwMessageMask</i></p>

<p class=Def1>Array of <b>DWORD</b>s that contain the message identifiers that
you want DirectPlay Voice to send to your callback function. If a message
identifier is not specified in this array, it is not sent. Each message
identifier should appear only once in the array and only valid message
identifiers are allowed. For example, DVMSGID_CONNECTRESULT is not valid for
the server interface, but is for the client interface. To enable all messages,
specify NULL for this value.</p>

<p class=Term1><i>dwMessageMaskElements</i></p>

<p class=Def1>Number of elements specified in the <i>pdwMessageMask</i>
parameter. If <i>pdwMessageMask</i> is NULL, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_GENERIC</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOTINIT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call <b>IDirectPlayVoiceClient::SetNotifyMask</b>
to change the notify mask during the course of the voice session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::SetClientConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the client configuration.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetClientConfig(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVCLIENTCONFIG</b> <i>pClientConfig</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pClientConfig</i></p>

<p class=Def1>Pointer to the <b>DVCLIENTCONFIG</b> structure that contains the
configuration description to set.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Calling this method sets all the
parameters in the <b>DVCLIENTCONFIG</b> structure. Therefore, to leave a
setting unmodified, you must retrieve the current configuration with <b>IDirectPlayVoiceClient::GetClientConfig</b>.
Then modify the parameters to change and call <b>IDirectPlayVoiceClient::SetClientConfig</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the session is running in
half duplex, the members of <b>GetClientConfig</b> related to recording are
ignored. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::SetNotifyMask</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specifies which messages are
sent to the message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetNotifyMask(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwMessageMask</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwMessageMaskElements</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdwMessageMask</i></p>

<p class=Def1>Pointer to an array of <b>DWORD</b>s containing the message
identifiers that you want Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice to send to your callback
function. If a message identifier is not specified in this array, it is not
sent. Each message identifier should appear only once in the array, and only
valid message identifiers are allowed. For example, DVMSGID_CONNECTRESULT is
not valid for the server interface, but is for the client interface. To enable
all messages, specify NULL for this value.</p>

<p class=Term1><i>dwMessageMaskElements</i></p>

<p class=Def1>Number of elements specified in the <i>pdwMessageMask</i>
parameter. If <i>pdwMessageMask</i> is NULL, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceClient::SetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specifies which players and/or
groups receive audio transmissions from the local client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetTransmitTargets(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVID</b> <i>pdvIDTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwNumTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdvIDTargets</i></p>

<p class=Def1>Pointer an array of DVIDs that specify your targets. To specify
no targets, pass NULL for this parameter. Additionally, this parameter can be
set to the following value.</p>

<p class=Term2>DVID_ALLPLAYERS</p>

<p class=Def2>The client is targeting all players in the session. This must be
the only element in the array.</p>

<p class=Term1><i>dwNumTargets</i></p>

<p class=Def1>Number of DVIDs in the array. This value cannot exceed 64. If <i>pdvIDTargets</i>
is NULL, this must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDTARGET</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For Microsoft<span
style='font-size:7.0pt'></span> DirectX<span style='font-size:7.0pt'></span>
8.0, the number of individual targets that you can transmit to is limited to
64. If you exceed this value, the method will fail, and return
DVERR_NOTALLOWED. However, you can transmit to more than 64 players. To do so,
form the players into groups, and then use the group as your target.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <i>pdvIDTargets</i>
parameter specifies an array of player and/or group DVIDs. There must be no
duplicate targets in this parameter, and all entries must be valid DVIDs. If a
target contains a player as its individual DVID and through a group that the
target belongs to, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice ensures duplicate speech packets are not
sent to the player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the session was created with
the DVSESSION_SERVERCONTROLTARGET flag, only the server can set the targets for
this local client. A call to this method returns DVERR_NOTALLOWED.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlayVoiceServer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the methods of
the <b>IDirectPlayVoiceServer</b> interface to manage the host of the voice
session. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlayVoiceServer</b>
interface can be organized into the following groups. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous </b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionTypes</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>&nbsp;</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetNotifyMask</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session management</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSessionDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetTransmitTargets</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSessionDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetTransmitTargets</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StartSession</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StopSession</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the capabilities of
the Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice server for this system.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCaps(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVCAPS</b> <i>pDVCaps</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pDVCaps</i></p>

<p class=Def1>Pointer to the <b>DVCAPS</b> structure that contains the
capabilities of the DirectPlayVoiceServer object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::GetCompressionTypes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves available compression
types for the system.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetCompressionTypes(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID</b> <i>pData,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwDataSize,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD </b><i>pdwNumElements,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pData</i></p>

<p class=Def1>Pointer to the buffer that receives an array of <b>DVCOMPRESSIONINFO</b>
structures that describe the compression types supported by this object. </p>

<p class=Term1><i>pdwDataSize</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> that contains the size of the buffer,
in bytes, passed in the <i>pData </i>parameter.</p>

<p class=Term1><i>pdwNumElements</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> where the method writes the number of
elements returned in the array of <b>DVCOMPRESSIONINFO</b> structures.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer is not large
enough to store the list of compression types, the method returns
DVERR_BUFFERTOOSMALL and the <i>pdwDataSize </i>parameter is set to the minimum
required size. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::GetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session settings.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSessionDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSESSIONDESC</b> <i>pvSessionDesc</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvSessionDesc</i></p>

<p class=Def1>Pointer to a <b>DVSESSIONDESC</b> structure to receive the
session description. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTHOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before calling this method, make
sure to set the <b>dwSize</b> member of the <b>DVSESSIONDESC</b> structure.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>IDirectPlayVoiceServer::StartSession</b>
must be made before this method can be called.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::GetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the transmit targets,
if any, of the voice stream for a player in a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetTransmitTargets(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DVID</b> <i>dvSource</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVID</b> <i>pdvIDTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dvSource</i></p>

<p class=Def1>DVID of the user or group whose target is returned.</p>

<p class=Term1><i>pdvIDTargets</i></p>

<p class=Def1>Array of DVIDs that specify the current targets of the player or
group that were set by the <b>IDirectPlayVoiceServer::SetTransmitTargets</b>
method. You can retrieve the number of targets by specifying NULL for this
parameter. </p>

<p class=Term1><i>pdwNumTargets</i></p>

<p class=Def1>Number of DVIDs in the array. When you call this method, this
should be the same value as the number of targets set in the <b>IDirectPlayVoiceServer::SetTransmitTargets</b>
method. If the call is successful, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> returns the number of elements
in the <i>pdvIDTargets</i> array.</p>

<p class=Def1>If <i>pdvIDTargets</i> is NULL, this must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be used only if
the DVSESSION_SERVERCONTROLTARGET flag is specified on creation of the
DirectPlay Voice session. If the flag is not specified, this method returns DVERR_NOTALLOWED.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Initializes the
DirectPlayVoiceServer object by associating it with a DirectPlay object.
Additionally, this method registers a message handler with this interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPVOID</b> <i>lpVoid</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVMESSAGEHANDLER</b> <i>pMessageHandler</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PVOID</b> <i>pUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPDWORD</b> <i>lpdwMessageMask</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwMessageMaskElements</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>lpVoid</i></p>

<p class=Def1>Pointer to the <b>IUnknown</b> interface for the DirectPlay
object that this DirectPlayVoiceServer object should use.</p>

<p class=Term1><i>pMessageHandler</i></p>

<p class=Def1>User-defined callback function that is called when there is a
DirectPlayVoiceClient message to process. A thread within the
DirectPlayVoiceClient object calls the callback function, so it is not called
in the context of your processs main thread.</p>

<p class=Term1><i>pUserContext</i></p>

<p class=Def1>Pointer to an application-defined structure that is passed to the
callback function each time the method is called.</p>

<p class=Term1><i>lpdwMessageMask</i></p>

<p class=Def1>Array of <b>DWORD</b>s that contain the message identifiers that
you want DirectPlay Voice to send to your callback function. If a message
identifier is not specified in this array, it is not sent. Each message
identifier should appear only once in the array, and only valid message
identifiers are allowed. For example, DVMSGID_CONNECTRESULT is not valid for
the server interface but is for the client interface. To enable all messages, specify
NULL for this value.</p>

<p class=Term1><i>dwMessageMaskElements</i></p>

<p class=Def1>Number of elements specified in the <i>lpdwMessageMask</i>
parameter. If <i>lpdwMessageMask</i> is NULL, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_GENERIC</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOTINIT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call <b>IDirectPlayVoiceServer::SetNotifyMask</b>
to change the notify mask during the course of the voice session.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::SetNotifyMask</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specifies which messages are
sent to the message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetNotifyMask(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwMessageMask</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwMessageMaskElements</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdwMessageMask</i></p>

<p class=Def1>Pointer to an array of <b>DWORD</b>s that contain the message
identifiers that you want Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice to send to your callback
function. If a message identifier is not specified in this array, it is not
sent. Each message identifier should appear only once in the array, and only
valid message identifiers are allowed. For example, DVMSGID_CONNECTRESULT is
not valid for the server interface but is for the client interface. To enable
all messages, specify NULL for this value.</p>

<p class=Term1><i>dwMessageMaskElements</i></p>

<p class=Def1>Number of elements specified in the <i>pdwMessageMask</i>
parameter. If <i>pdwMessageMask</i> is NULL, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::SetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the session settings.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetSessionDesc(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSESSIONDESC</b> <i>pSessionDesc</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pSessionDesc</i></p>

<p class=Def1>Pointer to a <b>DVSESSIONDESC</b> structure that contains the
session description.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTHOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>After the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
voice session has started, not all the session properties of the <b>DVSESSIONDESC</b>
structure can be changed. For more information, see <b>DVSESSIONDESC</b>.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::SetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Controls the transmission of
audio from the client to the specified members of the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetTransmitTargets(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DVID </b><i>dvSource</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVID</b> <i>pdvIDTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwNumTargets</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dvSource</i></p>

<p class=Def1>DVID of the user whose targets are set.</p>

<p class=Term1><i>pdvIDTargets</i></p>

<p class=Def1>List of player DVIDs and/or group DVIDs that are the target for
audio transmission. To specify no targets, pass NULL for this parameter.
Additionally, this parameter can be set to the following value.</p>

<p class=Term2>DVID_ALLPLAYERS</p>

<p class=Def2>This client is targeting all players in the session. This must be
the only element in the array.</p>

<p class=Term1><i>dwNumTargets</i></p>

<p class=Def1>Number of DVIDs in the array. This value cannot exceed 64. If <i>pdvIDTargets</i>
is NULL this must be 0.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDTARGET</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For Microsoft<span
style='font-size:7.0pt'></span> DirectX<span style='font-size:7.0pt'></span>
8.0, the number of individual targets that you can transmit to is limited to
64. If you exceed this value, the method will fail, and return
DVERR_NOTALLOWED. However, you can transmit to more than 64 players. To do so,
form the players into groups, and then use the group as your target.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There must be no duplicate
targets in this parameter, and all entries must be valid DVIDs. If a target
contains a player as its individual DVID and through a group that the target
belongs to, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice ensures duplicate speech packets are not
sent to the player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be used only if
the DVSESSION_SERVERCONTROLTARGET flag is specified on creation of the
DirectPlay Voice session. If the flag is not specified, this method returns
DVERR_NOTALLOWED.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::StartSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Starts an initialized Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session within a running DirectPlay transport session. This method must
be successfully called before the clients can complete a
connection-to-the-voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT StartSession(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDVSESSIONDESC</b> <i>pSessionDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pSessionDesc</i></p>

<p class=Def1>Pointer to a <b>DVSESSIONDESC</b> structure that contains the
session description.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_HOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlayVoiceServer::Initialize</b>
method must be called before this method is called. The voice session can be
hosted on any client in the session if the voice session is peer-to-peer. If
the voice session is not peer-to-peer, it must be hosted on the transport
client, which is the host of a active transport session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVSESSIONDESC</b>
structure contains the type of voice session to start. The type of voice
session can have a dramatic effect on the CPU and bandwidth usage for both the
client and the server. You can set the <b>guidCT</b> member of <b>DVSESSIONDESC</b>
to DPVCTGUID_DEFAULT. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceServer::StopSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Stops the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT StopSession(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flag. The following flag can be set.</p>

<p class=Term2>DVFLAGS_NOHOSTMIGRATE</p>

<p class=Def2>The host will not migrate regardless of session and transport
settings. Use this flag when you want to shut down the voice session
completely.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTHOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method returns
DVERR_ALREADYPENDING if it is called while another thread is processing a <b>StopSession</b>
request.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlayVoiceTest</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Applications use the <b>CheckAudioSetup</b>
method of the <b>IDirectPlayVoiceTest</b> interface to test the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice audio configuration. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Audio Configuration</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CheckAudioSetup</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlayVoiceTest::CheckAudioSetup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Runs the Audio Setup Wizard on
the specified devices. This wizard runs a series of tests on the devices to
determine if they are capable of full duplex audio and to ensure that the
microphone is plugged in and working correctly on the capture device.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT CheckAudioSetup(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *</b> <i>pguidPlaybackDevice</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *</b> <i>pguidCaptureDevice</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HWND</b> <i>hwndParent</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidPlaybackDevice</i></p>

<p class=Def1>Pointer to the GUID that identifies the playback device to test.
If NULL is passed for this parameter, Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice tests the system default
playback device defined by Microsoft<span style='font-size:7.0pt'></span>
DirectSound<span style='font-size:7.0pt'></span>. You can also pass one of the
DirectSound default GUIDs:</p>

<p class=Term2>DSDEVID_DefaultPlayback </p>

<p class=Def2>The system default playback device. </p>

<p class=Term2>DSDEVID_DefaultVoicePlayback </p>

<p class=Def2>The default voice playback device. </p>

<p class=Term1>&nbsp;</p>

<p class=Term1><i>pguidCaptureDevice</i></p>

<p class=Def1>Pointer to the GUID that identifies the capture device to test.
If NULL is passed for this parameter, DirectPlay Voice tests the system default
capture device defined by DirectSound. You can also pass one of the DirectSound
default GUIDs:</p>

<p class=Term2>DSDEVID_DefaultCapture </p>

<p class=Def2>The default system capture device. You can also specify this
device by passing a NULL pointer in the device GUID parameter. </p>

<p class=Term2>DSDEVID_DefaultVoiceCapture </p>

<p class=Def2>The default voice communications capture device. Typically, this
is a secondary device such as a USB headset with microphone. </p>

<p class=Term1><i>hwndParent</i></p>

<p class=Def1>The test wizard invoked by this method is modal. If the calling
application has a window that should be the parent window of the wizard, it
should pass a handle to that window in this parameter. If the calling
application does not have a window, it can pass NULL. If the DVFLAGS_QUERYONLY
flag is specified, this parameter is not used and the application can pass
NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Flags. The following flags can be set.</p>

<p class=Term2>DVFLAGS_QUERYONLY</p>

<p class=Def2>Audio setup is not run. Instead, the method checks the registry
to see if the devices have been tested. If the devices have not been tested,
the method returns DVERR_RUNSETUP. If the devices have been tested, the method
returns DV_FULLDUPLEX if the devices support full duplex audio, or
DV_HALFDUPLEX if the devices do not support full duplex audio.</p>

<p class=Term2>DVFLAGS_ALLOWBACK</p>

<p class=Def2>Passing this flag enables the <b>Back</b> button on the wizards
Welcome page. If the user clicks the <b>Back</b> button on the Welcome page,
the wizard exits, and <b>CheckAudioSetup</b> returns DVERR_USERBACK.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns DV_OK, DV_FULLDUPLEX,
DV_HALFDUPLEX if successful, or one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_RUNSETUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDDEVICE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method contains user interface
(UI) elements and displays dialog boxes. If the DVFLAGS_QUERYONLY flag is
specified, the tests are not actually run and no UI is raised. Instead, the
registry is checked to determine the results of a previous test of these
devices.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the user cancels the wizard,
the <b>CheckAudioSetup</b> call returns DVERR_USERCANCEL. The calling
application can then handle the situation appropriately. For example, in
DirectPlay Voice part of the gaming options control panel application, if the
user clicks <b>Cancel</b>, the dialog box displays a message indicating that
voice cannot be used because the wizard has been canceled.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method might return
DVERR_INVALIDDEVICE if the device specified does not exist. Also, if you
specify the default device and this method still returns this error, then there
are no sound devices on the system.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8LobbyClient</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8LobbyClient</b>
interface is used by a lobby client application and is responsible for
enumerating and launching lobby-enabled game applications on the local
computer, and communicating with them once they are running. The lobby client
must register a message handler routine to process messages from the lobby and
the lobbied game application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlay8LobbyClient</b>
interface are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8LobbyClient Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ConnectApplication</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumLocalPrograms</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ReleaseApplication</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetConnectionSettings</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Close(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::ConnectApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Connects a lobby-enabled
application to the session specified in the <b>DPL_CONNECT_INFO</b> structure.
If the application is not running, this method can be used to launch the
application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the connection is
successfully established, the lobbied application generates a <b>DPL_MSGID_CONNECT</b>
system message to the message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT ConnectApplication(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPL_CONNECT_INFO *const</b> <i>pdplConnectionInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PVOID</b> <i>pvUserApplicationContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>phApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwTimeOut</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdplConnectionInfo</i></p>

<p class=Def1>Pointer to a <b>DPL_CONNECT_INFO</b> structure, which describes
the connection parameters, including the GUID of the application to connect to.</p>

<p class=Term1><i>pvUserApplicationContext</i></p>

<p class=Def1>Pointer to a context value defined for the lobby client that is
passed in calls to the lobby clients message handler.</p>

<p class=Term1><i>phApplication</i></p>

<p class=Def1>Pointer to a <b>DPNHANDLE</b> that specifies the application
connect handle that is set if this method succeeds. This handle is used for
further communication with the application. Additionally, this handle is used
in the <i>phApplication</i> parameter in the <b>IDirectPlay8LobbyClient::ReleaseApplication</b>
method.</p>

<p class=Term1><i>dwTimeOut</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the number of
milliseconds to wait for the connection to process.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANTLAUNCHAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::EnumLocalPrograms</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Enumerates the lobbied
applications that are registered on the system.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT EnumLocalPrograms(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GUID *const</b> <i>pGuidApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>BYTE *const</b> <i><span
style='font-family:"Times New Roman",serif'>pEnumData</span></i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwEnumData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD *const</b> <i>pdwItems.</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pGuidApplication</i></p>

<p class=Def1>Pointer to a variable of type <b>GUID</b> that specifies the
lobbied application to enumerate. This parameter is optional, and passing NULL
enumerates all available lobbied applications.</p>

<p class=Term1><i>pEnumData</i></p>

<p class=Def1>Pointer to a variable of type <b>BYTE</b>, which is filled with a
description of the lobbied application.</p>

<p class=Term1><i>pdwEnumData</i></p>

<p class=Def1>Pointer to variable of type <b>DWORD</b> that specifies the
number of bytes contained in the <i>pEnumData</i> buffer. If the buffer in <i>pEnumData</i>
is too small, this method returns DPNERR_BUFFERTOOSMALL and sets this parameter
to the size of the required buffer.</p>

<p class=Term1><i>pdwItems</i></p>

<p class=Def1>Pointer to a variable of type <b>DWORD</b> that contains the
number of <b>DPL_APPLICATION_INFO</b> structures in the <i>pEnumData</i>
buffer. This parameter is filled only if the method succeeds.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is generally called
twiceonce to obtain the size of the required buffer, and then with the correct
buffer size.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers an entry point in the lobby
clients code that receives notifications on changes of state for any launched
applications. The message handler also receives messages from the lobbied
application. This method must be called before calling any other methods of
this interface.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PVOID</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PFNDPNMESSAGEHANDLER</b> <i>pfn</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the user-provided context value provided in calls to
the message handler. Providing a user-context value is useful to differentiate
messages from multiple interfaces to a common message handler.</p>

<p class=Term1><i>pfn</i></p>

<p class=Def1>Pointer to a <b>PFNDPNMESSAGEHANDLER</b> callback function that
receives all messages from the <b>IDirectPlay8LobbyClient</b> interface and
indications of session changes from the <b>IDirectPlay8LobbiedApplication</b>
interface.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPLINITIALIZE_DISABLEPARAMVAL</p>

<p class=Def2>Disables parameter validation.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this is method first after
using <b>CoCreateInstance</b> to obtain the <b>IDirectPlay8LobbyClient</b>
interface.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::ReleaseApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Releases a lobbied application
and closes the connection between the lobby client and the application. This
method should be called whenever a lobby client has finished its session with
an application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT ReleaseApplication(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hApplication.</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b><i> dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hApplication</i></p>

<p class=Def1>The <b>DPNHANDLE</b> of the lobbied application to release. This
value is set in the <i>phApplication</i> parameter of the <b>IDirectPlay8LobbyClient::ConnectApplication</b>
method. You may also specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>All application connections will be released.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sends a message to a lobbied
application that was launched by this lobby client or was connected by this
lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method sends a <b>DPL_MSGID_RECEIVE</b>
system message to the targets message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Send(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>BYTE *const</b> <i>pBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>pBufferSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the target for
the message transmission. You may also specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>The message you have specified will be sent to all lobbied
applications that are connected to your lobby client application.</p>

<p class=Term1><i>pBuffer</i></p>

<p class=Def1>Pointer to an array of bytes that contains the message.</p>

<p class=Term1><i>pBufferSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the
message buffer in the <i>pBuffer</i> parameter, in bytes. This parameter must
be at least 1 byte and no more than 64 KB.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SENDTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer size is larger
than 64 KB, the method returns DPNERR_SENDTOOLARGE. If the buffer size is set
to 0, the method returns DPNERR_INVALIDPARAM.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::GetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the set of connection
settings for the specified connection. These settings can be set through a call
to the <b>IDirectPlay8LobbyClient::ConnectApplication</b>, <b>IDirectPlay8LobbyClient::SetConnectionSettings</b>,
or <b>IDirectPlay8LobbiedApplication::SetConnectionSettings</b> method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you get connection
settings, a reference will be added for each address object that is returned to
the user. Therefore, users must be sure to call <b>Release</b> on each address
object when they are finished with the structure.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetConnectionSettings(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPL_CONNECTION_SETTINGS *const</b> <i>pdplConnectSettings</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD*</b><i>pdwDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Handle to the connection for which to retrieve the settings.</p>

<p class=Term1><i>pdplConnectSettings</i></p>

<p class=Def1>Pointer to a buffer to receive the connection settings for the
specified connection.</p>

<p class=Term1><i>pdwDataSize</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> containing the size, in bytes, of the
buffer specified in the <i>pdplConnectSettings</i> structure. If the buffer is
not large enough to hold the connection settings, DPNERR_BUFFERTOOSMALL is
returned and this value is set to the required buffer size. On success, this
value contains the number of bytes written to the specified buffer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbyClient::SetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the connection settings to
be associated with the specified connection. Calling this method will generate
a DPL_MSGID_CONNECTION_SETTINGS message to be sent to the client specified by <i>hConnection</i>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you set connection
settings, the lobby application will add a reference to each of the address
objects specified in the call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetConnectionSettings(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPL_CONNECTION_SETTINGS
*const</b> <i>pdplConnectSettings</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Handle to the connection to set the settings for. You may also
specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>The connection settings will be updated for all the lobbied
applications you are connected to.</p>

<p class=Term1><i>pdplConnectSettings</i></p>

<p class=Def1>Pointer to a DPL_CONNECTION_SETTINGS structure containing the
settings associated with the specified connection.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8LobbiedApplication</b>
interface is used by an application that supports lobbying. This interface
allows the application to register with the system so that it can be lobby
launched. Additionally, it also lets the application get the connection
information necessary to launch a game without querying the user. Lastly, this
interface allows the lobbied application to send messages and notifications to
the lobby client that launched the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>IDirectPlay8LobbiedApplication</b>
interface are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8LobbiedApplication Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetAppAvailable</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterProgram</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterProgram</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UpdateStatus</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetConnectionSettings</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Deletes the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Close(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD </b><i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><span style='color:black'>DPNERR_INVALIDOBJECT</span></p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><span style='color:black'>DPNERR_OUTOFMEMORY</span></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::SetAppAvailable</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Makes an application available
or unavailable for a lobby client to connect to. This method is typically
called if a lobbied application is independently launched, that is, not
launched by a lobby client. Additionally, this method should be called if a game
has ended and the lobbied application needs to be available to connect to a
lobby client at the start of another game.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetAppAvailable(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const BOOL </b><i>fAvailable,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b><i> dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>fAvailable</i></p>

<p class=Def1>Boolean value that sets the availability of the application. Set
this value to TRUE to indicate that your application is available, or to FALSE
to indicate that it is not available.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be set for this method.</p>

<p class=Term2>DPLAVAILABLE_ALLOWMULTIPLECONNECT</p>

<p class=Def2>The default behavior for<b> </b>this method is to automatically
mark the interface as Unavailable when the first connection is established. By
specifying this flag, the interface is not automatically marked unavailable
after the first connection is established, thereby allowing multiple
connections.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers a message handler
function that receives notifications about changes in the state of the lobby
client and receives messages from the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Initialize(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PVOID</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const PFNDPNMESSAGEHANDLER</b> <i>pfn</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPNHANDLE *const</b> <i>pdpnhConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the user-provided context value in calls to the
message handler. Providing a user-context value is useful to differentiate
messages from multiple interfaces to a common message handler.</p>

<p class=Term1><i>pfn</i></p>

<p class=Def1>Pointer to a <b>PFNDPNMESSAGEHANDLER</b> callback function that
receives all messages from the <b>IDirectPlay8LobbyClient</b> interface and
indications of session changes from the <b>IDirectPlay8LobbiedApplication</b>
interface.</p>

<p class=Term1><i>pdpnhConnection</i></p>

<p class=Def1>Value used to detect if your application was lobby launched. If
your application was lobby launched, this parameter will be set to the
connection handle for the lobby client. If your process was not lobby launched,
this parameter is set to NULL.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>The following flag can be specified.</p>

<p class=Term2>DPLINITIALIZE_DISABLEPARAMVAL</p>

<p class=Def2>Disables parameter validation.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method first after
using <b>CoCreateInstance</b> to obtain the <b>IDirectPlay8LobbiedApplication</b>
interface.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method automatically
establishes a connection to the lobby client if you were lobby launched. If you
call <b>Initialize</b> and you were lobby launched and the lobbied application
interface is unable to contact the lobby client process, <b>Initialize</b> will
time out after four seconds. In this case, <b>Initialize</b> will return
DPNERR_TIMEDOUT but will still succeed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::RegisterProgram</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Registers a lobby-aware
application with DirectPlay. Applications must be registered to enable lobby launching.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT RegisterProgram(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDPL_PROGRAM_DESC</b> <i>pdplProgramDesc</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdplProgramDesc</i></p>

<p class=Def1>Pointer to the <b>DPL_PROGRAM_DESC</b> structure that describes
the lobby-aware application to register.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The application needs to
register only once. It should be unregistered with a call to the <b>IDirectPlay8LobbiedApplication::UnRegisterProgram</b>
method when it is uninstalled. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In Microsoft DirectX 8.0, <b>RegisterProgram</b>
must be used. You cannot manually enter application information in the
registry. Failure to use this interface makes your application nonportable and
incompatible with future versions of DirectPlay.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sends a message from the lobbied
application to the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Send(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>BYTE *const</b> <i>pBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>pBufferSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the lobby client
that the message is sent to. You may also specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>The message you have specified will be sent to all lobby clients
to which you are connected.</p>

<p class=Term1><i>pBuffer</i></p>

<p class=Def1>Pointer to a variable of type <b>BYTE</b> that contains the
message buffer.</p>

<p class=Term1><i>pBufferSize</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the
message buffer in the <i>pBuffer</i> parameter, in bytes. This parameter must
be at least 1 byte and no more than 64 KB.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SENDTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer size is larger
than 64 KB, the method returns DPNERR_SENDTOOLARGE. If the buffer size is set
to 0, the method returns DPNERR_INVALIDPARAM.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::UnRegisterProgram</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unregisters a lobby-aware
application that was registered through the <b>IDirectPlay8LobbiedApplication::RegisterProgram</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT UnRegisterProgram(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GUID*</b> <i>pguidApplication</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidApplication</i></p>

<p class=Def1>Pointer to the GUID of the application to unregister.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::UpdateStatus</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Updates the status of a
connected lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT UpdateStatus(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwStatus,</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b><i> dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Variable of type <b>DPNHANDLE</b> that specifies the lobby
client. You may also specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>The status update will be sent to all lobby clients to which you
are connected. </p>

<p class=Term1><i>dwStatus</i></p>

<p class=Def1>Variable of type <b>DWORD</b> that is filled with one of the
following values that indicate the status between the lobby client and the
lobbied application.</p>

<p class=Term2>DPLSESSION_CONNECTED</p>

<p class=Def2>The lobby client and lobbied application are currently connected.</p>

<p class=Term2>DPLSESSION_COULDNOTCONNECT</p>

<p class=Def2>The lobby client was not able to connect to the lobbied
application.</p>

<p class=Term2>DPLSESSION_DISCONNECTED</p>

<p class=Def2>The lobby client and lobbied application are currently
disconnected.</p>

<p class=Term2>DPLSESSION_TERMINATED</p>

<p class=Def2>The connection between the lobby client and lobbied application
has been terminated.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATED</p>

<p class=Def2>The peer object associated with the connection is involved in a
session where a host migration takes place and the local client is not the new
host.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATEDHERE</p>

<p class=Def2>The peer object associated with the connection is involved in a
session where a host migration takes place and the local client becomes the new
host.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::GetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the set of connection
settings for the specified connection. These settings can be set through a call
to the <b>IDirectPlay8LobbyClient::ConnectApplication</b>, <b>IDirectPlay8LobbyClient::SetConnectionSettings</b>,
or <b>IDirectPlay8LobbiedApplication::SetConnectionSettings</b> method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you get connection
settings, a reference will be added for each address object that is returned to
the user. Therefore, users must be sure to call <b>Release</b> on each address
object when they are done with the structure.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetConnectionSettings(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hLobbyClient</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DPL_CONNECTION_SETTINGS *const</b> <i>pdplSessionInfo</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD*</b> <i>pdwInfoSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hLobbyClient</i></p>

<p class=Def1>Handle to the connection for which to retrieve the settings.</p>

<p class=Term1><i>pdplSessionInfo</i></p>

<p class=Def1>Pointer to a <b>DPL_CONNECTION_SETTINGS </b>structure to receive
the connection settings for the specified connection.</p>

<p class=Term1><i>pdwInfoSize</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> containing the size, in bytes, of the
buffer specified in the <i>pdplSessionInfo</i> structure. If the buffer is not
large enough to hold the connection settings, DPNERR_BUFFERTOOSMALL is returned
and this value will be set to the required buffer size. On success, this value
will contain the number of bytes written to the specified buffer.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8LobbiedApplication::SetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the connection settings to
be associated with the specified connection. Calling this method generates a
DPL_MSGID_CONNECTION_SETTINGS message to be sent to the client specified by <i>hConnection</i>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you set connection
settings, the lobby application will add a reference to each of the address
objects specified in the call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetConnectionSettings(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPNHANDLE</b> <i>hConnection</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DPL_CONNECTION_SETTINGS
*const</b> <i>pdplConnectSettings</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwFlags</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>hConnection</i></p>

<p class=Def1>Handle to the connection to set the settings for. You may also
specify the following flag.</p>

<p class=Term2>DPLHANDLE_ALLAPPLICATIONS</p>

<p class=Def2>The connection settings will be updated for all the lobby clients
to which you are connected.</p>

<p class=Term1><i>pdplConnectSettings</i></p>

<p class=Def1>Pointer to a <b>DPL_CONNECTION_SETTINGS</b> structure containing
the settings associated with the specified connection.</p>

<p class=Term1><i>dwFlags</i></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8Address</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8Address</b>
interface contains generic addressing methods used to create and manipulate
addresses for Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span>. This interface is one of the interfaces
available through the CLSID_DirectPlayAddress COM object. To create an object
that supports this interface, use the <b>CoCreateInstanceEx</b> method for the
CLSID CLSID_DirectPlayAddress that specifies the IID_IDirectPlayAddress8
interface.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8Address</b>
interface contains the following methods.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8Address Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildFromURLW</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildFromURLA</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Duplicate</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetEqual</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IsEqual</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Clear</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetURLW</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetURLA</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSP</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetUserData</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSP</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetUserData</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetNumComponents</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetComponentByName</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetComponentByIndex</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddComponent</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetDevice</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetDevice</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildFromDPADDRESS</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In order to deliver messages,
each participant in a multiplayer game must have a unique address. Addresses
can refer either to the computer that your application is running on (<i>device
address</i>), or a computer that your application needs to communicate with (<i>host
address</i>). </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay represents addresses
as URLs. These URLs are then encapsulated in the address object so that they
can be passed to or from the DirectPlay API. In general, address URLs are
strings that consist of three basic components in the following order: scheme,
scheme separator, and data string.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All DirectPlay addresses use
x-directplay as the scheme, and :/ as the scheme separator. Using :/ as a
separator implies that the data that follows is <i>opaque.</i> In other words,
the data string does not conform to any Internet standard, and should simply be
passed on to the receiving application without modification. All DirectPlay
URLs thus have the following general form:</p>

<p class=Ex>x-directplay:/[<i>data string</i>]</p>

<p class=Ex>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>There are two basic approaches
to handling address objects:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Handle the data string directly,
using normal string manipulation techniques.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Use the methods exposed by <b>IDirectPlay8Address</b>
to obtain or modify the individual elements of the data string.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For more information on
DirectPlay addresses, see DirectPlay Addressing.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::BuildFromURLW</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the object equal to the
address in the DirectPlay 8 URL. It erases the contents of the object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildFromURLW(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>WCHAR*</b> <i>pwszSourceURL</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pwszSourceURL</i></p>

<p class=Def1>Pointer to a NULL-terminated Unicode string that contains a
properly formatted DirectPlay 8 address.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Dpaddr.h header file defines
a number of standard strings that you can use to construct your URL instead
using a literal string. All of the string names have the form DPNA_XXX. For
example, DPNA_HEADER can be used in place of L&quot;x-directplay:/&quot; for
the URL header.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::BuildFromURLA</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the object equal to the
specified in the DirectPlay 8 URL. It erases the contents of the object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildFromURLA(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CHAR*</b> <i>pszSourceURL</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pszSourceURL</i> </p>

<p class=Def1>Pointer to a NULL-terminated ANSI string that contains a properly
formatted DirectPlay 8 address.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Dpaddr.h header file defines
a number of standard strings that you can use to construct your URL instead
using a literal string. All of the string names have the form DPNA_XXX. For
example, DPNA_HEADER can be used in place of L&quot;x-directplay:/&quot; for
the URL header.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::Duplicate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Creates a DirectPlay Address
object that duplicates the address in this object. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Duplicate(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDIRECTPLAY8ADDRESS*</b> <i>ppdpaNewAddress</i>
</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>ppdpaNewAddress</i> </p>

<p class=Def1>Address of a pointer to receive the <b>IDirectPlay8Address</b>
pointer for the duplicate object. DirectPlay increments the reference count for
this interface. You must release the interface when you no longer need it.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_GENERIC</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::SetEqual</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the contents of the object
it is called on to match the contents of the address object passed to the
method. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetEqual(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDIRECTPLAY8ADDRESS</b> <i>pdpaAddress</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpaAddress</i></p>

<p class=Def1>Pointer to a DirectPlay8Address object that this object will be
set to.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDADDRESSFORMAT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::IsEqual</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Compares two addresses to see if
they are equal.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT IsEqual(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDIRECTPLAY8ADDRESS</b> <i>pdpaAddress</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdpaAddress</i></p>

<p class=Def1>Address to compare to the address contained within the object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method is successful, one
of the following values is returned.</p>

<p class=Term1>DPNSUCCESS_EQUAL</p>

<p class=Def1>The two addresses are equal.</p>

<p class=Term1>DPNSUCCESS_NOTEQUAL</p>

<p class=Def1>The two addresses are not equal.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, one of the
following error values may be returned.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDADDRESSFORMAT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method checks the contents
of the address specified by the <i>pdpaAddress</i> parameter and compares it to
the address contained within the object this method was called on. This method
does not affect the contents of either address.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::Clear</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Resets the address object to an
empty address.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT Clear();</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetURLW</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the DirectPlay 8
address URL string represented by this object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetURLW(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>WCHAR*</b> <i>pwszURL</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumChars</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pwszURL</i></p>

<p class=Def1>Address of a pointer to receive the URL represented by this
object. This parameter can be NULL if <i>pdwNumChars </i>points to a <b>DWORD</b>
containing 0. </p>

<p class=Term1><i>pdwNumChars</i> </p>

<p class=Def1>Pointer to a <b>DWORD</b> that contains the number of characters
the specified buffer can hold, including NULL terminator. On success this value
contains the number of characters written to the specified buffer, including
NULL terminator. On failure this value contains the number of characters,
including NULL terminator, required to hold the URL and the method returns
DPNERR_BUFFERTOOSMALL.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_GENERIC</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_OUTOFMEMORY</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetURLA</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
address URL string represented by this object. (ANSI Version.)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetURLA(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CHAR*</b> <i>pszURL</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumChars</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pszURL</i></p>

<p class=Def1>Address of a pointer to receive the URL represented by this
object. This parameter can be NULL if <i>pdwNumChars </i>points to a <b>DWORD</b>
containing 0. </p>

<p class=Term1><i>pdwNumChars</i></p>

<p class=Def1>Pointer to a <b>DWORD</b> that contains the number of characters
the specified buffer can hold, including NULL terminator. On success this value
contains the number of characters written to the specified buffer, including
NULL terminator. On failure this value contains the number of characters,
including NULL terminator, required to hold the URL and the method returns
DPNERR_BUFFERTOOSMALL.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_GENERIC</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_OUTOFMEMORY</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetSP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the service provider
GUID in the address object. If no service provider is specified, this method
returns DPNERR_DOESNOTEXIST.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSP(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GUID*</b> <i>pguidSP</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to a GUID to receive the service provider in the address
object. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetUserData</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the user data in the
address object. If no user data exists in this address object, this method
returns DPNERR_DOESNOTEXIST.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetUserData(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void*</b> <i>pvUserData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwBufferSize</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserData</i></p>

<p class=Def1>Pointer to a buffer to receive the user data from this address.
To retrieve the required size, set this parameter to NULL and the <b>DWORD</b>
in <i>pdwBufferSize </i>to 0. </p>

<p class=Term1><i>pdwBufferSize</i></p>

<p class=Def1>Size in bytes of the buffer pointed to by <i>pvUserData</i>. If <i>pvUserData
</i>is NULL, this parameter must point to a <b>DWORD</b> containing 0. On
output, the contained <b>DWORD</b> is set to the number of bytes written to the
buffer. On failure, this contains the number of bytes required to retrieve the
user data and the method returns DPNERR_BUFFERTOOSMALL.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::SetSP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the service provider GUID
in the address object. If a service provider is specified for this address, it
is overwritten by this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetSP(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidSP</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidSP</i></p>

<p class=Def1>Pointer to the service provider GUID.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::SetUserData</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the user data in the
address object. If there is user data in this address, it is overwritten by
this call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetUserData(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const void *const</b> <i>pvUserData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwDataSize</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserData</i></p>

<p class=Def1>Pointer to a buffer that contains the data to place in the user
data section of the address. Set to NULL to clear the user data.</p>

<p class=Term1><i>dwDataSize</i></p>

<p class=Def1>Size, in bytes, of the data in <i>pvUserData</i>. If <i>pvUserData
</i>is NULL, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetNumComponents</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the number of
components in the address.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetNumComponents(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNumComponents</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pdwNumComponents</i> </p>

<p class=Def1>Pointer to a <b>DWORD</b> to receive the number of components in
this address object.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
the following error value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetComponentByName</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves information on the
component at the specified key. Values for the component are retrieved in their
native format. If the component key is not found, DPNERR_DOESNOTEXIST is
returned.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The value of the component is
retrieved in its native format. Therefore, if the components value is a <b>DWORD</b>,
a <b>DWORD</b> is retrieved by this call. So buffer size = 4 and <i>pvBuffer </i>should
be a recast <b>PDWORD</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetComponentByName(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const WCHAR *const</b> <i>pwszName</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void*</b> <i>pvBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwBufferSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwDataType</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pwszName</i></p>

<p class=Def1>String specifying the name of the component you want to retrieve.</p>

<p class=Term1><i>pvBuffer</i></p>

<p class=Def1>Buffer to retrieve the data stored in the value of the component.
To retrieve the size required, specify NULL for this parameter and 0 for the <b>DWORD</b>
pointed to by <i>pdwBufferSize</i>. The method returns DPNERR_BUFFERTOOSMALL in
this case.</p>

<p class=Term1><i>pdwBufferSize</i></p>

<p class=Def1>On input, a pointer to a <b>DWORD</b> that contains the size of
the buffer, in bytes, pointed to by <i>pvBuffer</i>. On output, a pointer to a <b>DWORD</b>
that contains the number of bytes written to the buffer on success and on
failure, the number of bytes required to store the data. </p>

<p class=Term1><i>pdwDataType</i> </p>

<p class=Def1><b>DWORD</b> pointed to by this parameter that is set to the type
of data that is stored in this component. This can be one of the following:</p>

<p class=Term2>DPNA_DATATYPE_STRING</p>

<p class=Def2>Data is a NULL-terminated string.</p>

<p class=Term2>DPNA_DATATYPE_DWORD</p>

<p class=Def2>Data is a <b>DWORD</b>.</p>

<p class=Term2>DPNA_DATATYPE_GUID</p>

<p class=Def2>Data is a GUID.</p>

<p class=Term2>DPNA_DATATYPE_BINARY</p>

<p class=Def2>Data is raw binary.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetComponentByIndex</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves information on the
component at the specified index. Values for the component are retrieved in
their native format. If the component key is not found, the method returns
DPNERR_DOESNOTEXIST.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The value of the component is
retrieved in its native format. Therefore, if the components value is a <b>DWORD</b>,
a <b>DWORD</b> is retrieved by this call. So buffer size = 4 and <i>pvBuffer </i>should
be a recast <b>PDWORD</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetComponentByIndex(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwComponentID</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>WCHAR*</b> <i>pwszName</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwNameLen</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>void*</b> <i>pvBuffer</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwBufferSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwDataType</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>dwComponentID</i></p>

<p class=Def1>Index of the component to retrieve. This value is zero-based and
should be in the range of [0..GetNumComponents()-1].</p>

<p class=Term1><i>pwszName</i></p>

<p class=Def1>Buffer to retrieve the name of the component on a successful
call. To retrieve the size required, specify NULL for this parameter and 0 for
the <b>DWORD</b> pointed to by <i>pdwNameBufferSize</i>. The method returns
DPNERR_BUFFERTOOSMAL in this case.</p>

<p class=Term1><i>pdwNameLen</i></p>

<p class=Def1>On input, a pointer to a <b>DWORD</b> that contains the size of
the buffer, in characters including NULL terminator, pointed to by <i>pwszName</i>.
On output, a pointer to a <b>DWORD</b> that contains the number of characters
written to the buffer, including NULL terminator, on success and on failure,
the number of characters required, including NULL terminator, to store this
value.</p>

<p class=Term1><i>pvBuffer</i></p>

<p class=Def1>Buffer to retrieve the data stored in the value of the component.
To retrieve the size required, specify NULL for this parameter and 0 for the <b>DWORD</b>
pointed to by <i>pdwBufferSize</i>. The method returns DPNERR_BUFFERTOOSMALL in
this case.</p>

<p class=Term1><i>pdwBufferSize</i></p>

<p class=Def1>On input, a pointer to a <b>DWORD</b> containing the size of the
buffer, in bytes, pointed to by <i>pvBuffer</i>. On output, a pointer to a <b>DWORD</b>
that contains the number of bytes written to the buffer on success and on
failure, the number of bytes required to store the data. </p>

<p class=Term1><i>pdwDataType</i> </p>

<p class=Def1><b>DWORD</b> pointed to by this parameter that is set to the type
of data that is stored in this component. This can be one of the following:</p>

<p class=Term2>DPNA_DATATYPE_STRING</p>

<p class=Def2>Data is a NULL-terminated string.</p>

<p class=Term2>DPNA_DATATYPE_DWORD</p>

<p class=Def2>Data is a <b>DWORD</b>.</p>

<p class=Term2>DPNA_DATATYPE_GUID</p>

<p class=Def2>Data is a GUID.</p>

<p class=Term2>DPNA_DATATYPE_BINARY</p>

<p class=Def2>Data is raw binary.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::AddComponent</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Adds a component to the address.
If the component is part of the address, then it is replaced by the new value
in this call. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Values are specified in native
formats when making this call. Therefore, the <i>lpvData</i> parameter should
be a recast pointer to a variable that holds the data in the native format. For
example, if the component is a GUID, the <i>lpvData</i> parameter should be a
recast pointer to a GUID. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method validates that the
predefined component types are the right format. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT AddComponent(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const WCHAR *const</b> <i>pwszName</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const void *const</b> <i>lpvData</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwDataSize</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const DWORD</b> <i>dwDataType</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pwszName</i></p>

<p class=Def1>NULL-terminated Unicode string that contains the key for the
component. </p>

<p class=Term1><i>lpvData</i></p>

<p class=Def1>Pointer to a buffer that contains the value associated with the
specified key. Data should be specified in its native format.</p>

<p class=Term1><i>dwDataSize</i></p>

<p class=Def1>Size, in bytes, of the data in the buffer located at <i>lpvData</i>.
The size depends on the data type. If the size is not specified correctly, the
method returns DPNERR_INVALIDPARAM.</p>

<p class=Term2><b>DWORD</b></p>

<p class=Def2>Size = sizeof( DWORD )</p>

<p class=Term2>GUID</p>

<p class=Def2>Size = sizeof( GUID )</p>

<p class=Term2>String</p>

<p class=Def2>Size = size of the string in bytes, including NULL terminator.</p>

<p class=Term1><i>dwDataType</i> </p>

<p class=Def1>Data type of the value associated with this key. The data type
can be one of the following: </p>

<p class=Term2>DPNA_DATATYPE_STRING</p>

<p class=Def2>Data is a NULL-terminated string.</p>

<p class=Term2>DPNA_DATATYPE_DWORD</p>

<p class=Def2>Data is a <b>DWORD</b>.</p>

<p class=Term2>DPNA_DATATYPE_GUID</p>

<p class=Def2>Data is a GUID.</p>

<p class=Term2>DPNA_DATATYPE_BINARY</p>

<p class=Def2>Data is in raw binary format.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::GetDevice</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the local device GUID
in the address object. If no device is specified, this method returns
DPNERR_DOESNOTEXIST.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetDevice(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GUID*</b> <i>pguidDevice</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidDevice</i></p>

<p class=Def1>Pointer to a GUID to receive the device in the address object. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::SetDevice</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the local device GUID in
the address object. If a local device is specified for this address, it is
overwritten by this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT SetDevice(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidDevice</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidDevice</i></p>

<p class=Def1>Pointer to a GUID of the local device. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8Address::BuildFromDPADDRESS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Sets the current objects
internal address to be the DirectPlay 8 equivalent of the specified DirectPlay
4 address. The purpose of this method is to allow lobby developers to launch
games with the new Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> interface using the old lobby code.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method enumerates the
address components in the specified address and adds the corresponding element
to the DirectPlay 8 address.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildFromDPADDRESS(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LPVOID</b> <i>pvAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DWORD</b> <i>dwDataSize</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvAddress</i></p>

<p class=Def1>Pointer to a DirectPlay4 address that will be converted to the
DirectPlay 8 address format.</p>

<p class=Term1><i>dwDataSize</i></p>

<p class=Def1>Size of data contained in the <i>pvAddress</i> parameter.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDADDRESSFORMAT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method builds a DirectPlay
8 address from a DirectPlay4 address. This method will clear the current
address of all elements before building the new address.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method has the following
limitations.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> The method cannot map the
DPAID_Modem address element because DirectPlay 4 used modem names, while
DirectPlay 8 uses GUIDs to identify modems.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Elements of the DirectPlay 4
address that are not part of the predefined DirectPlay 4 address elements will
result in an error and a return value of DPNERR_INVALIDADDRESSFORMAT. See
DirectPlay 4 documentation on DirectPlay addresses for a complete list of the
DirectPlay 4 address elements.</span></p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh1 style='page-break-after:avoid'>IDirectPlay8AddressIP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8AddressIP</b>
interface is available through the CLSID_DirectPlayAddress COM object. This
interface is used for IP provider-specific addressing services.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>IDirectPlay8AddressIP</b>
interface contains the following methods.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8AddressIP Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildFromSockAddr</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>BuildLocalAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSockAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetLocalAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetAddress</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::BuildFromSockAddr</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Builds a remote DirectPlay 8 IP
address from a valid <b>SOCKADDR</b> structure. The <b>SOCKADDR</b> structure
must specify an IP address. If the address is not in the correct format,
DPNERR_INVALIDPARAM is returned. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The result of a successful call
is a valid remote address with the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER =
CLSID_DP8SP_TCPIP</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_HOSTNAME = specified
host name </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT = specified port</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All addressing information
contained in the object before the call is erased. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildFromSockAddr(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const SOCKADDR *const</b> <i>pSockAddr</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pSockAddr</i></p>

<p class=Def1>Valid UDP address specified in <b>SOCKADDR</b> form.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::BuildAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Builds a remote DirectPlay 8 IP
address from a host name and a port. The result of a successful call is a valid
remote address with the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER =
CLSID_DP8SP_TCPIP</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_HOSTNAME = specified
host name </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT = specified port</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All addressing information
contained in the object before the call is erased. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const WCHAR *const</b> <i>wszAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const USHORT</b> <i>usPort</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>wszAddress</i></p>

<p class=Def1>Remote host address can be a dotted Internet addressfor example,
127.0.0.1or a valid host namefor example, <a name="_Hlt410202085">example.microsoft.com</a>.</p>

<p class=Term1><i>usPort</i></p>

<p class=Def1>Port on the remote host to which to connect. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=Nh>Note</p>

<p class=Np1>The DPNSVR is a DirectPlay feature that allows multiple processes
to share a single port for enumeration. Do not use the DPNA_DPNSVR_PORT flag
when constructing a device address, or when making a connection. This flag
should only be used for enumerations. If you do not add a port element to the
enumeration address, the port represented by the flag will be automatically
added to that address. See Using the DirectPlay DPNSVR Application for a
further discussion of DPNSVR.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::BuildLocalAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Builds a local DirectPlay 8 IP
address from a device and port. The result of a successful call is a valid
remote address with the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER =
CLSID_DP8SP_TCPIP</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_DEVICE= specified
device </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT = specified port</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All addressing information
contained in the object before the call is erased. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT BuildLocalAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const GUID *const</b> <i>pguidAdapter</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>const USHORT</b> <i>usPort</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidAdapter</i></p>

<p class=Def1>Local device identifier to host on. </p>

<p class=Term1><i>usPort</i></p>

<p class=Def1>Port on the local device to host on. This value can be set to 0
to allow DirectPlay 8.0 to automatically select the port.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=Nh>Note</p>

<p class=Np1>The DPNSVR is a DirectPlay feature that allows multiple processes
to share a single port for enumeration. Do not use the DPNA_DPNSVR_PORT flag
when constructing a device address, or when making a connection. This flag
should only be used for enumerations. If you do not add a port element to the
enumeration address, the port represented by the flag will be automatically
added to that address. See Using the DirectPlay DPNSVR Application for a
further discussion of DPNSVR.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::GetSockAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves a list of <b>SOCKADDR</b>
structures describing the addresses represented by this object. If the host
name specified in the object requires a DNS lookup, it is performed. Therefore,
this method may block while the DNS is queried. It is also possible for a host
name to resolve to multiple addresses.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To succeed, the contained
address must have at least the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_HOSTNAME</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT = specified port</span></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetSockAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SOCKADDR*</b> <i>psockAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwAddressBufferSize</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>psockAddress</i></p>

<p class=Def1>Pointer to buffer to retrieve the array of <b>SOCKADDR</b>
structures. There is one <b>SOCKADDR</b> structure for each address the host
resolves to.</p>

<p class=Term1><i>pdwAddressBufferSize</i></p>

<p class=Def1>Size, in bytes, of the buffer specified in <i>psockAddresses</i>.
On success, this parameter contains the number of bytes written to the
specified buffer. On failure, this parameter contains the number of bytes
required to retrieve the array of <b>SOCKADDR</b> structures. You can divide
the value of this parameter by the size of<b> </b>the SOCKADDR structure to
determine the number of items present in the returned array. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::GetLocalAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the local address
information from a DirectPlay 8 IP address. To succeed, the contained address
must have at least the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_DEVICE</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT</span></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetLocalAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GUID*</b> <i>pguidAdapter</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>USHORT*</b> <i>pusPort</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pguidAdapter</i></p>

<p class=Def1>Pointer to a GUID to retrieve the GUID of the local device
specified in this address.</p>

<p class=Term1><i>pusPort</i> </p>

<p class=Def1>Pointer to a <b>USHORT</b> to contain the port specified in this
local address. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh2 style='page-break-after:avoid'>IDirectPlay8AddressIP::GetAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Retrieves the remote address
information from a remote DirectPlay 8 IP address. To succeed, the contained
address must have at least the following elements.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PROVIDER </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_HOSTNAME</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DPNA_KEY_PORT = specified port</span></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT GetAddress(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>WCHAR*</b> <i>wszAddress</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PDWORD</b> <i>pdwAddressLength</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>USHORT*</b> <i>psPort</i> </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>wszAddress</i></p>

<p class=Def1>Pointer to a buffer to receive the host name. This parameter can
be NULL to retrieve the required size.</p>

<p class=Term1><i>pdwAddressLength</i></p>

<p class=Def1>Size, in characters, of the buffer specified in <i>wszAddress,</i>
including NULL terminator. On success, this parameter contains the number of
characters, including NULL terminator, written to the specified buffer. On
failure, this parameter contains the number of characters, including NULL
terminator, required to retrieve the host name. </p>

<p class=Term1><i>psPort</i> </p>

<p class=Def1>Pointer to a <b>USHORT</b> to contain the port specified in this
local address. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns S_OK if successful, or
one of the following error values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Functions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
functions are:</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8Create</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DirectPlay8LobbyCreate</span></b></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8AddressCreate</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlayVoiceCreate</b></span></p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Create</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8Create</b>
function is an external creation function used to create interfaces defined in
the Dplay8.h header file.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT WINAPI DirectPlay8Create(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> GUID*</b> <i>pcIID</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>void**</b> <i>ppvInterface</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>IUnknown*</b> <i>pUnknown</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pcIID</i></p>

<p class=Def1>Pointer to the interface ID you want to create. You may specify
the IID_IDirectPlay8Client, IID_IDirectPlay8Server or IID_IDirectPlay8Peer
interface ID.</p>

<p class=Term1><i>ppvInterface</i></p>

<p class=Def1>Address of a variable to receive the new interface pointer.</p>

<p class=Term1><i>pUnknown</i></p>

<p class=Def1>Address of the controlling object's IUnknown interface for COM
aggregation. Must be NULL. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8LobbyCreate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8LobbyCreate</b>
function is an external creation function used to create one of the lobby
interfaces defined in the Dplobby8.h header file.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT WINAPI
DirectPlay8LobbyCreate(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> GUID*</b> <i>pcIID</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>void**</b> <i>ppvInterface</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>IUnknown*</b> <i>pUnknown</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pcIID</i></p>

<p class=Def1>Pointer to the interface ID you want to create. You may specify
the IID_IDirectPlay8LobbiedApplication or IID_IDirectPlay8LobbyClient interface
ID.</p>

<p class=Term1><i>ppvInterface</i></p>

<p class=Def1>Address of a variable to receive the new interface pointer.</p>

<p class=Term1><i>pUnknown</i></p>

<p class=Def1>Address of the controlling object's IUnknown interface for COM
aggregation. Must be NULL. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8AddressCreate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlay8AddressCreate</b>
function is an external creation function used to create one of the addressing
interfaces defined in the Dpaddr.h header file.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT WINAPI
DirectPlay8AddressCreate(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> GUID*</b> <i>pcIID</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>void**</b> <i>ppvInterface</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>IUnknown*</b> <i>pUnknown</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pcIID</i></p>

<p class=Def1>Pointer to the interface ID you want to create. You may specify
the IID_IDirectPlay8Address or IID_IDirectPlay8AddressIP interface ID.</p>

<p class=Term1><i>ppvInterface</i></p>

<p class=Def1>Address of a variable to receive the new interface pointer.</p>

<p class=Term1><i>pUnknown</i></p>

<p class=Def1>Address of the controlling object's IUnknown interface for COM
aggregation. Must be NULL. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dpaddr.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlayVoiceCreate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlayVoiceCreate</b>
function is an external creation function used to create one of the interfaces
used in Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice that are defined in the Dvoice.h header
file.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HRESULT WINAPI
DirectPlayVoiceCreate(</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> GUID*</b> <i>pcIID</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>void**</b> <i>ppvInterface</i>, </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>IUnknown*</b> <i>pUnknown</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pcIID</i></p>

<p class=Def1>Pointer to the interface ID you want to create. You may specify
the IID_IDirectPlayVoiceTest, IID_IDirectPlayVoiceClient or
IID_IDirectPlayVoiceServer interface ID.</p>

<p class=Term1><i>ppvInterface</i></p>

<p class=Def1>Address of a variable to receive the new interface pointer.</p>

<p class=Term1><i>pUnknown</i></p>

<p class=Def1>Address of the controlling object's IUnknown interface for COM
aggregation. Must be NULL. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Callback Functions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
callback functions are: </p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>PFNDPNMESSAGEHANDLER</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>PDVMESSAGEHANDLER</b></span></p>

<p class=Leh>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>PFNDPNMESSAGEHANDLER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a name="_Toc466984235"><b>PFNDPNMESSAGEHANDLER</b>
is an application-defined callback function used by the <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b> <b>IDirectPlay8LobbyClient</b>
and <b>IDirectPlay8LobbiedApplication</b> interfaces to process messages.</a></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>typedef HRESULT (WINAPI
*PFNDPNMESSAGEHANDLER)( </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>PVOID</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>DWORD</b> <i>dwMessageType</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>PVOID</b> <i>pMessage</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the application-defined structure that will be passed
to this callback function. This is defined in the <i>pvUserContext</i>
parameter of the <b>Initialize</b> method.</p>

<p class=Term1><i>dwMessageType</i></p>

<p class=Def1>One of the following message types that are generated by the <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b> interfaces. Each
interface uses a different subset of the available messages. Refer to the
interface documentation for details.</p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_ADD_PLAYER_TO_GROUP</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_ASYNC_OP_COMPLETE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_CLIENT_INFO</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_CONNECT_COMPLETE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_CREATE_GROUP</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_CREATE_PLAYER</span></b></p>

<p class=Lb1><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_DESTROY_GROUP</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_DESTROY_PLAYER</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_ENUM_HOSTS_QUERY</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_ENUM_HOSTS_RESPONSE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_GROUP_INFO</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_HOST_MIGRATE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_INDICATE_CONNECT</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_INDICATED_CONNECT_ABORTED</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_PEER_INFO</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_RECEIVE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_REMOVE_PLAYER_FROM_GROUP</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_RETURN_BUFFER</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_SEND_COMPLETE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_SERVER_INFO</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPN_MSGID_TERMINATE_SESSION</span></b></p>

<p class=Le>&nbsp;</p>

<p class=Def1>Additionally, if the application supports Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
lobby functionality, this parameter can specify one of the following message
types that are generated by the <b>IDirectPlay8LobbyClient</b> and <b>IDirectPlay8LobbiedApplication</b>
interfaces. Each interface uses a different subset of the available messages.
Refer to the interface documentation for details.</p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPL_MSGID_CONNECT</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPL_MSGID_CONNECTION_SETTINGS</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPL_MSGID_DISCONNECT</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPL_MSGID_RECEIVE</span></b></p>

<p class=Lb1><b><span style='font-family:"Times New Roman",serif'>DPL_MSGID_SESSION_STATUS</span></b></p>

<p class=Le>&nbsp;</p>

<p class=Term1><i>pMessage</i></p>

<p class=Def1>Structure containing message information. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See the documentation for the
individual messages for appropriate return values. Unless otherwise noted, this
function should return S_OK.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This function must be threadsafe
because it might be called reentrantly through multiple threads.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Callback messages from the same
player are serialized. Once you receive a message from a player, you will not
receive another until you have handled the first message, and the callback
function has returned.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The message structures have the
same name as the message type except the &quot;DPN_MSGID&quot; is replaces with
&quot;DPNMSG&quot;. For example, the <b>DPN_MSGID_CONNECTION_TERMINATED</b>
message type uses the <b>DPNMSG_CONNECTION_TERMINATED</b> message structure to
convey the actual message information.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When implementing this callback
function, first look at the message type returned in the <i>dwMessageType</i>
parameter and then cast the message structure (<i>pMessage</i>) to that type to
obtain message information. Some messages don't have a defined structure
because they have no parameters. For these messages, the <i>pMessage </i>parameter
is NULL.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>PDVMESSAGEHANDLER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>PDVMESSAGEHANDLER</b> is an
application-defined callback function used by the <b>IDirectPlayVoiceClient</b>
and <b>IDirectPlayVoiceServer</b> interfaces to send messages to the user.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>typedef HRESULT (FAR PASCAL
*PDVMESSAGEHANDLER)( </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>LPVOID</b> <i>pvUserContext</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>DWORD</b> <i>dwMessageType</i>,</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> <b>LPVOID</b> <i>lpMessage</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>pvUserContext</i></p>

<p class=Def1>Pointer to the application-defined structure that will be passed
to this callback function. This is defined in the <i>lpUserContext</i>
parameter of the <b>IDirectPlayVoiceServer::Initialize</b> and <b>IDirectPlayVoiceClient::Initialize</b>
methods.</p>

<p class=Term1><i>dwMessageType</i></p>

<p class=Def1>One of the following message types.</p>

<p class=Term2><b>DVMSGID_CONNECTRESULT</b></p>

<p class=Term2><b>DVMSGID_CREATEVOICEPLAYER</b></p>

<p class=Term2><b>DVMSGID_DELETEVOICEPLAYER</b></p>

<p class=Term2><b>DVMSGID_DISCONNECTRESULT</b></p>

<p class=Term2><b>DVMSGID_GAINFOCUS</b></p>

<p class=Term2><b>DVMSGID_HOSTMIGRATED</b></p>

<p class=Term2><b>DVMSGID_INPUTLEVEL</b></p>

<p class=Term2><b>DVMSGID_LOCALHOSTSETUP</b></p>

<p class=Term2><b>DVMSGID_LOSTFOCUS</b></p>

<p class=Term2><b>DVMSGID_OUTPUTLEVEL</b></p>

<p class=Term2><b>DVMSGID_PLAYEROUTPUTLEVEL</b></p>

<p class=Term2><b>DVMSGID_PLAYERVOICESTART</b></p>

<p class=Term2><b>DVMSGID_PLAYERVOICESTOP</b></p>

<p class=Term2><b>DVMSGID_RECORDSTART</b></p>

<p class=Term2><b>DVMSGID_RECORDSTOP</b></p>

<p class=Term2><b>DVMSGID_SESSIONLOST</b></p>

<p class=Term2><b>DVMSGID_SETTARGETS</b></p>

<p class=Term1><i>lpMessage</i></p>

<p class=Def1>Structure containing message information. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>See the documentation for the
individual messages for appropriate return values. Unless otherwise noted, this
function should return DV_OK.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When implementing this callback
function, you must first look at the message type returned in the <i>dwMessageType</i>
parameter and then cast the message structure (<i>lpMessage</i>) to that type
to obtain message information. Some messages don't have a defined structure
because they have no parameters. For these messages, the <i>lpMessage </i>parameter
is NULL.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>This function may be called on multiple different threads at the
same time. It must thus be threadsafe and reentrant.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>All message structures have the
same name as the corresponding message types except the prefix is DVMSG_
instead of DVMSGID_. For example, the structure for <b>DVMSGID_RECORDSTART</b>
is <b>DVMSG_RECORDSTART</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The structure sent to the
message handler is valid only for the duration of the call. Therefore, if you
want to use any of the information passed into the function after the handler
function has returned you must make a copy of the data.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Callback messages from the same
player are serialized. Once you receive a message from a player, you will not
receive another until you have handled the first message, and the callback
function has returned.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Only messages that are specified
in the message mask through a call to the <b>IDirectPlayVoiceClient::Initialize</b>,
<b>IDirectPlayVoiceServer::Initialize</b>, <b>IDirectPlayVoiceClient::SetNotifyMask</b>
and <b>IDirectPlayVoiceServer::SetNotifyMask</b> methods are sent to this
callback function.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSGID_GAINFOCUS</b> and
<b>DVMSGID_LOSTFOCUS</b> message structures have not been implemented in this
release of Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span>.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>System Messages</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> messages are
received by a DirectPlay callback message handler. DirectPlay uses these
messages to convey information from the system to a DirectPlay application.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Server Messages</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Client Messages</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Lobby Messages</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay Voice Messages</span></p>

<h4 style='page-break-after:avoid'>DirectPlay Server Messages</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages should be
processed by all Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> server callback message handlers.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_CREATE_PLAYER</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_DESTROY_PLAYER</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_INDICATE_CONNECT</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_INDICATED_CONNECT_ABORTED</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_RECEIVE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_RETURN_BUFFER</span></b></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages can be
processed by DirectPlay server callback message handlers, but are not required.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_ADD_PLAYER_TO_GROUP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_ASYNC_OP_COMPLETE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_CLIENT_INFO</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_CREATE_GROUP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_DESTROY_GROUP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_GROUP_INFO</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_ENUM_HOSTS_QUERY</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_REMOVE_PLAYER_FROM_GROUP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_SEND_COMPLETE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_SERVER_INFO</span></b></p>

<p class=Le>&nbsp;</p>

<h4 style='page-break-after:avoid'>DirectPlay Client Messages</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages should be
processed by all DirectPlay client callback message handlers.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_RECEIVE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_TERMINATE_SESSION</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_RETURN_BUFFER</span></b></p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages can be
processed by DirectPlay client callback message handlers, but are not required.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_ASYNC_OP_COMPLETE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_CLIENT_INFO</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_CONNECT_COMPLETE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_ENUM_HOSTS_RESPONSE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_SEND_COMPLETE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_SERVER_INFO</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPN_MSGID_GROUP_INFO</span></b></p>

<p class=Le>&nbsp;</p>

<h4 style='page-break-after:avoid'>DirectPlay Lobby Messages</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages are
handled by lobby client and lobbied application callback message handlers.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPL_MSGID_CONNECT</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPL_MSGID_CONNECTION_SETTINGS</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPL_MSGID_DISCONNECT</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPL_MSGID_RECEIVE</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DPL_MSGID_SESSION_STATUS</span></b></p>

<p class=Le>&nbsp;</p>

<h4 style='page-break-after:avoid'>DirectPlay Voice Messages</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following messages are
handled by Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> voice callback message handlers. </p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_CONNECTRESULT</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_CREATEVOICEPLAYER</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_DELETEVOICEPLAYER</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_DISCONNECTRESULT</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_GAINFOCUS</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_HOSTMIGRATED</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_INPUTLEVEL</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_LOCALHOSTSETUP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_LOSTFOCUS</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_OUTPUTLEVEL</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_PLAYEROUTPUTLEVEL</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_PLAYERVOICESTART</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_PLAYERVOICESTOP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_RECORDSTART</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_RECORDSTOP</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_SESSIONLOST</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> DVMSGID_SETTARGETS</span></b></p>

<p class=Lb1><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MSGID_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> generates a
DPL_MSGID_CONNECT message when a lobby client connects to the lobbied
application through the <b>IDirectPlay8LobbyClient::ConnectApplication</b>
method.</p>

<p class=Rh2 style='page-break-after:avoid'>DPL_MESSAGE_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPL_MESSAGE_CONNECT</b>
structure is passed with the DPL_MSGID_CONNECT message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPL_MESSAGE_CONNECT{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hConnectId;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PDPL_CONNECTION_SETTINGS
pdplConnectionSettings;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLobbyConnectData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwLobbyConnectDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvConnectionContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_MESSAGE_CONNECT,
*PDPL_MESSAGE_CONNECT;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_MESSAGE_CONNECT</b> message structure. The
application must set this member before it uses the structure.</p>

<p class=Term1><b>hConnectId</b></p>

<p class=Def1>Handle used to identify the connection. This handle is used in
subsequent calls to <b>IDirectPlay8LobbyClient::Send</b> and <b>IDirectPlay8LobbyClient::ReleaseApplication</b>.</p>

<p class=Term1><b>pdplConnectionSettings</b></p>

<p class=Def1>Pointer to a <b>DPL_CONNECTION_SETTINGS</b> structure with
connection information.</p>

<p class=Term1><b>pvLobbyConnectData</b></p>

<p class=Def1>Pointer to lobby connection data.</p>

<p class=Term1><b>dwLobbyConnectDataSize</b></p>

<p class=Def1>Variable of type DWORD specifying the size of the data contained
in the <b>pvLobbyConnectData</b> member.</p>

<p class=Term1><b>pvConnectionContext</b></p>

<p class=Def1>Context value associated with this connection. For lobbied
applications, set this parameter when this message is received in your message
handler to associate the context value with the connection. This may be set to
NULL to disable context values.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MSGID_CONNECTION_SETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The
DPL_MSGID_CONNECTION_SETTINGS message is sent from the lobby client to the
lobby application when <b>IDirectPlay8LobbyClient::SetConnectionSettings</b> is
called. It is also sent from the lobby application to the lobby client when <b>IDirectPlay8LobbiedApplication::SetConnectionSettings</b>
is called. The contents of the message are valid only for the duration of the
message callback. Therefore, if you want to use the data contained in the
message, you must make a copy before returning. In addition, if you want to use
the addressing objects you must call <b>AddRef</b> on each address to ensure
you retain a reference.</p>

<p class=Rh2 style='page-break-after:avoid'>DPL_MESSAGE_CONNECTION_SETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
structure is passed with the DPL_MSGID_CONNECTION_SETTINGS message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPL_MESSAGE_CONNECTION_SETTINGS{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PDPL_CONNECTION_SETTINGS
pdplConnectionSettings;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvConnectionContext</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_MESSAGE_CONNECTION_SETTINGS,
*PDPL_MESSAGE_CONNECTION_SETTINGS;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Contains the size of the <b>DPL_MESSAGE_CONNECTION_SETTINGS</b>
structure. It should be set to <b>sizeof</b>( DPL_MESSAGE_CONNECTION_SETTINGS
).</p>

<p class=Term1><b>hSender</b></p>

<p class=Def1>Contains the handle for the connection that sent this message.</p>

<p class=Term1><b>pdplConnectionSettings</b></p>

<p class=Def1>Contains a pointer to a <b>DPL_CONNECTION_SETTINGS</b> structure
describing the connection settings for the specified connection.</p>

<p class=Term1><b>pvConnectionContext</b></p>

<p class=Def1>Pointer to a context value that has been set for the connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobbied applications, the
context value is set through the <b>pvConnectionContext</b> member of the <b>DPL_MESSAGE_CONNECT</b>
message structure. When your message handler receives this message, whatever
you set this member to before returning will be the context value for that
connection. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobby clients, the <i>pvConnectionContext</i>
parameter in the <b>IDirectPlay8LobbyClient::ConnectApplication</b> method will
be used as the connection's context value if the connection is successful. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Context values are not shared
between lobby client and lobbied application. For example, if you set your
context value for a lobby connection in your <b>IDirectPlay8LobbyClient</b>
interface to pointer A and in your <b>IDirectPlay8LobbiedApplication</b>
interface you set it to pointer B, indications in your <b>IDirectPlay8LobbyClient</b>
interface will have pointer A as their context value and in your<b>
IDirectPlay8LobbiedApplication</b> interface pointer B will be the context
value. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also set your context
values to NULL if you do not want to use this feature. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MSGID_DISCONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> generates a
DPL_MSGID_DISCONNECT message when a lobby client disconnects from a lobbied
application through the <b>IDirectPlay8LobbyClient::ReleaseApplication</b>
method.</p>

<p class=Rh2 style='page-break-after:avoid'>DPL_MESSAGE_DISCONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPL_MESSAGE_DISCONNECT</b>
structure contains information for the DPL_MSGID_DISCONNECT system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPL_MESSAGE_DISCONNECT{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hDisconnectId;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hrReason;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvConnectionContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_MESSAGE_DISCONNECT, *PDPL_MESSAGE_DISCONNECT;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_MESSAGE_DISCONNECT</b> message structure. The
application must set this member before it uses the structure.</p>

<p class=Term1><b>hDisconnectId</b></p>

<p class=Def1>Handle specifying the disconnection ID.</p>

<p class=Term1><b>hrReason</b></p>

<p class=Def1>Reason for the disconnection.</p>

<p class=Term2>S_OK</p>

<p class=Def2>It was a standard disconnection.</p>

<p class=Term2>DPNERR_CONNECTIONLOST</p>

<p class=Def2>This will be set if the process running the client or application
exited abnormally.</p>

<p class=Term1><b>pvConnectionContext</b></p>

<p class=Def1>Context value that has been set for the connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobbied applications, the
context value is set through the <b>pvConnectionContext</b> member of the <b>DPL_MESSAGE_CONNECT</b>
message structure. When your message handler receives this message, whatever
you set this member to before returning will be the context value for that
connection. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobby clients, the <i>pvConnectionContext</i>
parameter in the <b>IDirectPlay8LobbyClient::ConnectApplication</b> method will
be used as the connection's context value if the connection is successful. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Context values are not shared
between lobby client and lobbied application. For example, if you set your
context value for a lobby connection in your <b>IDirectPlay8LobbyClient</b>
interface to pointer A and in your <b>IDirectPlay8LobbiedApplication</b>
interface you set it to pointer B, indications in your <b>IDirectPlay8LobbyClient</b>
interface will have pointer A as their context value and in your <b>IDirectPlay8LobbiedApplication</b>
interface pointer B will be the context value. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also set your context
values to NULL if you do not want to use this feature. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MSGID_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> generates the
DPL_MSGID_RECEIVE message when the target receives a message sent by the <b>IDirectPlay8LobbyClient::Send</b>
or <b>IDirectPlay8LobbiedApplication::Send</b> method.</p>

<p class=Rh2 style='page-break-after:avoid'>DPL_MESSAGE_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPL_MESSAGE_RECEIVE</b>
structure contains information for the DPL_MSGID_RECEIVE system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPL_MESSAGE_RECEIVE{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> BYTE* pBuffer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvConnectionContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_MESSAGE_RECEIVE,
*PDPL_MESSAGE_RECEIVE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_MESSAGE_RECEIVE</b> message structure. The
application must set this member before it uses the structure.</p>

<p class=Term1><b>hSender</b></p>

<p class=Def1>Handle of the client that sent the message.</p>

<p class=Term1><b>pBuffer</b></p>

<p class=Def1>Pointer to message data.</p>

<p class=Term1><b>dwBufferSize</b></p>

<p class=Def1>Size of the message data contained in the <b>pBuffer</b> member.</p>

<p class=Term1><b>pvConnectionContext</b></p>

<p class=Def1>Context value that has been set for the connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobbied applications, the
context value is set through the <b>pvConnectionContext</b> member of the <b>DPL_MESSAGE_CONNECT</b>
message structure. When your message handler receives this message, whatever
you set this member to before returning will be the context value for that
connection. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobby clients, the <i>pvConnectionContext</i>
parameter in the <b>IDirectPlay8LobbyClient::ConnectApplication</b> method will
be used as the connection's context value if the connection is successful. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Context values are not shared
between lobby client and lobbied application. For example, if you set your
context value for a lobby connection in your <b>IDirectPlay8LobbyClient</b>
interface to pointer A and in your <b>IDirectPlay8LobbiedApplication</b>
interface you set it to pointer B, indications in your <b>IDirectPlay8LobbyClient
</b>interface will have pointer A as their context value and in your <b>IDirectPlay8LobbiedApplication</b>
interface pointer B will be the context value. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also set your context
values to NULL if you do not want to use this feature. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MSGID_SESSION_STATUS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPL_MSGID_SESSION_STATUS message when the session has been updated with a
call to the <b>IDirectPlay8LobbiedApplication::UpdateStatus</b> method.</p>

<p class=Rh2 style='page-break-after:avoid'>DPL_MESSAGE_SESSION_STATUS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPL_MESSAGE_SESSION_STATUS</b>
structure contains information for the DPL_MSGID_SESSION_STATUS system message.
</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPL_MESSAGE_SESSION_STATUS{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwStatus;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvConnectionContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_MESSAGE_SESSION_STATUS,
*PDPL_MESSAGE_SESSION_STATUS;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_MESSAGE_SESSION_STATUS</b> message structure.
The application must set this member before it uses the structure.</p>

<p class=Term1><b>hSender</b></p>

<p class=Def1>The handle of the application that sent the status update
message.</p>

<p class=Term1><b>dwStatus</b></p>

<p class=Def1>Updated status of the session. This member can be set to one of
the following values.</p>

<p class=Term2>DPLSESSION_CONNECTED</p>

<p class=Def2>The lobbied application is currently connected to a session.</p>

<p class=Term2>DPLSESSION_COULDNOTCONNECT</p>

<p class=Def2>The lobbied application could not connect to the session.</p>

<p class=Term2>DPLSESSION_DISCONNECTED</p>

<p class=Def2>The lobbied application is currently disconnected from the
session.</p>

<p class=Term2>DPLSESSION_TERMINATED</p>

<p class=Def2>The connection between session host and the lobbied application
has been terminated.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATED</p>

<p class=Def2>The host of a peer-to-peer session has migrated. The local client
is not the new host.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATEDHERE</p>

<p class=Def2>The host of a peer-to-peer session has migrated. The local client
is the new host.</p>

<p class=Term1><b>pvConnectionContext</b></p>

<p class=Def1>Context value that has been set for the connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobbied applications, the
context value is set through the <b>pvConnectionContext</b> member of the <b>DPL_MESSAGE_CONNECT</b>
message structure. When your message handler receives this message, whatever
you set this member to before returning will be the context value for that
connection. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For lobby clients, the <i>pvConnectionContext</i>
in the <b>IDirectPlay8LobbyClient::ConnectApplication</b> method will be used
as the connection's context value if the connection is successful. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Context values are not shared
between lobby client and lobbied application. For example, if you set your
context value for a lobby connection in your <b>IDirectPlay8LobbyClient</b>
interface to pointer A and in your <b>IDirectPlay8LobbiedApplication</b>
interface you set it to pointer B, indications in your <b>IDirectPlay8LobbyClient</b>
interface will have pointer A as their context value and in your <b>IDirectPlay8LobbiedApplication</b>
interface pointer B will be the context value. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can also set your context
values to NULL if you do not want to use this feature. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_APPLICATION_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This message indicates that the
application description has been changed. There is no accompanying structure.
To determine the new application description, call the <b>GetApplicationDesc</b>
method exposed by <b>IDirectPlay8Peer</b>, <b>IDirectPlay8Client</b>, or <b>IDirectPlay8Server</b>
interfaces.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_ADD_PLAYER_TO_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_ADD_PLAYER_TO_GROUP message when a player has been added to a
group in a peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_ADD_PLAYER_TO_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_ADD_PLAYER_TO_GROUP</b>
structure contains information for the DPN_MSGID_ADD_PLAYER_TO_GROUP system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_ADD_PLAYER_TO_GROUP{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidGroup;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvGroupContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_ADD_PLAYER_TO_GROUP,
*PDPNMSG_ADD_PLAYER_TO_GROUP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidGroup</b></p>

<p class=Def1>DPNID of the group to add the player.</p>

<p class=Term1><b>pvGroupContext</b></p>

<p class=Def1>Group context value.</p>

<p class=Term1><b>dpnidPlayer</b></p>

<p class=Def1>DPNID of the player added to the group.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_ASYNC_OP_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_ASYNC_OP_COMPLETE message when an asynchronous request has
completed.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_ASYNC_OP_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_ASYNC_OP_COMPLETE</b>
structure contains information for the DPN_MSGID_ASYNC_OP_COMPLETE system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_ASYNC_OP_COMPLETE{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hAsyncOp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvUserContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hResultCode;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_ASYNC_OP_COMPLETE,
*PDPNMSG_ASYNC_OP_COMPLETE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>hAsyncOp</b></p>

<p class=Def1>Asynchronous operation handle.</p>

<p class=Term1><b>pvUserContext</b></p>

<p class=Def1>Supplied user context.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1>HRESULT indicating the result of the asynchronous operation.</p>

<p class=Le>&nbsp;</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_CLIENT_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_CLIENT_INFO message when client data is modified during a
client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_CLIENT_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_CLIENT_INFO</b>
structure contains information for the DPN_MSGID_CLIENT_INFO system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_CLIENT_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidClient;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_CLIENT_INFO,
*PDPNMSG_CLIENT_INFO;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidClient</b></p>

<p class=Def1>DPNID of the client for client information.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_CONNECT_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_CONNECT_COMPLETE message when the connection attempt has been
completed in a peer-to-peer or client/server session. This message is generated
whether or not the connection was successful.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_CONNECT_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_CONNECT_COMPLETE</b>
structure contains information for the DPN_MSGID_CONNECT_COMPLETE system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_CONNECT_COMPLETE{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hAsyncOp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvUserContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hResultCode;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvApplicationReplyData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwApplicationReplyDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_CONNECT_COMPLETE,
*PDPNMSG_CONNECT_COMPLETE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>hAsyncOp</b></p>

<p class=Def1>Asynchronous operation handle.</p>

<p class=Term1><b>pvUserContext</b></p>

<p class=Def1>User context supplied when the <b>IDirectPlay8Peer::Connect</b>
or <b>IDirectPlay8Client::Connect</b> methods are called.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1>HRESULT describing the result of the connection attempt. See the
Return Values section in the <b>IDirectPlay8Peer::Connect</b> or <b>IDirectPlay8Client::Connect</b>
method for more information. Additionally, DPNERR_PLAYERNOTREACHABLE will be
returned if a player has tried to join a peer-to-peer session where at least
one other existing player in the session cannot connect to the joining player.</p>

<p class=Term1><b>pvApplicationReplyData</b></p>

<p class=Def1>Connection reply data returned from the host or server.</p>

<p class=Term1><b>dwApplicationReplyDataSize</b></p>

<p class=Def1>Size of the data, in bytes, of the <b>pvApplicationReplyData</b>
member.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_CREATE_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_CREATE_GROUP message when a group is created.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_CREATE_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_CREATE_GROUP</b>
structure contains information for the DPN_MSGID_CREATE_GROUP system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_CREATE_GROUP{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidGroup;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidOwner;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvGroupContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_CREATE_GROUP,
*PDPNMSG_CREATE_GROUP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidGroup</b></p>

<p class=Def1>DPNID of the of the created group.</p>

<p class=Term1><b>dpnidOwner</b></p>

<p class=Def1>DPNID of the of the group's owner. This value is only set for
groups that have the DPNGROUP_AUTODESTRUCT flag set in the <b>dwGroupFlags</b>
member of the <b>DPN_GROUP_INFO</b> structure. </p>

<p class=Term1><b>pvGroupContext</b></p>

<p class=Def1>Group context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The only method of setting the
group context value is through this system message. Group context values once
set cannot be changed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_CREATE_PLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_CREATE_PLAYER message when a player is added to a peer-to-peer or
client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_CREATE_PLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_CREATE_PLAYER</b>
structure contains information for the DPN_MSGID_CREATE_PLAYER system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_CREATE_PLAYER{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_CREATE_PLAYER,
*PDPNMSG_CREATE_PLAYER;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidPlayer</b></p>

<p class=Def1>DPNID of the player that was added to the session.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The only method of setting the
player context value is through this system message. You can either set the
player context value directly, through this message, or indirectly through <b>DPN_MSGID_INDICATE_CONNECT</b>.
Once a player context value has been set, it cannot be changed.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Lb1><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_DESTROY_PLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_DESTROY_PLAYER message<span style='font-size:7.0pt'> </span>when
a player leaves a peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_DESTROY_PLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_DESTROY_PLAYER</b>
structure contains information for the DPN_MSGID_DESTROY_PLAYER system message.
</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_DESTROY_PLAYER{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReason;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_DESTROY_PLAYER,
*PDPNMSG_DESTROY_PLAYER;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidPlayer</b></p>

<p class=Def1>DPNID of the player deleted from the session.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Term1><b>dwReason</b></p>

<p class=Def1>One of the following flags indicating why the player was
destroyed.</p>

<p class=Term2>DPNDESTROYPLAYERREASON_NORMAL</p>

<p class=Def2>The player is being deleted for normal reasons.</p>

<p class=Term2>DPNDESTROYPLAYERREASON_CONNECTIONLOST</p>

<p class=Def2>The player is being deleted because the connection was lost.</p>

<p class=Term2>DPNDESTROYPLAYERREASON_SESSIONTERMINATED</p>

<p class=Def2>The player is being deleted because the session was terminated.</p>

<p class=Term2>DPNDESTROYPLAYERREASON_HOSTDESTROYEDPLAYER</p>

<p class=Def2>The player is being deleted because the host called <b>IDirectPlay8Peer::DestroyPeer</b>.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In client/server mode, this
message is received only by the server. In peer-to-peer mode, all players
receive this message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You may receive <b>DPN_MSGID_CREATE_PLAYER</b>
and <b>DPN_MSGID_DESTROY_PLAYER</b> messages on different threads. However, you
will not receive a <b>DPN_MSGID_DESTROY_PLAYER</b> message before your callback
function has returned from receiving a <b>DPN_MSGID_CREATE_PLAYER</b> message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_DESTROY_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_DESTROY_GROUP message when a group is destroyed from a
peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_DESTROY_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_DESTROY_GROUP</b>
structure contains information for the DPN_MSGID_DESTROY_GROUP system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_DESTROY_GROUP{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidGroup;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvGroupContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReason;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_DESTROY_GROUP,
*PDPNMSG_DESTROY_GROUP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidGroup</b></p>

<p class=Def1>DPNID of the group deleted from the session.</p>

<p class=Term1><b>pvGroupContext</b></p>

<p class=Def1>Group context value.</p>

<p class=Term1><b>dwReason</b></p>

<p class=Def1>One of the following flags indicating why the player was
destroyed.</p>

<p class=Term2>DPNDESTROYGROUPREASON_SESSIONTERMINATED</p>

<p class=Def2>The group is being destroyed because the session was terminated.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Le>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_ENUM_HOSTS_QUERY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay sends the
DPN_MSGID_ENUM_HOSTS_QUERY message to the host's message handler when a peer or
client is enumerating the available hosts.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_ENUM_HOSTS_QUERY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_ENUM_HOSTS_QUERY</b>
structure contains information for the DPN_MSGID_ENUM_HOSTS_QUERY system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_ENUM_HOSTS_QUERY{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvReceivedData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwReceivedDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMaxResponseDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvResponseData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwResponseDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvResponseContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_ENUM_HOSTS_QUERY,
*PDPNMSG_ENUM_HOSTS_QUERY;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>pAddressSender</b></p>

<p class=Def1>Pointer an <b>IDirectPlay8Address</b> interface specifying the
address of the sender. You must call <b>IDirectPlay8Address::AddRef</b> to
increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Term1><b>pAddressDevice</b></p>

<p class=Def1>Pointer an <b>IDirectPlay8Address</b> interface specifying the
address of the device. You must call <b>IDirectPlay8Address::AddRef</b> to
increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Term1><b>pvReceivedData</b></p>

<p class=Def1>Pointer to the data received from the enumeration.</p>

<p class=Term1><b>dwReceivedDataSize</b></p>

<p class=Def1>Size of the data pointed to in the <b>pvReceivedData</b> member.</p>

<p class=Term1><b>dwMaxResponseDataSize</b></p>

<p class=Def1>Maximum allowed size for the enumeration response.</p>

<p class=Term1><b>pvResponseData</b></p>

<p class=Def1>Pointer to the response data from the enumeration. This data must
be valid beyond the scope of the callback message handler. It cannot be
stack-based. You will receive a <b>DPN_MSGID_RETURN_BUFFER</b> message when
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> is finished with this buffer.</p>

<p class=Term1><b>dwResponseDataSize</b></p>

<p class=Def1>Size of the data pointed to in the <b>pvResponseData</b> member.</p>

<p class=Term1><b>pvUserContext</b></p>

<p class=Def1>Pointer to a response context value. This value will be passed to
the host's message handler with the <b>DPN_MSGID_RETURN_BUFFER</b> message as
the <b>pvUserContext</b> member of the associated structure.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you respond normally to
this query, DirectPlay will send you a <b>DPN_MSGID_RETURN_BUFFER</b> message
once the buffer is no longer needed. You can then safely free the buffer.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can reject the query by
returning a value that is not equal to S_OK. However, when you reject a query,
DirectPlay does not send a reply, does not need a reply buffer, and does not
generate a <b>DPN_MSGID_RETURN_BUFFER</b> message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_ENUM_HOSTS_RESPONSE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay sends the
DPN_MSGID_ENUM_HOSTS_RESPONSE message to a peer or client's message handler to
convey the host's response to an enumeration request.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_ENUM_HOSTS_RESPONSE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_ENUM_HOSTS_RESPONSE</b>
structure contains information for the DPN_MSGID_ENUM_HOSTS_RESPONSE system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_ENUM_HOSTS_RESPONSE{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> const DPN_APPLICATION_DESC*
pApplicationDescription;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvResponseData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwResponseDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID
pvUserContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwRoundTripLatencyMS;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_ENUM_HOSTS_RESPONSE,
*PDPNMSG_ENUM_HOSTS_RESPONSE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>pAddressSender</b></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address</b> interface specifying the
address of the host responding to the enumeration. You must call <b>IDirectPlay8Address::AddRef</b>
to increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Term1><b>pAddressDevice</b></p>

<p class=Def1>Pointer an <b>IDirectPlay8Address</b> interface specifying the
address of the device. You must call <b>IDirectPlay8Address::AddRef</b> to
increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Term1><b>pApplicationDescription</b></p>

<p class=Def1>Pointer to a <b>DPN_APPLICATION_DESC</b> structure containing the
application description. </p>

<p class=Term1><b>pvResponseData</b></p>

<p class=Def1>Pointer to the response data from the enumeration.</p>

<p class=Term1><b>dwResponseDataSize</b></p>

<p class=Def1>Size of the data pointed to in the <b>pvResponseData</b> member.</p>

<p class=Term1><b>pvUserContext</b></p>

<p class=Def1>Pointer to the user context value. This value is the same as the
user context value passed to <b>IDirectPlay8Peer::EnumHosts</b> or <b>IDirectPlay8Client::EnumHosts</b>.</p>

<p class=Term1><b>dwRoundTripLatencyMS</b></p>

<p class=Def1>Latency measured in milliseconds.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because there is no buffer to
fill, this message does not generate a <b>DPN_MSGID_RETURN_BUFFER</b> message.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_GROUP_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_GROUP_INFO message when group data is modified during a
peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_GROUP_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_GROUP_INFO</b>
structure contains information for the DPN_MSGID_GROUP_INFO system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_GROUP_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidGroup;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvGroupContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_GROUP_INFO,
*PDPNMSG_GROUP_INFO;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidGroup</b></p>

<p class=Def1>DPNID of the group for group information.</p>

<p class=Term1><b>pvGroupContext</b></p>

<p class=Def1>Group context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_HOST_MIGRATE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_HOST_MIGRATE message if the DPNSESSION_MIGRATE_HOST flag is set
in the <b>DPN_APPLICATION_DESC</b> structure and the host has migrated.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_HOST_MIGRATE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_HOST_MIGRATE</b>
structure contains information for the DPN_MSGID_HOST_MIGRATE system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPNMSG_HOST_MIGRATE{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidNewHost;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_HOST_MIGRATE,
*PDPNMSG_HOST_MIGRATE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidNewHost</b></p>

<p class=Def1>DPNID of the player that is now hosting the session.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_INDICATE_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_INDICATE_CONNECT message when a player attempts to connect to a
peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_INDICATE_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_INDICATE_CONNECT</b>
structure contains information for the DPN_MSGID_INDICATE_CONNECT system
message. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This structure gives the
opportunity for the host application to allow or reject the connection based on
user data and provide reply information to the connecting application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvUserConnectData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwUserConnectDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvReplyData; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReplyDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvReplyContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pAddressDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_INDICATE_CONNECT,
*PDPNMSG_INDICATE_CONNECT;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>pvUserConnectData</b></p>

<p class=Def1>Data of the connecting player.</p>

<p class=Term1><b>dwUserConnectDataSize</b></p>

<p class=Def1>Size of the data, in bytes, contained in the <b>pvUserConnectData</b>
member.</p>

<p class=Term1><b>pvReplyData</b></p>

<p class=Def1>Connection reply data. This data must be valid beyond the scope
of the callback message handler. You will receive a <b>DPN_MSGID_RETURN_BUFFER</b>
message when Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> is finished with this buffer.</p>

<p class=Term1><b>dwReplyDataSize</b></p>

<p class=Def1>Size of the data, in bytes, contained in the <b>pvReplyData</b>
member.</p>

<p class=Term1><b>pvReplyContext</b></p>

<p class=Def1>Buffer context for <b>pvReplyData</b>. This value will be passed
to the host's message handler with the <b>DPN_MSGID_RETURN_BUFFER</b> message
as the <b>pvUserContext</b> member of the associated structure.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context preset.</p>

<p class=Term1><b>pAddressPlayer</b></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address </b>interface for the
connecting player. You must call <b>IDirectPlay8Address::AddRef</b> to
increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Term1><b>pAddressDevice</b></p>

<p class=Def1>Pointer to an <b>IDirectPlay8Address </b>interface for the device
receiving the connect attempt. You must call <b>IDirectPlay8Address::AddRef</b>
to increment the interface's reference count. Call <b>IDirectPlay8Address::Release</b>
when you no longer need the interface.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Return S_OK to allow the player
to join the session. Any other return value will reject the requested
connection. The <b>hResultCode </b>member of the structure associated with the <b>DPN_MSGID_CONNECT_COMPLETE</b>
message that is sent to the player requesting a connection will be set to S_OK
if the connection was successful. If the connection is rejected, <b>hResultCode
</b>will be set to DPNERR_HOSTREJECTEDCONNECTION, not the value you return from
this message.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When an <b>DPN_MSGID_INDICATE_CONNECT</b>
notification arrives on the host player's message handler, setting <b>pvPlayerContext</b>
before returning the thread will preset the player context value on the
respective <b>DPN_MSGID_CREATE_PLAYER</b> notification. This feature allows you
to pass a player context value to <b>DPN_MSGID_CREATE_PLAYER</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you set a player context
value, that value is not frozen until the subsequent <b>DPN_MSGID_CREATE_PLAYER</b>message
has been processed. You thus have the option of modifying this player context
value when you process <b>DPN_MSGID_CREATE_PLAYER</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If a client drops the connection
after the server has processed the <b>DPN_MSGID_INDICATE_CONNECT</b> message
but before it has processed <b>DPN_MSGID_CREATE_PLAYER</b>, the server will
receive a <b>DPN_MSGID_INDICATED_CONNECT_ABORTED</b> message. If you receive
this message, free any memory that you allocated while processing <b>DPN_MSGID_INDICATE_CONNECT</b>.
Once <b>DPN_MSGID_CREATE_PLAYER</b> has been processed, this memory should be
freed when you process <b>DPN_MSGID_DESTROY_PLAYER</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you specify a value for <b>pvUserConnectData</b>,<b>
</b>you will subsequently be sent a <b>DPN_MSGID_RETURN_BUFFER</b> message to
notify you that you can safely free the buffer.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_INDICATED_CONNECT_ABORTED</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_INDICATED_CONNECT_ABORTED message if a player's connection drops
after it was indicated on the host, but prior to being added to the session
though <b>DPN_MSGID_CREATE_PLAYER</b>.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_INDICATED_CONNECT_ABORTED</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_INDICATED_CONNECT_ABORTED</b>
structure contains information for the DPN_MSGID_INDICATED_CONNECT_ABORTED
system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_INDICATED_CONNECT_ABORTED,
*PDPNMSG_INDICATED_CONNECT_ABORTED;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_PEER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_PEER_INFO message when peer data is modified during a
peer-to-peer session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_PEER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_PEER_INFO</b>
structure contains information for the DPN_MSGID_PEER_INFO system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidPeer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_PEER_INFO,
*PDPNMSG_PEER_INFO;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidPeer</b></p>

<p class=Def1>DPNID of the peer for peer information.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_RECEIVE message when a message has been processed by the
receiver.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_RECEIVE</b>
structure contains information for the DPN_MSGID_RECEIVE system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidSender;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PBYTE pReceiveData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReceiveDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hBufferHandle; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_RECEIVE, *PDPNMSG_RECEIVE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidSender</b></p>

<p class=Def1>DPNID of the player that sent the message.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value of the player that sent the message.</p>

<p class=Term1><b>pReceiveData</b></p>

<p class=Def1>PBYTE pointer to the message data buffer. This buffer is normally
only valid while the <b>DPN_MSGID_RECEIVE</b> message is being processed by the
callback message handler. Because you should not spend large amounts of time
processing messages, you should copy this data, and process the message.
Alternatively, you can return DPNSUCCESS_PENDING from the callback message
handler. Doing so transfers ownership of the buffer to the application. If you
return DPNSUCCESS_PENDING, you must call <b>IDirectPlay8Peer::ReturnBuffer</b>,
<b>IDirectPlay8Client::ReturnBuffer</b>, or <b>IDirectPlay8Server::ReturnBuffer</b>
when you are finished with the buffer. Pass the method the value you receive in
the <b>hBufferHandle </b>member to identify the buffer. If you fail to call <b>ReturnBuffer</b>,
you will create a memory leak.</p>

<p class=Term1><b>dwReceiveDataSize</b></p>

<p class=Def1>Size of the data, in bytes, of the <b>pReceiveData</b> member.</p>

<p class=Term1><b>hBufferHandle</b></p>

<p class=Def1>Buffer handle for the <b>pReceiveData</b> member. If you have
returned DPNSUCCESS_PENDING , pass this value to <b>ReturnBuffer</b> to notify
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> to free the buffer.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_REMOVE_PLAYER_FROM_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_REMOVE_PLAYER_FROM_GROUP message when a player has been deleted
from a group in a peer-to-peer or client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_REMOVE_PLAYER_FROM_GROUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_REMOVE_PLAYER_FROM_GROUP</b>
structure contains information for the DPN_MSGID_REMOVE_PLAYER_FROM_GROUP
system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPNMSG_REMOVE_PLAYER_FROM_GROUP{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidGroup;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvGroupContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_REMOVE_PLAYER_FROM_GROUP,
*PDPNMSG_REMOVE_PLAYER_FROM_GROUP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidGroup</b></p>

<p class=Def1>DPNID of the group that the player was deleted from.</p>

<p class=Term1><b>pvGroupContext</b></p>

<p class=Def1>Group context value.</p>

<p class=Term1><b>dpnidPlayer</b></p>

<p class=Def1>DPNID of the player deleted from the group.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_RETURN_BUFFER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_RETURN_BUFFER message when DirectPlay is done with a user buffer.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_RETURN_BUFFER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_RETURN_BUFFER</b>
structure contains information for the DPN_MSGID_RETURN_BUFFER system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hResultCode;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvBuffer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pUserContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_RETURN_BUFFER,
*PDPNMSG_RETURN_BUFFER;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1>Return value of the operation. This will be set to
DPNERR_ENUMRESPONSETOOLARGE if the response to a <b>DPN_MSGID_ENUM_HOSTS_QUERY</b>
message is too large.</p>

<p class=Term1><b>pvBuffer</b></p>

<p class=Def1>Pointer to the buffer being returned.</p>

<p class=Term1><b>pUserContext</b></p>

<p class=Def1>Context value associated with the buffer.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_SEND_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_SEND_COMPLETE message when a send message request has completed.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_SEND_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_SEND_COMPLETE</b>
structure contains information for the DPN_MSGID_SEND_COMPLETE system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHANDLE hAsyncOp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvUserContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hResultCode;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSendTime;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_SEND_COMPLETE,
*PDPNMSG_SEND_COMPLETE;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>hAsyncOp</b></p>

<p class=Def1>Asynchronous operation handle.</p>

<p class=Term1><b>pvUserContext</b></p>

<p class=Def1>User context supplied in the <b>IDirectPlay8Client::Send</b>, <b>IDirectPlay8Peer::SendTo</b>
and <b>IDirectPlay8Server::SendTo</b> methods.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1>HRESULT indicating the result of the send message request.</p>

<p class=Term1><b>dwSendTime</b></p>

<p class=Def1>Total time, in milliseconds, between send call and completion.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_SERVER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_SERVER_INFO message when server data is modified during a
client/server session.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_SERVER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_SERVER_INFO</b>
structure contains information for the DPN_MSGID_SERVER_INFO system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID dpnidServer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_SERVER_INFO,
*PDPNMSG_SERVER_INFO;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>dpnidServer</b></p>

<p class=Def1>DPNID of the server for server information.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_MSGID_TERMINATE_SESSION</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay generates
the DPN_MSGID_TERMINATE_SESSION message when a session is terminated by the
host.</p>

<p class=Rh2 style='page-break-after:avoid'>DPNMSG_TERMINATE_SESSION</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DPNMSG_TERMINATE_SESSION</b>
structure contains information for the DPN_MSGID_TERMINATE_SESSION system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hResultCode;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvTerminateData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwTerminateDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPNMSG_TERMINATE_SESSION,
*PDPNMSG_TERMINATE_SESSION;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of this structure.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1>Specifies how the session was terminated. This member is set to
DPNERR<b>_</b>HOSTTERMINATEDSESSION if the session was peer-to-peer, and the
host called <b>IDirectPlay8Peer::TerminateSession</b>. If the session was ended
by the host calling <b>Close</b>, or if the host stops responding, <b>hResultCode
</b>is set to DPNERR_CONNECTIONLOST. </p>

<p class=Term1><b>pvTerminateData</b></p>

<p class=Def1>Termination data. If <b>hResultCode</b> is set to
DPNERR_HOSTTERMINATEDSESSION, <b>pvTerminateData</b> points to the data block
that the host passed through the <i>pvTerminateData</i> parameter of <b>IDirectPlay8Peer::TerminateSession</b>.</p>

<p class=Term1><b>dwTerminateDataSize</b></p>

<p class=Def1>Size of the data block pointed to by <b>pvTerminateData</b>. This
member will be zero if <b>pvTerminateData </b>is set to NULL.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a peer-peer game that permits
host-migration, if the current host calls <b>Close</b> or stops responding, the
session does not terminate. Instead, the host migrates and all nonhost players
receive a <b>DPN_MSGID_DESTROY_PLAYER</b> message for the host's players, and a
<b>DPN_MSGID_HOST_MIGRATE</b> message for the new host. To prevent host
migration, the host must shut down the session by calling <b>IDirectPlay8Peer::TerminateSession</b>.
When the host terminates a session this way, all players receive a <b>DPN_MSGID_TERMINATE_SESSION</b>
message with <b>hResultCode</b> set to DPNERR<b>_</b>HOSTTERMINATEDSESSION. The
session will terminate, generating <b>DPN_MSGID_DESTROY_PLAYER</b> messages for
every player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a peer-peer game that does
not permit host-migration, the session is terminated if the host calls <b>IDirectPlay8Peer::Close</b>,
or stops responding. In that case, <b>DPN_MSGID_TERMINATE_SESSION</b> is sent
to all players with <b>hResultCode</b> set to DPNERR_CONNECTIONLOST. The
session will terminate, generating <b>DPN_MSGID_DESTROY_PLAYER</b> messages for
every player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a client/server game, the
session is also terminated if the host calls <b>IDirectPlay8Server::Close</b>
or stops responding. In that case, <b>DPN_MSGID_TERMINATE_SESSION</b> is sent
to all connected clients with <b>hResultCode</b> set to DPNERR_CONNECTIONLOST.
The <b>DPN_MSGID_DESTROY_PLAYER</b> message not sent to clients. If the server
disconnected by calling <b>IDirectPlay8Server::Close</b>, it will receive <b>DPN_MSGID_DESTROY_PLAYER</b>
messages for all players, including its own. Otherwise, the server will only
receive <b>DPN_MSGID_DESTROY_PLAYER</b> for the clients' players.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>The <b>DPN_MSGID_TERMINATE_SESSION</b> message typically arrives
before any <b>DPN_MSGID_DESTROY_PLAYER</b> messages. However, the order of
arrival is not guaranteed.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_CONNECTRESULT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_CONNECTRESULT message when the connect request generated
through a call to the <b>IDirectPlayVoiceClient::Connect</b> method has
completed. This message is sent only if the <b>Connect</b> method is called
asynchronously.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_CONNECTRESULT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_CONNECTRESULT</b>
structure contains information for the DVMSGID_CONNECTRESULT system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hrResult;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_CONNECTRESULT,
*LPDVMSG_CONNECTRESULT, *PDVMSG_CONNECTRESULT;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_CONNECTRESULT</b> message structure.</p>

<p class=Term1><b>hrResult</b></p>

<p class=Def1>Result of the connection attempt.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_CREATEVOICEPLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_CREATEVOICEPLAYER message when a new player joins the
voice session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Upon connecting to a voice
session, clients will receive one of these messages for each player in the
voice session. These messages are sent only to clients in peer-to-peer voice
sessions.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The host receives these messages
when players join the voice session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Players do not join the voice
session until they have called <b>IDirectPlayVoiceClient::Connect</b>.
Therefore, it is possible for a player to be in the transport session but not
part of the voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_CREATEVOICEPLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_CREATEVOICEPLAYER</b>
structure contains information for the DVMSGID_CREATEVOICEPLAYER system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID dvidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_CREATEVOICEPLAYER,
*LPDVMSG_CREATEVOICEPLAYER, *PDVMSG_CREATEVOICEPLAYER;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the this message structure.</p>

<p class=Term1><b>dvidPlayer</b></p>

<p class=Def1>DVID of the player who connected.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Flag specifying information about the player:</p>

<p class=Term2>DVPLAYERCAPS_HALFDUPLEX</p>

<p class=Def2>The specified player is running in half duplex mode. The player
will only be able to receive voice, not transmit it.</p>

<p class=Term2>DVPLAYERCAPS_LOCAL</p>

<p class=Def2>The player is the local player.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Player context value for the player in the voice session. This
value is set through this parameter when this message is received.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_DELETEVOICEPLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For clients, Microsoft
DirectPlay Voice generates the DVMSGID_DELETEVOICEPLAYER message when a player
quits the voice session. This message is available only to clients in
peer-to-peer voice sessions.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For the host, Microsoft
DirectPlay Voice generates the DVMSGID_DELETEVOICEPLAYER message when a player
quits the voice session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Players do not leave the voice
session until they have called <b>IDirectPlayVoiceClient::Disconnect</b> or
they have disconnected from the transport session. Therefore, a client might be
part of the transport session but not part of the voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_DELETEVOICEPLAYER</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_DELETEVOICEPLAYER</b>
structure contains information for the DVMSGID_DELETEVOICEPLAYER system
message.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID dvidPlayer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_DELETEVOICEPLAYER,
*LPDVMSG_DELETEVOICEPLAYER, *PDVMSG_DELETEVOICEPLAYER;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_DELETEVOICEPLAYER</b> message structure. </p>

<p class=Term1><b>dvidPlayer</b></p>

<p class=Def1>DVID of player who disconnected.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the player. This value is
set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_DISCONNECTRESULT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_DISCONNECTRESULT message when the disconnect request
generated through a call to the <b>IDirectPlayVoiceClient::Disconnect</b>
method has completed. This message is sent only if the <b>Disconnect</b> method
is called asynchronously.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_DISCONNECTRESULT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_DISCONNECTRESULT</b>
structure contains information for the DVMSGID_DISCONNECTRESULT system message.
</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hrResult;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_DISCONNECTRESULT,
*LPDVMSG_DISCONNECTRESULT, *PDVMSG_DISCONNECTRESULT;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_DISCONNECTRESULT</b> message structure. </p>

<p class=Term1><b>hrResult</b></p>

<p class=Def1>Result of the disconnect request.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_GAINFOCUS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DVMSGID_GAINFOCUS message is
sent to notify you that you have begun capturing audio. It is sent when an
application that has lost capture focus recovers it. There is no data
associated with this message. Refer to the Microsoft<span style='font-size:
7.0pt'></span> DirectSound<span style='font-size:7.0pt'></span> documentation
for more information on capturing audio.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_HOSTMIGRATED</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_HOSTMIGRATED message when the voice host has changed.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_HOSTMIGRATED</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_HOSTMIGRATED</b>
structure contains information for the DVMSGID_HOSTMIGRATED system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID
dvidNewHostID;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPDIRECTPLAYVOICESERVER
pdvServerInterface;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_HOSTMIGRATED,
*LPDVMSG_HOSTMIGRATED, *PDVMSG_HOSTMIGRATED;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_HOSTMIGRATED</b> message structure. </p>

<p class=Term1><b>dvidNewHostID</b></p>

<p class=Def1>DVID of the new host.</p>

<p class=Term1><b>pdvServerInterface</b></p>

<p class=Def1>If the local client has become the new voice session host, this
member will point to a newly created <b>IDirectPlayVoiceServer</b> object that
can be used by the local client for providing host services. If the local
client is not the new host, then this member will be NULL. If this parameter
points to an <b>IDirectPlayVoiceServer</b> interface, you must call <b>IDirectPlayVoiceServer::AddRef</b>
to increment the interface's reference count. Call <b>IDirectPlayVoiceServer::Release</b>
when you no longer need the interface.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_INPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_INPUTLEVEL message periodically to notify the user of the
input level from the microphone. The period of notification is set by the <b>dwNotifyPeriod</b>
member of the <b>DVCLIENTCONFIG</b> structure. If the notification period is
set to 0, this message will not be sent. In addition, if the client is running
in half duplex mode, this message is not available.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_INPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_INPUTLEVEL</b>
structure contains information for the DVMSGID_INPUTLEVEL system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakLevel;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LONG lRecordVolume;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLocalPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_INPUTLEVEL,
*LPDVMSG_INPUTLEVEL, *PDVMSG_INPUTLEVEL;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_INPUTLEVEL</b> message structure. </p>

<p class=Term1><b>dwPeakLevel</b></p>

<p class=Def1>Integer representing peak level across the current frame, which
corresponds to approximately 1/10 second of audio stream. The current frame
typically lags 50-200 ms behind real-time. This value can range from 0 through
99, with 0 being completely silent and 99 being the highest possible input
level.</p>

<p class=Term1><b>lRecordVolume</b></p>

<p class=Def1>Current recording volume for the client. The value can range from
-10,000 to 0. This member is available even when automatic gain control is
active.</p>

<p class=Term1><b>pvLocalPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the local player. This value
is set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_LOCALHOSTSETUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DVMSGID_LOCALHOSTSETUP
message is sent when the local client is elected to become the new voice host
during host migration. The message is sent before the DVMSGID_HOSTMIGRATED
message and gives you the chance to set the callback function and context value
that will be used when creating the new host object. If you do not set either
of the values, then the new server interface will have no callback function.
Once the application returns from handling this message it will receive the
DVMSGID_HOSTMIGRATED message. The new message has the following associated
structure, which is passed in the void * field of the message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_LOCALHOSTSETUP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_LOCALHOSTSETUP</b>
structure contains information for the DVMSGID_LOCALHOSTSETUP system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PDVMESSAGEHANDLER pMessageHandler;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_LOCALHOSTSETUP,
*LPDVMSG_LOCALHOSTSETUP, *PDVMSG_LOCALHOSTSETUP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_LOCALHOSTSETUP</b> message structure. </p>

<p class=Term1><b>pvContext</b></p>

<p class=Def1>Set to the context value you want to set for the new server.</p>

<p class=Term1><b>pMessageHandler</b></p>

<p class=Def1>Set to the callback function to be used for the new server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_LOSTFOCUS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DVMSGID_LOSTFOCUS message is
sent to notify you that you have stopped capturing audio. It is sent when an
application that has capture focus loses it to another application. There is no
data associated with this message. Refer to the Microsoft<span
style='font-size:7.0pt'></span> DirectSound<span style='font-size:7.0pt'></span>
documentation for more information on capturing audio.</p>

<p class=Def1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_OUTPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_OUTPUTLEVEL message periodically to notify the user of
the output level of playback. The period of notification is set by the <b>dwNotifyPeriod</b>
member of the <b>DVCLIENTCONFIG</b> structure. If the notification period is
set to 0, this message will not be sent.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_OUTPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_OUTPUTLEVEL</b>
structure contains information for the DVMSGID_OUTPUTLEVEL system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakLevel;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LONG lOutputVolume;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLocalPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_OUTPUTLEVEL,
*LPDVMSG_OUTPUTLEVEL, *PDVMSG_OUTPUTLEVEL;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_OUTPUTLEVEL</b> message structure. </p>

<p class=Term1><b>dwPeakLevel</b></p>

<p class=Def1>Integer representing the current output level of playback. This
value is in the range from 0 through 99, with 0 being completely silent and 99
being the highest possible output level.</p>

<p class=Term1><b>lOutputVolume</b></p>

<p class=Def1>Current playback volume for the client.</p>

<p class=Term1><b>pvLocalPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the local player. This value
is set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_PLAYEROUTPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_PLAYEROUTPUTLEVEL message periodically to notify the user
of the output level of an individual players voice stream. It is generated
while voice is being played back for an individual player. If multiple player
voices are being played, one message for each player speaking will be sent each
notification period.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The period of notification is
set by the <b>dwNotifyPeriod</b> member of the <b>DVCLIENTCONFIG</b> structure.
If the notification period is set to 0, this message will not be sent.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_PLAYEROUTPUTLEVEL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_PLAYEROUTPUTLEVEL</b>
structure contains information for the DVMSGID_PLAYEROUTPUTLEVEL system
message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID dvidSourcePlayerID;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakLevel;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_PLAYEROUTPUTLEVEL,
*LPDVMSG_PLAYEROUTPUTLEVEL, *PDVMSG_PLAYEROUTPUTLEVEL;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_PLAYEROUTPUTLEVEL</b> message structure. </p>

<p class=Term1><b>dvidSourcePlayerID</b></p>

<p class=Def1>DVID of the player whose voice is being played back.</p>

<p class=Term1><b>dwPeakLevel</b></p>

<p class=Def1>Integer representing the current output level of the players
voice stream. This value is in the range from 0 through 99, with 0 being
completely silent and 99 being the highest possible output level.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the player. This value is
set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_PLAYERVOICESTART</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_PLAYERVOICESTART message when an incoming audio stream
begins playing back.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_PLAYERVOICESTART</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_PLAYERVOICESTART</b>
structure contains information for the DVMSGID_PLAYERVOICESTART system message.
</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID dvidSourcePlayerID;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_PLAYERVOICESTART,
*LPDVMSG_PLAYERVOICESTART, *PDVMSG_PLAYERVOICESTART;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_PLAYERVOICESTART</b> message structure. </p>

<p class=Term1><b>dvidSourcePlayerID</b></p>

<p class=Def1>DVID of the player where the voice transmission originated.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the player. This value is
set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_PLAYERVOICESTOP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_PLAYERVOICESTOP message when an incoming audio stream
stops.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_PLAYERVOICESTOP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_PLAYERVOICESTOP</b>
structure contains information for the DVMSGID_PLAYERVOICESTOP system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID dvidSourcePlayerID;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_PLAYERVOICESTOP,
*LPDVMSG_PLAYERVOICESTOP, *PDVMSG_PLAYERVOICESTOP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_PLAYERVOICESTOP</b> message structure. </p>

<p class=Term1><b>dvidSourcePlayerID</b></p>

<p class=Def1>DVID of the player where the voice transmission originated.</p>

<p class=Term1><b>pvPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the player. This value is
set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_RECORDSTART</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_RECORDSTART message when audio input on the local client
begins. This can be caused by the voice activation sensitivity level being
exceeded or when a valid target is specified in push-to-talk mode.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_RECORDSTART</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_RECORDSTART</b>
structure contains information for the DVMSGID_RECORDSTART system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakLevel;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLocalPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_RECORDSTART,
*LPDVMSG_RECORDSTART, *PDVMSG_RECORDSTART;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_RECORDSTART</b> message structure. </p>

<p class=Term1><b>dwPeakLevel</b></p>

<p class=Def1>Voice activation level that caused the transmission to begin. In
push-to-talk mode, this value is 0.</p>

<p class=Term1><b>pvLocalPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the local player. This value
is set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_RECORDSTOP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_RECORDSTOP message when audio input on the local client
stops. This can be caused by the voice activation sensitivity level not being
reached or when a target is deselected in push-to-talk mode.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_RECORDSTOP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_RECORDSTOP</b>
structure contains information for the DVMSGID_RECORDSTOP system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakLevel;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLocalPlayerContext;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_RECORDSTOP,
*LPDVMSG_RECORDSTOP, *PDVMSG_RECORDSTOP;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_RECORDSTOP</b> message structure. </p>

<p class=Term1><b>dwPeakLevel</b></p>

<p class=Def1>Voice activation level that caused the transmission to stop. In
push-to-talk mode, this value is 0.</p>

<p class=Term1><b>pvLocalPlayerContext</b></p>

<p class=Def1>Pointer to the context value set for the local player. This value
is set through the <b>pvPlayerContext</b> member of the <b>DVMSG_CREATEVOICEPLAYER</b>
message structure.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_SESSIONLOST</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_SESSIONLOST message when the voice session terminates.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_SESSIONLOST</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_SESSIONLOST</b>
structure contains information for the DVMSGID_SESSIONLOST system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HRESULT hrResult; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_SESSIONLOST,
*LPDVMSG_SESSIONLOST, *PDVMSG_SESSIONLOST;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_SESSIONLOST</b> message structure. </p>

<p class=Term1><b>hrResult</b></p>

<p class=Def1>HRESULT indicating why the session was terminated.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVMSGID_SETTARGETS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft DirectPlay Voice
generates the DVMSGID_SETTARGETS message when the <b>IDirectPlayVoiceClient::SetTransmitTargets</b>
or <b>IDirectPlayVoiceServer::SetTransmitTargets</b> methods are called.</p>

<p class=Rh2 style='page-break-after:avoid'>DVMSG_SETTARGETS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVMSG_SETTARGETS</b>
structure contains information for the DVMSGID_SETTARGETS system message. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwNumTargets;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PDVID pdvidTargets;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVMSG_SETTARGETS,
*LPDVMSG_SETTARGETS, *PDVMSG_SETTARGETS;</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DVMSG_SETTARGETS</b> message structure. </p>

<p class=Term1><b>dwNumTargets</b></p>

<p class=Def1>Number of DVIDs contained in the <b>pdvidTargets</b> member.</p>

<p class=Term1><b>pdvidTargets</b></p>

<p class=Def1>Array of DVIDs specifying the set targets. This can also be set
to NULL if there are no targets.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Structures</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
structures are: </p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_APPLICATION_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_CONNECT_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_CONNECTION_SETTINGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_PROGRAM_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_APPLICATION_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_BUFFER_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_CAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_CONNECTION_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_GROUP_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_PLAYER_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SECURITY_CREDENTIALS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SECURITY_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SERVICE_PROVIDER_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SP_CAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCLIENTCONFIG</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCOMPRESSIONINFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVSESSIONDESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVSOUNDDEVICECONFIG</b></span></p>

<p class=Leh>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_APPLICATION_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used in the <i>pEnumData</i>
parameter of the <b>IDirectPlay8LobbyClient::EnumLocalPrograms</b> method to
describe the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPL_APPLICATION_INFO {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidApplication;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszApplicationName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwNumRunning;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwNumWaiting;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_APPLICATION_INFO,
*PDPL_APPLICATION_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>Variable of type GUID specifying the lobbied application.</p>

<p class=Term1><b>pwszApplicationName</b></p>

<p class=Def1>Pointer to a variable of type <b>WSTR</b> containing the name of
the lobbied application.</p>

<p class=Term1><b>dwNumRunning</b></p>

<p class=Def1>Number of instances of the application.</p>

<p class=Term1><b>dwNumWaiting</b></p>

<p class=Def1>Number of clients waiting to connect to the lobbied application.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_CONNECT_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to specify connection
information for a lobby client when connecting to the lobby application in the <b>IDirectPlay8LobbyClient::ConnectApplication</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPL_CONNECT_INFO {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidApplication;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PDPL_CONNECTION_SETTINGS
pdplConnectionSettings;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvLobbyConnectData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwLobbyConnectDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_CONNECT_INFO,
*PDPL_CONNECT_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_CONNECT_INFO</b> structure. The application
must set this member before it uses the structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>One of the following flags, which determine connection behavior.</p>

<p class=Term2>DPLCONNECT_LAUNCHNEW</p>

<p class=Def2>Launches a new instance of the application.</p>

<p class=Term2>DPLCONNECT_LAUNCHNOTFOUND</p>

<p class=Def2>Launches a new instance of the application only if there is
currently no application running that can supply launch settings.</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>Variable of type GUID specifying the application.</p>

<p class=Term1><b>pdplConnectionSettings</b></p>

<p class=Def1>Contains the connection settings you want to associate with the
connection when it is established.</p>

<p class=Term1><b>pvLobbyConnectData</b></p>

<p class=Def1>Pointer to connection data passed to the lobbied application.</p>

<p class=Term1><b>dwLobbyConnectDataSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> specifying the size of the data
buffer in the <b>pvLobbyConnectData</b> member.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_CONNECTION_SETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to specify the settings you
want to associate with a connection. These settings contain all the information
required to create, initialize and connect/host a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'> </span>object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPL_CONNECTION_SETTINGS {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_APPLICATION_DESC
dpnAppDesc; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address*
pdp8HostAddress;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> IDirectPlay8Address**
ppdp8DeviceAddresses;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
cNumDeviceAddresses;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR
pwszPlayerName</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_CONNECTION_SETTINGS,
*PDPL_CONNECTION_SETTINGS;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_CONNECTION_SETTINGS</b> structure. The
application must set this to sizeof( DPL_CONNECTION_SETTINGS ) before using
this structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Combination of the following flags.</p>

<p class=Term2>DPLCONNECTSETTINGS_CLIENTSERVER</p>

<p class=Def2>The application should be launched with a client/server session.</p>

<p class=Term2>DPLCONNECTSETTINGS_HOST</p>

<p class=Def2>The application should host the session. </p>

<p class=Term1><b>dpnAppDesc</b></p>

<p class=Def1>Pointer to the application description that should be passed to
the <b>Connect</b> or <b>Host</b> call when DirectPlay initialized.</p>

<p class=Term1><b>pdp8HostAddress</b></p>

<p class=Def1>If DPLCONNECTSETTINGS_HOST is not specified, this is the address
of the session the client should connect to. If DPLCONNECTSETTINGS_HOST is
specified, this member must be NULL.</p>

<p class=Term1><b>ppdp8DeviceAddresses</b></p>

<p class=Def1>This structure contains an array of pointers to device addresses.
If DPLCONNECTSETTINGS_HOST is specified, this member will contain the addresses
the host should listen on. If DPLCONNECTSETTINGS_HOST is not specified, this
member will contain the address of the devices the client should use when
connecting.</p>

<p class=Term1><b>cNumDeviceAddresses</b></p>

<p class=Def1>Number of addresses specified in the <b>ppdp8DeviceAddresses</b><i>
</i>member.</p>

<p class=Term1><b>pwszPlayerName</b></p>

<p class=Def1>Can be used to pass the player name you want the DirectPlay
object to use when launching. This member can be NULL.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_PROGRAM_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes a Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
lobby-aware application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPL_PROGRAM_DESC {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidApplication;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszApplicationName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszCommandLine;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszCurrentDirectory;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszDescription;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszExecutableFilename;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszExecutablePath;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszLauncherFilename;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszLauncherPath;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPL_PROGRAM_DESC,
*PDPL_PROGRAM_DESC;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPL_PROGRAM_DESC</b> structure. The application
must set this member before it uses the structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>Variable of type GUID specifying the application.</p>

<p class=Term1><b>pwszApplicationName</b></p>

<p class=Def1>Pointer to the application name.</p>

<p class=Term1><b>pwszCommandLine</b></p>

<p class=Def1>Pointer to the command-line arguments.</p>

<p class=Term1><b>pwszCurrentDirectory</b></p>

<p class=Def1>Pointer to the directory that should be set as the application's
working directory..</p>

<p class=Term1><b>pwszDescription</b></p>

<p class=Def1>Pointer to the application description.</p>

<p class=Term1><b>pwszExecutableFilename</b></p>

<p class=Def1>Pointer to the file name of the application executable.</p>

<p class=Term1><b>pwszExecutablePath</b></p>

<p class=Def1>Pointer to the path of the application executable.</p>

<p class=Term1><b>pwszLauncherFilename</b></p>

<p class=Def1>Pointer to the file name of the launcher executable.</p>

<p class=Term1><b>pwszLauncherPath</b></p>

<p class=Def1>Pointer to the path of the launcher executable.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplobby8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_APPLICATION_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes the settings for a
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_APPLICATION_DESC{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidInstance;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidApplication;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwMaxPlayers;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwCurrentPlayers;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> WCHAR* pwszSessionName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> WCHAR* pwszPassword;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvReservedData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReservedDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvApplicationReservedData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwApplicationReservedDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_APPLICATION_DESC,
*PDPN_APPLICATION_DESC;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the <b>DPN_APPLICATION_DESC</b> structure. The
application must set this member before it uses the structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>One of the following flags describing application behavior.</p>

<p class=Term2>DPNSESSION_CLIENT_SERVER</p>

<p class=Def2>This type of session is client/server. This flag cannot be
combined with DPNSESSION_MIGRATE_HOST.</p>

<p class=Term2>DPNSESSION_MIGRATE_HOST</p>

<p class=Def2>Used in peer-to-peer sessions, enables host migration. This flag
cannot be combined with DPNSESSION_CLIENT_SERVER.</p>

<p class=Term2>DPNSESSION_NODPNSVR</p>

<p class=Def2>You do not want enumerations forwarded to your host from DPNSVR.
See Using the DirectPlay DPNSVR Application.</p>

<p class=Term2>DPNSESSION_REQUIREPASSWORD</p>

<p class=Def2>The session is password protected. If this flag is set, <i>pwszPassword</i>
must be a valid string.</p>

<p class=Term1><b>guidInstance</b></p>

<p class=Def1>Globally unique identifier (GUID) that is generated by DirectPlay
at startup representing the instance of this application. This member is an
[out] parameter when calling the <b>GetApplicationDesc</b> method exposed by
the <b>IDirectPlay8Peer</b>, <b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b>
interfaces. It is an optional [in] parameter when calling the <b>Connect</b>
method exposed by the <b>IDirectPlay8Peer</b> and <b>IDirectPlay8Client </b>interfaces.
It must be set to NULL when you call the <b>SetApplicationDesc</b> method
exposed by the <b>IDirectPlay8Server</b> and <b>IDirectPlay8Peer</b>
interfaces. You can not obtain this GUID by calling the <b>IDirectPlay8Server::Host</b>
or <b>IDirectPlay8Peer::Host</b> methods. You must obtain the GUID by calling a
<b>GetApplicationDesc</b> method.</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>Application GUID.</p>

<p class=Term1><b>dwMaxPlayers</b></p>

<p class=Def1>Variable of type <b>DWORD</b> specifying the maximum number of
players allowed in the session. Set this member to 0 to specify an unlimited
number of players.</p>

<p class=Term1><b>dwCurrentPlayers</b></p>

<p class=Def1>Variable of type <b>DWORD</b> specifying the number of players
currently connected to the session. This member is an [out] parameter that is
set only by the <b>GetApplicationDescription</b> method exposed by <b>IDirectPlay8Peer</b>,
<b>IDirectPlay8Client</b>, and <b>IDirectPlay8Server</b>.</p>

<p class=Term1><b>pwszSessionName</b></p>

<p class=Def1>Pointer to a variable of type <b>WCHAR</b> specifying the Unicode<span
style='font-size:7.0pt'></span> name of the session. This member is set by the
host or server only for informational purposes. A client cannot use this name
to connect to a host or server.</p>

<p class=Term1><b>pwszPassword</b></p>

<p class=Def1>Pointer to a variable of type <b>WCHAR</b> specifying the Unicode
password that is required to connect to the session. This must be NULL if the
DPNSESSION_REQUIREPASSWORD is not set in the <b>dwFlags</b> member.</p>

<p class=Term1><b>pvReservedData</b></p>

<p class=Def1>Pointer to DirectPlay reserved data. An application should never
modify this value.</p>

<p class=Term1><b>dwReservedDataSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> specifying the size of data
contained in the <b>pvReservedData</b> member. An application should never
modify this value.</p>

<p class=Term1><b>pvApplicationReservedData</b></p>

<p class=Def1>Pointer to application-specific reserved data. This value is
optional and may be set to NULL.</p>

<p class=Term1><b>dwApplicationReservedDataSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> specifying the size of the data in
the <b>pvApplicationReservedData</b> member. This value is optional and may be
set to 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>dwMaxPlayers</b>, <b>pvApplicationReservedData</b>,
<b>dwApplicationReservedDataSize</b>, <b>pwszPassword</b>, and <b>pwszSessionName</b>
members can be set when calling the <b>Host</b> or <b>SetApplicationDesc</b>
methods exposed by the <b>IDirectPlay8Server</b> and <b>IDirectPlay8Peer</b>
interfaces.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_BUFFER_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used by Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
for generic buffer information.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _BUFFERDESC{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> BYTE* pBufferData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} BUFFERDESC, DPN_BUFFER_DESC;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwBufferSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
buffer in the <b>pBufferData</b> member.</p>

<p class=Term1><b>pBufferData</b></p>

<p class=Def1>Pointer to a variable of type <b>BYTE</b> that contains the
buffer data.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_CAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to set and retrieve general
parameters for DirectPlay.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_CAPS{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwConnectTimeout;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwConnectRetries;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwTimeoutUntilKeepAlive;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_CAPS, *PDPN_CAPS;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>This value must be set to the size of the structure. </p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Reserved, this must be 0.</p>

<p class=Term1><b>dwConnectTimeout</b></p>

<p class=Def1>Number of milliseconds DirectPlay should wait before it retries a
connection request.</p>

<p class=Term1><b>dwConnectRetries</b></p>

<p class=Def1>Number of connection retries DirectPlay should make during the
connection process.</p>

<p class=Term1><b>dwTimeoutUntilKeepAlive</b></p>

<p class=Def1>Number of milliseconds DirectPlay should wait since the last time
it received a packet from an endpoint, before it sends a keep-alive message.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_CONNECTION_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to retrieve statistics for
the connection between you and a remote computer that you are connected to.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_CONNECTION_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwRoundTripLatencyMS;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwThroughputBPS;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPeakThroughputBPS;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBytesSentGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPacketsSentGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBytesSentNonGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwPacketsSentNonGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBytesRetried;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPacketsRetried;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBytesDropped; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPacketsDropped; </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTransmittedHighPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTimedOutHighPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTransmittedNormalPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTimedOutNormalPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTransmittedLowPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMessagesTimedOutLowPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBytesReceivedGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwPacketsReceivedGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwBytesReceivedNonGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwPacketsReceivedNonGuaranteed;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwMessagesReceived;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_CONNECTION_INFO,
*PDPN_CONNECTION_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Size of the structure.</p>

<p class=Term1><b>dwRoundTripLatencyMS</b></p>

<p class=Def1>Approximate time, in milliseconds (ms), it takes a packet to
reach the remote computer and be returned to the local computer. This number
will change throughout the session as link conditions change.</p>

<p class=Term1><b>dwThroughputBPS</b></p>

<p class=Def1>Approximate throughput, in bytes per second (Bps), for the link.
This number will change throughout the session as link conditions change. This
value is approximate, and you may want to calculate your own value for greater
accuracy.</p>

<p class=Term1><b>dwPeakThroughputBPS</b></p>

<p class=Def1>Peak throughput, in bytes per second (Bps) for the link. This
number will change throughout the session as link conditions change. This value
is approximate, and you may want to calculate your own value for greater
accuracy.</p>

<p class=Term1><b>dwBytesSentGuaranteed</b></p>

<p class=Def1>Amount, in bytes, of guaranteed messages that have been sent.</p>

<p class=Term1><b>dwPacketsSentGuaranteed</b></p>

<p class=Def1>Number of packets of guaranteed messages that have been sent.</p>

<p class=Term1><b>dwBytesSentNonGuaranteed</b></p>

<p class=Def1>Amount, in bytes, of nonguaranteed messages that have been sent.</p>

<p class=Term1><b>dwPacketsSentNonGuaranteed</b></p>

<p class=Def1>Number of packets of nonguaranteed messages that have been sent.</p>

<p class=Term1><b>dwBytesRetried</b></p>

<p class=Def1>Amount, in bytes, of messages that have been retried.</p>

<p class=Term1><b>dwPacketsRetried</b></p>

<p class=Def1>Amount of packets that have been retried.</p>

<p class=Term1><b>dwBytesDropped</b></p>

<p class=Def1>Amount, in bytes, of messages that have been dropped.</p>

<p class=Term1><b>dwPacketsDropped</b></p>

<p class=Def1>Number of packets that have been dropped.</p>

<p class=Term1><b>dwMessagesTransmittedHighPriority</b></p>

<p class=Def1>Number of high-priority messages that have been transmitted.</p>

<p class=Term1><b>dwMessagesTimedOutHighPriority</b></p>

<p class=Def1>Number of high-priority messages that have timed out.</p>

<p class=Term1><b>dwMessagesTransmittedNormalPriority</b></p>

<p class=Def1>Number of normal-priority messages that have been transmitted.</p>

<p class=Term1><b>dwMessagesTimedOutNormalPriority</b></p>

<p class=Def1>Number of normal-priority messages that have timed out.</p>

<p class=Term1><b>dwMessagesTransmittedLowPriority</b></p>

<p class=Def1>Number of low-priority messages that have been transmitted.</p>

<p class=Term1><b>dwMessagesTimedOutLowPriority</b></p>

<p class=Def1>Number of low priority messages that have timed out.</p>

<p class=Term1><b>dwBytesReceivedGuaranteed</b></p>

<p class=Def1>Amount, in bytes, of guaranteed messages that have been received.</p>

<p class=Term1><b>dwPacketsReceivedGuaranteed</b></p>

<p class=Def1>Number of packets of guaranteed messages that have been received.</p>

<p class=Term1><b>dwBytesReceivedNonGuaranteed</b></p>

<p class=Def1>Amount, in bytes, of nonguaranteed messages that have been
received.</p>

<p class=Term1><b>dwPacketsReceivedNonGuaranteed</b></p>

<p class=Def1>Number of packets of nonguaranteed messages that have been
received.</p>

<p class=Term1><b>dwMessagesReceived</b></p>

<p class=Def1>Number of messages that have been received.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_GROUP_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes static group
information. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_GROUP_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwInfoFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwGroupFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_GROUP_INFO, *PDPN_GROUP_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> describing the size of this
structure.</p>

<p class=Term1><b>dwInfoFlags</b></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Variable of type <b>DWORD</b>
containing flags that specify the type of information contained in this
structure. When a <b>GetGroupInfo</b> method returns, the <b>dwInfoFlags</b>
member of the <b>DPN_GROUP_INFO</b> will always have both flags set, even if
the corresponding pointers are set to NULL. These flags are used when calling <b>IDirectPlay8Peer::SetGroupInfo,
</b>to notify Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> of which values have changed.</p>

<p class=Term2>DPNINFO_NAME</p>

<p class=Def2>The <b>pwszName</b> member contains valid data.</p>

<p class=Term2>DPNINFO_DATA</p>

<p class=Def2>The <b>pvData</b> member contains valid data.</p>

<p class=Term1><b>pwszName</b></p>

<p class=Def1>Pointer to a variable of type <b>PWSTR</b> specifying the Unicode
name of the group.</p>

<p class=Term1><b>pvData</b></p>

<p class=Def1>Pointer to the data describing the group.</p>

<p class=Term1><b>dwDataSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
contained in the <b>pvData</b> member.</p>

<p class=Term1><b>dwGroupFlags</b></p>

<p class=Def1>Variable of type <b>DWORD</b> that can be set to the following
description flag.</p>

<p class=Term2>DPNGROUP_AUTODESTRUCT</p>

<p class=Def2>Causes the group to be automatically destroyed when the group
creator leaves the group.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When using this structure in the
<b>IDirectPlay8Peer::GetGroupInfo</b> and <b>IDirectPlay8Server::GetGroupInfo</b>
methods, <b>dwInfoFlags</b> must be set to 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_PLAYER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes static player
information. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_PLAYER_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwInfoFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PWSTR pwszName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvData;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwDataSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwPlayerFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_PLAYER_INFO, *PDPN_PLAYER_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> describing the size of this
structure.</p>

<p class=Term1><b>dwInfoFlags</b></p>

<p class=Def1>Variable of type <b>DWORD</b> containing flags that specify the
type of information contained in this structure. When a <b>GetPlayerInfo</b>
method returns, the <b>dwInfoFlags</b> member of the <b>DPN_PLAYER_INFO</b>
will always have both flags set, even if the corresponding pointers are set to
NULL. These flags are used when calling <b>IDirectPlay8Peer::SetPeerInfo, </b>to
notify Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> which values have changed.</p>

<p class=Term2>DPNINFO_NAME</p>

<p class=Def2>The <b>pwszName</b> member contains valid data.</p>

<p class=Term2>DPNINFO_DATA</p>

<p class=Def2>The <b>pvData</b> member contains valid data.</p>

<p class=Term1><b>pwszName</b></p>

<p class=Def1>Pointer to a variable of type <b>PWSTR</b> specifying the Unicode
name of the player.</p>

<p class=Term1><b>pvData</b></p>

<p class=Def1>Pointer to the data describing the player.</p>

<p class=Term1><b>dwDataSize</b></p>

<p class=Def1>Variable of type <b>DWORD</b> that specifies the size of the data
contained in the <b>pvData</b> member.</p>

<p class=Term1><b>dwPlayerFlags</b></p>

<p class=Def1>Variable of type <b>DWORD</b> that may contain one of the
following flags.</p>

<p class=Term2>DPNPLAYER_LOCAL</p>

<p class=Def2>This information is for the local player.</p>

<p class=Term2>DPNPLAYER_HOST</p>

<p class=Def2>This player is the host for the application.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When using this structure in the
<b>IDirectPlay8Peer::GetPeerInfo</b> and <b>IDirectPlay8Server::GetClientInfo</b>
methods, <b>dwInfoFlags</b> must be set to 0.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SECURITY_CREDENTIALS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Not implemented.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SECURITY_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Not implemented.</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SERVICE_PROVIDER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used when enumerating information
for a specific service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct
_DPN_SERVICE_PROVIDER_INFO{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID Guid;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> WCHAR* pwszName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PVOID pvReserved;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwReserved;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_SERVICE_PROVIDER_INFO,
*PDPN_SERVICE_PROVIDER_INFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><b>pGuid</b></p>

<p class=Def1>GUID for the service provider.</p>

<p class=Term1><b>pwszName</b></p>

<p class=Def1>Name of the service provider.</p>

<p class=Term1><b>pvReserved</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><b>dwReserved</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SP_CAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to set and retrieve
parameters for service providers.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct _DPN_SP_CAPS{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwNumThreads;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwDefaultEnumCount;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwDefaultEnumRetryInterval;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwDefaultEnumTimeout;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwMaxEnumPayloadSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBuffersPerThread;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSystemBufferSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DPN_SP_CAPS, *PDPN_SP_CAPS;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>This value must be set to the size of the structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>This can be a combination of the following flags.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSDPNSRV</p>

<p class=Def2>DPNSVR.EXE will provide port sharing for the given SP. Currently
this flag is available on IP and IPX only. See Using the DirectPlay DPNSVR
Application for a further discussion of DPNSVR.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSBROADCAST</p>

<p class=Def2>On IP and IPX applications, the service provider has the ability
to broadcast to find games if not enough addressing information is passed.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSALLADAPTERS</p>

<p class=Def2>The service provider will use all devices on the system. There is
no need to specify a device element.</p>

<p class=Term1><b>dwNumThreads</b></p>

<p class=Def1>Number of threads the service provider will use for servicing
network requests. The default value for this is based on an algorithm that
takes into account the number of processors on the system. Most applications
will not need to modify this value.</p>

<p class=Def1>After a service provider is active in your process, you may only
increase this value. Decreasing the value will have no effect. The setting is
process wide, which means it will affect your current DirectPlay object and any
other DirectPlay objects in your process.</p>

<p class=Def1>You may specify a lower value than the default if you call the <b>SetSPCaps</b>
method before you call an <b>EnumHosts,</b> <b>Connect</b>, or <b>Host</b>
method.</p>

<p class=Term1><b>dwDefaultEnumCount</b></p>

<p class=Def1>Default enumeration count.</p>

<p class=Term1><b>dwDefaultEnumRetryInterval</b></p>

<p class=Def1>Default retry interval, in milliseconds.</p>

<p class=Term1><b>dwDefaultEnumTimeout</b></p>

<p class=Def1>Default enumeration timeout value, in milliseconds.</p>

<p class=Term1><b>dwMaxEnumPayloadSize</b></p>

<p class=Def1>Maximum size of the payload information that can be sent in the <b>pvResponseData
</b>member of the structures that accompany the <b>DPN_MSGID_ENUM_HOST_QUERY</b>
and <b>DPN_MSGID_ENUM_HOST_RESPONSE</b> messages..</p>

<p class=Term1><b>dwBuffersPerThread</b></p>

<p class=Def1>The number of outstanding receive buffers allocated for each
DirectPlay thread. If you increase the number of receive buffers, DirectPlay
can pull more data out of the operating system buffers. However, you may also
increase latency if data is arriving faster than your application can process
it.</p>

<p class=Term1><b>dwSystemBufferSize</b></p>

<p class=Def1>The size of the operating system buffer. This buffer holds data
from the communications device when your application cannot process data as
fast as it arrives. The purpose of this buffer is to prevent data loss if you
receive a sudden burst of data, or if the receive threads are momentarily
stalled. Increasing <b>dwSystemBufferSize</b> may increase latency if your
application cannot process the received data fast enough. You can eliminate the
operating system buffer by setting <b>dwSystemBufferSize</b> to 0. However, if you
do so, you run the risk of losing data if you cannot process the received data
as fast as it arrives. </p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For DirectX 8.0, the <b>dwBuffersPerThread
</b>and <b>dwSystemBufferSize</b> members are used only by IP and IPX service
providers. The default values for these members are set by the service
provider. To determine the default value, call the appropriate <b>GetSPCaps</b>
method. Most applications should use the default values for these two members.
They are intended primarily for use by developers writing server applications
for massively-multiplayer games. </p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dplay8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVCAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes the capabilities of
the Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> VoiceClient object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVCAPS, *LPDVCAPS, *PDVCAPS;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Must be set the to size of this structure, in bytes, before using
this structure.</p>

<p class=Term1><b>dwFlags </b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice8.h.</p>

<p class=Rh1 style='page-break-after:avoid'><a name="_Toc456442118"></a><a
name="_Toc460299489"></a><a name="_DVSOUNDCONFIG"></a><a
name="_DVSOUNDDEVICECONFIG"></a>DVCLIENTCONFIG</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Controls the run-time parameters
for the client. The structure is first used in the call to <b>IDirectPlayVoiceClient::Connect</b>,
where it sets the initial state of these parameters. The structure can be
retrieved after a connection has been made by calling <b>IDirectPlayVoiceClient::GetClientConfig</b>,
and set using <b>IDirectPlayVoiceClient::SetClientConfig</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LONG lRecordVolume;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LONG lPlaybackVolume;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwThreshold;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferQuality;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferAggressiveness;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwNotifyPeriod;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVCLIENTCONFIG, *LPDVCLIENTCONFIG,
*PDVCLIENTCONFIG;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Must be set the to size of this structure, in bytes, before using
this structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Combination of the following flags.</p>

<p class=Term2>DVCLIENTCONFIG_AUTORECORDVOLUME</p>

<p class=Def2>Activates automatic gain control. With automatic gain control,
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice adjusts the hardware input volume on
your sound card automatically to get the best input level possible. You can
determine the current input volume by looking at the <b>lRecordVolume</b>
member after a call to <b>IDirectPlayVoiceClient::GetClientConfig</b>, or by
looking at the <b>lRecordVolume</b> member of <b>DVMSG_INPUTLEVEL</b> messages.</p>

<p class=Term2>DVCLIENTCONFIG_ECHOSUPPRESSION</p>

<p class=Def2>Activates the echo suppression mode. This mode reduces echo
introduced by configurations with external speakers and extremely sensitive
microphones. While remote players' voices are being played back on the local
speaker, the microphone is automatically muted. If the local player is
transmitting, the playback of remote player voices is buffered until local
input stops. After local input stops, playback resumes.</p>

<p class=Term2>DVCLIENTCONFIG_MUTEGLOBAL</p>

<p class=Def2>Mutes playback of the main sound buffer. Only sound buffers
created through calls to <b>IDirectPlayVoiceClient::Create3DSoundBuffer</b>
will be heard.</p>

<p class=Term2>DVCLIENTCONFIG_PLAYBACKMUTE</p>

<p class=Def2>Mutes playback of all DirectPlay Voice output and stops playback.
This also stops decompression of incoming packets so CPU usage is reduced.
Packets are effectively discarded while this flag is specified.</p>

<p class=Term2>DVCLIENTCONFIG_RECORDMUTE</p>

<p class=Def2>Mutes input from the microphone and stops recording. This also
stops compression so CPU usage is reduced.</p>

<p class=Def1>In addition to the preceding flags, the method of transmission is
controlled by setting only one of the following flags or by not specifying
either flag.</p>

<p class=Term2>DVCLIENTCONFIG_AUTOVOICEACTIVATED</p>

<p class=Def2>Places the transmission control system into automatic voice
activation mode. In this mode, the sensitivity of voice activation is
determined automatically by the system. The input level is adaptive, adjusting
itself automatically to the input signal. For most applications this should be
the setting used. This flag is mutually exclusive with the
DVCLIENTCONFIG_MANUALVOICEACTIVATED flag.</p>

<p class=Term2>DVCLIENTCONFIG_MANUALVOICEACTIVATED</p>

<p class=Def2>Places the transmission control system into manual voice
activation mode. In this mode, transmission of voice begins when the input
level passes the level specified by the <b>dwThreshold</b> member. When input
levels drop below the specified level, transmission stops. This flag is
mutually exclusive with the DVCLIENTCONFIG_AUTOVOICEACTIVATED flag.</p>

<p class=Def1>If you do not specify either DVCLIENTCONFIG_MANUALVOICEACTIVATED
or DVCLIENTCONFIG_AUTOVOICEACTIVATED, the system will operate in push-to-talk
mode. In push-to-talk mode, as long as there is a valid target specified the
input from the microphone will be transmitted. Voice transmission stops when a
NULL target is set or the current target leaves the session or is destroyed.</p>

<p class=Term1><b>lRecordVolume</b></p>

<p class=Def1>Value indicating what the volume of the recording should be set
to. See the <b>IDirectSoundBuffer8::SetVolume</b> method for valid values.</p>

<p class=Def1>If automatic gain control is enabled, this value can be set to DVRECORDVOLUME_LAST,
which tells the system to use the current volume as determined by the automatic
gain control algorithm. If a value other than DVRECORDVOLUME_LAST is specified
in combination with automatic gain control, this value will be used to restart
the algorithm at the specified value.</p>

<p class=Def1>On return from a call to <b>IDirectPlayVoiceClient::GetClientConfig</b>,
this value will contain the current recording volume. When adjusting the
recording volume, DirectPlay Voice will adjust the volume for the microphone
(if a microphone volume is present for the card) and the master recording
volume (if one is present on the card). If neither a microphone volume nor a
master record volume is present, DirectPlay Voice will be unable to adjust the
recording volume. </p>

<p class=Term1><b>lPlaybackVolume</b></p>

<p class=Def1>Value indicating what the volume of the playback should be set
to. Adjusting this volume adjusts both the main buffer and all 3-D sound
buffers. See the <b>IDirectSoundBuffer8::SetVolume</b> method for valid values.
You can specify DVPLAYBACKVOLUME_DEFAULT to use a default value that is
appropriate for most situations (full volume).</p>

<p class=Term1><b>dwThreshold</b></p>

<p class=Def1>Input level used to trigger voice transmission if the
DVCLIENTCONFIG_MANUALVOICEACTIVATED flag is specified in the <b>dwFlags</b>
member. When the flag is specified, this value can be set to anywhere in the
range of DVTHRESHOLD_MIN to DVTHRESHOLD_MAX. Additionally, DVTHRESHOLD_DEFAULT
can be set to use a default value.</p>

<p class=Def1>If DVCLIENTCONFIG_MANUALVOICEACTIVATED or
DVCLIENTCONFIG_AUTOVOICEACTIVATED is not specified in the <b>dwFlags</b> member
of this structure (indicating push-to-talk mode) this value must be set to
DVTHRESHOLD_UNUSED.</p>

<p class=Term1><b>dwBufferQuality</b></p>

<p class=Def1>Buffer quality setting for the adaptive buffering algorithm. For
most applications, this should be set to DVBUFFERQUALITY_DEFAULT. It can be set
to anything in the range of DVBUFFERQUALITY_MIN to DVBUFFERQUALITY_MAX. In
general, the higher the value, the higher the quality of the voice but the
higher the latency. The lower the value, the lower the latency but the lower
the quality.</p>

<p class=Term1><b>dwBufferAggressiveness</b></p>

<p class=Def1>Buffer aggressiveness setting for the adaptive buffer algorithm.
For most applications, this can be set to DVBUFFERAGGRESSIVENESS_DEFAULT. It
can also be set to anything in the range of DVBUFFERAGGRESSIVENESS_MIN and
DVBUFFERAGGRESSIVENESS_MAX. In general, the higher the value, the quicker the
adaptive buffering adjusts to changing conditions. The lower the value, the
slower the adaptive buffering adjusts to changing conditions.</p>

<p class=Term1><b>dwNotifyPeriod</b></p>

<p class=Def1>Value indicating how often you want to receive
DVMSGID_OUTPUTLEVEL and DVMSGID_INPUTLEVEL (if session is full duplex)
messages. If this value is set to 0, these messages are disabled. The value
specifies the number of milliseconds between these messages.
DVNOTIFYPERIOD_MINPERIOD specifies the minimum period between messages that is
allowed.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVCOMPRESSIONINFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes the attributes of a
specific Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice compression type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct{</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidType;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPWSTR lpszName;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPWSTR lpszDescription;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMaxBitsPerSecond;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVCOMPRESSIONINFO,
*LPDVCOMPRESSIONINFO, *PDVCOMPRESSIONINFO;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1>Must be set the to size of this structure, in bytes, before using
this structure.</p>

<p class=Term1><b>guidType</b></p>

<p class=Def1>GUID used to identify this compression type by DirectPlay Voice.</p>

<p class=Term1><b>lpszName</b></p>

<p class=Def1>Pointer to a name describing the codec.</p>

<p class=Term1><b>lpszDescription</b></p>

<p class=Def1>Pointer to a longer name of the codec.</p>

<p class=Term1><b>dwFlags </b></p>

<p class=Def1>Reserved; must be 0.</p>

<p class=Term1><b>dwMaxBitsPerSecond</b></p>

<p class=Def1>Maximum number of bits per second claimed by the codec.</p>

<p class=Le><a name="_Toc456442120"></a><a name="_Toc460299491">&nbsp;</a></p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice8.h.</p>

<p class=Rh1 style='page-break-after:avoid'>DVSESSIONDESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Describes the desired or current
session settings for the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice server. This structure
is used by the voice session host to configure the session, and by the session
host and clients to retrieve information about the current session. The <b>dwFlags</b>,
<b>dwSessionType</b>, and <b>guidCT</b> members can only be set when the host
starts the voice session. The host can change the buffer settings at any time.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSessionType;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID guidCT;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferQuality;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwBufferAggresiveness;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVSESSIONDESC, *LPDVSESSIONDESC,
*PDVSESSIONDESC;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><a name="_Toc456442121"></a><a name="_Toc460299492"></a><a
name="_DVCOMPRESSIONINFO"></a><b>dwSize</b></p>

<p class=Def1>Must be set the to size of this structure, in bytes, before using
this structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>Combination of the following flags.</p>

<p class=Term2>DVSESSION_NOHOSTMIGRATION</p>

<p class=Def2>The voice host will not migrate regardless of the transport
settings. If this flag is not specified, the voice host will migrate if the
transport supports it.</p>

<p class=Term2>DVSESSION_SERVERCONTROLTARGET</p>

<p class=Def2>The clients are unable to control the target of their speech.
Only the server player can control the target of their speech. If the server
does not specify this flag, only the clients can control the target of their
speech. This flag can be specified only in multicast and mixing sessions.</p>

<p class=Term1><b>dwSessionType</b></p>

<p class=Def1>The type of DirectPlay Voice session to run. The
DVSESSIONTYPE_PEER flag is not available in client/server sessions; all other
flags are valid for all session types. This member can be one of the following
values.</p>

<p class=Term2>DVSESSIONTYPE_PEER</p>

<p class=Def2>Voice messages will be sent directly between players.</p>

<p class=Term2>DVSESSIONTYPE_MIXING</p>

<p class=Def2>Voice session will use a mixing server. In this mode of
operation, all voice messages are sent to the server, which mixes them and then
forwards a single, premixed stream to each client. This reduces the bandwidth
and CPU usage on clients significantly at the cost of increased bandwidth and
CPU usage on the server.</p>

<p class=Term2>DVSESSIONTYPE_FOWARDING</p>

<p class=Def2>Voice messages will be routed through the session host. This will
save bandwidth on the clients at the expense of bandwidth usage on the server.
This option is only useful if the session host has a high-speed connection.</p>

<p class=Term1><b>guidCT</b></p>

<p class=Def1>GUID specifying the compression type of the session.</p>

<p class=Term1><b>dwBufferQuality</b></p>

<p class=Def1>The buffer quality setting. This member is unused for all session
types except mixing sessions. For all sessions except mixing sessions, set this
member to DVBUFFERQUALITY_DEFAULT.</p>

<p class=Def1>Allowable values are between DVBUFFERQUALITY_MIN and
DVBUFFERQUALITY_MAX. Additionally, this member can be set to the following
value.</p>

<p class=Term2>DVBUFFERQUALITY_DEFAULT </p>

<p class=Def2>Specifying this value tells DirectPlay Voice to use the system
default for this value, which is adjustable through a registry entry that can
also be set through Sounds and Multimedia in Control Panel.</p>

<p class=Term1><b>dwBufferAggresiveness</b></p>

<p class=Def1>Buffer aggressiveness setting. This member is unused for all
session types except mixing sessions. For all sessions except mixing sessions,
set this member to DVBUFFERAGGRESIVENESS_DEFAULT.</p>

<p class=Def1>Allowable values are between DVBUFFERAGGRESIVENESS _MIN and
DVBUFFERAGGRESIVENESS _MAX. Additionally, this member can be set to the
following value.</p>

<p class=Term2>DVBUFFERAGGRESIVENESS_DEFAULT </p>

<p class=Def2>Specifying this value tells DirectPlay Voice to use the system
default for this value, which is adjustable through a registry entry that can
also be set through Control Panel.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice8.h.</p>

<p class=Rh1 style='page-break-after:avoid'><a name="_Toc456442122"></a><a
name="_Toc460299493"></a><a name="_DVCAPS"></a>DVSOUNDDEVICECONFIG</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Used to set and retrieve
information about the sound device configuration and cannot be changed once a
connection has been made. After a connection is made, you can retrieve the
current sound device configuration by calling <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>typedef struct {</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwSize;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD dwFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID
guidPlaybackDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPDIRECTSOUND
lpdsPlaybackDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID
guidCaptureDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPDIRECTSOUNDCAPTURE
lpdsCaptureDevice;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> HWND
hwndAppWindow;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LPDIRECTSOUNDBUFFER
lpdsMainBuffer;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMainBufferFlags;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DWORD
dwMainBufferPriority;</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>} DVSOUNDDEVICECONFIG,
*LPDVSOUNDDEVICECONFIG, *PDVSOUNDDEVICECONFIG;</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dwSize</b></p>

<p class=Def1><a name="_Toc456442119"></a><a name="_Toc460299490"></a><a
name="_DVSESSIONDESC"></a><a name="_DVCLIENTSETTINGS"></a>Must be set the to
size of this structure, in bytes, before using this structure.</p>

<p class=Term1><b>dwFlags</b></p>

<p class=Def1>A combination of the following flags.</p>

<p class=Term2>DVSOUNDCONFIG_AUTOSELECT</p>

<p class=Def2>Tells Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice to attempt to automatically select (or
unmute) the microphone line in the mixer for the specified recording device.</p>

<p class=Term2>DVSOUNDCONFIG_HALFDUPLEX</p>

<p class=Def2>Tells DirectPlay Voice to initialize itself in half-duplex mode.
In half-duplex mode no recording takes place. If the initialization of the
sound system fails in full-duplex mode, this flag will be set by the system.</p>

<p class=Term2>DVSOUNDCONFIG_NORMALMODE</p>

<p class=Def2>Tells DirectPlay Voice to use Microsoft<span style='font-size:
7.0pt'></span> DirectSound<span style='font-size:7.0pt'></span> Normal Mode
when initializing the DirectSound object. If this flag is not specified, the
DirectSound object is initialized with DirectSound Priority Mode. See
documentation for <b>IDirectSound8::SetCooperativeLevel</b> for more
information. If a valid DirectSound object is specified in the <b>lpdsPlaybackDevice</b>
member, this flag is ignored.</p>

<p class=Term2>DVSOUNDCONFIG_SETCONVERSIONQUALITY</p>

<p class=Def2>Enables better quality audio at the expense of higher CPU usage.</p>

<p class=Term2>DVSOUNDCONFIG_NORECVOLAVAILABLE</p>

<p class=Def2>Set by DirectPlay Voice if there are no volume controls available
on the recording device you specified. You cannot set this flag.</p>

<p class=Term2>DVSOUNDCONFIG_NOFOCUS</p>

<p class=Def2>The voice application will never go out of focus. In other words,
the application will never release the sound capture device. Use of this flag
is not recommended.</p>

<p class=Term2>DVSOUNDCONFIG_STRICTFOCUS</p>

<p class=Def2>The voice application will lose focus whenever its window is not
the foreground window.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>Applications should set the DVSOUNDCONFIG_NOFOCUS or
DVSOUNDCONFIG_STRICTFOCUS flags only when strictly necessary. Instead, you
should normally use the default behavior that results when neither flag is set.</p>

<p class=Term1><b>guidPlaybackDevice</b></p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::Connect</b>
method, this member specifies the GUID of the device used for playback. This
must be specified even if the <b>lpdsPlaybackDevice</b> member is used. You can
also specify the following default GUIDs provided by DirectSound.</p>

<p class=Term2>DSDEVID_DefaultPlayback</p>

<p class=Def2>The system default playback device.</p>

<p class=Term2>DSDEVID_DefaultVoicePlayback</p>

<p class=Def2>The default voice playback device.</p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>
method, this member contains the actual device GUID used for playback.</p>

<p class=Term1><b>lpdsPlaybackDevice</b></p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::Connect</b>
method, this member specifies the DirectSound object you want DirectPlay Voice
to use for playback. The GUID specified in <b>guidPlaybackDevice</b> must match
the one used to create the device specified by this parameter. If you used NULL
when specifying the device when you created your DirectSound object, pass
DSDEVID_DefaultPlayback for this member.</p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>
method, this member contains a pointer to the DirectSound object being used by
DirectPlay Voice. This will either be a pointer to the object specified when <b>Connect</b>
was called or a pointer to a newly created and initialized DirectSound object.
If you want to use this DirectSound object, you must store the pointer and
increment the reference count by calling <b>AddRef</b> on the DirectSound
interface.</p>

<p class=Term1><b>guidCaptureDevice</b></p>

<p class=Def1>When this structure is used in <b>IDirectPlayVoiceClient::Connect</b>
method, this member specifies the GUID of the device used for capture. This
must be specified even if the <b>lpdsCaptureDevice</b> member is used. If you
used NULL when specifying the device when you created your DirectSoundCapture
object, pass DSDEVID_DefaultCapture for this member.</p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>
method, this member will contain the actual device GUID used for capture.</p>

<p class=Term1><b>lpdsCaptureDevice</b></p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::Connect</b>
method, this member specifies the DirectSound object you want DirectPlay Voice
to use for capture. The GUID specified in <b>guidCaptureDevice</b> must match
the one used to create the device specified by this parameter. If you want to
have DirectPlay Voice create the DirectSoundCapture object for you, specify
NULL for this member.</p>

<p class=Def1>When this structure is used in the <b>IDirectPlayVoiceClient::GetSoundDeviceConfig</b>
method, this member contains a pointer to the DirectSoundCapture object being
used by DirectPlay Voice. This will either be a pointer to the object specified
when <b>Connect</b> was called or a pointer to a newly created and initialized
DirectSoundCapture object. If you want to use this DirectSoundCapture object,
you must store the pointer and increment the reference count by calling <b>AddRef</b>
on the <b>IDirectSoundCapture8</b> interface. If the DirectPlay Voice object is
operating in half duplex mode, this member will be NULL.</p>

<p class=Term1><b>hwndAppWindow</b></p>

<p class=Def1>Must be set to the handle of the window that will be used to
determine focus for sound playback. See <b>IDirectSound8::SetCooperativeLevel</b>
for information on DirectSound focus. If you do not have a window to use for
focus, use <b>GetDesktopWindow</b> to use the desktop window.</p>

<p class=Term1><b>lpdsMainBuffer</b></p>

<p class=Def1>Pointer to an <b>IDirectSoundBuffer8 </b>interface, which is used
to create the DirectPlay Voice main buffer. This can be either NULL or a
user-created DirectSound buffer. If this member is set to NULL, DirectPlay
Voice will create a buffer for the main voice buffer. If users specify a buffer
here, DirectPlay Voice will use their buffer for the main voice buffer.
User-created buffers have the following restrictions.</p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must be 22 kilohertz,
16-bit, Mono format.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must be at least 1
second in length.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must have been
created with the DSBCAPS_GETCURRENTPOSITION2 and DSBCAPS_CTRL3D flags.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be a primary
buffer.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be playing
when it is passed to the DirectPlay Voice software. </span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be locked
when it is passed to the DirectPlay Voice software.</span></p>

<p class=Term1><b>dwMainBufferFlags</b></p>

<p class=Def1>Passed directly to the <i>dwFlags</i> parameter of the <b>IDirectSoundBuffer8::Play</b><i>
</i>method when <b>Play</b> is called for the main buffer. The DSBPLAY_LOOPING
flag is automatically added to this field. See the documentation on <b>IDirectSoundBuffer8::Play</b>
for details. This parameter must be 0 if the <b>lpdsMainBufferDesc</b> member
of this structure is NULL.</p>

<p class=Term1><b>dwMainBufferPriority</b></p>

<p class=Def1>Passed directly to the <i>dwPriority</i> parameter of the <b>IDirectSoundBuffer8::Play</b>
method when <b>Play</b> is called on the main buffer. See documentation for <b>IDirectSoundBuffer8::Play</b>
for more information. This member must be set to 0 if <b>lpdsMainBufferDesc</b>
is NULL.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid;background:#FFFFBA'><span
style='color:black'>Requirements </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>&nbsp;&nbsp;Windows NT/2000: </b>Available
as a redistributable for Windows 2000 and later.<br>
<b>&nbsp;&nbsp;Windows 95/98: </b>Available as a redistributable for Windows 95
and later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in Dvoice8.h.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Return Values</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Errors are represented by
negative values and cannot be combined.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following table lists the
interfaces to which the error values listed below apply.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Thf>Interface</p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Th>Interface</p>
  </td>
 </tr>
 <tr>
  <td width=464 colspan=2 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tr><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8Address</b></p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IDirectPlay8Peer</b></p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8AddressIP</b></p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IDirectPlay8Server</b></p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8Client</b></p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IDirectPlayVoiceClient</b></p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8LobbiedApplication</b></p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IDirectPlayVoiceServer</b></p>
  </td>
 </tr>
 <tr>
  <td width=224 valign=top style='width:168.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>IDirectPlay8LobbyClient</b></p>
  </td>
  <td width=240 valign=top style='width:2.5in;padding:0in 0in 0in 0in'>
  <p class=MsoNormal style='margin-bottom:6.0pt'><b>IDirectPlayVoiceTest</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a list of the error values
each method can return, see the individual method descriptions. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Many of the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
samples include a <b>GetDirectPlayErrStr</b> function that converts HRESULT
values to string names for the DirectPlay errors. You can copy this code into
your own applications for diagnostic traces or error reports. </p>

<h4 style='page-break-after:avoid'>Success Codes</h4>

<p class=Term1>DPNSUCCESS_PENDING</p>

<p class=Def1>An asynchronous operation has reached the point where it is
successfully queued. </p>

<p class=Term1>S_OK</p>

<p class=Def1>The operation completed successfully. </p>

<h4 style='page-break-after:avoid'>Error Codes</h4>

<p class=Term1>DPNERR_ABORTED</p>

<p class=Def1>The operation was canceled before it could be completed.</p>

<p class=Term1>DPNERR_ADDRESSING</p>

<p class=Def1>The address specified is invalid.</p>

<p class=Term1>DPNERR_ALREADYCONNECTED</p>

<p class=Def1>The object is already connected to the session.</p>

<p class=Term1>DPNERR_ALREADYCLOSING</p>

<p class=Def1>An attempt to call the <b>Close</b> method on a session has been
made more than once.</p>

<p class=Term1>DPNERR_ALREADYDISCONNECTING</p>

<p class=Def1>The client is already disconnecting from the session.</p>

<p class=Term1>DPNERR_ALREADYINITIALIZED</p>

<p class=Def1>The object has already been initialized.</p>

<p class=Term1>DPNERR_BUFFERTOOSMALL</p>

<p class=Def1>The supplied buffer is not large enough to contain the requested
data. </p>

<p class=Term1>DPNERR_CANNOTCANCEL</p>

<p class=Def1>The operation could not be canceled.</p>

<p class=Term1>DPNERR_CANTCREATEGROUP</p>

<p class=Def1>A new group cannot be created. </p>

<p class=Term1>DPNERR_CANTCREATEPLAYER</p>

<p class=Def1>A new player cannot be created. </p>

<p class=Term1>DPNERR_CANTLAUNCHAPPLICATION</p>

<p class=Def1>The lobby cannot launch the specified application.</p>

<p class=Term1>DPNERR_CONNECTING</p>

<p class=Def1>The method is in the process of connecting to the network.</p>

<p class=Term1>DPNERR_CONNECTIONLOST</p>

<p class=Def1>The service provider connection was reset while data was being
sent. </p>

<p class=Term1>DPNERR_DATATOOLARGE</p>

<p class=Def1>The application data is too large for the service provider's
Maximum Transmission Unit.</p>

<p class=Term1>DPNERR_DOESNOTEXIST</p>

<p class=Def1>Requested element is not part of the address.</p>

<p class=Term1>DPNERR_ENUMQUERYTOOLARGE</p>

<p class=Def1>The query data specified is too large.</p>

<p class=Term1>DPNERR_ENUMRESPONSETOOLARGE</p>

<p class=Def1>The response to an enumeration query is too large.</p>

<p class=Term1>DPNERR_EXCEPTION</p>

<p class=Def1>An exception occurred when processing the request. </p>

<p class=Term1>DPNERR_GENERIC</p>

<p class=Def1>An undefined error condition occurred. </p>

<p class=Term1>DPNERR_GROUPNOTEMPTY</p>

<p class=Def1>The specified group is not empty.</p>

<p class=Term1>DPNERR_HOSTREJECTEDCONNECTION</p>

<p class=Def1>The <b>DPN_MSGID_INDICATE_CONNECT</b> system message returned
something other than S_OK in response to a connect request.</p>

<p class=Term1>DPNERR<b>_</b>HOSTTERMINATEDSESSION</p>

<p class=Def1>The host in a peer session (with host migration enabled)
terminated the session.</p>

<p class=Term1>DPNERR_INCOMPLETEADDRESS</p>

<p class=Def1>The address specified is not complete.</p>

<p class=Term1>DPNERR_INVALIDADDRESSFORMAT</p>

<p class=Def1>Address format is invalid.</p>

<p class=Term1>DPNERR_INVALIDAPPLICATION</p>

<p class=Def1>The GUID supplied for the application is invalid.</p>

<p class=Term1>DPNERR_INVALIDCOMMAND</p>

<p class=Def1>The command specified is invalid.</p>

<p class=Term1>DPNERR_INVALIDDEVICEADDRESS</p>

<p class=Def1>The address for the local computer or adapter is invalid.</p>

<p class=Term1>DPNERR_INVALIDFLAGS</p>

<p class=Def1>The flags passed to this method are invalid. </p>

<p class=Term1>DPNERR_INVALIDGROUP</p>

<p class=Def1>The group ID is not recognized as a valid group ID for this game
session. </p>

<p class=Term1>DPNERR_INVALIDHANDLE</p>

<p class=Def1>The handle specified is invalid.</p>

<p class=Term1>DPNERR_INVALIDHOSTADDRESS</p>

<p class=Def1>The specified remote address is invalid.</p>

<p class=Term1>DPNERR_INVALIDINSTANCE</p>

<p class=Def1>The GUID for the application instance is invalid.</p>

<p class=Term1>DPNERR_INVALIDINTERFACE</p>

<p class=Def1>The interface parameter is invalid. This value will be returned
in a connect request if the connecting player was not a client in a
client/server game or a peer in a peer-to-peer game.</p>

<p class=Term1>DPNERR_INVALIDOBJECT</p>

<p class=Def1>The DirectPlay object pointer is invalid. </p>

<p class=Term1>DPNERR_INVALIDPARAM</p>

<p class=Def1>One or more of the parameters passed to the method are invalid. </p>

<p class=Term1>DPNERR_INVALIDPASSWORD</p>

<p class=Def1>An invalid password was supplied when attempting to join a
session that requires a password. </p>

<p class=Term1>DPNERR_INVALIDPLAYER</p>

<p class=Def1>The player ID is not recognized as a valid player ID for this
game session. </p>

<p class=Term1>DPNERR_INVALIDPOINTER</p>

<p class=Def1>Pointer specified as a parameter is invalid.</p>

<p class=Term1>DPNERR_INVALIDPRIORITY</p>

<p class=Def1>The specified priority is not within the range of allowed
priorities, which is inclusively from 0 through 65535.</p>

<p class=Term1>DPNERR_INVALIDSTRING</p>

<p class=Def1>String specified as a parameter is invalid.</p>

<p class=Term1>DPNERR_INVALIDURL</p>

<p class=Def1>Specified string is not a valid DirectPlay URL.</p>

<p class=Term1>DPNERR_INVALIDVERSION</p>

<p class=Def1>There was an attempt to connect to an invalid version of
DirectPlay.</p>

<p class=Term1>DPNERR_NOCAPS</p>

<p class=Def1>The communication link that DirectPlay is attempting to use is
not capable of this function. </p>

<p class=Term1>DPNERR_NOCONNECTION</p>

<p class=Def1>No communication link was established. </p>

<p class=Term1>DPNERR_NOHOSTPLAYER</p>

<p class=Def1>There is currently no player acting as the host of the session.</p>

<p class=Term1>DPNERR_NOINTERFACE</p>

<p class=Def1>The interface is not supported. </p>

<p class=Term1>DPNERR_NORESPONSE</p>

<p class=Def1>There was no response from the specified target.</p>

<p class=Term1>DPNERR_NOTALLOWED</p>

<p class=Def1>Object is read-only; this function is not allowed on this object.</p>

<p class=Term1>DPNERR_NOTHOST</p>

<p class=Def1>An attempt by the client to connect to a nonhost computer.
Additionally, this error value may be returned by a nonhost that tries to set
the application description.</p>

<p class=Term1>DPNERR_OUTOFMEMORY</p>

<p class=Def1>There is insufficient memory to perform the requested operation. </p>

<p class=Term1>DPNERR_PENDING</p>

<p class=Def1>Not an error, this return indicates that an asynchronous
operation has reached the point where it is successfully queued. <b>SUCCEEDED</b>(DPNERR_PENDING)
will return TRUE. This error value has been superseded by DPNERR_SUCCESS, which
should be used by all new applications. DPNERR_PENDING is only included for
backward compatibility.</p>

<p class=Term1>DPNERR_PLAYERLOST</p>

<p class=Def1>A player has lost the connection to the session. </p>

<p class=Term1>DPNERR_PLAYERNOTREACHABLE</p>

<p class=Def1>A player has tried to join a peer-peer session where at least one
other existing player in the session cannot connect to the joining player.</p>

<p class=Term1>DPNERR_SESSIONFULL</p>

<p class=Def1>The request to connect to the host or server failed because the
maximum number of players allotted for the session has been reached.</p>

<p class=Term1>DPNERR_TIMEDOUT</p>

<p class=Def1>The operation could not complete because it has timed out.</p>

<p class=Term1>DPNERR_UNINITIALIZED</p>

<p class=Def1>The requested object has not been initialized. </p>

<p class=Term1>DPNERR_UNSUPPORTED</p>

<p class=Def1>The function or feature is not available in this implementation
or on this service provider. </p>

<p class=Term1>DPNERR_USERCANCEL</p>

<p class=Def1>The user canceled the operation.</p>

<p class=Term1>&nbsp;</p>

<p class=Term1>DV_OK</p>

<p class=Def1>The request completed successfully. </p>

<p class=Term1>DV_FULLDUPLEX</p>

<p class=Def1>The sound card is capable of full-duplex operation.</p>

<p class=Term1>DV_HALFDUPLEX</p>

<p class=Def1>The sound card can only be run in half-duplex mode.</p>

<p class=Term1>DVERR_BUFFERTOOSMALL</p>

<p class=Def1>The supplied buffer is not large enough to contain the requested
data. </p>

<p class=Term1>DVERR_EXCEPTION</p>

<p class=Def1>An exception occurred when processing the request. </p>

<p class=Term1>DVERR_GENERIC</p>

<p class=Def1>An undefined error condition occurred. </p>

<p class=Term1>DVERR_INVALIDFLAGS</p>

<p class=Def1>The flags passed to this method are invalid. </p>

<p class=Term1>DVERR_INVALIDOBJECT</p>

<p class=Def1>The DirectPlay object pointer is invalid. </p>

<p class=Term1>DVERR_INVALIDPARAM</p>

<p class=Def1>One or more of the parameters passed to the method are invalid. </p>

<p class=Term1>DVERR_INVALIDPLAYER</p>

<p class=Def1>The player ID is not recognized as a valid player ID for this
game session. </p>

<p class=Term1>DVERR_INVALIDGROUP</p>

<p class=Def1>The group ID is not recognized as a valid group ID for this game
session. </p>

<p class=Term1>DVERR_INVALIDHANDLE</p>

<p class=Def1>The handle specified is invalid.</p>

<p class=Term1>DVERR_OUTOFMEMORY</p>

<p class=Def1>There is insufficient memory to perform the requested operation. </p>

<p class=Term1>DVERR_PENDING</p>

<p class=Def1>Not an error, this return indicates that an asynchronous
operation has reached the point where it is successfully queued. </p>

<p class=Term1>DVERR_NOTSUPPORTED</p>

<p class=Def1>The operation is not supported.</p>

<p class=Term1>DVERR_NOINTERFACE</p>

<p class=Def1>The specified interface is not supported. Could indicate using
the wrong version of DirectPlay.</p>

<p class=Term1>DVERR_SESSIONLOST</p>

<p class=Def1>The transport has lost the connection to the session.</p>

<p class=Term1>DVERR_NOVOICESESSION</p>

<p class=Def1>The session specified is not a voice session.</p>

<p class=Term1>DVERR_CONNECTIONLOST</p>

<p class=Def1>The connection to the voice session has been lost.</p>

<p class=Term1>DVERR_NOTINITIALIZED</p>

<p class=Def1>The <b>IDirectPlayVoiceClient::Initialize</b> or <b>IDirectPlayVoiceServer::Initialize</b>
method must be called before calling this method.</p>

<p class=Term1>DVERR_CONNECTED</p>

<p class=Def1>The DirectPlayVoice object is connected.</p>

<p class=Term1>DVERR_NOTCONNECTED</p>

<p class=Def1>The DirectPlayVoice object is not connected.</p>

<p class=Term1>DVERR_CONNECTABORTING</p>

<p class=Def1>The connection is being disconnected.</p>

<p class=Term1>DVERR_NOTALLOWED</p>

<p class=Def1>The object does not have the permission to perform this
operation.</p>

<p class=Term1>DVERR_INVALIDTARGET</p>

<p class=Def1>The specified target is not a valid player ID or group ID for
this voice session.</p>

<p class=Term1>DVERR_TRANSPORTNOTHOST</p>

<p class=Def1>The object is not the host of the voice session.</p>

<p class=Term1>DVERR_COMPRESSIONNOTSUPPORTED</p>

<p class=Def1>The specified compression type is not supported on the local
computer.</p>

<p class=Term1>DVERR_ALREADYPENDING</p>

<p class=Def1>An asynchronous call of this type is already pending.</p>

<p class=Term1>DVERR_ALREADYINITIALIZED</p>

<p class=Def1>The object has already been initialized.</p>

<p class=Term1>DVERR_SOUNDINITFAILURE</p>

<p class=Def1>A failure was encountered initializing the sound card.</p>

<p class=Term1>DVERR_TIMEOUT</p>

<p class=Def1>The operation could not be performed in the specified time.</p>

<p class=Term1>DVERR_CONNECTABORTED</p>

<p class=Def1>The connect operation was canceled before it could be completed.</p>

<p class=Term1>DVERR_NO3DSOUND</p>

<p class=Def1>The local computer does not support 3-D sound.</p>

<p class=Term1>DVERR_ALREADYBUFFERED</p>

<p class=Def1>There is already a user buffer for the specified ID.</p>

<p class=Term1>DVERR_NOTBUFFERED</p>

<p class=Def1>There is no user buffer for the specified ID.</p>

<p class=Term1>DVERR_HOSTING</p>

<p class=Def1>The object is the host of the session.</p>

<p class=Term1>DVERR_NOTHOSTING</p>

<p class=Def1>The object is not the host of the session.</p>

<p class=Term1>DVERR_INVALIDDEVICE</p>

<p class=Def1>The specified device is invalid.</p>

<p class=Term1>DVERR_RECORDSYSTEMERROR</p>

<p class=Def1>An error in the recording system occurred.</p>

<p class=Term1>DVERR_PLAYBACKSYSTEMERROR</p>

<p class=Def1>An error in the playback system occurred.</p>

<p class=Term1>DVERR_SENDERROR</p>

<p class=Def1>An error occurred while sending data.</p>

<p class=Term1>DVERR_USERCANCEL</p>

<p class=Def1>The user canceled the operation.</p>

<p class=Term1>DVERR_UNKNOWN</p>

<p class=Def1>An unknown error occurred.</p>

<p class=Term1>DVERR_RUNSETUP</p>

<p class=Def1>The specified audio configuration has not been tested. Call the <b>IDirectPlayVoiceTest::CheckAudioSetup</b>
method.</p>

<p class=Term1>DVERR_INCOMPATIBLEVERSION</p>

<p class=Def1>The client connected to a voice session that is incompatible with
the host.</p>

<p class=Term1>DVERR_INITIALIZED</p>

<p class=Def1>The <b>Initialize</b> method failed because the object has
already been initialized.</p>

<p class=Term1>DVERR_INVALIDPOINTER</p>

<p class=Def1>The pointer specified is invalid.</p>

<p class=Term1>DVERR_NOTRANSPORT</p>

<p class=Def1>The specified object is not a valid transport.</p>

<p class=Term1>DVERR_NOCALLBACK</p>

<p class=Def1>This operation cannot be performed because no callback function
was specified.</p>

<p class=Term1>DVERR_TRANSPORTNOTINIT</p>

<p class=Def1>Specified transport is not yet initialized.</p>

<p class=Term1>DVERR_TRANSPORTNOSESSION</p>

<p class=Def1>Specified transport is valid but is not connected/hosting.</p>

<p class=Term1>DVERR_TRANSPORTNOPLAYER</p>

<p class=Def1>Specified transport is connected/hosting but no local player
exists.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h1 style='page-break-after:avoid'>DirectPlay Visual Basic Reference</h1>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section contains reference
information for the API elements of Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> for Microsoft<span
style='font-size:7.0pt'> </span>Visual Basic<span style='font-size:7.0pt'></span>.
Reference material is divided into the following categories.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Classes</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Functions</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Types </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Enumerations </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Error Codes </span></p>

<p class=Leh>&nbsp;</p>

<h2 style='page-break-after:avoid'>Classes</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section contains references
for methods of the following Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> classes.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8Address</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8Client</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8Event</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbiedApplication</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyClient</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8LobbyEvent</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8Peer</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlay8Server</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlayVoiceClient8</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlayVoiceEvent8</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlayVoiceServer8</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DirectPlayVoiceTest8</b></span></p>

<p class=Leh>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Address</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn1" name="_ftnref1"
title=""><span class=MsoFootnoteReference>#</span></a>The <b>DirectPlay8Address</b>
class provides methods for creating and managing <b>DirectPlay</b> addresses.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8Address</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf><b>DirectPlay8Address Methods</b></p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>AddComponentLong</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>AddComponentString</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>BuildFromURL</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>Clear</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>Duplicate</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetComponentLong</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetComponentString</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetDevice</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetNumComponents</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetSP</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetURL</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>GetUserData</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>SetDevice</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>SetEqual</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>SetSP</b></p>
  </td>
 </tr>
 <tr>
  <td width=167 valign=top style='width:125.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=327 valign=top style='width:245.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Tp><b>SetUserData</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.AddComponentLong</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn2" name="_ftnref2"
title=""><span class=MsoFootnoteReference>#</span></a>Adds a component of type <b>Long</b>
to the address. If the component is part of the address, then it is replaced by
the new value in this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddComponentLong(</b><i>sComponent</i><b>
As String, </b><i>lValue</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>sComponent</i></p>

<p class=Def1>String that contains the key for the component. </p>

<p class=Term1><i>lValue</i></p>

<p class=Def1><b>Long</b> value to be added to the component.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.AddComponentString</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn3" name="_ftnref3"
title=""><span class=MsoFootnoteReference>#</span></a>Adds a component of type <b>String
</b>to the address. If the component is part of the address, then it is
replaced by the new value in this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddComponentString(</b><i>sComponent</i><b>
As String, </b><i>sValue</i><b> As String)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>sComponent</i></p>

<p class=Def1>String that contains the key for the component. </p>

<p class=Term1><i>sValue</i></p>

<p class=Def1>String value to be added to the component.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.BuildFromURL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn4" name="_ftnref4"
title=""><span class=MsoFootnoteReference>#</span></a>Sets the object equal to
the address of a DirectPlay URL. It erases the contents of the object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>BuildFromURL(</b><i>SourceURL</i><b>
As String)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SourceURL</i></p>

<p class=Def1>String that contains a properly formatted DirectPlay address.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.Clear</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn5" name="_ftnref5"
title=""><span class=MsoFootnoteReference>#</span></a>Resets the address object
to an empty address.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Clear()</b></p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.Duplicate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn6" name="_ftnref6"
title=""><span class=MsoFootnoteReference>#</span></a>Creates a <b>DirectPlay8Address</b>
object that duplicates the address in this object. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Duplicate() As DirectPlay8Address</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectPlay8Address</b>
object.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_GENERIC</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetComponentLong</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn7" name="_ftnref7"
title=""><span class=MsoFootnoteReference>#</span></a>Retrieves one of the
integer components in the address URL string.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetComponentLong(</b><i>sComponent</i><b>
As String) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>sComponent</i></p>

<p class=Def1>Name of the component to retrieve.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the value of the
requested component. </p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a discussion of the URL
string, see DirectPlay Addressing.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetComponentString</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn8" name="_ftnref8"
title=""><span class=MsoFootnoteReference>#</span></a>Retrieves one of the
integer components in the address URL string.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetComponentString(</b><i>sComponent</i><b>
As String) As String</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>sComponent</i></p>

<p class=Def1>Name of the component to retrieve.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the requested string.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a discussion of the URL
string, see DirectPlay Addressing.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetDevice</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn9" name="_ftnref9"
title=""><span class=MsoFootnoteReference>#</span></a>Retrieves the local
device GUID in the address object. If no device is specified, this method
raises DPNERR_DOESNOTEXIST.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetDevice() As String</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>String</b> value
representing the device in the address object.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetNumComponents</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn10"
name="_ftnref10" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of components in the address.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetNumComponents() As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of components
in this address object.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetSP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn11"
name="_ftnref11" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the service provider GUID in the address object. If no service provider is
specified, this method raises DPNERR_DOESNOTEXIST.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSP() As String</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the service provider in
the address object. </p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetURL</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn12"
name="_ftnref12" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the DirectPlay address URL represented by this object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetURL() As String</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the URL represented by
this object.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_OUTOFMEMORY</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDURL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_GENERIC</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.GetUserData</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn13"
name="_ftnref13" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the user data in the address object. If no user data exists in this address
object, DPNERR_DOESNOTEXIST is raised.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetUserData(</b><i>UserData</i><b>
As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>User data from this address.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_DOESNOTEXIST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.SetDevice</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn14"
name="_ftnref14" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
local device GUID in the address object. If a local device is specified for
this address, it is overwritten by this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetDevice(</b><i>guidDevice</i><b>
As String)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidDevice</i></p>

<p class=Def1>GUID of the local device. </p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.SetEqual</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn15"
name="_ftnref15" title=""><span class=MsoFootnoteReference>#</span></a>Sets
this <b>DirectPlay8Address</b> object to the address specified.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetEqual(</b><i>Address</i><b> As
DirectPlay8Address)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>Address</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that this object will be set to.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.SetSP</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn16"
name="_ftnref16" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
service provider GUID in the address object. If a service provider is specified
for this address, it is overwritten by this call. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetSP(</b><i>guidSP</i><b> As
String)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1>Service provider GUID to set.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Address.SetUserData</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn17"
name="_ftnref17" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
user data in the address object. If there is user data in this address, it is
overwritten by this call.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetUserData(</b><i>UserData</i><b>
As Long, </b><i>lDataSize</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Data to place in the user data section of the address. Set to 0 to
clear the user data.</p>

<p class=Term1><i>lDataSize</i></p>

<p class=Def1>Size, in bytes, of the data in <i>UserData</i>. If <i>UserData </i>is
0, this must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails,<b>
Err.Number</b> can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Client</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn18"
name="_ftnref18" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlay8Client</b> class to create and manage
client applications for client/server sessions.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8Client</b>
class can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHosts</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServiceProvider</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Message Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Client Information</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetClientInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Server Information</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServerAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn19"
name="_ftnref19" title=""><span class=MsoFootnoteReference>#</span></a>Cancels
asynchronous requests. Many methods of the <b>DirectPlay8Client</b> class run
asynchronously by default. Depending on the situation, you might want to cancel
requests before they are processed. All the methods of this class that can be
run asynchronously return an <i>lAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>lAsyncHandle</i> of the request in this method's <i>lAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, passing 0 in the <i>lAsyncHandle </i>parameter, and specifying
DPNCANCEL_ALL_OPERATIONS in the <i>lFlags </i>parameter. If a specific handle
is provided to this method, you must pass 0 in the <i>lFlags</i> parameter.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CancelAsyncOperation(</b><i>lAsyncHandle</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As
CONST_DPNCANCELFLAGS</b>]<b>)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. This value can be 0
to stop all requests or a particular type of asynchronous request. If a
specific handle for the request to cancel is specified, the <i>lFlags</i>
parameter must be 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request to cancel. You can
set this parameter to one of the flags of the <b>CONST_DPNCANCELFLAGS</b>
enumeration.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_PENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a send by
providing the handle returned from <b>DirectPlay8Client.Send</b> method. The <b>DirectPlay8Event.SendComplete</b>
method will still be called unless the message was sent with the
DPNSEND_NOCOMPLETE flag set. If you cancel a send operation by calling <b>DirectPlay8Peer.CancelAsyncOperation</b>
the <b>hResultCode </b>member of the <b>DPNMSG_SEND_COMPLETE</b> type that is
passed to the <b>DirectPlay8Event.SendComplete</b> method will be set to
DPNERR_CANCELLED.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn20"
name="_ftnref20" title=""><span class=MsoFootnoteReference>#</span></a>Closes
the open connection with a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Close(</b>[<i>lFlags</i><b> As Long</b>]<b>);</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Leh>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn21"
name="_ftnref21" title=""><span class=MsoFootnoteReference>#</span></a>Establishes
the connection to the server. Once a connection is established, the
communication channel on the interface is open and active and the application
should expect messages to arrive immediately. No messages can be sent by means
of the <b>DirectPlay8Client.Send</b> method until the connection has completed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before this method is called,
you can obtain an application description by calling <b>DirectPlay8Client.EnumHosts</b>.
The <b>EnumHosts</b> method returns a <b>DPN_APPLICATION_DESC</b> type for each
hosted application. The type describes the application, including the GUID of
the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the connection to the host
is requested, the <b>DirectPlay8Event.IndicateConnect</b> method is called in
the host's message handler. The host may either accept or reject the
connection. In either case, once the host has acted, the client message
handler's <b>DirectPlay8Event.ConnectComplete</b> method will be called to
convey the response.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Connect(</b><i>AppDesc</i><b> As
DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Address</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DeviceInfo</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNOPERATIONS, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application.
The only member of this type that you must set is the <i>guidApplication</i>
member. Only some of the members of this type are used by this method. The only
member that you must set is <i>guidApplication</i>. You can also set <i>guidInstance</i>,<b>
</b><i>pwszPassword</i>,<b> </b><i>dwFlags</i>,<b> </b>and <i>dwSize</i><b>.</b></p>

<p class=Term1><i>Address</i></p>

<p class=Def1>Optional <b>DirectPlay8Address</b> object that specifies the
addressing information to use to connect to the computer that is hosting.</p>

<p class=Term1><i>DeviceInfo</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the network
adapter (that is, NIC, modem, and so on) to use to connect to the server.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag from the <b>CONST_DPNOPERATIONS</b> enumeration that
describes the connection mode. You can set the following flag.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def1>Process the connection request synchronously. Setting this flag
does not generate a <b>DirectPlay8Event.ConnectComplete</b> method call.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Application-specific user data.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1>Size of the data contained in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Client.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPASSWORD</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINTERFACE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SESSIONFULL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_HOSTREJECTEDCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINSTANCE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although multiple enumerations
can be run concurrently, and can be run across the duration of a connection,
only one connection is allowed per object. To establish a connection to more
than one application, you must create another object. That is, only one running
application per object is allowed. If <b>DirectPlay8Client.Connect</b> is
called while another connection is in progress, the method raises an error. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.EnumHosts</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn22"
name="_ftnref22" title=""><span class=MsoFootnoteReference>#</span></a>Enumerates
applications that host Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> games. When an application is
found meeting the enumeration criteria, the <b>DirectPlay8Event.EnumHostsResponse</b>
method is called in the application's message handler. This method contains a <b>DPNMSG_ENUM_HOSTS_RESPONSE</b>
message type that contains a <b>DPN_APPLICATION_DESC</b> type that describes
the applications found.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>EnumHosts(</b><i>ApplicationDesc</i><b>
As DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>AddrHost</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DeviceInfo</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lRetryCount </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> lRetryInterval</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNOPERATIONS, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ApplicationDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> structure that specifies which
application hosts to enumerate. You can specify the following fields to reduce
the number of responses to the enumeration.</p>

<p class=Term2>guidApplication</p>

<p class=Def2>GUID of the application to find; if not specified, all are
searched for.</p>

<p class=Term2>Password </p>

<p class=Def2>Password to provide; secure sessions will not respond without a
password.</p>

<p class=Term1><i>AddrHost</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the address of
the computer that is hosting the application. </p>

<p class=Term1><i>DeviceInfo</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the service
provider and settings to enumerate.</p>

<p class=Term1><i>lRetryCount</i></p>

<p class=Def1>Value that specifies how many times the enumeration data will be
sent. You can set this parameter to zero to specify the default value. If you
set this value to INFINITE, the enumeration will continue until canceled.</p>

<p class=Term1><i>lRetryInterval</i></p>

<p class=Def1>Value that specifies the time, in milliseconds, between
successive enumeration attempts. Set this parameter to 0 to use the default
value.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1>Number of milliseconds for the enumeration to run. If 0 is
specified, a default value is used. If INFINITE is specified, the enumeration
continues until it is canceled.</p>

<p class=Term1><i>lEnumPeriod</i></p>

<p class=Def1>Value specifying how often to re-enumerate. If 0 is specified, a
default value is used. </p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag from the <b>CONST_DPNOPERATIONS</b> enumeration that
controls how this method is processed. The following flag can be set for this
method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Block of data that is sent in the enumeration request to the
host. The size of the data can be limited depending on the network type, but
512 bytes is supported at a minimum.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1>Size of the data in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Client.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because of the variety of ways
enumeration can happen, it is not recommended that an application specify <i>lEnumPeriod
</i>unless the application has some specific media knowledge.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn23"
name="_ftnref23" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the full application description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetApplicationDesc(</b>[<i>lFlags</i><b>
As Long</b>]<b>) _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> As DPN_APPLICATION_DESC</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_APPLICATION_DESC</b>
type describing the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn24"
name="_ftnref24" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_CAPS</b> type for the current object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCaps(</b>[<i>lFlags</i><b> As
Long</b>]<b>) As DPN_CAPS</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_CAPS</b> type
filled with session parameters.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Client.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn25"
name="_ftnref25" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
statistical information about the connection between the local endpoint and the
server.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetConnectionInfo(</b>[<i>lFlags</i><b>
As Long</b>]<b>) As DPN_CONNECTION_INFO</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_CONNECTION_INFO</b>
type to retrieve information about the specified connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Connect</b> call has completed.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetCountServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn26"
name="_ftnref26" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountServiceProviders(</b>[<i>lFlags</i><b>
As Long</b>]<b>) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of registered
service providers available to the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn27"
name="_ftnref27" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the application to monitor the size of the send queue. Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
does not send messages faster than the receiving computer can process them. As
a result, if the sending computer is sending faster than the receiver can
receive, messages accumulate in the senders queue. If the application
registers that the send queue is growing too large, it should decrease the rate
at which messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSendQueueInfo(</b><i>lNumMsgs</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lNumBytes</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As
CONST_DPNGETSENDQUEUEINFO</b>]<b>)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lNumMsgs</i></p>

<p class=Def1>Number of messages currently queued.</p>

<p class=Term1><i>lNumBytes</i></p>

<p class=Def1>Amount of data, in bytes, of the messages currently queued.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Set this parameter to one of the <b>CONST_DPNGETSENDQUEUEINFO </b>values
to get the send-queue information for a particular priority level. Set this
flag to zero to get the combined send-queue information.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetServerAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn28"
name="_ftnref28" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the address for the server for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetServerAddress(</b>[<i>lFlags</i><b>
As Long</b>]<b>) As DirectPlay8Address</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectPlay8Address</b>
object specifying the address of the server.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetServerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn29"
name="_ftnref29" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the data set for the server set by the call to the <b>DirectPlay8Server.SetServerInfo</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetServerInfo(</b>[<i>lFlags</i><b>
As Long</b>]<b>) As DPN_PLAYER_INFO</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Set this parameter to one of the <b>CONST_DPNINFO</b> flags to
indicate whether the method should return the name or the data set.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_PLAYER_INFO</b>
type containing the name or the data set for the server.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetServiceProvider</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn30"
name="_ftnref30" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
information for the specified service provider. Before calling this method,
call the <b>DirectPlay8Client.GetCountServiceProviders</b> method to obtain the
number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b><span style='font-size:10.0pt;
font-family:"Times New Roman",serif'>GetServiceProvider(</span></b><i><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>lIndex</span></i> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Long)</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>DPN_SERVICE_PROVIDER_INFO</span></b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index value specifying the specific server provider. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SERVICE_PROVIDER_INFO</b>
type that describes the service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn31"
name="_ftnref31" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_SP_CAPS</b> structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSPCaps(</b><i>guidSP</i><b> As
String, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As Long</b>]<b>)
As DPN_SP_CAPS</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1>String specifying the GUID of the service provider you want to
get information about.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SP_CAPS</b>
type to receive the information about the specified service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Client.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn32"
name="_ftnref32" title=""><span class=MsoFootnoteReference>#</span></a>Registers
or unregisters an application with a lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterLobby(</b><i>dpnHandle</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> LobbyApp</i><b> As
DirectPlay8LobbiedApplication, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As Long</b>]<b>)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnHandle</i><b> </b></p>

<p class=Def1>Connection handle to be used when making the calls to <b>DirectPlay8LobbiedApplication.UpdateStatus</b>.</p>

<p class=Def1>&nbsp;</p>

<p class=Term1><i>LobbyApp</i></p>

<p class=Def1><b>DirectPlay8LobbiedApplication</b> object that specifies the
application.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Set this parameter to one of the two <b>CONST_DPNLOBBY</b>
enumeration values to indicate whether the application is to be registered or
unregistered.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When an application is
registered with a lobby, the lobby client automatically receives notifications
of changes in game status.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.RegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn33"
name="_ftnref33" title=""><span class=MsoFootnoteReference>#</span></a>Registers
an entry point in the client's code that receives the messages from the <b>DirectPlay8Client</b>
object and from the server. This method must be called before calling any other
methods of this class.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterMessageHandler(</b><i>event</i><b>
As DirectPlay8Event)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>event</i></p>

<p class=Def1><b>DirectPlay8Event</b> object that will receive the messages
generated by the client and server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYREGISTERED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to register a new
message handler, you must first call <b>DirectPlay8Client.UnRegisterMessageHandler</b>
to unregister the current message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn34"
name="_ftnref34" title=""><span class=MsoFootnoteReference>#</span></a>Transmits
data to the server. The message can be sent synchronously or asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Send(</b><i>buffer()</i><b> As
BYTE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As
CONST_DPNSENDFLAGS</b>]<b>) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>buffer()</i></p>

<p class=Def1>Array of type <b>BYTE</b> that describes the data to send.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to be sent. If the
message has not been sent by the <i>lTimeOut</i> value, the message is not
sent. If you do not want a time out for message sends, set this parameter to 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
following flags defined in the <b>CONST_DPNSENDFLAGS</b> enumeration. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Client.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method will call the <b>DirectPlay8Event.Receive</b>
method in the server's message handler. When the <b>Send</b> request is
completed, the <b>DirectPlay8Event.SendComplete</b> method is called in the
client's message handler. The <b>SendComplete</b> method contains a <b>DPNMSG_SEND_COMPLETE</b>
message type. The success or failure of the request is contained in the <b>hResultCode</b>
member of this message type.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn35"
name="_ftnref35" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
capabilities for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetCaps(</b><i>caps</i><b> As
DPN_CAPS, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As Long</b>]<b>)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>caps</i></p>

<p class=Def1><b>DPN_CAPS</b> type used to set the information about the
current session.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Client.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.SetClientInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn36"
name="_ftnref36" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
static settings of a client with an application. Call this method before
connecting to relay basic player information with the application. After the
client successfully connects with the application, information obtained through
this method can be retrieved by the server by calling the <b>DirectPlay8Server.GetClientInfo</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetClientInfo(</b><i>PlayerInfo</i><b>
As DPN_PLAYER_INFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As
CONST_DPNOPERATIONS</b>]<b>) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PlayerInfo</i></p>

<p class=Def1><b>DPN_PLAYER_INFO</b> type that contains the peer information to
set.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Set the DPNSETCLIENTINFO_SYNC flag from the CONST_DPNOPERATIONS
enumeration to have the method process synchronously. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Client.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>DirectPlay8Client.Send</b> method
because of the high cost of using the <b>DirectPlay8Client.SetClientInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the client
information with this method after connecting to the application. Calling this
method after connection will call the <b>DirectPlay8Event.InfoNotify</b> method
in the server's message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn37"
name="_ftnref37" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
capabilities for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetSPCaps(</b><i>guidSP</i><b> As
String, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>spCaps</i><b> As
DPN_SP_CAPS, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b>[<i>lFlags</i><b> As Long</b>]<b>)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1>String specifying the GUID of the service provider you want to
set information about.</p>

<p class=Term1><i>spCaps</i></p>

<p class=Def1><b>DPN_SP_CAPS</b> type to set the information about the
specified service provider.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Client.RegisterMessageHandler</b>
must be made before this method can be called. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Client.UnregisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn38"
name="_ftnref38" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
the current <b>DirectPlay8Client</b> message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Event</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn39"
name="_ftnref39" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlay8Event</b> class to capture Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
events generated by the <b>DirectPlay8Peer</b>, <b>DirectPlay8Client</b>, and <b>DirectPlay8Server</b>
classes.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>DirectPlay8Event</b> is
associated with the <b>DirectPlay8Peer</b>, <b>DirectPlay8Client</b>, and <b>DirectPlay8Server</b>
objects when calling <b>RegisterMessageHandler</b> for each object.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>When implementing the <b>DirectPlay8Event</b> object, Microsoft<span
style='font-size:7.0pt'> </span>Visual Basic<span style='font-size:7.0pt'></span>
requires that every method of this object is implemented in your form.</p>

<p class=Ne>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8Event</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>DirectPlay8Event Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddRemovePlayerGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AppDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AsyncOpComplete</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ConnectComplete</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreatePlayer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyPlayer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHostsQuery</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHostsResponse</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>HostMigrate</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IndicateConnect</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>IndicateConnectAborted</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>InfoNotify</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Receive</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SendComplete</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>TerminateSession</b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.AddRemovePlayerGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn40"
name="_ftnref40" title=""><span class=MsoFootnoteReference>#</span></a>Called
by the associated <b>DirectPlay8Peer</b>, <b>DirectPlay8Client</b>, or <b>DirectPlay8Server</b>
object when a player or group has been added to or removed from a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddRemovePlayerGroup( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lMsgID</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lPlayerID</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lGroupID</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lMsgID</i></p>

<p class=Def1>One of the following flags, which indicate whether a player or
group has joined or has left the session:</p>

<p class=Term2>DPN_MSGID_ADD_PLAYER_TO_GROUP</p>

<p class=Def2>A player has joined the group.</p>

<p class=Term2>DPN_MSGID_REMOVE_PLAYER_FROM_GROUP</p>

<p class=Def2>A player has left the group.</p>

<p class=Term1><i>lPlayerID</i><b> </b></p>

<p class=Def1><b>Long</b> value set to the ID of the player or group being
added or removed.</p>

<p class=Term1><i>lGroupID</i><b> </b></p>

<p class=Def1><b>Long</b> value set to the ID of the group this player or group
is being added to or removed from.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.AppDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn41"
name="_ftnref41" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the application description has been changed by a call to the <b>DirectPlay8Peer.SetApplicationDesc</b>
or <b>DirectPlay8Server.SetApplicationDesc</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AppDesc(</b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.AsyncOpComplete</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn42"
name="_ftnref42" title=""><span class=MsoFootnoteReference>#</span></a>Called
when an asynchronous operation has completed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AsyncOpComplete( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_ASYNC_OP_COMPLETE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_ASYNC_OP_COMPLETE</b> message type containing the
handle and the result of the asynchronous operation.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.ConnectComplete</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn43"
name="_ftnref43" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the attempt to connect to the host or server has completed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>ConnectComplete( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_CONNECT_COMPLETE, </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_CONNECT_COMPLETE</b> message type containing the async
handle and the result of the connection attempt.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.CreateGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn44"
name="_ftnref44" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a group is created.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CreateGroup</b> <b>( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lGroupID <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> lOwnerID <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lGroupID </i></p>

<p class=Def1><b>Long</b> value set to the group's ID.</p>

<p class=Term1><i>lOwnerID </i></p>

<p class=Def1><b>Long</b> value set to the owner's ID.</p>

<p class=Term1><i>fRejectMsg</i><b> </b></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.CreatePlayer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn45"
name="_ftnref45" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a player is created.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CreatePlayer</b> <b>( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lPlayerID </i><b>As
Long,<i> _</i></b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lPlayerID </i></p>

<p class=Def1><b>Long</b> value set to the player's ID.</p>

<p class=Term1><i>fRejectMsg</i><b> </b></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.DestroyGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn46"
name="_ftnref46" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a group is destroyed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyGroup( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lGroupID <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> lReason <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lGroupID </i></p>

<p class=Def1><b>Long</b> value set to the group's ID.</p>

<p class=Term1><i>lReason </i></p>

<p class=Def1><b>Long</b> value that indicates the reason that the group was
destroyed.</p>

<p class=Term1><i>fRejectMsg</i><b> </b></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.DestroyPlayer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn47"
name="_ftnref47" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a player is destroyed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyPlayer( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lPlayerID <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> lReason <b>As Long, _</b></i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lPlayerID </i></p>

<p class=Def1><b>Long</b> value set to the player's ID.</p>

<p class=Term1><i>lReason </i></p>

<p class=Def1><b>Long</b> value that indicates the reason that the group was
destroyed.</p>

<p class=Term1><i>fRejectMsg</i><b> </b></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.EnumHostsQuery</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn48"
name="_ftnref48" title=""><span class=MsoFootnoteReference>#</span></a>Called
when host enumeration is requested through the <b>DirectPlay8Peer.EnumHosts</b>
or <b>DirectPlay8Client.EnumHosts</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>EnumHostsQuery( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_ENUM_HOSTS_QUERY, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_ENUM_HOSTS_QUERY</b> message type containing received
data. </p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1><b>Boolean</b> value that is set to True to reject the
enumeration request. However, if you reject the query, Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
will not call the client's <b>DirectPlay8Event.EnumHostsResponse</b>, so they
will not be aware that you are hosting a session.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.EnumHostsResponse</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn49"
name="_ftnref49" title=""><span class=MsoFootnoteReference>#</span></a>Contains
the host information resulting from a call to the <b>DirectPlay8Peer.EnumHosts</b>
or <b>DirectPlay8Client.EnumHosts</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>EnumHostsResponse( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_ENUM_HOSTS_RESPONSE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_ENUM_HOSTS_RESPONSE</b> message type containing host
information.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.HostMigrate</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn50"
name="_ftnref50" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the host has changed in a session by a call to the <b>DirectPlay8Peer.Host</b>
or <b>DirectPlay8Server.Host</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HostMigrate(</b><i>NewHostID </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>NewHostID </i></p>

<p class=Def1><b>Long</b> value set to the ID of the new host.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.IndicateConnect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn51"
name="_ftnref51" title=""><span class=MsoFootnoteReference>#</span></a>Called
on the host's message handler when a player has requested a connection to the
session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IndicateConnect( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_INDICATE_CONNECT, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_INDICATE_CONNECT</b> message type.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1><b>Boolean </b>value that is set to False to enable the player to
join the session and True to reject the players request.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>After this method returns, the
player's <b>DirectPlay8Event.ConnectComplete</b> method will be called with the
response to their request to join the session. If the connection request was
successful, the <b>hResultCode </b>member<b> </b>of the <b>DPNMSG_CONNECT_COMPLETE</b>
type will be set to 0. If the request was rejected or failed, <b>hResultCode</b>
will be set to an error code.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.IndicateConnectAborted</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn52"
name="_ftnref52" title=""><span class=MsoFootnoteReference>#</span></a>Called
if a player's connection is lost after it was indicated on the host, but prior
to being added to the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>IndicateConnectAborted( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.InfoNotify</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn53"
name="_ftnref53" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the information for a client, server, peer, or group has been updated.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>InfoNotify(</b><i>lMsgID</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lNotifyID </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lMsgID</i></p>

<p class=Def1>This will be set to one of the following constants.</p>

<p class=Term2>DPN_MSGID_CLIENT_INFO</p>

<p class=Def2>The client information has changed.</p>

<p class=Term2>DPN_MSGID_GROUP_INFO</p>

<p class=Def2>The group information has changed.</p>

<p class=Term2>DPN_MSGID_PEER_INFO</p>

<p class=Def2>The peer information has changed.</p>

<p class=Term2>DPN_MSGID_SERVER_INFO</p>

<p class=Def2>The server information has changed.</p>

<p class=Term1><i>lNotifyID</i></p>

<p class=Def1>Notification ID.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.Receive</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn54"
name="_ftnref54" title=""><span class=MsoFootnoteReference>#</span></a>Called
in the receiver's message handler when a message is received from a player or
host.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Receive( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_RECEIVE, </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_RECEIVE</b> message type containing the data sent.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.SendComplete</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn55"
name="_ftnref55" title=""><span class=MsoFootnoteReference>#</span></a>Called
in the sender's message handler when the message is received by the recipient.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SendComplete( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dpnotify</i><b> As
DPNMSG_SEND_COMPLETE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_SEND_COMPLETE</b> message type containing the result of
the message send and the time it took to send the message.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Event.TerminateSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn56"
name="_ftnref56" title=""><span class=MsoFootnoteReference>#</span></a>Called
in the message handler for each session player after a call to <b>DirectPlay8Peer.TerminateSession</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>TerminateSession( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i>dpnotify</i><b> As
DPNMSG_TERMINATE_SESSION, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i>fRejectMsg</i><b> As Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnotify</i></p>

<p class=Def1><b>DPNMSG_TERMINATE_SESSION </b>message type containing the
result of the message send.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1>Parameter is not supported in this release.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a peer-peer session that
permits host-migration, the host migrates if the current host calls <b>DirectPlay8Peer.Close</b>
or stops responding. When this event occurs:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Microsoft</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'> </span><span
style='font-family:"Times New Roman",serif'>DirectPlay</span><span
style='font-size:7.0pt;font-family:"Times New Roman",serif'></span><span
style='font-family:"Times New Roman",serif'> notifies all the other players
that the host has left the session by calling their <b>DirectPlay8Event.DestroyPlayer</b>
method.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay then notifies the
remaining players of the new host by calling their <b>DirectPlay8Event.HostMigrate</b>
method </span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>To prevent host-migration, the
current host must terminate the session by calling <b>DirectPlay8Peer.TerminateSession</b>.
When the host terminates a session this way:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay calls each players' <b>DirectPlay8Event.TerminateSession</b>
method. The <b>hResultCode</b> of the associated <b>DPNMSG_TERMINATE_SESSION</b>
type will be set to DPNERR<b>_</b>HOSTTERMINATEDSESSION.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay will then generate <b>DirectPlay8Event.DestroyPlayer
</b>calls for each player.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a peer-peer game that does
not permit host-migration, the session is terminated if the host calls <b>DirectPlay8Peer.Close</b>,
or stops responding. When this event occurs:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay calls each player's <b>DirectPlay8Event.TerminateSession</b>
method. The <b>hResultCode</b> of the associated <b>DPNMSG_TERMINATE_SESSION</b>
type will be set to set to DPNERR<b>_</b>HOSTTERMINATEDSESSION.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay will then generate <b>DirectPlay8Event.DestroyPlayer
</b>calls for each player.</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In a client/server game, the
session is terminated if the host calls <b>DirectPlay8Server.Close</b> or stops
responding. When this event occurs:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> DirectPlay calls each player's <b>DirectPlay8Event.TerminateSession</b>
method. The <b>hResultCode</b> of the associated <b>DPNMSG_TERMINATE_SESSION</b>
type will be set to DPNERR_CONNECTIONLOST.</span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> If the server disconnected
itself from the session by calling <b>DirectPlay8Server.Close</b>, its <b>DirectPlay8Event.DestroyPlayer</b>
method will be called once for each player in the session, including its own
player. </span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> Otherwise, the server's <b>DirectPlay8Event.DestroyPlayer</b>
method is called for each client's player, but not for the server's player.</span></p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8LobbiedApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn57"
name="_ftnref57" title=""><span class=MsoFootnoteReference>#</span></a>The <b>DirectPlay8LobbiedApplication</b>
class is used by an application that supports lobbying. This class enables the
application to register with the system so that it can be lobby launched.
Additionally, it also enables the application to get the connection information
necessary to launch a game without querying the user. Lastly, this class
enables the lobbied application to send messages and notifications to the lobby
client that launched the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8LobbiedApplication</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>DirectPlay8LobbiedApplication Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterProgram</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetAppAvailable</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterProgram</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UpdateStatus</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn58"
name="_ftnref58" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Close()</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.GetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn59"
name="_ftnref59" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the settings for the specified connection. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetConnectionSettings(</b><i>LobbyClient</i><b>
As Long, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>LobbyClient</i><b> </b></p>

<p class=Def1>Handle to the connection to retrieve the settings for.</p>

<p class=Term1><i>lFlags</i><b> </b></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.RegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn60"
name="_ftnref60" title=""><span class=MsoFootnoteReference>#</span></a>Registers
a message handler function that receives notifications about changes in the
state of the lobbied application and receives messages from the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterMessageHandler(</b><i>lobbyEvent</i><b>
As DirectPlay8LobbyEvent)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lobbyEvent</i></p>

<p class=Def1><b>DirectPlay8LobbyEvent</b> object that is used to receive
notifications.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYREGISTERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to register a new
message handler, you must first call <b>DirectPlay8LobbiedApplication.UnRegisterMessageHandler</b>
to unregister the current message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.RegisterProgram</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn61"
name="_ftnref61" title=""><span class=MsoFootnoteReference>#</span></a>Registers
a lobby-aware application with Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span>. Applications must be registered to enable
lobby launching.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterProgram( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>ProgramDesc</i><b> As
DPL_PROGRAM_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ProgramDesc</i></p>

<p class=Def1><b>DPL_PROGRAM_DESC</b> type that describes the lobby-aware
application to register.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The application needs to
register only once. It should be unregistered with a call to the <b>DirectPlay8LobbiedApplication.UnRegisterProgram</b>
method when it is uninstalled. If a lobby client tries to launch an application
that no longer exists on the system, DirectPlay automatically unregisters the
application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In DirectX<span
style='font-size:7.0pt'></span> 8.0, <b>RegisterProgram</b> must be used. You
cannot manually place application information into the registry. Failure to use
this class makes your application nonportable and incompatible with future
versions of DirectPlay.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn62"
name="_ftnref62" title=""><span class=MsoFootnoteReference>#</span></a>Sends a
message from the lobbied application to the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Send(</b><i>Target</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>buffer()</i><b> As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lBufferSize</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>Target</i></p>

<p class=Def1><b>Long</b> value specifying the handle of the lobby client to
receive the message.</p>

<p class=Term1><i>buffer()</i></p>

<p class=Def1>Variable of type <b>BYTE</b> that contains the message buffer.</p>

<p class=Term1><i>lBufferSize</i></p>

<p class=Def1><b>Long</b> value that specifies the size of the message buffer
in the <i>buffer()</i> parameter, in bytes. This value must be at least 1 byte
and no more than 64 KB.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1><b>Long</b> value that specifies the number of milliseconds to
wait for the <b>Send</b> request to process.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SENDTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer size is larger
than 64 KB, <b>Err.Number</b> is set to DPNERR_SENDTOOLARGE. If the buffer size
is set to 0, <b>Err.Number</b> is set to DPNERR_INVALIDPARAM.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.SetAppAvailable</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn63"
name="_ftnref63" title=""><span class=MsoFootnoteReference>#</span></a>Makes an
application available or unavailable for a lobby client to connect to. This
method is typically called if a lobbied application is independently launched,
that is, not launched by a lobby client. Additionally, this method should be
called if a game has ended and the lobbied application needs to be available to
connect to a lobby client at the start of another game.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetAppAvailable(</b><i>fAvailable</i><b>
As Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>fAvailable</i></p>

<p class=Def1><b>Boolean</b> value to set to TRUE if the application is
available, or FALSE to make it unavailable.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.SetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn64"
name="_ftnref64" title=""><span class=MsoFootnoteReference>#</span></a>Specifies
the settings for the connection.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetConnectionSettings(</b><i>hTarget
</i><b>As Long</b><i>, </i><b>_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> lFlags</i><b> As Long</b><i>, _</i></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> ConnectionSettings As </i><b>DPL_CONNECTION_SETTINGS</b><i>,
</i><b>_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> HostAddress </i><b>As</b><i> </i><b>DirectPlay8Address</b><i>,
</i><b>_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> Device </i><b>As</b><i> </i><b>DirectPlay8Address)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>hTarget </i></p>

<p class=Def1><b>Long </b>value that is set to the connection handle.</p>

<p class=Term1><i>lFlags</i><b> </b></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Term1><i>ConnectionSettings </i></p>

<p class=Def1><b>DPL_CONNECTION_SETTINGS </b>type with the connection settings.</p>

<p class=Term1><i>HostAddress </i></p>

<p class=Def1><b>DirectPlay8Address </b>object with the host address.</p>

<p class=Term1><i>Device </i></p>

<p class=Def1><b>DirectPlay8Address </b>object with the device address.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.UnRegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn65"
name="_ftnref65" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
the current <b>DirectPlay8LobbiedApplication</b> message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.UnRegisterProgram</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn66"
name="_ftnref66" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
a lobby-aware application that was registered through the <b>DirectPlay8LobbiedApplication.RegisterProgram</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterProgram(</b><i>guidApplication</i><b>
As String, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidApplication</i></p>

<p class=Def1>GUID of the application to unregister.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbiedApplication.UpdateStatus</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn67"
name="_ftnref67" title=""><span class=MsoFootnoteReference>#</span></a>Updates
the status of a connected lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UpdateStatus(</b><i>LobbyClient</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lStatus</i><b> As
CONST_DPLSESSION)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>LobbyClient</i></p>

<p class=Def1><b>Long</b> value that specifies the connection handle for the
lobby client.</p>

<p class=Term1><i>lStatus</i></p>

<p class=Def1>One of the constants of the <b>CONST_DPLSESSION</b> enumeration
that specifies the status between the lobby client and the lobbied application.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You define the connection handle
when you register the application with the lobby by calling <b>DirectPlay8Client.RegisterLobby</b>
or <b>DirectPlay8Peer.RegisterLobby</b>.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8LobbyClient</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn68"
name="_ftnref68" title=""><span class=MsoFootnoteReference>#</span></a>The <b>DirectPlay8LobbyClient</b>
class is used by a lobby client application and is responsible for enumerating
and launching lobby-enabled game applications on the local computer, and
communicating with them after they are running. The lobby client must register
a message handler routine to process messages from the lobby and the lobbied
game application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8LobbyClient</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>DirectPlay8LobbyClient Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ConnectApplication</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountLocalPrograms</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetLocalProgram</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ReleaseApplication</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Send</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterMessageHandler</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn69"
name="_ftnref69" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Close()</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.ConnectApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn70"
name="_ftnref70" title=""><span class=MsoFootnoteReference>#</span></a>Connects
a lobby-enabled application to the session specified in the <b>DPL_CONNECT_INFO</b>
type. If the application is not running, this method can be used to launch the
application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the connection is
successfully established, Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> calls the message handler's <b>DirectPlay8LobbyEvent.Connect</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>ConnectApplication( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>ConnectionInfo</i><b> As
DPL_CONNECT_INFO, </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPLCONNECT) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ConnectionInfo</i></p>

<p class=Def1><b>DPL_CONNECT_INFO</b> type that describes the connection
parameters, including the GUID of the application to connect to.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1><b>Long</b> value that specifies the number of milliseconds to
wait for the connection to process.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>One of the constants of the <b>CONST_DPLCONNECT</b> enumeration
that determines connection behavior.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a<b> Long</b> value that
is set to the application connection handle . This handle is used for further
communication with the application. Additionally, this handle is used in the <i>Application</i>
parameter in the <b>DirectPlay8LobbyClient.ReleaseApplication</b> method.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANTLAUNCHAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.GetCountLocalPrograms</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn71"
name="_ftnref71" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of lobbied applications that are registered on the system.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountLocalPrograms(</b><i>guidApplication</i><b>
As String) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidApplication</i></p>

<p class=Def1><b>String</b> value specifying the <b>GUID</b> of the lobbied
application to enumerate. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of lobbied
applications that are registered.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.GetLocalProgram</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn72"
name="_ftnref72" title=""><span class=MsoFootnoteReference>#</span></a>Enumerates
the specified lobbied application that is registered on the system. Before
calling this method, call <b>DirectPlay8LobbyClient.GetCountLocalPrograms</b>
to see how many lobbied applications are registered.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetLocalProgram(</b><i>lProgID</i><b>
As Long) As DPL_APPLICATION_INFO</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lProgID</i></p>

<p class=Def1><b>Long</b> value specifying the ID of the lobbied application to
enumerate.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPL_APPLICATION_INFO</b>
structure that describes the lobbied application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is generally called
twiceonce to obtain the size of the required buffer, and then with the correct
buffer size.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.RegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn73"
name="_ftnref73" title=""><span class=MsoFootnoteReference>#</span></a>Registers
a message handler function that receives notifications about changes in the
state of the lobby client and receives messages from the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterMessageHandler(</b><i>lobbyEvent</i><b>
As DirectPlay8LobbyEvent)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lobbyEvent</i></p>

<p class=Def1><b>DirectPlay8LobbyEvent</b> object that is used to receive
notifications.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYREGISTERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to register a new
message handler, you must first call <b>DirectPlay8LobbyClient.UnRegisterMessageHandler</b>
to unregister the current message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.ReleaseApplication</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn74"
name="_ftnref74" title=""><span class=MsoFootnoteReference>#</span></a>Releases
a lobbied application and closes the connection between the lobby client and
the application. This method should be called whenever a lobby client has
finished its session with an application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>ReleaseApplication(</b><i>Application</i><b>
As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>Application</i></p>

<p class=Def1><b>Long</b> value specifying the GUID of the lobbied application
to release. This value is returned by the <b>DirectPlay8LobbyClient.ConnectApplication</b>
method.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.Send</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn75"
name="_ftnref75" title=""><span class=MsoFootnoteReference>#</span></a>Sends a
message to a lobbied application that was launched by this lobby client or was
connected by this lobby client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> transmits the
data to the target by calling the target message handler's <b>DirectPlay8LobbyEvent.Receive</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Send(</b><i>Target</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>buffer()</i><b> As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lBufferSize</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>Target</i></p>

<p class=Def1><b>Long</b> value that specifies the target for the message
transmission.</p>

<p class=Term1><i>buffer()</i></p>

<p class=Def1>Buffer that contains the message.</p>

<p class=Term1><i>lBufferSize</i></p>

<p class=Def1>Size of the message buffer in the <i>buffer()</i> parameter, in
bytes. This value must be at least 1 byte and no more than 64 KB<i>.</i></p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SENDTOOLARGE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the buffer size is larger
than 64 KB, <b>Err.Number</b> is set to DPNERR_SENDTOOLARGE. If the buffer size
is set to 0, <b>Err.Number</b> is set to DPNERR_INVALIDPARAM.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.SetConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn76"
name="_ftnref76" title=""><span class=MsoFootnoteReference>#</span></a>Sets the
connection settings to be associated with the specified connection. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetConnectionSettings(</b><i>hTarget</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>ConnectionSettings</i><b>
As DPL_CONNECTION_SETTINGS), _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>HostAddress</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Device</i><b> As
DirectPlay8Address)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>hTarget</i><b> </b></p>

<p class=Def1><b>Long </b>value that is set to the connection handle. </p>

<p class=Term1><i>lFlags</i><b> </b></p>

<p class=Def1>Reserved. Set to 0.</p>

<p class=Term1><i>ConnectionSettings</i><b> </b></p>

<p class=Def1><b>DPL_CONNECTION_SETTINGS </b>structure that contains the
connections.</p>

<p class=Term1><i>HostAddress</i><b> </b></p>

<p class=Def1><b>DirectPlay8Address</b> object containing the host address.</p>

<p class=Term1><i>Device</i><b> </b></p>

<p class=Def1><b>DirectPlay8Address</b> object containing the device address.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyClient.UnRegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn77"
name="_ftnref77" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
the current <b>DirectPlay8LobbyClient</b> message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8LobbyEvent</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn78"
name="_ftnref78" title=""><span class=MsoFootnoteReference>#</span></a>The <b>DirectPlay8LobbyEvent</b>
class is used to capture Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> events generated when using the <b>DirectPlay8LobbiedApplication</b>
and <b>DirectPlay8LobbyClient</b> classes.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>When implementing the <b>DirectPlay8LobbyEvent</b> object,
Microsoft<span style='font-size:7.0pt'> </span>Visual Basic<span
style='font-size:7.0pt'></span> requires that every method of this object is
implemented in your form.</p>

<p class=Ne>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8LobbyEvent</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=168 valign=top style='width:1.75in;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>DirectPlay8LobbyEvent Methods</b></p>
  </td>
  <td width=296 valign=top style='width:221.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b></p>
  </td>
 </tr>
 <tr>
  <td width=168 valign=top style='width:1.75in;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>&nbsp;</b></p>
  </td>
  <td width=296 valign=top style='width:221.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ConnectionSettings</b></p>
  </td>
 </tr>
 <tr>
  <td width=168 valign=top style='width:1.75in;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=296 valign=top style='width:221.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Disconnect</b></p>
  </td>
 </tr>
 <tr>
  <td width=168 valign=top style='width:1.75in;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=296 valign=top style='width:221.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Receive</b></p>
  </td>
 </tr>
 <tr>
  <td width=168 valign=top style='width:1.75in;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=296 valign=top style='width:221.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SessionStatus</b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn79"
name="_ftnref79" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the <b>DirectPlay8LobbyClient.ConnectApplication</b> method has been
called by the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Connect( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>dlNotify</i><b> As
DPL_MESSAGE_CONNECT, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dlNotify</i><b> </b></p>

<p class=Def1><b>DPL_MESSAGE_CONNECT</b> message type with the connection
information.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1><b>Boolean</b> value indicating whether to connect the
application.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyEvent.ConnectionSettings</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn80"
name="_ftnref80" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the <b>DirectPlay8LobbyClient.SetConnectionSettings</b> or <b>DirectPlay8LobbiedApplication.SetConnectionSettings</b>
method is called. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>ConnectionSettings( _</b><i>ConnectionSettings</i><b>
As DPL_MESSAGE_CONNECTION_SETTINGS)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ConnectionSettings</i><b> </b></p>

<p class=Def1><b>DPL_MESSAGE_CONNECTION_SETTINGS </b>message type with the
connection settings.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Disconnect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn81"
name="_ftnref81" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the <b>DirectPlay8LobbyClient.ReleaseApplication</b> method has been
called by the lobby client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Disconnect(</b><i>DisconnectID</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lReason</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>DisconnectID</i></p>

<p class=Def1><b>Long</b> value specifying the identifier of the lobby
application that requested to disconnect.</p>

<p class=Term1><i>lReason</i><b> </b></p>

<p class=Def1><b>Long</b> value that is set to the reason for the
disconnection.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyEvent.Receive</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn82"
name="_ftnref82" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the <b>DirectPlay8LobbyClient.Send</b> or <b>DirectPlay8LobbiedApplication.Send</b>
method has been called.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Receive(</b><i>dlNotify</i><b> As
DPL_MESSAGE_RECEIVE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>fRejectMsg</i><b> As
Boolean)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dlNotify</i></p>

<p class=Def1><b>DPL_MESSAGE_RECEIVE</b> message type containing the message
sent.</p>

<p class=Term1><i>fRejectMsg</i></p>

<p class=Def1><b>Boolean</b> value indicating whether to accept or reject the
message.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8LobbyEvent.SessionStatus</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn83"
name="_ftnref83" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the <b>DirectPlay8LobbiedApplication.UpdateStatus</b> method has been
called by the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>LobbySessionStatus(</b><i>status</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lHandle</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>status</i></p>

<p class=Def1><b>Long</b> value specifying the updated status of the lobby
session. It will be set to one of the constants of the <b>CONST_DPLSESSION</b>
enumeration that specifies the status between the lobby client and the lobbied
application.</p>

<p class=Term1><i>lHandle</i><b> </b></p>

<p class=Def1><b>Long</b> value set to the handle of the application that sent
the status update message.</p>

<p class=Le>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Peer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn84"
name="_ftnref84" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlay8Peer</b> class to create a peer-to-peer
Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8Peer</b>
class can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>EnumHosts</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetEnumHostResponseAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServiceProvider</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Host</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>&nbsp;</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>TerminateSession</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Message Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SendTo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnregisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Player Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyPeer</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPlayerOrGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountClientsAndGroups</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPeerAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetPeerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RemovePlayerFromGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetPeerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Group Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddPlayerToGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountGroupMembers</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupMember</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.AddPlayerToGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn85"
name="_ftnref85" title=""><span class=MsoFootnoteReference>#</span></a>Adds a
peer to a group. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called,
DirectPlay calls each player's <b>DirectPlay8Event.AddRemovePlayerGroup</b>
method to notify him or her of the new group member.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddPlayerToGroup(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>idClient</i><b> As Long,
</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group to
add the peer to.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the peer that
is added to the group.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any peer can add itself or
another peer to an existing group. After the peer is successfully added to the
group, all messages sent to the group are also sent to the peer.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a peer to add itself to the
group, pass DPNID_ME in the <i>idClient</i> parameter. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn86"
name="_ftnref86" title=""><span class=MsoFootnoteReference>#</span></a>Cancels
asynchronous requests. Many methods of the <b>DirectPlay8Peer</b> class run
asynchronously by default. Depending on the situation, you might want to cancel
requests before they are processed. All the methods of this class that can be
run asynchronously return an <i>lAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>lAsyncHandle</i> of the request in this method's <i>lAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, passing 0 in the <i>lAsyncHandle </i>parameter, and specifying
DPNCANCEL_ALL_OPERATIONS in the <i>lFlags </i>parameter. If a specific handle
is provided to this method, you must pass 0 in the <i>lFlags</i> parameter.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CancelAsyncOperation(</b><i>lAsyncHandle</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNCANCELFLAGS)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. This value can be 0
to stop all requests or a particular type of asynchronous request. If a
specific handle for the request to cancel is specified, the <i>lFlags</i>
parameter must be 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request to canceled. You
can set this parameter to one of the flags of the <b>CONST_DPNCANCELFLAGS</b>
enumeration.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_PENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a send by
providing the handle returned from <b>DirectPlay8Peer.SendTo</b> method. The <b>DirectPlay8Event.SendComplete</b>
method will still be called unless the message was sent with the
DPNSEND_NOCOMPLETE flag set. If you cancel a send operation by calling <b>DirectPlay8Peer.CancelAsyncOperation</b>
the <b>hResultCode </b>member of the <b>DPNMSG_SEND_COMPLETE</b> type that is
passed to the <b>DirectPlay8Event.SendComplete</b> method will be set to
DPNERR_CANCELLED. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn87"
name="_ftnref87" title=""><span class=MsoFootnoteReference>#</span></a>Closes
the open connection with a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Close();</b></p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn88"
name="_ftnref88" title=""><span class=MsoFootnoteReference>#</span></a>Establishes
the connection to the server. After a connection is established, the
communication channel on the object is open and active and the application
should expect messages to arrive immediately. No messages can be sent by means
of the <b>DirectPlay8Peer.SendTo</b> method until the connection has completed.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Before this method is called, it
must obtain an application description by calling <b>DirectPlay8Peer.EnumHosts</b>.
The <b>EnumHosts</b> method returns a <b>DPN_APPLICATION_DESC</b> type for each
hosted application. The type describes the application, including the GUID of
the application.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although the application GUID is
not required, Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> performs verification if one is specified.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the connection to the host
is requested, the <b>DirectPlay8Event.IndicateConnect</b> method is called in
the host's message handler. The host may either accept or reject the
connection. In either case, after the host has acted, the client message
handler's <b>DirectPlay8Event.ConnectComplete</b> method will be called to
convey the response.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Connect(</b><i>AppDesc</i><b> As
DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Address</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DeviceInfo</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application.
Only some of the members of this type are used by this method. The only member
of this type that you must set is the <i>guidApplication</i> member. You can
also set <i>guidInstance</i>, <i>Password</i>, and <i>lFlags</i><b>.</b></p>

<p class=Term1><i>Address</i></p>

<p class=Def1>Optional <b>DirectPlay8Address</b> object that specifies the
addressing information to use to connect to the computer that is hosting.</p>

<p class=Term1><i>DeviceInfo</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies what service
provider to enumerate and what settings to use.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that describes the connection mode. You can set the
following flag.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Process the connection request synchronously. If this flag is
set, DirectPlay will not call the <b>DirectPlay8Event.ConnectComplete</b>
method.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Application-specific user data.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1>Size of the data contained in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPASSWORD</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINTERFACE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDAPPLICATION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_SESSIONFULL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_HOSTREJECTEDCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDINSTANCE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Although multiple enumerations
can be run concurrently, and can be run across the duration of a connection,
only one connection is allowed per object. To establish a connection to more
than one application, you must create another object. That is, only one running
application per object is allowed. If <b>DirectPlay8Peer.Connect</b> is called
while another connection is in progress, the function raises an error. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.CreateGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn89"
name="_ftnref89" title=""><span class=MsoFootnoteReference>#</span></a>Creates
a group in the current session. A group is a logical collection of players. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called,
DirectPlay calls each player's <b>DirectPlay8Event.CreateGroup</b> method to
notify him or her of the new group. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CreateGroup(</b><i>GroupInfo</i><b>
As DPN_GROUP_INFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>GroupInfo</i></p>

<p class=Def1><b>DPN_GROUP_INFO</b> structure that contains the group
description.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> does not
maintain hierarchical groups because they can easily be implemented with flat
groups and expeditious use of the group data.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.DestroyPeer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn90"
name="_ftnref90" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
a peer from the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyPeer(</b><i>idClient</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the peer to
delete.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Pointer that describes additional delete data information that is
sent to the peer.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1><b>Long</b> value that specifies the size of the data contained
in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method calls the <b>DirectPlay8Event.DestroyPlayer</b>
method in the destroyed player's message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.DestroyGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn91"
name="_ftnref91" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
a group created by the <b>DirectPlay8Peer.CreateGroup</b> method. This method
can be called by any peer in the group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method will call the <b>DirectPlay8Event.AddRemovePlayerGroup</b>
method for each peer in the group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyGroup(</b><i>idGroup</i><b>
As Long, </b><i>lFlags</i><b> As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies of the identifier of the group
to delete.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.EnumHosts</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn92"
name="_ftnref92" title=""><span class=MsoFootnoteReference>#</span></a>Enumerates
applications that host Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> games. When an application is found meeting
the enumeration criteria, the <b>DirectPlay8Event.EnumHostsResponse</b> method
is called in the application's message handler. This method contains a <b>DPNMSG_ENUM_HOSTS_RESPONSE</b>
message type that contains a <b>DPN_APPLICATION_DESC</b> type that describes
the applications found.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>EnumHosts(</b><i>ApplicationDesc</i><b>
As DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>AddrHost</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DeviceInfo</i><b> As
DirectPlay8Address, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lRetryCount </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lRetryInterval </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNOPERATIONS, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ApplicationDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> structure that specifies which
application hosts to enumerate. You can specify the following fields to reduce
the number of responses to the enumeration.</p>

<p class=Term2>guidApplication</p>

<p class=Def2>GUID of the application to find; if not specified, all are
searched for.</p>

<p class=Term2>Password </p>

<p class=Def2>Password to provide; secure sessions will not respond without a
password.</p>

<p class=Term1><i>AddrHost</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the address of
the computer that is hosting the application.</p>

<p class=Term1><i>DeviceInfo</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the service
provider and settings to enumerate.</p>

<p class=Term1><i>lRetryCount</i></p>

<p class=Def1>Value that specifies how many times the enumeration data will be
sent. You can set this parameter to zero to specify the default value. If you
set this value to INFINITE, the enumeration will continue until canceled.</p>

<p class=Term1><i>lRetryInterval</i></p>

<p class=Def1>Value that specifies the time, in milliseconds, between
successive enumeration attempts. Set this parameter to 0 to use the default
value.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1>Number of milliseconds for the enumeration to run. If 0 is
specified, a default value is used. If INFINITE is specified, the enumeration
continues until it is canceled.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Block of data that is sent in the enumeration request to the
host. The size of the data can be limited depending on the network type, but
512 bytes is supported at a minimum.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1>Size of the data in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because of the variety of ways
enumeration can happen, it is not recommended that an application specify <i>lRetryInterval</i>,
<i>lRetryCount , orlTimeOut</i><b> </b>unless the application has some specific
media knowledge.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn93"
name="_ftnref93" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the full application description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetApplicationDesc(</b><i>lFlags</i><b>
As Long) _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> As DPN_APPLICATION_DESC</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_APPLICATION_DESC</b>
type describing the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn94"
name="_ftnref94" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_CAPS</b> type for the current object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCaps() As DPN_CAPS</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SP_CAPS </b>type
to receive the information about the specified service provider.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Peer.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetPlayerOrGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn95"
name="_ftnref95" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the client or group identifier for the specified client or group. The number of
clients or groups for the application can be determined by calling <b>DirectPlay8Peer.GetCountClientsAndGroups</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetPlayerOrGroup(</b><i>lIndex</i><b>
As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index of the client or group.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the identification of
the client or group.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn96"
name="_ftnref96" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
statistical information about the connection between the local endpoint and the
host.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetConnectionInfo() As
DPN_CONNECTION_INFO</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_CONNECTION_INFO</b>
type to retrieve information about the specified connection.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Connect</b> call has completed.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetCountClientsAndGroups</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn97"
name="_ftnref97" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of peers or groups for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountClientsAndGroups( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNENUMCLIENTGROUPFLAGS) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that describes enumeration behavior. You can set one of the
following flags of the <b>CONST_DPNENUMCLIENTGROUPFLAGS</b> enumeration.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetCountGroupMembers</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn98"
name="_ftnref98" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of players in a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountGroupMembers(</b><i>dpid</i><b>
As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpid</i></p>

<p class=Def1><b>Long</b> value that specifies the identification of the group.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of players in
the group.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because player information
changes frequently, the required buffer size returned may change between
subsequent calls. Check and reallocate the buffer until the method succeeds.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetCountServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn99"
name="_ftnref99" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountServiceProviders() As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of registered
service providers available to the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetEnumHostResponseAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn100"
name="_ftnref100" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the address of the host.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetEnumHostResponseAddress( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>AppDesc</i><b> As
DPN_APPLICATION_DESC) _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> As DirectPlay8Address</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type describing the application.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectPlay8Address</b>
object specifying the address of the host.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn101"
name="_ftnref101" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
a block of data associated with a group, including the group name.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method is typically called
after DirectPlay calls the <b>DirectPlay8Event.InfoNotify</b> method,
indicating that the group data has been modified.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetGroupInfo(</b><i>idGroup</i><b>
As Long) As DPN_GROUP_INFO</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group
whose data block will be retrieved.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_GROUP_INFO</b>
type that describes the group data.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetGroupMember</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn102"
name="_ftnref102" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the identifier of the specified member of a group. The number of players in a
group is determined by calling <b>DirectPlay8Peer.GetCountGroupMembers</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetGroupMember(</b><i>lIndex</i><b>
As Long, </b><i>dpid</i><b> As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index value of the player in a group.</p>

<p class=Term1><i>dpid</i></p>

<p class=Def1><b>Long</b> value that specifies the identification of the group.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a<b> Long</b> value that
specifies the identification of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetPeerAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn103"
name="_ftnref103" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the address for the specified player in the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetPeerAddress(</b><i>idPlayer</i><b>
As Long) As DirectPlay8Address</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idPlayer</i></p>

<p class=Def1><b>Long</b> value specifying the identification of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectPlay8Address</b>
object that specifies the address of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetPeerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn104"
name="_ftnref104" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
player information set for the specified peer.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetPeerInfo(</b><i>idPeer</i><b> As
Long) As DPN_PLAYER_INFO</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idPeer</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the peer whose
information will be retrieved.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_PLAYER_INFO</b>
type describing player information.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after
DirectPlay calls the <b>DirectPlay8Event.InfoNotify</b> method, indicating that
the group data has been modified.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn105"
name="_ftnref105" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the application to monitor the size of the send queue. Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
does not send messages faster than the receiving computer can process them. As
a result, if the sending computer is sending faster than the receiver can
receive, messages accumulate in the senders queue. If the application
registers that the send queue is growing too large, it should decrease the rate
that messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSendQueueInfo(</b><i>lNumMsgs</i><b>
As Long, </b><i>lNumBytes</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lNumMsgs</i></p>

<p class=Def1>Number of messages currently queued.</p>

<p class=Term1><i>lNumBytes</i></p>

<p class=Def1>Amount of data, in bytes, of the messages currently queued.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetServiceProvider</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn106"
name="_ftnref106" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
information for the specified service provider. Before calling this method,
call the <b>DirectPlay8Peer.GetCountServiceProviders</b> method to obtain the
number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b><span style='font-size:10.0pt;
font-family:"Times New Roman",serif'>GetServiceProvider(</span></b><i><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>lIndex</span></i> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Long)</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>DPN_SERVICE_PROVIDER_INFO</span></b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index value specifying the specific server provider. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SERVICE_PROVIDER_INFO</b>
type that describes the service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn107"
name="_ftnref107" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_SP_CAPS</b> structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSPCaps(</b><i>guidSP</i><b> As
String) As DPN_SP_CAPS</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1><b>String</b> specifying the GUID of the service provider you
want to get information about.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SP_CAPS</b>
type to receive the information about the specified service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Peer.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.Host</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn108"
name="_ftnref108" title=""><span class=MsoFootnoteReference>#</span></a>Specifies
the host for the peer-to-peer session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Host(</b><i>AppDesc</i><b> As
DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Address</i><b> As
DirectPlay8Address)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application.</p>

<p class=Term1><i>Address</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies an addresses of a
service-provider device or a service provider to host the application on.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn109"
name="_ftnref109" title=""><span class=MsoFootnoteReference>#</span></a>Registers
or unregisters an application with a lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterLobby(</b><i>dpnHandle</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> LobbyApp</i><b> As
DirectPlay8LobbiedApplication, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpnHandle</i><b> </b></p>

<p class=Def1>Connection handle to be used when making the calls to <b>DirectPlay8LobbiedApplication.UpdateStatus</b>.</p>

<p class=Def1>&nbsp;</p>

<p class=Term1><i>LobbyApp</i></p>

<p class=Def1><b>DirectPlay8LobbiedApplication</b> object that specifies the
application.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Set this parameter to one of the two CONST_DPNLOBBY enumeration
values to indicate whether the application is to be registered or unregistered.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When an application is
registered with a lobby, the lobby client automatically receives notifications
of changes in game status.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.RegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn110"
name="_ftnref110" title=""><span class=MsoFootnoteReference>#</span></a>Registers
an entry point in the client's code that receives the messages from the <b>DirectPlay8Peer</b>
class. Call this method before calling any other methods of this class.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterMessageHandler(</b><i>event</i><b>
As DirectPlay8Event)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>event</i></p>

<p class=Def1><b>DirectPlay8Event</b> object that will receive the messages
generated by the client and server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYREGISTERED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to register a new
message handler, you must first call <b>DirectPlay8Peer.UnRegisterMessageHandler</b>
to unregister the current message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.RemovePlayerFromGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn111"
name="_ftnref111" title=""><span class=MsoFootnoteReference>#</span></a>Removes
a peer from a group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called,
DirectPlay calls each player's <b>DirectPlay8Event.AddRemovePlayerGroup</b>
method to notify him or her that a member has been removed from the group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RemovePlayerFromGroup(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>idClient</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group that
the peer will be removed from.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the peer that
will be removed from the group.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SendTo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn112"
name="_ftnref112" title=""><span class=MsoFootnoteReference>#</span></a>Transmits
data to the specified player. The message can be sent synchronously or asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SendTo(</b><i>idSend</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>buffer()</i><b> As BYTE,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lPriority</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNSENDFLAGS) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idSend</i></p>

<p class=Def1><b>Long</b> value specifying the identifier of the player to
receive data. Set this parameter to DPNID_ALL_PLAYERS_GROUP value from the
CONST_DPNPLAYERGROUPFLAGS enumeration to send a message to all players in the
session.</p>

<p class=Term1><i>buffer()</i></p>

<p class=Def1>Array of type <b>BYTE</b> that describes the data to send.</p>

<p class=Term1><i>lPriority</i></p>

<p class=Def1>Priority of the message.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to be sent. If the
message has not been sent by the <i>lTimeOut</i> value, the message is not
sent. If you do not want a time-out for message sends, set this parameter to 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
following flags defined in the <b>CONST_DPNSENDFLAGS</b> enumeration. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method will call the <b>DirectPlay8Event.Receive</b>
method in the recipient's message handler. When the <b>SendTo</b> request is
completed, the <b>DirectPlay8Event.SendComplete</b> method is called in the
sender's message handler. The <b>SendComplete</b> method contains a <b>DPNMSG_SEND_COMPLETE</b>
message type. The success or failure of the request is contained in the <b>hResultCode</b>
member of this message type.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn113"
name="_ftnref113" title=""><span class=MsoFootnoteReference>#</span></a>Changes
the settings for the application that is being hosted. Only some settings can
be changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetApplicationDesc(</b><i>AppDesc</i><b>
As DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application
settings to modify.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
modify only the following members of the <b>DPN_APPLICATION_DESC</b> type.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> lMaxPlayers</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> SessionName</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> Password</span></b></p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn114"
name="_ftnref114" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the capabilities for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetCaps(</b><i>caps</i><b> As
DPN_CAPS, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>caps</i></p>

<p class=Def1><b>DPN_CAPS</b> type used to set the information about the
current session.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Peer.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn115"
name="_ftnref115" title=""><span class=MsoFootnoteReference>#</span></a>Sets a
block of data associated with a group, including the name of the group.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>DirectPlay calls each player's <b>DirectPlay8Event.InfoNotify</b>
method to notify him or her that the group information has changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetGroupInfo(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>PlayerInfo</i><b> As
DPN_GROUP_INFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group
whose data block will be modified.</p>

<p class=Term1><i>PlayerInfo</i></p>

<p class=Def1><b>DPN_GROUP_INFO</b> type that describes the group data to set.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method:</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SetPeerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn116"
name="_ftnref116" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the static settings of a peer with an application. Call this method before
connecting to relay basic player information with the application. After the
peer successfully connects with the application, information obtained through
this method can be retrieved by other players by calling the <b>DirectPlay8Peer.GetPeerInfo</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetPeerInfo(</b><i>PlayerInfo</i><b>
As DPN_PLAYER_INFO) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PlayerInfo</i></p>

<p class=Def1><b>DPN_PLAYER_INFO</b> type that contains the player information
to set.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in the <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Peer.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>DirectPlay8Peer.SendTo</b> method
because of the high cost of using the <b>DirectPlay8Peer.SetPeerInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the peer
information with this method after connecting to the application. If this
method is called after a connection, DirectPlay will call each player's <b>DirectPlay8Event.InfoNotify</b>
method to notify him or her that the data has been updated.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn117"
name="_ftnref117" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the capabilities for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetSPCaps(</b><i>guidSP</i><b> As
String, </b><i>spCaps</i><b> As DPN_SP_CAPS)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1><b>String</b> specifying the GUID of the service provider you
want to set information about.</p>

<p class=Term1><i>spCaps</i></p>

<p class=Def1><b>DPN_SP_CAPS</b> type to set the information about the
specified service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Peer.RegisterMessageHandler</b>
must be made before this method can be called. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.TerminateSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn118"
name="_ftnref118" title=""><span class=MsoFootnoteReference>#</span></a>Terminates
the current Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>TerminateSession(</b><i>lFlags</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Pointer to termination data. </p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1>Size of data contained in the <i>UserData</i> parameter.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called only
by the host player.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When this method is called, the <b>DirectPlay8Event.TerminateSession</b>
method is called in the message handler of all players connected to the
session.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Peer.UnregisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unregisters the current message
handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlay8Server</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn119"
name="_ftnref119" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlay8Server</b> class to create and manage the
server for a Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> client/server transport session </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlay8Server</b>
class can be organized into the following groups.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Close</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetConnectionInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountServiceProviders</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetServiceProvider</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Host</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetApplicationDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>&nbsp;</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSPCaps</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Message Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSendQueueInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SendTo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnregisterMessageHandler</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Player Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyClient</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientAddress</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientOrGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountClientsAndGroups</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RemoveClientFromGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetServerInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Group Management</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>AddClientToGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DestroyGroup</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCountGroupMembers</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetGroupMember</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetGroupInfo</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous</b></p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CancelAsyncOperation</b></p>
  </td>
 </tr>
 <tr>
  <td width=160 valign=top style='width:120.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=304 valign=top style='width:227.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RegisterLobby</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.AddClientToGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn120"
name="_ftnref120" title=""><span class=MsoFootnoteReference>#</span></a>Adds a
client to a group. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddClientToGroup(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>idClient</i><b> As Long,
</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group to
add the client to.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the client
that is added to the group.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any client can add itself or
another client to an existing group. After the client is successfully added to
the group, all messages sent to the group are also sent to the client.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a client to add itself to
the group, pass DPNID_ME in the <i>idClient</i> parameter. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.CancelAsyncOperation</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn121"
name="_ftnref121" title=""><span class=MsoFootnoteReference>#</span></a>Cancels
asynchronous requests. Many methods of the <b>DirectPlay8Server</b> class run
asynchronously by default. Depending on the situation, you might want to cancel
requests before they are processed. All the methods of this class that can be
run asynchronously return a <i>lAsyncHandle</i> parameter.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Specific requests are canceled
by passing the <i>lAsyncHandle</i> of the request in this method's <i>lAsyncHandle
</i>parameter. You can cancel all pending asynchronous operations by calling
this method, passing 0 in the <i>lAsyncHandle </i>parameter, and specifying
DPNCANCEL_ALL_OPERATIONS in the <i>lFlags </i>parameter. If a specific handle
is provided to this method, you must pass 0 in the <i>lFlags</i> parameter.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CancelAsyncOperation(</b><i>lAsyncHandle</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNCANCELFLAGS)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lAsyncHandle</i></p>

<p class=Def1>Handle of the asynchronous operation to stop. This value can be 0
to stop all requests or a particular type of asynchronous request. If a
specific handle for the request to cancel is specified, the <i>lFlags</i>
parameter must be 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that specifies which asynchronous request to canceled. You
can set this parameter to one of the flags of the <b>CONST_DPNCANCELFLAGS</b>
enumeration.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_PENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_CANNOTCANCEL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDHANDLE</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can cancel a send by
providing the handle returned from <b>DirectPlay8Server.SendTo</b> method.. The
<b>DirectPlay8Event.SendComplete</b> method will still be called unless the
message was sent with the DPNSEND_NOCOMPLETE flag set. If you cancel a send
operation by calling <b>DirectPlay8Peer.CancelAsyncOperation</b> the <b>hResultCode
</b>member of the <b>DPNMSG_SEND_COMPLETE</b> type that is passed to the <b>DirectPlay8Event.SendComplete</b>
method will be set to DPNERR_CANCELLED.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.Close</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn122"
name="_ftnref122" title=""><span class=MsoFootnoteReference>#</span></a>Closes
the open connection with a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Close();</b></p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.CreateGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn123"
name="_ftnref123" title=""><span class=MsoFootnoteReference>#</span></a>Creates
a group in the current session. A group is a logical collection of players. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CreateGroup(</b><i>GroupInfo</i><b>
As DPN_GROUP_INFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>GroupInfo</i></p>

<p class=Def1><b>DPN_GROUP_INFO</b> structure that contains the group
description.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span> does not
maintain hierarchical groups because they can easily be implemented with flat
groups and expeditious use of the group data.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.DestroyClient</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn124"
name="_ftnref124" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
a client from the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyClient(</b><i>idClient</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserData</i><b> As Any,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserDataSize</i><b> As
Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the client to
delete.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><i>UserData</i></p>

<p class=Def1>Application-specific user data.</p>

<p class=Term1><i>UserDataSize</i></p>

<p class=Def1><b>Long</b> value that specifies the size of the data contained
in the <i>UserData</i> parameter.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOTHOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method calls the <b>DirectPlay8Event.DestroyPlayer</b>
method in the destroyed player's message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.DestroyGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn125"
name="_ftnref125" title=""><span class=MsoFootnoteReference>#</span></a>Deletes
a group created by the <b>DirectPlay8Server.CreateGroup</b> method. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DestroyGroup(</b><i>idGroup</i><b>
As Long, </b><i>lFlags</i><b> As Long) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group to
delete.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in the <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn126"
name="_ftnref126" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the full application description for the connected application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetApplicationDesc(</b><i>lFlags</i><b>
As Long) _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> As DPN_APPLICATION_DESC</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_APPLICATION_DESC</b>
type describing the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn127"
name="_ftnref127" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_CAPS</b> type for the current object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCaps() As DPN_CAPS</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_CAPS</b> type
filled with caps information.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Server.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetClientAddress</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn128"
name="_ftnref128" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the address for the specified player in the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetClientAddress(</b><i>idPlayer</i><b>
As Long) As DirectPlay8Address</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idPlayer</i></p>

<p class=Def1><b>Long</b> value specifying the identification of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectPlay8Address</b>
object that specifies the address of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetClientInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn129"
name="_ftnref129" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
player information set for the specified client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetClientInfo(</b><i>idClient</i><b>
As Long) As DPN_PLAYER_INFO</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the client
whose information will be retrieved.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_PLAYER_INFO</b>
type describing player information.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after
DirectPlay calls the <b>DirectPlay8Event.InfoNotify</b> method, indicating that
the player data has been modified.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetClientOrGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn130"
name="_ftnref130" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the client or group identifier for the specified client or group. The number of
clients or groups for the application can be determined by calling <b>DirectPlay8Server.GetCountClientsAndGroups</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetClientOrGroup(</b><i>lIndex</i><b>
As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index of the client or group.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the identification of
the client or group.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetConnectionInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn131"
name="_ftnref131" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
statistical information about the connection between the specified player and
the server.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetConnectionInfo(</b><i>idPlayer</i><b>
As Long) As DPN_CONNECTION_INFO</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameter</p>

<p class=Term1><i>idPlayer</i></p>

<p class=Def1><b>Long</b> value specifying the identifier of the player.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_CONNECTION_INFO</b>
type to retrieve information about the specified connection.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be called only
after a successful <b>Connect</b> call has completed.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetCountClientsAndGroups</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn132"
name="_ftnref132" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of clients or groups for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountClientsAndGroups( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNENUMCLIENTGROUPFLAGS) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that describes enumeration behavior. You can set one of the
flags from the <b>CONST_DPNENUMCLIENTGROUPFLAGS</b> enumeration.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetCountGroupMembers</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn133"
name="_ftnref133" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of players in a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountGroupMembers(</b><i>dpid</i><b>
As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>dpid</i></p>

<p class=Def1><b>Long</b> value that specifies the identification of the group.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of players in
the group.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because player information
changes frequently, the required buffer size returned may change between
subsequent calls. Check and reallocate the buffer until the method succeeds.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetCountServiceProviders</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn134"
name="_ftnref134" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCountServiceProviders() As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of registered
service providers available to the application.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn135"
name="_ftnref135" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
a block of data associated with a group, including the group name.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Call this method after
DirectPlay calls the <b>DirectPlay8Event.InfoNotify</b> method, indicating that
the group data has been modified.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetGroupInfo(</b><i>idGroup</i><b>
As Long) As DPN_GROUP_INFO</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group
whose data block will be retrieved.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_GROUP_INFO</b>
type that describes the group data.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetGroupMember</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn136"
name="_ftnref136" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the identifier of the specified member of a group. The number of players in a
group is determined by calling <b>DirectPlay8Server.GetCountGroupMembers</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetGroupMember(</b><i>lIndex</i><b>
As Long, </b><i>dpid</i><b> As Long) As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index value of the player in a group.</p>

<p class=Term1><i>dpid</i></p>

<p class=Def1><b>Long</b> value that specifies the identification of the group.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><b>Long</b> value that specifies
the identification of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetSendQueueInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn137"
name="_ftnref137" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the application to monitor the size of the send queue. Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
does not send messages faster than the receiving computer can process them. As
a result, if the sending computer is sending faster than the receiver can
receive, messages accumulate in the senders queue. If the application
registers that the send queue is growing too large, it should decrease the rate
at which messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSendQueueInfo(</b><i>idPlayer</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lNumMsgs</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lNumBytes</i><b> As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>&nbsp;</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idPlayer</i></p>

<p class=Def1><b>Long</b> value specifying the identifier of the player.</p>

<p class=Term1><i>lNumMsgs</i></p>

<p class=Def1>Number of messages currently queued.</p>

<p class=Term1><i>lNumBytes</i></p>

<p class=Def1>Amount of data, in bytes, of the messages currently queued.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetServiceProvider</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn138"
name="_ftnref138" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
information for the specified service provider. Before you call this method,
call the <b>DirectPlay8Server.GetCountServiceProviders</b> method to obtain the
number of registered service providers available to the application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b><span style='font-size:10.0pt;
font-family:"Times New Roman",serif'>GetServiceProvider(</span></b><i><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>lIndex</span></i> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>Long)</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>As</span></b> <b><span
style='font-size:10.0pt;font-family:"Times New Roman",serif'>DPN_SERVICE_PROVIDER_INFO</span></b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Index value specifying the specific server provider. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SERVICE_PROVIDER_INFO</b>
type that describes the service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.GetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn139"
name="_ftnref139" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the <b>DPN_SP_CAPS</b> structure for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSPCaps(</b><i>guidSP</i><b> As
String) As DPN_SP_CAPS</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1><b>String</b> specifying the GUID of the service provider you
want to get information about.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DPN_SP_CAPS</b>
type to receive the information about the specified service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Server.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.Host</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn140"
name="_ftnref140" title=""><span class=MsoFootnoteReference>#</span></a>Specifies
the host for the client/server session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Host(</b><i>AppDesc</i><b> As
DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Address</i><b> As
DirectPlay8Address)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application.</p>

<p class=Term1><i>Address</i></p>

<p class=Def1><b>DirectPlay8Address</b> object that specifies the address of a
service-provider device or a service provider on which to host the application.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.RegisterLobby</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn141"
name="_ftnref141" title=""><span class=MsoFootnoteReference>#</span></a>Enables
launched applications to automatically propagate game status to the lobby.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterLobby(</b><i>LobbyApp</i><b>
As DirectPlay8LobbiedApplication)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>LobbyApp</i></p>

<p class=Def1><b>DirectPlay8LobbiedApplication</b> object that specifies the
application.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.RegisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn142"
name="_ftnref142" title=""><span class=MsoFootnoteReference>#</span></a>Registers
an entry point in the server's code that receives the messages from the <b>DirectPlay8Server</b>
class and from connected clients.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RegisterMessageHandler(</b><i>event</i><b>
As DirectPlay8Event)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>event</i></p>

<p class=Def1><b>DirectPlay8Event</b> object that will receive the messages
generated by the client and server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_ALREADYREGISTERED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you want to register a new
message handler, you must first call <b>DirectPlay8Server.UnRegisterMessageHandler</b>
to unregister the current message handler.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.RemoveClientFromGroup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn143"
name="_ftnref143" title=""><span class=MsoFootnoteReference>#</span></a>Removes
a client from a group.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RemoveClientFromGroup(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>idClient</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group from
which the client will be removed.</p>

<p class=Term1><i>idClient</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the client
that will be removed from the group.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method.</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPLAYER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SendTo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn144"
name="_ftnref144" title=""><span class=MsoFootnoteReference>#</span></a>Transmits
data to the specified player. The message can be sent synchronously or
asynchronously.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SendTo(</b><i>idSend</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>buffer()</i><b> As
BYTE, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lPriority</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lTimeOut</i><b> As Long,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As
CONST_DPNSENDFLAGS) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idSend</i></p>

<p class=Def1><b>Long</b> value specifying the identifier of the player to
receive data.</p>

<p class=Term1><i>buffer()</i></p>

<p class=Def1>Array of type <b>BYTE</b> that describes the data to send.</p>

<p class=Term1><i>lPriority</i></p>

<p class=Def1>Priority of the message.</p>

<p class=Term1><i>lTimeOut</i></p>

<p class=Def1>Number of milliseconds to wait for the message to be sent. If the
message has not been sent by the <i>lTimeOut</i> value, the message is not
sent. If you do not want a time-out for message sends, set this parameter to 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flags that describe send behavior. You can set one or more of the
flags defined in the <b>CONST_DPNSENDFLAGS</b> enumeration. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_TIMEDOUT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method will call the <b>DirectPlay8Event.Receive</b>
method in the recipient's message handler. When the <b>SendTo</b> request is
completed, the <b>DirectPlay8Event.SendComplete</b> method is called in the
sender's message handler. The <b>SendComplete</b> method contains a <b>DPNMSG_SEND_COMPLETE</b>
message type. The success or failure of the request is contained in the <b>hResultCode</b>
member of this message type.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SetApplicationDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn145"
name="_ftnref145" title=""><span class=MsoFootnoteReference>#</span></a>Changes
the settings for the application that is being hosted. Only some settings can
be changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetApplicationDesc(</b><i>AppDesc</i><b>
As DPN_APPLICATION_DESC, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>AppDesc</i></p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type that describes the application
settings to modify.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use this method to
modify only the following members of the <b>DPN_APPLICATION_DESC</b> type:</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> lMaxPlayers</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> SessionName</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> Password</span></b></p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn146"
name="_ftnref146" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the capabilities for the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetCaps(</b><i>caps</i><b> As
DPN_CAPS, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>caps</i></p>

<p class=Def1><b>DPN_CAPS</b> type used to set the information about the
current session.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Server.RegisterMessageHandler</b>
must be made before this method can be called.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SetGroupInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn147"
name="_ftnref147" title=""><span class=MsoFootnoteReference>#</span></a>Sets a
block of data associated with a group, including the name of the group. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetGroupInfo(</b><i>idGroup</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>PlayerInfo</i><b> As
DPN_GROUP_INFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>idGroup</i></p>

<p class=Def1><b>Long</b> value that specifies the identifier of the group
whose data block will be modified.</p>

<p class=Term1><i>PlayerInfo</i></p>

<p class=Def1><b>DPN_GROUP_INFO</b> type that describes the group data to set.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flag that controls how this method is processed. The following
flag can be set for this method:</p>

<p class=Term2>DPNOP_SYNC</p>

<p class=Def2>Causes the method to process synchronously.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDGROUP</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SetServerInfo</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn148"
name="_ftnref148" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the static settings of a client with an application. Call this method before
connecting to relay basic player information with the application. After the
client successfully connects with the application, other players can retrieve
information obtained through this method by calling the <b>DirectPlay8Client.GetServerInfo</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetServerInfo(</b><i>PlayerInfo</i><b>
As DPN_PLAYER_INFO) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PlayerInfo</i></p>

<p class=Def1><b>DPN_PLAYER_INFO</b> type that contains the player information
to set.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the asynchronous handle
for this operation. This is the handle that is used in <i>lAsyncHandle</i>
parameter of the <b>DirectPlay8Server.CancelAsyncOperation</b> method to cancel
the request, if the request is processed asynchronously.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_NOCONNECTION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Transmission of nonstatic
information should be handled with the <b>DirectPlay8Server.SendTo</b> method
because of the high cost of using the <b>DirectPlay8Server.SetClientInfo</b>
method.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can modify the client
information with this method after connecting to the application. If this
method is called after a connection, DirectPlay will call each player's <b>DirectPlay8Event.InfoNotify</b>
method to notify him or her that the data has been updated.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.SetSPCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn149"
name="_ftnref149" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the capabilities for the specified service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetSPCaps(</b><i>guidSP</i><b> As
String, </b><i>spCaps</i><b> As DPN_SP_CAPS)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidSP</i></p>

<p class=Def1><b>String</b> specifying the GUID of the service provider you
want to set information about.</p>

<p class=Term1><i>spCaps</i></p>

<p class=Def1><b>DPN_SP_CAPS</b> type to set the information about the
specified service provider.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DPNERR_UNINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A successful call to <b>DirectPlay8Server.RegisterMessageHandler</b>
must be made before this method can be called. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlay8Server.UnregisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Unregisters the current message
handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlayVoiceClient8</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn150"
name="_ftnref150" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlayVoiceClient8</b> class to manage clients in
a voice session. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlayVoiceClient8</b>
class can be organized into the following groups. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Buffer management</b> </p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Create3DSoundBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Delete3DSoundBuffer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous </b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionType</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionTypeCount</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSoundDeviceConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSoundDevices</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StartClientNotification</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session management</b> </p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Connect</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Disconnect</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetClientConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSessionDesc</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetTransmitTargets</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetClientConfig</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetCurrentSoundDevices</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetTransmitTargets</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnRegisterMessageHandler</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.Connect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn151"
name="_ftnref151" title=""><span class=MsoFootnoteReference>#</span></a>Connects
the client to a Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Connect( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>SoundDeviceConfig</i><b>
As DVSOUNDDEVICECONFIG, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>ClientConfig</i><b> As
DVCLIENTCONFIG, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SoundDeviceConfig</i></p>

<p class=Def1><b>DVSOUNDDEVICECONFIG</b> type that describes the sound device
configuration.</p>

<p class=Term1><i>ClientConfig</i></p>

<p class=Def1><b>DVCLIENTCONFIG</b> type that describes the general
configuration of the client.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>You can specify the following flag.</p>

<p class=Term2>DVFLAGS_SYNC</p>

<p class=Def2>The method does not return until the operation is completed.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SOUNDINITFAILURE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_OUTOFMEMORY</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_COMPRESSIONNOTSUPPORTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TIMEOUT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDDEVICE</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SENDERROR</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INCOMPATIBLEVERSION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOPLAYER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOSESSION</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_RUNSETUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must test the sound devices
selected for playback and capture by invoking the Setup Wizard before
connecting the client to the DirectPlay Voice session. On application startup,
check the audio configuration by using <b>DirectPlayVoiceTest8.CheckAudioSetup</b>.
If this method returns DVERR_RUNSETUP, the sound configuration specified has
not been tested. The Setup Wizard needs to be run only once for any
configuration.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Any calls to <b>DirectPlayVoiceClient8.Connect</b>
while a connection is pending return DVERR_ALREADYPENDING. Additionally, only
one connection can be pending at a time.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>A transport session must be
started on the specified DirectPlay object before calling this method. A
successful call to <b>DirectPlayVoiceClient8.Initialize</b> must be made before
calling the <b>Connect</b> method.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.Create3DSoundBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn152"
name="_ftnref152" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
a 3-D sound buffer for a player or group. You can use the methods of the 3-D
sound buffer object to change the virtual 3-D position of incoming voice
transmissions from the specified group or player.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Create3DSoundBuffer(</b><i>playerID</i><b>
As Long) _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> As DirectSound3dBuffer8</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerID</i></p>

<p class=Def1><b>Long</b> value that specifies the identification of the player
or group for which the user wants to reserve a buffer. You can also specify
DVID_REMAINING to create a 3-D user buffer for all players or groups that do
not have a user buffer. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DirectSound3dBuffer8</b>
type used for the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice main buffer.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_OUTOFMEMORY</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED </p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DirectPlay Voice session
is a mixing server session, this method fails and returns DVERR_NOTALLOWED. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because the DirectPlay Voice
client uses the buffer to stream incoming audio, you can access all the member
functions of the 3-D sound buffer object. However, you should not use the <b>Lock</b>,
<b>UnLock</b>, or <b>Play</b> methods of the <b>DirectSound3DBuffer</b> object.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When the buffer for the
individual user is no longer required or when a player leaves the voice
session, it is important to call <b>DirectPlayVoiceClient8.Delete3DSoundBuffer</b>
to free up resources. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.Delete3DSoundBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn153"
name="_ftnref153" title=""><span class=MsoFootnoteReference>#</span></a>Returns
exclusive control of the 3-D sound buffer object back to the Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice client object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Delete3DSoundBuffer(</b><i>playerID</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>UserBuffer</i><b> As
DirectSound3dBuffer8)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerID</i></p>

<p class=Def1><b>Long</b> value specifying the DVID of the player or group that
the user wants to delete a buffer for.</p>

<p class=Term1><i>UserBuffer</i></p>

<p class=Def1>User buffer to delete. This must be a user buffer obtained
through the <b>DirectPlayVoiceClient8.Create3DSoundBuffer</b> method.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTBUFFERED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the DirectPlay Voice session
is a mixing server session, this method fails and returns DVERR_NOTALLOWED. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.Disconnect</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn154"
name="_ftnref154" title=""><span class=MsoFootnoteReference>#</span></a>Disconnects
the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice client from the existing DirectPlay
Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Disconnect(</b><i>lFlags</i><b> As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>You can specify the following flag.</p>

<p class=Term2>DVFLAGS_SYNC</p>

<p class=Def2>Do not return until the operation is completed.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_PENDING </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_CONNECTABORTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TIMEOUT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>On calling this method, all
recording and playback is stopped. If a connection is being processed, it is
canceled by this call.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If this method is called
synchronously by setting the DVFLAGS_SYNC flag, the method does not return
until the <b>Disconnect</b> completes. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn155"
name="_ftnref155" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice capabilities.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCaps() As DVCAPS</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVCAPS</b> type
that contains the capabilities of the <b>DirectPlayVoiceClient8</b> object.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetClientConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn156"
name="_ftnref156" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the client configuration.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetClientConfig() As DVCLIENTCONFIG</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVCLIENTCONFIG</b>
type that contains the configuration of the local client.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetCompressionType</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn157"
name="_ftnref157" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the compression type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCompressionType(</b><i>lIndex</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Data</i><b> As
DVCOMPRESSIONINFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Specific compression type. The number of supported compression
types can be determined with a call to <b>DirectPlayVoiceClient8.GetCompressionTypeCount</b>.</p>

<p class=Term1><i>Data</i></p>

<p class=Def1><b>DVCOMPRESSIONINFO</b> type describing compression information.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetCompressionTypeCount</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn158"
name="_ftnref158" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of supported compression types.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCompressionTypeCount() As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of supported
compression types.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn159"
name="_ftnref159" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the session properties.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSessionDesc() As DVSESSIONDESC</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVSESSIONDESC</b>
type to receive the session description. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetSoundDeviceConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn160"
name="_ftnref160" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the sound device configuration of the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSoundDeviceConfig() As
DVSOUNDDEVICECONFIG</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVSOUNDDEVICECONFIG</b>
type that is filled with the configuration of the sound device.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetSoundDevices</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn161"
name="_ftnref161" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the current Microsoft<span style='font-size:7.0pt'> </span>DirectSound<span
style='font-size:7.0pt'> </span>capture and playback objects.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSoundDevices( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DirectSoundObj</i><b> As
DirectSound8, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DirectCaptureObj</i><b>
As DirectSoundCapture8)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>DirectSoundObj</i></p>

<p class=Def1>Current <b>DirectSound8</b> object being used for playback.</p>

<p class=Term1><i>DirectCaptureObj</i></p>

<p class=Def1>Current <b>DirectSoundCapture8</b> object being using for
capture.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Term1>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.GetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn162"
name="_ftnref162" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the transmit targets, if any, of the voice stream from this client. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetTransmitTargets(</b><i>lFlags</i><b>
As Long) As Long()</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns an array of <b>Long</b>
values containing the DVIDs of the of the transmit targets, if any, of the
client's voice stream.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFfERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The DVIDs returned can be player
or group DVIDs.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn163"
name="_ftnref163" title=""><span class=MsoFootnoteReference>#</span></a>Initializes
the <b>DirectPlayVoiceClient8</b> object by associating the <b>DirectPlayVoiceClient8</b>
object with a DirectPlay object. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method must be called
successfully before <b>DirectPlayVoiceClient8.Connect</b> method is called.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Initialize(</b><i>DplayObj</i><b>
As Unknown, </b><i>lFlags</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>DplayObj</i></p>

<p class=Def1>Pointer to the <b>IUnknown</b> interface for the DirectPlay
object that this <b>DirectPlayVoiceClient8</b> object should use.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOTINIT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_GENERIC</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.SetClientConfig</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn164"
name="_ftnref164" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the client configuration.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetClientConfig(</b><i>ClientConfig</i><b>
As DVCLIENTCONFIG)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ClientConfig</i></p>

<p class=Def1><b>DVCLIENTCONFIG</b> type that contains the configuration
description to set.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can call this method only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Calling this method sets all the
parameters in the <b>DVCLIENTCONFIG</b> type. Therefore, to leave a setting
unmodified, you must retrieve the current configuration with <b>DirectPlayVoiceClient8.GetClientConfig</b>.
Then, modify the parameters to change and call <b>DirectPlayVoiceClient8.SetClientConfig</b>.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the session is running in
half duplex, the members of the <b>GetClientConfig</b> method related to
recording are ignored. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.SetCurrentSoundDevices</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn165"
name="_ftnref165" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the current Microsoft<span style='font-size:7.0pt'> </span>DirectSound<span
style='font-size:7.0pt'> </span>capture and playback objects.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetCurrentSoundDevices( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DirectSoundObj</i><b> As
DirectSound8, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>DirectCaptureObj</i><b>
As DirectSoundCapture8)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>DirectSoundObj</i></p>

<p class=Def1><b>DirectSound8</b> object to be used for playback.</p>

<p class=Term1><i>DirectCaptureObj</i></p>

<p class=Def1><b>DirectSoundCapture8</b> object to be used for capture.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Term1>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.SetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn166"
name="_ftnref166" title=""><span class=MsoFootnoteReference>#</span></a>Specifies
which players or groups receive audio transmissions from the local client.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetTransmitTargets(</b><i>playerIDs()</i><b>
As Long, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerIDs()</i></p>

<p class=Def1>Array of <b>Long</b> values specifying the DVIDs of the players
or groups that are to receive the voice transmission.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDTARGET</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the session was created with
the DVSESSION_SERVERCONTROLTARGET flag, only the server can set the target for
this local client. A call to this method returns DVERR_NOTALLOWED.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.StartClientNotification</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn167"
name="_ftnref167" title=""><span class=MsoFootnoteReference>#</span></a>Registers
a <b>DirectPlayVoiceEvent8</b> object with the client to receive all messages
generated by the client and server.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>StartClientNotification(</b><i>event</i><b>
As DirectPlayVoiceEvent8)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>event</i></p>

<p class=Def1><b>DirectPlayVoiceEvent8</b> object that will receive messages
from this client and from the server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceClient8.UnregisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn168"
name="_ftnref168" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
the current <b>DirectPlayVoiceClient8</b> message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlayVoiceEvent8</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn169"
name="_ftnref169" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlayVoiceEvent8</b> class to capture Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
events generated by the <b>DirectPlayVoiceClient8</b> and <b>DirectPlayVoiceServer8</b>
classes.</p>

<p class=Ns><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Nh>Note</p>

<p class=Np1>When implementing the <b>DirectPlayVoiceEvent8</b> object,
Microsoft<span style='font-size:7.0pt'> </span>Visual Basic<span
style='font-size:7.0pt'></span> requires that every method of this object is
implemented in your form.</p>

<p class=Ne>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlayVoiceEvent8</b>
class are:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>DirectPlayVoiceEvent8 Methods</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>ConnectResult</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>CreateVoicePlayer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DeleteVoicePlayer</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>DisconnectResult</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>HostMigrated</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>InputLevel</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>OutputLevel</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>PlayerOutputLevel</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>PlayerVoiceStart</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>PlayerVoiceStop</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RecordStart</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>RecordStop</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tp>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SessionLost</b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.ConnectResult</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn170"
name="_ftnref170" title=""><span class=MsoFootnoteReference>#</span></a>Called when
the connect request generated through a call to the
DirectPlayVoiceClient8.Connect method has completed. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>ConnectResult(</b><i>ResultCode </i><b>As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ResultCode </i></p>

<p class=Def1><b>Long</b> value set to the result code.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.CreateVoicePlayer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn171"
name="_ftnref171" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a new player joins the voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CreateVoicePlayer(</b><i>playerID </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>flags </i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerID</i></p>

<p class=Def1><b>Long</b> value set to the player's ID.</p>

<p class=Term1><i>flags</i></p>

<p class=Def1>Flags with information about the player.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.DeleteVoicePlayer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn172"
name="_ftnref172" title=""><span class=MsoFootnoteReference>#</span></a>Called
when a player quits the voice session<b>. </b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DeleteVoicePlayer(</b><i>playerID </i><b>As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerID </i></p>

<p class=Def1><b>Long</b> value set to the player's ID.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.DisconnectResult</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn173"
name="_ftnref173" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the disconnect request generated through a call to the <b>DirectPlayVoiceClient8.Disconnect</b>
method has completed. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>DisconnectResult(</b><i>ResultCode </i><b>As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ResultCode </i></p>

<p class=Def1><b>Long</b> value set to the result code.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.HostMigrated</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn174"
name="_ftnref174" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the voice host has changed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>HostMigrated(</b><i>NewHostID </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> NewServer </i><b>As
DirectPlayVoiceServer8)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>NewHostID </i></p>

<p class=Def1>Long value set to the ID of the new voice host.</p>

<p class=Term1><i>NewServer </i></p>

<p class=Def1>If the local client has become the new voice session host, this
member will point to a newly created <b>DirectPlayVoiceServer8</b> object that
can be used by the local client for providing host services. If the local
client is not the new host, then this member will be NULL.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.InputLevel</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn175"
name="_ftnref175" title=""><span class=MsoFootnoteReference>#</span></a>Called
periodically to notify the user of the input level from the microphone. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>InputLevel(</b><i>PeakLevel</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> RecordVolume </i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PeakLevel</i><b> </b></p>

<p class=Def1><b>Long</b> value representing peak level across the current
frame, which corresponds to approximately 1/10 second of audio stream. The
current frame typically lags 50-200 milliseconds (ms) behind real-time. This
value can range from 0 through 99, with 0 being completely silent and 99 being
the highest possible input level. </p>

<p class=Term1><i>RecordVolume</i></p>

<p class=Def1>Current recording volume for the client. The value can range from
-10,000 through 0. This member is available even when automatic gain control is
active.</p>

<p class=Def1>&nbsp;</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.OutputLevel</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn176"
name="_ftnref176" title=""><span class=MsoFootnoteReference>#</span></a>Called
periodically to notify the user of the output level from the microphone. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>OutputLevel(</b><i>PeakLevel </i><b>As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> OutputVolume </i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PeakLevel </i></p>

<p class=Def1><b>Long</b> value representing peak level across the current
frame, that corresponds to approximately 1/10 second of audio stream. The
current frame typically lags 50-200 ms behind real-time. This value can range
from 0 through 99, with 0 being completely silent and 99 being the highest
possible output level.</p>

<p class=Term1><i>OutputVolume</i></p>

<p class=Def1>Current playback volume for the client.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.PlayerOutputLevel</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn177"
name="_ftnref177" title=""><span class=MsoFootnoteReference>#</span></a>Called
periodically to notify the user of the output level of an individual players
voice stream. It is generated while voice is being played back for an
individual player. If multiple player voices are being played, one message for
each player speaking will be sent each notification period.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PlayerOutputLevel(</b><i>SourcePlayerID
</i><b>As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><i> PeakLevel </i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SourcePlayerID </i></p>

<p class=Def1><b>Long</b> value set to the ID of the player whose voice is
being played back.</p>

<p class=Term1><i>PeakLevel </i></p>

<p class=Def1>Integer representing the peak output level of the players voice
stream. This value is in the range from 0 through 99, with 0 being completely
silent and 99 being the highest possible output level </p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.PlayerVoiceStart</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn178"
name="_ftnref178" title=""><span class=MsoFootnoteReference>#</span></a>Called
when an incoming audio stream begins playing back.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PlayerVoiceStart(</b><i>SourcePlayerID
</i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SourcePlayerID </i></p>

<p class=Def1><b>Long</b> value set to the ID of the player where the voice
transmission originated.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.PlayerVoiceStop</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn179"
name="_ftnref179" title=""><span class=MsoFootnoteReference>#</span></a>Called
when an incoming audio stream stops.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>PlayerVoiceStop(</b><i>SourcePlayerID
</i><b>As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SourcePlayerID </i></p>

<p class=Def1><b>Long</b> value set to the ID of the player where the voice
transmission stopped.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.RecordStart</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn180"
name="_ftnref180" title=""><span class=MsoFootnoteReference>#</span></a>Called
when audio input on the local client begins. This can be caused by the voice
activation sensitivity level being exceeded or when a valid target is specified
in push-to-talk mode.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RecordStart(</b><i>PeakVolume </i><b>As
Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PeakVolume </i></p>

<p class=Def1><b>Long</b> value set to the voice activation level that caused
the transmission to begin. In push-to-talk mode, this value is 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.RecordStop</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn181"
name="_ftnref181" title=""><span class=MsoFootnoteReference>#</span></a>Called<b>
</b>when audio input on the local client stops. This can be caused by the voice
activation sensitivity level not being reached or when a target is deselected
in push-to-talk mode.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>RecordStop(</b><i>PeakVolume </i><b>As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>PeakVolume </i></p>

<p class=Def1><b>Long</b> value set to the voice activation level that caused
the transmission to stop. In push-to-talk mode, this value is 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceEvent8.SessionLost</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn182"
name="_ftnref182" title=""><span class=MsoFootnoteReference>#</span></a>Called
when the voice session terminates.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SessionLost(</b><i>ResultCode </i><b>As
Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ResultCode </i></p>

<p class=Def1><b>Long</b> value set to a result code that indicates why the
session terminated.</p>

<p class=Le>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlayVoiceServer8</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn183"
name="_ftnref183" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the methods of the <b>DirectPlayVoiceServer8</b> class to manage the host
of the voice session. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The methods of the <b>DirectPlayVoiceServer8</b>
class can be organized into the following groups. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Miscellaneous </b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCaps</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionType</b> </p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetCompressionTypeCount</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf><b>Session Management</b></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetSessionDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>GetTransmitTargets</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>Initialize</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetSessionDesc</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>SetTransmitTargets</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StartServerNotification</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StartSession</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf></p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>StopSession</b></p>
  </td>
 </tr>
 <tr>
  <td width=187 valign=top style='width:140.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>&nbsp;</p>
  </td>
  <td width=277 valign=top style='width:207.95pt;padding:0in 0in 0in 0in'>
  <p class=Tp><b>UnregisterMessageHandler</b></p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.GetCaps</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn184"
name="_ftnref184" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice capabilities.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCaps() As DVCAPS</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVCAPS</b> type
that contains the capabilities of the <b>DirectPlayVoiceClient8</b> object.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.GetCompressionType</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn185"
name="_ftnref185" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the compression type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCompressionType(</b><i>lIndex</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Data</i><b> As
DVCOMPRESSIONINFO, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lIndex</i></p>

<p class=Def1>Specific compression type. The number of supported compression
types can be determined with a call to <b>DirectPlayVoiceServer8.GetCompressionTypeCount</b>.</p>

<p class=Term1><i>Data</i></p>

<p class=Def1><b>DVCOMPRESSIONINFO</b> type describing compression information.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.GetCompressionTypeCount</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn186"
name="_ftnref186" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the number of supported compression types.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetCompressionTypeCount() As Long</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns the number of supported
compression types.</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to the following value.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.GetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn187"
name="_ftnref187" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the session properties.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetSessionDesc() As DVSESSIONDESC</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>DVSESSIONDESC</b>
type to receive the session description. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method may be called only
after a connection is successfully established with a Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.GetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn188"
name="_ftnref188" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
the transmit targets, if any, of the voice stream for a player in a session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetTransmitTargets(</b><i>playerSourceID</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long()</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerSourceID</i></p>

<p class=Def1><b>Long</b> value specifying the DVID of the user or group whose
target is returned.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns an array of <b>Long</b>
values containing the DVIDs of the of the transmit targets, if any, of the
server's voice stream. When you call this method, this should be the same value
as the number of targets set in the <b>DirectPlayVoiceServer8.SetTransmitTargets</b>
method.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_BUFFERTOOSMALL</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTCONNECTED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be used only if
the DVSESSION_SERVERCONTROLTARGET flag is specified on creation of the
DirectPlay Voice session. If the flag is not specified, this method returns
DVERR_NOTALLOWED.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.Initialize</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn189"
name="_ftnref189" title=""><span class=MsoFootnoteReference>#</span></a>Initializes
the <b>DirectPlayVoiceClient8</b> object by associating the <b>DirectPlayVoiceServer8</b>
object with a Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> object. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>Initialize(</b><i>DplayObj</i><b>
As Unknown, </b><i>lFlags</i><b> As Long)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>DplayObj</i></p>

<p class=Def1>Pointer to the <b>IUnknown</b> interface for the DirectPlay
object that this <b>DirectPlayVoiceServer8</b> object should use.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM </p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_TRANSPORTNOTINIT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOCALLBACK</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_GENERIC</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.SetSessionDesc</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn190"
name="_ftnref190" title=""><span class=MsoFootnoteReference>#</span></a>Sets
the session settings.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetSessionDesc(</b><i>ClientConfig</i><b>
As DVSESSIONDESC)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>ClientConfig</i></p>

<p class=Def1><b>DVSESSIONDESC</b> type that contains the session description.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number
</b>can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTHOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>After the Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice session has started, not all the session properties of the <b>DVSESSIONDESC</b>
structure can be changed. For more information, see <b>DVSESSIONDESC</b>.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.SetTransmitTargets</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn191"
name="_ftnref191" title=""><span class=MsoFootnoteReference>#</span></a>Controls
the transmission of audio from the client to the specified members of the
session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>SetTransmitTargets(</b><i>playerSourceID</i><b>
As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>playerTargetIDs</i><b>
As Long(), _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>playerSourceID</i></p>

<p class=Def1>DVID of the user whose targets are set.</p>

<p class=Term1><i>playerTargetIDs</i></p>

<p class=Def1>Array of long values specifying the DVIDs of the players or
groups that are to receive the voice transmission. To specify no targets, pass
an empty array for this parameter. To specify all players, create a single-item
array containing DVID_ALLPLAYERS.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0. </p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTALLOWED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDTARGET</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method can be used only if
the DVSESSION_SERVERCONTROLTARGET flag is specified on creation of the
DirectPlay Voice session. If the flag is not specified, this method returns
DVERR_NOTALLOWED.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.StartServerNotification</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn192"
name="_ftnref192" title=""><span class=MsoFootnoteReference>#</span></a>Registers
a <b>DirectPlayVoiceEvent8</b> object that is used to capture messages
generated by this Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>StartServerNotification(</b><i>event</i><b>
As DirectPlayVoiceEvent8)</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>event</i></p>

<p class=Def1><b>DirectPlayVoiceEvent8</b> object that will receive messages
from this client and from the server.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to the following value. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
</table>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.StartSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn193"
name="_ftnref193" title=""><span class=MsoFootnoteReference>#</span></a>Starts
an initialized Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice session within a running DirectPlay
transport session. This method must be successfully called before the clients
can complete a connection to the voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>StartSession(</b><i>SessionDesc</i><b>
As DVSESSIONDESC, </b><i>lFlags</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>SessionDesc</i></p>

<p class=Def1><b>DVSESSIONDESC</b> type that contains the session description.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPOINTER</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_HOSTING</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DirectPlayVoiceServer8.Initialize</b>
method must be called before this method is called. The voice session can be
hosted on any client in the session if the voice session is peer-to-peer. If
the voice session is not peer-to-peer, it must be hosted on the transport
client, which is the host of an active transport session.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>DVSESSIONDESC</b>
structure contains the type of voice session to start. The type of voice
session can have a dramatic effect on the CPU and bandwidth usage for both the
client and the server.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.StopSession</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn194"
name="_ftnref194" title=""><span class=MsoFootnoteReference>#</span></a>Stops
the Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>StopSession(</b><i>lFlags</i><b> As
Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>The following flag can be set.</p>

<p class=Term2>DVFLAGS_NOHOSTMIGRATE</p>

<p class=Def2>The host will not migrate regardless of session and transport
settings. Use this flag to shut down the voice session completely.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_ALREADYPENDING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_SESSIONLOST</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTINITIALIZED</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_NOTHOSTING</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDFLAGS</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDOBJECT</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method returns the
DVERR_ALREADYPENDING error value if it is called while another thread is
processing a <b>StopSession</b> request.</p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceServer8.UnregisterMessageHandler</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn195"
name="_ftnref195" title=""><span class=MsoFootnoteReference>#</span></a>Unregisters
the current <b>DirectPlayVoiceServer8</b> message handler.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>UnRegisterMessageHandler()</b></p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must call this method before
registering a new message handler.</p>

<p class=Rh1 style='page-break-after:avoid'>DirectPlayVoiceTest8</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn196"
name="_ftnref196" title=""><span class=MsoFootnoteReference>#</span></a>Applications
use the method of the <b>DirectPlayVoiceTest8</b> class to test the Microsoft<span
style='font-size:7.0pt'> </span>DirectPlay<span style='font-size:7.0pt'></span>
Voice audio configuration. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>CheckAudioSetup</b>
method of the <b>DirectPlayVoiceTest8</b> class is used to check the audio
configuration. </p>

<p class=Rh2 style='page-break-after:avoid'>DirectPlayVoiceTest8.CheckAudioSetup</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn197"
name="_ftnref197" title=""><span class=MsoFootnoteReference>#</span></a>Runs
the Audio Setup Wizard on the specified devices. This wizard runs a series of
tests on the devices to determine if they are capable of full duplex audio and
to ensure that the microphone is plugged in and working correctly on the
capture device.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>CheckAudioSetup( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>guidPlaybackDevice</i><b>
As String, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>guidCaptureDevice</i><b>
As String, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>hwndOwner</i><b> As
Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lFlags</i><b> As Long)
As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parts</p>

<p class=Term1><i>guidPlaybackDevice</i></p>

<p class=Def1>GUID that identifies the playback device to test. If an empty
string is passed for this parameter, Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> Voice tests the default voice playback device
defined by Microsoft<span style='font-size:7.0pt'> </span>DirectSound<span
style='font-size:7.0pt'></span>.</p>

<p class=Term1><i>guidCaptureDevice</i></p>

<p class=Def1>GUID that identifies the capture device to test. If an empty
string is passed for this parameter, DirectPlay Voice tests the default voice
capture device defined by DirectSound.</p>

<p class=Term1><i>hwndOwner</i></p>

<p class=Def1>The test wizard invoked by this method is modal. If the calling
application has a window that should be the parent window of the wizard, it
should pass a handle to that window in this parameter. If the calling
application does not have a window, it can pass 0. If the DVFLAGS_QUERYONLY
flag is specified, this parameter is not used and the application can pass 0.</p>

<p class=Term1><i>lFlags</i></p>

<p class=Def1>Flags. The following flags can be set.</p>

<p class=Term2>DVFLAGS_QUERYONLY</p>

<p class=Def2>Audio setup is not run. Instead, the method checks the registry
to see if the devices have been tested. If the devices have not been tested,
the method returns DVERR_RUNSETUP. If the devices have been tested, the method
returns DV_FULLDUPLEX if the devices support full duplex audio, or
DV_HALFDUPLEX if the devices do not support full duplex audio.</p>

<p class=Term2>DVFLAGS_ALLOWBACK</p>

<p class=Def2>Enable the <b>Back</b> button on the Welcome page of the wizard.
If the user clicks the <b>Back</b> button on the Welcome page, the wizard
exits, and <b>CheckAudioSetup</b> returns DVERR_USERBACK.</p>

<p class=Le>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Error Codes</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the method fails, <b>Err.Number</b>
can be set to one of the following values. </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_INVALIDPARAM</p>
  </td>
 </tr>
 <tr>
  <td width=464 valign=top style='width:348.0pt;padding:0in 0in 0in 0in'>
  <p class=Tpf>DVERR_RUNSETUP</p>
  </td>
 </tr>
</table>

<p class=Tes>&nbsp;</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>This method contains user
interface (UI) elements and raises dialog boxes. If the DVFLAGS_QUERYONLY flag
is specified, the tests are not actually run and no UI is raised. Instead the
registry is checked to determine the results of a previous test of these
devices.</p>

<h2 style='page-break-after:avoid'>Functions</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section contains references
for the following Microsoft<span style='font-size:7.0pt'> </span>DirectPlay<span
style='font-size:7.0pt'></span> functions. They are designed to simplify the
process of handling byte arrays.</p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> AddDataToBuffer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> AddStringToBuffer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> GetDataFromBuffer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> GetStringFromBuffer</span></b></p>

<p class=Lb1><b><span
style='font-family:"Times New Roman",serif'> NewBuffer</span></b></p>

<p class=Rh1 style='page-break-after:avoid'>AddDataToBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn198"
name="_ftnref198" title=""><span class=MsoFootnoteReference>#</span></a>Adds
nonstring data to a byte array.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddDataToBuffer( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Buffer() </i><b>As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lData</i><b> As Any, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lSize</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lOffset</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>Buffer</i></p>

<p class=Def1><b>Byte</b> array to which the data is to be added.</p>

<p class=Term1><i>lData</i><b> </b></p>

<p class=Def1>Data that is to be added to <i>Buffer</i>.</p>

<p class=Term1><i>lSize</i><b> </b></p>

<p class=Def1>Size, in bytes, of the data in <i>lData</i>. The simplest way to
determine this value is to use the Microsoft<span style='font-size:7.0pt'> </span>Visual
Basic<span style='font-size:7.0pt'></span> <b>LenB</b> function. You can also
use one of the values from the CONST_DPLAYBUFSIZE enumeration.</p>

<p class=Term1><i>lOffset</i><b> </b></p>

<p class=Def1><b>Long</b> value containing the offset, in bytes, to the
location in the byte array where the data is to be added. When the function
returns, this parameter will be set to the offset of the first byte following
the data that has just been added.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the byte array passed to <i>Buffer</i>
is not large enough to hold the added data, the array will be enlarged without
data loss to a sufficient size.</p>

<p class=Rh1 style='page-break-after:avoid'>AddStringToBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn199"
name="_ftnref199" title=""><span class=MsoFootnoteReference>#</span></a>Adds a
string to a byte array.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>AddStringToBuffer( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Buffer() </i><b>As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>StringData</i><b> As
String, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lOffset</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>Buffer</i></p>

<p class=Def1><b>Byte</b> array that the data is to be added to.</p>

<p class=Term1><i>StringData</i></p>

<p class=Def1><b>String</b> value that is to be added to <i>Buffer</i>.</p>

<p class=Term1><i>lOffset</i><b> </b></p>

<p class=Def1><b>Long</b> value containing the offset, in bytes, to the
location in the byte array where the data is to be added. When the function
returns, this parameter will be set to the offset of the first byte following
the data that has just been added.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If the byte array passed to <i>Buffer</i>
is not large enough to hold the added string, the array will be enlarged
without data loss to a sufficient size.</p>

<p class=Rh1 style='page-break-after:avoid'>GetDataFromBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn200"
name="_ftnref200" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
nonstring data from a byte array.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetDataFromBuffer( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Buffer() </i><b>As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lData</i><b> As Any, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lSize</i><b> As Long, _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lOffset</i><b> As Long)</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>Buffer</i></p>

<p class=Def1><b>Byte</b> array from which the data is to be retrieved.</p>

<p class=Term1><i>lData</i><b> </b></p>

<p class=Def1>Variable to receive the data that is retrieved from <i>Buffer</i>.</p>

<p class=Term1><i>lSize</i><b> </b></p>

<p class=Def1>Size of the data in <i>lData</i>, in bytes. The simplest way to
determine this value is to use the Visual Basic <b>LenB</b> function. You can
also use one of the values from the CONST_DPLAYBUFSIZE enumeration.</p>

<p class=Term1><i>lOffset</i><b> </b></p>

<p class=Def1>Offset, in bytes, to the location in the byte array from which
the data is to be retrieved. When the function returns, this parameter will be
set to the offset of the first byte following the data that has just been
retrieved.</p>

<p class=Rh1 style='page-break-after:avoid'>GetStringFromBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn201"
name="_ftnref201" title=""><span class=MsoFootnoteReference>#</span></a>Retrieves
string data from a byte array.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>GetStringFromBuffer( _</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>Buffer() </i><b>As Byte,
_</b></p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b> </b><i>lOffset</i><b> As Long)
As String</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>Buffer</i></p>

<p class=Def1><b>Byte</b> array that the data is to be retrieved from.</p>

<p class=Term1><i>lOffset</i><b> </b></p>

<p class=Def1><b>Long</b> value containing the offset, in bytes, to the
location in the byte array from which the data is to retrieved. When the
function returns, this parameter will be set to the offset of the first byte
following the data that has just been retrieved.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>String</b> value
containing the retrieved string.</p>

<p class=Rh1 style='page-break-after:avoid'>NewBuffer</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn202"
name="_ftnref202" title=""><span class=MsoFootnoteReference>#</span></a>Creates
a byte array.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'><b>NewBuffer( </b><i>Buffer() </i><b>As
Byte ) As Long</b></p>

<p class=Rmh style='page-break-after:avoid'>Parameters</p>

<p class=Term1><i>Buffer</i></p>

<p class=Def1><b>Byte</b> array that will be initialized to a default number of
members.</p>

<p class=Rmh style='page-break-after:avoid'>Return Values</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Returns a <b>Long</b> value
containing the offset to the start of the array. This value will always be
zero.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The default number of members in
the returned array is 20.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Types</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This section contains
information on the following types used with Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>.</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_APPLICATION_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_CONNECT_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_CONNECTION_SETTINGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_CONNECTION_SETTINGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_MESSAGE_RECEIVE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPL_PROGRAM_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_APPLICATION_DESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_CAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_CONNECTION_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_GROUP_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_PLAYER_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SERVICE_PROVIDER_INFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPN_SP_CAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_ASYNC_OP_COMPLETE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_CONNECT_COMPLETE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_ENUM_HOSTS_QUERY</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_ENUM_HOSTS_RESPONSE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_INDICATE_CONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_RECEIVE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DPNMSG_SEND_COMPLETE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCLIENTCONFIG</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVCOMPRESSIONINFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVSESSIONDESC</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>DVSOUNDDEVICECONFIG</b></span></p>

<p class=Leh>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_APPLICATION_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn203"
name="_ftnref203" title=""><span class=MsoFootnoteReference>#</span></a>Returned
in the <b>DirectPlay8LobbyClient.GetLocalProgram</b> method to describe the
lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_APPLICATION_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ApplicationName As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidApplication As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DPLSESSION</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lNumRunning As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lNumWaiting As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>ApplicationName</b></p>

<p class=Def1>Name of the lobbied application.</p>

<p class=Term1><b>guidApplication</b> </p>

<p class=Def1><b>String</b> that specifies the GUID of the lobbied application.</p>

<p class=Term1><b>lFlags</b> </p>

<p class=Def1>One of the constants of <b>CONST_DPLSESSION</b> enumeration that
describes the current status of the lobbied application.</p>

<p class=Term1><b>lNumRunning</b> </p>

<p class=Def1>Number of instances of the application.</p>

<p class=Term1><b>lNumWaiting</b> </p>

<p class=Def1>Number of clients waiting to connect to the lobbied application.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_CONNECT_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn204"
name="_ftnref204" title=""><span class=MsoFootnoteReference>#</span></a>Used to
specify connection information for a lobby client when connecting to the lobby
application in the <b>DirectPlay8LobbyClient.ConnectApplication</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_CONNECT_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ConnectionSettings As
DPL_CONNECTION_SETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidApplication As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DPLCONNECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>ConnectionSettings</b> </p>

<p class=Def1><b>DPL_CONNECTION_SETTINGS </b>type with the settings for this
connection.</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>String that specifies the GUID of the application.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>One of the constants of the <b>CONST_DPLCONNECT</b> enumeration
that determine connection behavior.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_CONNECTION_SETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn205"
name="_ftnref205" title=""><span class=MsoFootnoteReference>#</span></a><b>H</b>olds
connection information for lobbied connections.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_CONNECTION_SETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressDeviceUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressSenderUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ApplicationDescription As
DPN_APPLICATION_DESC</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DPLCONNECTSETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> PlayerName As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AddressDeviceUrl</b> </p>

<p class=Def1><b>String</b> set to the device URL.</p>

<p class=Term1><b>AddressSenderUrl</b> </p>

<p class=Def1><b>String</b> set to the sender URL.</p>

<p class=Term1><b>ApplicationDescription</b> </p>

<p class=Def1><b>DPN_APPLICATION_DESC</b> type containing the application
description.</p>

<p class=Term1><b>lFlags</b> </p>

<p class=Def1>Value from the <b>CONST_CONNECTSETTINGS</b> enumeration. This
member is set to DPLCONNECTSETTINGS_HOST if your player is the session host,
and 0 otherwise.</p>

<p class=Term1><b>PlayerName</b> </p>

<p class=Def1><b>String</b> value set to the player's name.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MESSAGE_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn206"
name="_ftnref206" title=""><span class=MsoFootnoteReference>#</span></a>This
type is generated by Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> when a lobby client connects to the lobbied
application through the <b>DirectPlay8LobbyClient.ConnectApplication</b>
method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_MESSAGE_CONNECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ConnectId As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> dplMsgCon As
DPL_CONNECTION_SETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LobbyConnectData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>ConnectId</b></p>

<p class=Def1>Handle used to identify the connection. This handle is used to in
subsequent calls to <b>DirectPlay8LobbyClient.Send</b> and <b>DirectPlay8LobbyClient.ReleaseApplication</b>.</p>

<p class=Term1><b>dplMsgCon</b></p>

<p class=Def1><b>DPL_CONNECTION_SETTINGS</b> type with the connection settings.</p>

<p class=Term1><b>LobbyConnectData </b></p>

<p class=Def1>Lobby connection data.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MESSAGE_CONNECTION_SETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn207"
name="_ftnref207" title=""><span class=MsoFootnoteReference>#</span></a>Used
with the <b>DirectPlay8LobbyEvent.ConnectionSettings</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_MESSAGE_CONNECTION_SETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> dplConnectionSettings</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hSender As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>dplConnectionSettings</b></p>

<p class=Def1><b>DPL_CONNECTION_SETTINGS</b> type that describes the connection
settings.</p>

<p class=Term1><b>hSender</b> </p>

<p class=Def1><b>Long</b> value that contains the handle for the connection
that sent this message.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_MESSAGE_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn208"
name="_ftnref208" title=""><span class=MsoFootnoteReference>#</span></a>Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
generates this type when the target receives a message sent by the <b>DirectPlay8LobbyClient.Send</b>
or <b>DirectPlay8LobbiedApplication.Send</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_MESSAGE_RECEIVE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> buffer() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBufferSize As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> Sender As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>buffer</b></p>

<p class=Def1><b>BYTE</b> array with the message data.</p>

<p class=Term1><b>lBufferSize</b></p>

<p class=Def1>Size of the message data contained in the <b>buffer</b> member.</p>

<p class=Term1><b>Sender</b></p>

<p class=Def1>Handle of the client that sent the message.</p>

<p class=Rh1 style='page-break-after:avoid'>DPL_PROGRAM_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn209"
name="_ftnref209" title=""><span class=MsoFootnoteReference>#</span></a>Describes
a Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> lobby-aware application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPL_PROGRAM_DESC</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ApplicationName As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> CommandLine As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> CurrentDirectory As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> Description As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ExecutableFilename As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ExecutablePath As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidApplication As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LauncherFilename As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> LauncherPath As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>ApplicationName</b></p>

<p class=Def1>Application name.</p>

<p class=Term1><b>CommandLine</b></p>

<p class=Def1>Command line arguments.</p>

<p class=Term1><b>CurrentDirectory</b></p>

<p class=Def1>Current directory.</p>

<p class=Term1><b>Description</b></p>

<p class=Def1>Application description.</p>

<p class=Term1><b>ExecutableFilename</b></p>

<p class=Def1>File name of the application executable.</p>

<p class=Term1><b>ExecutablePath</b></p>

<p class=Def1>Path of the application executable.</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>String that specifies the GUID of the application.</p>

<p class=Term1><b>LauncherFilename</b></p>

<p class=Def1>File name of the launcher executable.</p>

<p class=Term1><b>LauncherPath</b></p>

<p class=Def1>Path of the launcher executable.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_APPLICATION_DESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn210"
name="_ftnref210" title=""><span class=MsoFootnoteReference>#</span></a>Describes
the settings for a Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_APPLICATION_DESC</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidApplication As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidInstance As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lCurrentPlayers As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMaxPlayers As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> Password As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SessionName As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>guidApplication</b></p>

<p class=Def1>Application GUID.</p>

<p class=Term1><b>guidInstance</b></p>

<p class=Def1>Globally unique identifier (GUID) that is generated at startup
representing the instance of this application. This member is an [out]
parameter when calling the <b>GetApplicationDesc</b> method exposed by the <b>DirectPlay8Peer</b>,
<b>DirectPlay8Client</b>, and <b>DirectPlay8Server</b> objects. It is an
optional [in] parameter when calling the <b>Connect</b> method exposed by the <b>DirectPlay8Peer</b>
and <b>DirectPlay8Client </b>objects. It must be set to NULL when you call the <b>SetApplicationDesc</b>
method exposed by the <b>DirectPlay8Server</b> and <b>DirectPlay8Peer</b>
objects. You can not obtain this GUID by calling the <b>DirectPlay8Server.Host</b>
or <b>DirectPlay8Peer.Host</b> methods. You must obtain the GUID by calling a <b>GetApplicationDesc</b>
method.</p>

<p class=Term1><b>lCurrentPlayers</b></p>

<p class=Def1>Number of clients currently connected to the session.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>One of the following flags describing application behavior.</p>

<p class=Term2>DPNSESSION_CLIENT_SERVER</p>

<p class=Def2>Specifies that this type of session is client/server. This flag
cannot be combined with DPNSESSION_MIGRATE_HOST.</p>

<p class=Term2>DPNSESSION_NODPNSVR</p>

<p class=Def2>Specifies that you do not want enumerations forwarded to your
host from DPNSVR. See Using the DirectPlay DPNSVR Application for a further
discussion of DPNSVR.</p>

<p class=Term2>DPNSESSION_REQUIREPASSWORD</p>

<p class=Def2>Specifies that the session is password protected. If this flag is
set, <b>Password</b> must be a valid string.</p>

<p class=Term2>DPNSESSION_MIGRATE_HOST</p>

<p class=Def2>Used in peer-to-peer sessions, setting this flag will enable host
migration. This flag cannot be combined with DPNSESSION_CLIENT_SERVER.</p>

<p class=Term1><b>lMaxPlayers</b></p>

<p class=Def1>Maximum number of clients allowed in the session. Set this member
to 0 to indicate an unlimited number of players.</p>

<p class=Term1><b>Password</b></p>

<p class=Def1><b>String</b> specifying the Unicode<span style='font-size:7.0pt'></span>
password that is required to connect to the session. This must be an empty
string if the DPNSESSION_REQUIREPASSWORD is not set in the <b>lFlags</b>
member.</p>

<p class=Term1><b>SessionName</b></p>

<p class=Def1>String specifying the Unicode name of the session.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The <b>lMaxPlayers</b>, <b>Password</b>,
and <b>SessionName</b> members can be set when calling the <b>Host</b> or <b>SetApplicationDesc</b>
methods exposed by the <b>DirectPlay8Server</b> and <b>DirectPlay8Peer</b>
objects.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_CAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn211"
name="_ftnref211" title=""><span class=MsoFootnoteReference>#</span></a>Used to
set and retrieve general parameters for Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span> sessions.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_CAPS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lConnectRetries As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lConnectTimeout As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lTimeoutUntilKeepAlive As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lConnectRetries</b></p>

<p class=Def1>Number of connection retries DirectPlay should make during the
connection process.</p>

<p class=Term1><b>lConnectTimeout</b></p>

<p class=Def1>Number of milliseconds DirectPlay should wait before it retries a
connection request.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Reserved, must be 0.</p>

<p class=Term1><b>lTimeoutUntilKeepAlive</b></p>

<p class=Def1>Number of milliseconds DirectPlay should wait, since the last
time it received a packet from an endpoint, before it sends a keep-alive
message.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_CONNECTION_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn212"
name="_ftnref212" title=""><span class=MsoFootnoteReference>#</span></a>Used to
retrieve statistics for the connection between you and a particular endpoint.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_CONNECTION_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lSize As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lRoundTripLatencyMS As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lThroughPutBPS As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPeakThroughPutBPS As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesSentGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsSentGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesSentNonGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsSentNonGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesRetried As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsRetried As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesDropped As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsDropped As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBandwidthBPS As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTransmittedHighPriority
As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTimedOutHighPriority As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTransmittedNormalPriority
As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTimedOutNormalPriority As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTransmittedLowPriority As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesTimedOutLowPriority As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesReceivedGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsReceivedGuaranteed As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBytesReceivedNonGuaranteed As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPacketsReceivedNonGuaranteed As
Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMessagesReceived As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lSize</b></p>

<p class=Def1><b>Long</b> value set to the size of the type.</p>

<p class=Term1><b>lRoundTripLatencyMS</b> </p>

<p class=Def1><b>Long</b> value set to the approximate time, in milliseconds,
for a packet to reach the endpoint and return to the local computer. This
number will fluctuate throughout the session, as network conditions change.</p>

<p class=Term1><b>lThroughPutBPS</b> </p>

<p class=Def1><b>Long</b> value set to the approximate throughput, in bytes per
second (BPS). This number will fluctuate throughout the session, as link
conditions change.</p>

<p class=Term1><b>lPeakThroughPutBPS</b> </p>

<p class=Def1><b>Long</b> value set to the peak throughput, in bytes per
second. This number will fluctuate throughout the session, as link conditions
change.</p>

<p class=Term1><b>lBytesSentGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of guaranteed
messages that have been sent.</p>

<p class=Term1><b>lPacketsSentGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the number of guaranteed packets that
have been sent.</p>

<p class=Term1><b>lBytesSentNonGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of nonguaranteed
messages that have been sent.</p>

<p class=Term1><b>lPacketsSentNonGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the number of nonguaranteed packets that
have been sent.</p>

<p class=Term1><b>lBytesRetried</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of messages that
have been retried.</p>

<p class=Term1><b>lPacketsRetried </b></p>

<p class=Def1><b>Long</b> value set to the number of packets that have been
retried.</p>

<p class=Term1><b>lBytesDropped</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of messages that
have been dropped.</p>

<p class=Term1><b>lPacketsDropped</b> </p>

<p class=Def1><b>Long</b> value set to the number of packets that have been
dropped.</p>

<p class=Term1><b>lBandwidthBPS</b> </p>

<p class=Def1><b>Long</b> value set to the bandwidth, in bytes per second.</p>

<p class=Term1><b>lMessagesTransmittedHighPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of high-priority messages
that have been transmitted.</p>

<p class=Term1><b>lMessagesTimedOutHighPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of high-priority messages
that have timed out.</p>

<p class=Term1><b>lMessagesTransmittedNormalPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of normal-priority messages
that have been transmitted.</p>

<p class=Term1><b>lMessagesTimedOutNormalPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of normal-priority messages
that have timed out.</p>

<p class=Term1><b>lMessagesTransmittedLowPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of low-priority messages that
have been transmitted.</p>

<p class=Term1><b>lMessagesTimedOutLowPriority</b> </p>

<p class=Def1><b>Long</b> value set to the number of low-priority messages that
have timed out.</p>

<p class=Term1><b>lBytesReceivedGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of guaranteed
messages that have been received.</p>

<p class=Term1><b>lPacketsReceivedGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the number of guaranteed packets that
have been received.</p>

<p class=Term1><b>lBytesReceivedNonGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the amount, in bytes, of nonguaranteed
messages that have been received.</p>

<p class=Term1><b>lPacketsReceivedNonGuaranteed</b> </p>

<p class=Def1><b>Long</b> value set to the number of nonguaranteed packets that
have been received.</p>

<p class=Term1><b>lMessagesReceived</b> </p>

<p class=Def1><b>Long</b> value set to the number of messages that have been
received.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_GROUP_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn213"
name="_ftnref213" title=""><span class=MsoFootnoteReference>#</span></a>Describes
static group information. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_GROUP_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lGroupFlags As
CONST_DPNGROUPINFOFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lInfoFlags As CONST_DPNINFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> name As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lGroupFlags</b></p>

<p class=Def1>One of the constants of the <b>CONST_DPNGROUPINFOFLAGS</b>
enumeration that describe the flags set for the player.</p>

<p class=Term1><b>lInfoFlags</b></p>

<p class=Def1>One of the constants of the <b>CONST_DPNINFO</b> enumeration that
describe the type of data contained in this type.</p>

<p class=Term1><b>Name</b></p>

<p class=Def1>Name of the group.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When using this type in the <b>DirectPlay8Peer.GetGroupInfo</b>
and <b>DirectPlay8Server.GetGroupInfo</b> methods, <b>lInfoFlags</b> must be
set to 0.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_PLAYER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn214"
name="_ftnref214" title=""><span class=MsoFootnoteReference>#</span></a>Describes
static player information. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_PLAYER_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lInfoFlags As CONST_DPNINFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPlayerFlags As
CONST_DPNPLAYINFOFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> name As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lInfoFlags</b></p>

<p class=Def1>One of the constants in the <b>CONST_DPNINFO</b> enumeration that
specify the type of information contained in this type.</p>

<p class=Term1><b>lPlayerFlags</b></p>

<p class=Def1>One of the constants in the <b>CONST_DPNPLAYINFOFLAGS</b>
enumeration describing the flags set for the player.</p>

<p class=Term1><b>name</b></p>

<p class=Def1>Name of the player.</p>

<p class=Rmh style='page-break-after:avoid'>Remarks</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When using this type in the <b>DirectPlay8Peer.GetPeerInfo</b>
and <b>DirectPlay8Server.GetClientInfo</b> methods, <b>lInfoFlags</b> must be
set to 0.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SERVICE_PROVIDER_INFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn215"
name="_ftnref215" title=""><span class=MsoFootnoteReference>#</span></a>Used
when enumerating information for a specific service provider.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_SERVICE_PROVIDER_INFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> GUID As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> name As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>GUID</b></p>

<p class=Def1>GUID for the service provider.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Term1><b>name</b></p>

<p class=Def1>Name of the service provider.</p>

<p class=Rh1 style='page-break-after:avoid'>DPN_SP_CAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn216"
name="_ftnref216" title=""><span class=MsoFootnoteReference>#</span></a>Used to
set and retrieve parameters for service providers.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPN_SP_CAPS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBuffersPerThread As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lDefaultEnumCount As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lDefaultEnumRetryInterval As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lDefaultEnumTimeout As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMaxEnumPayloadSize As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lNumThreads As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lSystemBufferSizeAs Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lBuffersPerThread</b> </p>

<p class=Def1>The number of outstanding receive buffers allocated for each
DirectPlay thread. If you increase the number of receive buffers, DirectPlay
can pull more data out of the operating system buffers. However, you may also
increase latency if data is arriving faster than your application can process
it.</p>

<p class=Term1><b>lDefaultEnumCount</b> </p>

<p class=Def1><b>Long</b> value that specifies the default enumeration count.</p>

<p class=Term1><b>lDefaultEnumRetryInterval</b> </p>

<p class=Def1><b>Long</b> value that specifies the default retry interval, in
milliseconds.</p>

<p class=Term1><b>lDefaultEnumTimeout</b> </p>

<p class=Def1><b>Long</b> value that specifies the default enumeration timeout
value, in milliseconds.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1><b>Long</b> value that can be a combination of the following
flags.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSALLADAPTERS</p>

<p class=Def2>The service provider is supported on all the adapters that are
present on the system.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSBROADCAST</p>

<p class=Def2>For IP and IPX applications, the service provider has the ability
to find games by broadcasting, if sufficient addressing information is not
provided.</p>

<p class=Term2>DPNSPCAPS_SUPPORTSDPNSRV</p>

<p class=Def2>Dpnsvr.exe will provide port sharing for the given SP. Currently,
this flag is available on IP and IPX only. See Using the DirectPlay DPNSVR
Application for a further discussion of DPNSVR.</p>

<p class=Term1><b>lMaxEnumPayloadSize</b> </p>

<p class=Def1><b>Long</b> that specifies the maximum size of the payload
information that can be sent in the <b>ResponseData </b>member of the types
that accompany the <b>DirectPlay8Event.EnumHostQuery</b> and <b>DirectPlay8Event.EnumHostQuery</b>
methods<b>.</b></p>

<p class=Term1><b>lNumThreads</b></p>

<p class=Def1>Number of threads the service provider will use for servicing
network requests. The default value is based on an algorithm that takes into
account the number of processors on the system. Most applications will not need
to modify this value.</p>

<p class=Def1>After a service provider is active in your process you may only <i>increase</i>
this value. Decreasing the value will have no effect. The setting is process
wide, meaning it will effect your current Microsoft<span style='font-size:7.0pt'>
</span>DirectPlay<span style='font-size:7.0pt'></span> object and any other
DirectPlay objects in your process.</p>

<p class=Term1><b>lSystemBufferSizeAs</b> </p>

<p class=Def1>The size of the operating system buffer. This buffer holds data
from the communications device when your application cannot process data as
fast as it arrives. The purpose of this buffer is to prevent data loss if you
receive a sudden burst of data, or if the receive threads are momentarily
stalled. Increasing <b>lSystemBufferSize</b> may increase latency if your
application cannot process the received data fast enough. You can eliminate the
operating system buffer by setting <b>lSystemBufferSize</b> to 0. However, if
you do so, you run the risk of losing data if you cannot process the received
data as fast as it arrives. </p>

<p class=Def1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_ASYNC_OP_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn217"
name="_ftnref217" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.AsyncOpComplete</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when an asynchronous operation
has completed.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_ASYNC_OP_COMPLETE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AsyncOpHandle As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hResultCode As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AsyncOpHandle</b></p>

<p class=Def1><b>Long</b> value specifying the handle of the asynchronous
operation.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1><b>Long</b> value specifying the result of the asynchronous
operation.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_CONNECT_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn218"
name="_ftnref218" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.ConnectComplete</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when a connection request has
been completed. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_CONNECT_COMPLETE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AsyncOpHandle As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hResultCode As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ReplyData() as Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AsyncOpHandle</b></p>

<p class=Def1><b>Long</b> value specifying the handle of the asynchronous
operation.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1><b>Long</b> value specifying result of the connection request.</p>

<p class=Term1><b>ReplyData</b></p>

<p class=Def1><b>Byte</b> array containing the connection data returned by the
host or server.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_ENUM_HOSTS_QUERY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn219"
name="_ftnref219" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.EnumHostsQuery</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when a player has requested a
host enumeration.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_ENUM_HOSTS_QUERY</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressDeviceUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressSenderUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMaxResponseDataSize As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ReceivedData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ResponseData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AddressDeviceUrl</b> </p>

<p class=Def1><b>String</b> value containing the devices URL.</p>

<p class=Term1><b>AddressSenderUrl</b> </p>

<p class=Def1><b>String</b> value containing the sender's URL.</p>

<p class=Term1><b>lMaxResponseDataSize</b> </p>

<p class=Def1><b>Long</b> value specifying the size of the response data block.</p>

<p class=Term1><b>ReceivedData</b></p>

<p class=Def1>Data received from the enumeration.</p>

<p class=Term1><b>ResponseData</b> </p>

<p class=Def1>Data block containing the response to the enumeration request.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_ENUM_HOSTS_RESPONSE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn220"
name="_ftnref220" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.EnumHostsResponse</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when the host responds with
information to an enumeration request.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_ENUM_HOSTS_RESPONSE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressDeviceUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressSenderUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ApplicationDescription As
DPN_APPLICATION_DESC</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lRoundTripLatencyMS As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ResponseData As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AddressDeviceUrl</b></p>

<p class=Def1><b>String</b> specifying the device's address URL </p>

<p class=Term1><b>AddressSenderUrl</b> </p>

<p class=Def1><b>String</b> specifying the sender's address URL. </p>

<p class=Term1><b>ApplicationDescription</b> </p>

<p class=Def1><b>DPN_APPLICATION_DESC </b>type that describes the application.</p>

<p class=Term1><b>lRoundTripLatencyMS</b> </p>

<p class=Def1>Round-trip latency, in milliseconds.</p>

<p class=Term1><b>ResponseData</b> </p>

<p class=Def1>Response data from the enumeration.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_INDICATE_CONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn221"
name="_ftnref221" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.IndicateConnect</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when a player has requested a
connection to the session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_INDICATE_CONNECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressDeviceUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AddressPlayerUrl As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> UserData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AddressDeviceUrl</b></p>

<p class=Def1><b>String</b> specifying the device's address URL </p>

<p class=Term1><b>AddressSenderUrl</b> </p>

<p class=Def1><b>String</b> specifying the sender's address URL. </p>

<p class=Term1><b>UserData </b></p>

<p class=Def1>Data of the connecting player.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_RECEIVE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn222"
name="_ftnref222" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.Receive</b> method.
This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when a message has been
received.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_RECEIVE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> idSender As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> iDataSize As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> ReceivedData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>idSender</b></p>

<p class=Def1><b>Long</b> value specifying the identifier of the message
sender.</p>

<p class=Term1><b>iDataSize</b> </p>

<p class=Def1><b>Long</b> value specifying the number of bytes in the <b>ReceivedData
</b>member. Because the byte array is zero-based, the upper limit of the array
will be <b>IDataSize</b>-1.</p>

<p class=Term1><b>ReceivedData</b></p>

<p class=Def1><b>Byte</b> array containing the message data that was sent.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_SEND_COMPLETE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn223"
name="_ftnref223" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>dpnotify</i> parameter of the <b>DirectPlay8Event.SendComplete</b>
method. This type is generated by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> when a message has been
received by the recipient.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_SEND_COMPLETE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> AsyncOpHandle As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hResultCode As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lSendTime As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>AsyncOpHandle</b></p>

<p class=Def1><b>Long</b> value specifying the handle of the asynchronous
operation.</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1><b>Long</b> value specifying the success or failure of the
message send.</p>

<p class=Term1><b>lSendTime</b></p>

<p class=Def1>Time, in milliseconds, between send call and completion.</p>

<p class=Rh1 style='page-break-after:avoid'>DPNMSG_TERMINATE_SESSION</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn224"
name="_ftnref224" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>DirectPlay8Event.TerminateSession</b> method.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DPNMSG_TERMINATE_SESSION</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hResultCode As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> TerminateData() As Byte</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>hResultCode</b></p>

<p class=Def1><b>Long</b> value specifying why the session was terminated. This
member is set to DPNERR<b>_</b>HOSTTERMINATEDSESSION if the session was
peer-to-peer, and the host called <b>DirectPlay8Peer.TerminateSession</b>. If
the session was ended by the host calling <b>Close</b>, or if the host stops
responding, <b>hResultCode </b>is set to DPNERR_CONNECTIONLOST. </p>

<p class=Term1><b>TerminateData</b> </p>

<p class=Def1>Termination data. If <b>hResultCode</b> is set to DPNERR<b>_</b>HOSTTERMINATEDSESSION,
<b>TerminateData</b> points to the data block that the host passed through the <i>UserData</i>
parameter of <b>DirectPlay8Peer.TerminateSession</b>. If <b>hResultCode</b> is
set to DPNERR_CONNECTIONLOST, <b>TerminateData</b> will be empty</p>

<p class=Rh1 style='page-break-after:avoid'>DVCAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn225"
name="_ftnref225" title=""><span class=MsoFootnoteReference>#</span></a>Describes
the capabilities of the Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice client object.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DVCAPS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Reserved. Must be 0.</p>

<p class=Rh1 style='page-break-after:avoid'>DVCLIENTCONFIG</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn226"
name="_ftnref226" title=""><span class=MsoFootnoteReference>#</span></a>Controls
the run-time parameters for the client. This type is first used in the call to <b>DirectPlayVoiceClient8.Connect</b>,
where it sets the initial state of these parameters. The type can be retrieved
after a connection has been made by calling <b>DirectPlayVoiceClient8.GetClientConfig</b>,
and set using <b>DirectPlayVoiceClient8.SetClientConfig</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DVCLIENTCONFIG</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBufferAggressiveness As
CONST_DVBUFFERAGGRESSIVENESS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBufferQuality As
CONST_DVBUFFERQUALITY</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DVCLIENTCONFIGENUM</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lNotifyPeriod As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lPlaybackVolume As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lRecordVolume As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lThreshold As CONST_DVTHRESHOLD</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>lBufferAggressiveness</b></p>

<p class=Def1>One of the constants of the <b>CONST_DVBUFFERAGGRESSIVENESS</b>
enumeration that specifies the buffer aggressiveness setting for the adaptive
buffer algorithm.</p>

<p class=Term1><b>lBufferQuality</b></p>

<p class=Def1>One of the constants of the <b>CONST_DVBUFFERQUALITY</b>
enumeration that specifies the buffer quality setting for the adaptive
buffering algorithm. For most applications, this should be set to
DVBUFFERQUALITY_DEFAULT. It can be set to anything in the range of
DVBUFFERQUALITY_MIN to DVBUFFERQUALITY_MAX. In general, the higher the value,
the higher the quality of the voice but the higher the latency. The lower the
value, the lower the latency but the lower the quality.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Combination of flags from the <b>CONST_DVCLIENTCONFIGENUM</b>
enumeration.</p>

<p class=Term1><b>lNotifyPeriod</b></p>

<p class=Def1>Specifies how often you want to receive DVMSGID_OUTPUTLEVEL and
DVMSGID_INPUTLEVEL (if session is full duplex) messages. If this value is set
to 0, these messages are disabled. The value specifies the number of
milliseconds between these messages. DVNOTIFYPERIOD_MINPERIOD specifies the
minimum period between messages that is allowed.</p>

<p class=Term1><b>lPlaybackVolume</b></p>

<p class=Def1>Specifies what the volume of the playback should be set to.
Adjusting this volume adjusts both the main buffer and all 3-D sound buffers.
See the <b>DirectSoundPrimaryBuffer8.SetVolume</b> method for the valid values
for this member. You can specify DVPLAYBACKVOLUME_DEFAULT to use a default
value that is appropriate for most situations (full volume).</p>

<p class=Term1><b>lRecordVolume</b></p>

<p class=Def1>Specifies what the volume of the recording should be set to. See
the <b>DirectSoundPrimaryBuffer8.SetVolume</b> method for the valid values for
this member.</p>

<p class=Def1>If automatic gain control is enabled, this value can be set to
DVRECORDVOLUME_LAST, which tells the system to use the current volume as
determined by the automatic gain control algorithm. If a value other then
DVRECORDVOLUME_LAST is specified in combination with automatic gain control,
this value will be used to restart the algorithm at the specified value.</p>

<p class=Def1>On return from a call to <b>DirectPlayVoiceClient8.GetClientConfig</b>,
this value will contain the current recording volume. When adjusting the
recording volume, Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice will adjust the volume for the
microphone (if a microphone volume is present for the card) and the master
recording volume (if one is present on the card). If neither a microphone
volume nor a master record volume is present, DirectPlay Voice will be unable
to adjust the recording volume. </p>

<p class=Term1><b>lThreshold</b></p>

<p class=Def1>One of the constants of the <b>CONST_DVTHRESHOLD</b> enumeration
that specifies the input level used to trigger voice transmission if the
DVCLIENTCONFIG_MANUALVOICEACTIVATED flag is specified in the <b>lFlags</b>
member. When the flag is specified, this value can be set to anywhere in the
range of DVTHRESHOLD_MIN to DVTHRESHOLD_MAX. Additionally, DVTHRESHOLD_DEFAULT
can be set to use a default value.</p>

<p class=Def1>If DVCLIENTCONFIG_MANUALVOICEACTIVATED or
DVCLIENTCONFIG_AUTOVOICEACTIVATED is not specified in the <b>lFlags</b> member
of this type (indicating push-to-talk mode) this value must be set to
DVTHRESHOLD_UNUSED.</p>

<p class=Rh1 style='page-break-after:avoid'>DVCOMPRESSIONINFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn227"
name="_ftnref227" title=""><span class=MsoFootnoteReference>#</span></a>Describes
the attributes of a specific Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> Voice compression type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DVCOMPRESSIONINFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidType As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMaxBitsPerSecond As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> strDescription As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> strName As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>guidType</b></p>

<p class=Def1><b>String</b> value specifying the GUID used to identify this
compression type by DirectPlay Voice.</p>

<p class=Term1><b>lFlags </b></p>

<p class=Def1>Reserved; must be 0.</p>

<p class=Term1><b>lMaxBitsPerSecond</b></p>

<p class=Def1>Maximum number of bits per second claimed by the codec.</p>

<p class=Term1><b>strDescription</b></p>

<p class=Def1>Description of the codec.</p>

<p class=Term1><b>strName</b></p>

<p class=Def1>Name describing the codec.</p>

<p class=Rh1 style='page-break-after:avoid'>DVSESSIONDESC</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn228"
name="_ftnref228" title=""><span class=MsoFootnoteReference>#</span></a>Describes
the desired or current session settings for the Microsoft<span
style='font-size:7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span>
Voice server. This structure is used by the voice session host to configure the
session, and by the session host and the clients to retrieve information about
the current session. The <b>lFlags</b>, <b>lSessionType</b>, and <b>guidCT</b>
members can only be set when the host starts the voice session. The host can
change the buffer settings at any time.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DVSESSIONDESC</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidCT As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBufferAggressiveness As
CONST_DVBUFFERAGGRESSIVENESS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lBufferQuality As
CONST_DVBUFFERQUALITY</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DVSESSION</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lSessionType As
CONST_DVSESSIONTYPE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>guidCT</b></p>

<p class=Def1><b>String</b> value specifying the GUID of the compression type
of the session.</p>

<p class=Term1><b>lBufferAggressiveness</b></p>

<p class=Def1>One of the constants of the <b>CONST_DVBUFFERAGGRESSIVENESS</b>
enumeration that specifies the buffer aggressiveness setting. This member is
unused for all session types except mixing sessions. For all sessions except
mixing sessions, set this member to DVBUFFERAGGRESIVENESS_DEFAULT.</p>

<p class=Def1>Allowable values are between DVBUFFERAGGRESIVENESS _MIN and
DVBUFFERAGGRESIVENESS _MAX. Additionally, this member can be set to the
following value.</p>

<p class=Term2>DVBUFFERAGGRESIVENESS_DEFAULT </p>

<p class=Def2>Specifying this value tells DirectPlay Voice to use the system
default for this value, which is adjustable through a registry entry that can
also be set through Control Panel.</p>

<p class=Term1><b>lBufferQuality</b></p>

<p class=Def1>One of the constants of the <b>CONST_DVBUFFERQUALITY</b>
enumeration that specifies the buffer quality setting. This member is unused
for all session types except mixing sessions. For all sessions except mixing
sessions, set this member to DVBUFFERQUALITY_DEFAULT.</p>

<p class=Def1>Allowable values are between DVBUFFERQUALITY_MIN and
DVBUFFERQUALITY_MAX. Additionally, this member can be set to the following
value.</p>

<p class=Term2>DVBUFFERQUALITY_DEFAULT </p>

<p class=Def2>Specifying this value tells DirectPlay Voice to use the system
default for this value, which is adjustable through a registry entry that can
also be set through Sounds and Multimedia in Control Panel.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Combination of the flags of the <b>CONST_DVSESSION</b>
enumeration.</p>

<p class=Term1><b>lSessionType</b></p>

<p class=Def1>One of the flags of the <b>CONST_DVSESSIONTYPE</b> enumeration to
specify the type of DirectPlay Voice session to run. The DVSESSIONTYPE_PEER
flag is not available in client/server sessions; all other flags are valid for
all session types. </p>

<p class=Rh1 style='page-break-after:avoid'>DVSOUNDDEVICECONFIG</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn229"
name="_ftnref229" title=""><span class=MsoFootnoteReference>#</span></a>Used to
set and retrieve information about the sound device configuration and cannot be
changed once a connection has been made. After a connection is made, you can
retrieve the current sound device configuration by calling <b>DirectPlayVoiceClient8.GetSoundDeviceConfig</b>.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type DVSOUNDDEVICECONFIG</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidCaptureDevice As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> guidPlaybackDevice As String</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> hwndAppWindow As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lFlags As CONST_DVSOUNDEFFECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMainBufferFlags As
CONST_DSBPLAYFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> lMainBufferPriority As Long</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> MainSoundBuffer As
DirectSoundSecondaryBuffer8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Members</p>

<p class=Term1><b>guidCaptureDevice</b></p>

<p class=Def1>When this type is used in <b>DirectPlayVoiceClient8.Connect</b>
method, this member specifies the GUID of the device used for capture.</p>

<p class=Def1>When this type is used in the <b>DirectPlayVoiceClient8.GetSoundDeviceConfig</b>
method, this member will contain the actual device GUID used for capture.</p>

<p class=Term1><b>guidPlaybackDevice</b></p>

<p class=Def1>When this type is used in the <b>DirectPlayVoiceClient8.Connect</b>
method, this member specifies the GUID of the device used for playback.</p>

<p class=Def1>When this type is used in the <b>DirectPlayVoiceClient8.GetSoundDeviceConfig</b>
method, this member contains the actual device GUID used for playback.</p>

<p class=Term1><b>hwndAppWindow</b></p>

<p class=Def1>Must be set to the handle of the window that will be used to
determine focus for sound playback. See <b>DirectSound8.SetCooperativeLevel</b>
for information on Microsoft<span style='font-size:7.0pt'></span> DirectSound<span
style='font-size:7.0pt'></span> focus. If you do not have a window to use for
focus, use <b>GetDesktopWindowHandle</b> to use the desktop window.</p>

<p class=Term1><b>lFlags</b></p>

<p class=Def1>Combination of the flags from the <b>CONST_DVSOUNDEFFECT</b>
enumeration.</p>

<p class=Term1><b>lMainBufferFlags</b></p>

<p class=Def1>Flags values taken from the<b> CONST_DSBPLAYFLAGS</b> enumeration
that specify how to play the buffer. </p>

<p class=Term1><b>lMainBufferPriority</b></p>

<p class=Def1>Passed directly to the <i>dwPriority</i> parameter of the <b>DirectSoundSecondaryBuffer8.Play</b>
method when <b>Play</b> is called on the main buffer.</p>

<p class=Term1><b>MainSoundBuffer</b></p>

<p class=Def1><b>DirectSoundSecondaryBuffer8 </b>object, which is used to
create the Microsoft DirectPlay<span style='font-size:7.0pt'></span> Voice
main buffer. This parameter can be either NULL or a user-created DirectSound
buffer. If this member is set to NULL, DirectPlay Voice will create a buffer
for the main voice buffer. If users specify a buffer here, DirectPlay Voice
will use their buffer for the main voice buffer.</p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must be 22 kilohertz,
16-bit, Mono format.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must be at least 1
second in length.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must have been
created with the DSBCAPS_GETCURRENTPOSITION2 and DSBCAPS_CTRL3D flags.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be a primary
buffer.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be playing
when it is passed to DirectPlay.</span></p>

<p class=Lb2><span
style='font-family:"Times New Roman",serif'> The buffer must not be locked
when it is passed to DirectPlay.</span></p>

<p class=Def1>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Enumerations</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>Microsoft<span style='font-size:
7.0pt'></span> DirectPlay<span style='font-size:7.0pt'></span> uses
enumerations to group constants in order to take advantage of the statement
completion feature of Microsoft<span style='font-size:7.0pt'></span> Visual
Basic<span style='font-size:7.0pt'></span>. The enumerations used in
DirectPlay are:</p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPLAYBUFSIZE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPLCONNECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPLSESSION</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNCANCELFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNENUMCLIENTGROUPFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNERR</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNGROUPINFOFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNINFO</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNLOBBY</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNMESSAGEID</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNOPERATIONS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNPLAYERGROUPFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNPLAYINFOFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNSENDFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNSESSIONFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNSPCAPS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DPNWAITTIME</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVBUFFERAGGRESSIVENESS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVBUFFERQUALITY</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVCLIENTCONFIGENUM</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVERR</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVFLAGS</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVMESSAGE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVNOTIFY</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVPLAYBACKVOLUME</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVSESSION</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVSESSIONTYPE</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVSOUNDEFFECT</b></span></p>

<p class=Lb1><span
style='font-family:"Times New Roman",serif'> <b>CONST_DVTHRESHOLD</b></span></p>

<p class=Le>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPLAYBUFSIZE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn230"
name="_ftnref230" title=""><span class=MsoFootnoteReference>#</span></a>Used to
specify the data type used in buffers.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPLAYBUFSIZE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_BOOLEAN = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_BYTE = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_CURRENCY = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_DATE = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_DECIMAL = 14</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_DOUBLE = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_INTEGER = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_LONG = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> SIZE_SINGLE = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>SIZE_BOOLEAN</p>

<p class=Def1>Size of a BOOLEAN variable, in bytes.</p>

<p class=Term1>SIZE_BYTE</p>

<p class=Def1>Size of a BYTE variable, in bytes.</p>

<p class=Term1>SIZE_CURRENCY </p>

<p class=Def1>Size of a CURRENCY variable, in bytes.</p>

<p class=Term1>SIZE_DATE </p>

<p class=Def1>Size of a DATE variable, in bytes.</p>

<p class=Term1>SIZE_DECIMAL </p>

<p class=Def1>Size of a DECIMAL variable, in bytes.</p>

<p class=Term1>SIZE_DOUBLE </p>

<p class=Def1>Size of a DOUBLE variable, in bytes.</p>

<p class=Term1>SIZE_INTEGER</p>

<p class=Def1>Size of an INTEGER variable, in bytes.</p>

<p class=Term1>SIZE_LONG</p>

<p class=Def1>Size of a LONG variable, in bytes.</p>

<p class=Term1>SIZE_SINGLE</p>

<p class=Def1>Size of a SINGLE variable, in bytes.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPLCONNECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn231"
name="_ftnref231" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>lFlags</i> parameter of the <b>DirectPlay8LobbyClient.ConnectApplication</b>
method to determine connection behavior.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPLCONNECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLCONNECT_LAUNCHNEW = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLCONNECT_LAUNCHNOTFOUND = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPLCONNECT_LAUNCHNEW</p>

<p class=Def1>Launch a new instance of the application.</p>

<p class=Term1>DPLCONNECT_LAUNCHNOTFOUND</p>

<p class=Def1>Launch a new instance of the application if there is no
application running that can supply launch settings.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_CONNECTSETTINGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn232"
name="_ftnref232" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>DPL_CONNECTION_SETTINGS</b> type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_CONNECTSETTINGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLCONNECTSETTINGS_HOST = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPLCONNECTSETTINGS_HOST </p>

<p class=Def1>Your player is the session host.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPLSESSION</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn233"
name="_ftnref233" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>lStatus</i> parameter of the <b>DirectPlay8LobbiedApplication.UpdateStatus</b>
method to set the current state of the connection between the lobby client and
the lobbied application.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPLSESSION</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_CONNECTED = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_COULDNOTCONNECT = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_DISCONNECTED = 3</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_HOSTMIGRATED = 5</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_HOSTMIGRATEDHERE = 6</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPLSESSION_TERMINATED = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term2>DPLSESSION_CONNECTED</p>

<p class=Def2>The lobbied application is currently connected to a session.</p>

<p class=Term2>DPLSESSION_COULDNOTCONNECT</p>

<p class=Def2>The lobbied application could not connect to the session.</p>

<p class=Term2>DPLSESSION_DISCONNECTED</p>

<p class=Def2>The lobbied application is currently disconnected from the
session.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATED</p>

<p class=Def2>The host of a peer-to-peer session has migrated. The local client
is not the new host.</p>

<p class=Term2>DPLSESSION_HOSTMIGRATEDHERE</p>

<p class=Def2>The host of a peer-to-peer session has migrated. The local client
is the new host.</p>

<p class=Term2>DPLSESSION_TERMINATED</p>

<p class=Def2>The connection between session host and the lobbied application
has been terminated.</p>

<p class=Term1>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNCANCELFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn234"
name="_ftnref234" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>lFlags</i> parameter of the <b>DirectPlay8Client.CancelAsyncOperation</b>,
<b>DirectPlay8Server.CancelAsyncOperation</b> and <b>DirectPlay8Peer.CancelAsyncOperation</b>
methods to specify which type of asynchronous operation to cancel.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNCANCELFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCANCEL_ALL_OPERATIONS = 32768
(&amp;H8000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCANCEL_CONNECT = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCANCEL_ENUM = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCANCEL_SEND = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNCANCEL_ALL_OPERATIONS</p>

<p class=Def1>Cancel all asynchronous requests.</p>

<p class=Term1>DPNCANCEL_CONNECT</p>

<p class=Def1>Cancel an asynchronous <b>Connect</b> request.</p>

<p class=Term1>DPNCANCEL_ENUM</p>

<p class=Def1>Cancel all asynchronous <b>EnumHosts</b> requests. A single <b>EnumHosts</b>
request can be canceled by specifying the handle returned from the <b>EnumHosts</b>
method.</p>

<p class=Term1>DPNCANCEL_SEND</p>

<p class=Def1>Cancel an asynchronous <b>Send</b> request.</p>

<p class=Le>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNENUMCLIENTGROUPFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn235"
name="_ftnref235" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <i>lFlags</i> parameter of the <b>DirectPlay8Peer.GetCountClientsAndGroups</b>
and the <b>DirectPlay8Server.GetCountClientsAndGroups</b> methods to determine
which type of enumeration to return.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNENUMCLIENTGROUPFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNENUM_ALL = 17 (&amp;H11)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNENUM_GROUP_MULTICAST = 32
(&amp;H20)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNENUM_GROUPS = 16 (&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNENUM_PLAYERS = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNENUM_ALL</p>

<p class=Def1>Return the number of all groups and players.</p>

<p class=Term1>DPNENUM_GROUP_MULTICAST</p>

<p class=Def1>Return the number of multicast groups.</p>

<p class=Term1>DPNENUM_GROUPS</p>

<p class=Def1>Return the number of groups.</p>

<p class=Term1>DPNENUM_PLAYERS</p>

<p class=Def1>Return the number of players.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNERR</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn236"
name="_ftnref236" title=""><span class=MsoFootnoteReference>#</span></a>Contains
the error values for Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span>. For more information, see <b>Error Codes</b>.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNGROUPINFOFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn237"
name="_ftnref237" title=""><span class=MsoFootnoteReference>#</span></a>Describes
the settings for a group. This enumeration is used in the <b>lGroupFlags</b>
member or the <b>DPN_GROUP_INFO</b> type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNGROUPINFOFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNGROUP_AUTODESTRUCT = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNGROUP_AUTODESTRUCT</p>

<p class=Def1>Automatically destroy the group when the group creator leaves the
group. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNINFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn238"
name="_ftnref238" title=""><span class=MsoFootnoteReference>#</span></a>Used to
specify the type of information you set or retrieve from group and player
information methods. This enumeration is used in the <b>lInfoFlags</b> member
of both the <b>DPN_GROUP_INFO</b> and <b>DPN_PLAYER_INFO</b> types.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNINFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNINFO_DATA = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNINFO_NAME = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNINFO_DATA</p>

<p class=Def1>The information is data set for the player or group.</p>

<p class=Term1>DPNINFO_NAME</p>

<p class=Def1>The information is the name of the player or group.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNLOBBY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn239"
name="_ftnref239" title=""><span class=MsoFootnoteReference>#</span></a>Used
with the <i>lFlags</i> parameter of the <b>DirectPlay8Client.RegisterLobby</b>
method. Set one of the two values to indicate whether the application is to be
registered or unregistered.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNLOBBY</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNLOBBY_REGISTER = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNLOBBY_UNREGISTER = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNLOBBY_REGISTER</p>

<p class=Def1>Register the application with the lobby.</p>

<p class=Term1>DPNLOBBY_UNREGISTER</p>

<p class=Def1>Unregister the application with the lobby.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNMESSAGEID</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn240"
name="_ftnref240" title=""><span class=MsoFootnoteReference>#</span></a>Contains
message identification flags that are used by some of the methods of the <b>DirectPlay8Event</b>
class. For more information, see the <b>DirectPlay8Event.AddRemovePlayerGroup</b>,
and <b>DirectPlay8Event.InfoNotify</b> methods.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNMESSAGEID</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_ADD_PLAYER_TO_GROUP =
-65528 (&amp;HFFFF0008)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_APPLICATION_DESC =
-65526 (&amp;HFFFF000A)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_ASYNC_OP_COMPLETE =
-65533 (&amp;HFFFF0003)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_CLIENT_INFO = -65524
(&amp;HFFFF000C)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_CONNECT_COMPLETE =
-65520 (&amp;HFFFF0010)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_CREATE_GROUP = -65530
(&amp;HFFFF0006)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_CREATE_PLAYER = -65529
(&amp;HFFFF0007)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_DESTROY_GROUP = -65528
(&amp;HFFFF0007)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_DESTROY_PLAYER = -65527
(&amp;HFFFF0005)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_ENUM_HOSTS_QUERY =
-65516 (&amp;HFFFF0014)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_ENUM_HOSTS_RESPONSE =
-65515 (&amp;HFFFF0015)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_GROUP_INFO = -65522
(&amp;HFFFF000E)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_HOST_MIGRATE = -65523
(&amp;HFFFF000D)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_INDICATE_CONNECT =
-65521 (&amp;HFFFF000F)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>
DPN_MSGID_INDICATED_CONNECT_ABORTED = -65521 (&amp;HFFFF000F)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_PEER_INFO = -65525
(&amp;HFFFF000B)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_RECEIVE = -65535
(&amp;HFFFF0001)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_REMOVE_PLAYER_FROM_GROUP
= -65518 (&amp;HFFFF0012)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_RETURN_BUFFER = -65517
(&amp;HFFFF0013)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_SEND_COMPLETE = -65534
(&amp;HFFFF0002)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_SERVER_INFO = -65523
(&amp;HFFFF000D)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPN_MSGID_TERMINATE_SESSION =
-65514 (&amp;HFFFF0016)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>&nbsp;</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNOPERATIONS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn241"
name="_ftnref241" title=""><span class=MsoFootnoteReference>#</span></a>Contains
a set of flags that are used by the methods of the <b>DirectPlay8Client</b>
class. See the individual method references for details.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNOPERATIONS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNADDPLAYERTOGROUP_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCONNECT_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNCREATEGROUP_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNDESTROYGROUP_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNENUMHOSTS_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNHOST_OKTOQUERYFORADDRESSING = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNOP_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNREMOVEPLAYERFROMGROUP_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSETCLIENTINFO_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSETGROUPINFO_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSETPEERINFO_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSETSERVERINFO_SYNC =
-2147483648 (&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNPLAYERGROUPFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn242"
name="_ftnref242" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the <b>DirectPlay8Server.SendTo</b> and <b>DirectPlay8Peer.SendTo</b> methods.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNPLAYERGROUPFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNID_ALL_PLAYERS_GROUP = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNID_ALL_PLAYERS_GROUP</p>

<p class=Def1>Send a message to all players in the session. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNPLAYINFOFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn243"
name="_ftnref243" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lPlayerFlags</b> member of the <b>DPN_PLAYER_INFO</b> structure to
determine whether the player is a host player or local player.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNPLAYINFOFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNPLAYER_HOST = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNPLAYER_LOCAL = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNPLAYER_HOST</p>

<p class=Def1>This information is for the local player. </p>

<p class=Term1>DPNPLAYER_LOCAL</p>

<p class=Def1>This player is the host for the application. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNSENDFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn244"
name="_ftnref244" title=""><span class=MsoFootnoteReference>#</span></a>Contains
flags that can be set in the <b>DirectPlay8Client.Send</b>, <b>DirectPlay8Server.SendTo</b>,
and <b>DirectPlay8Peer.SendTo</b> methods to control how messages are sent.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNSENDFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_COMPLETEONPROCESS = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_GUARANTEED = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_NOCOMPLETE = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_NOCOPY = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_NOLOOPBACK = 32 (&amp;H20)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_NONSEQUENTIAL = 16
(&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_PRIORITY_HIGH = 128
(&amp;H80)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_PRIORITY_LOW = 64
(&amp;H40)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSEND_SYNC = -2147483648
(&amp;H80000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNSEND_COMPLETEONPROCESS</p>

<p class=Def1>Call the <b>DirectPlay8Event.SendComplete</b> method in the
message handler when this message has been delivered to the target and the
target's message handler returns from indicating its reception. There is
additional internal message overhead when this flag is set, and the message
transmission process may become significantly slower. If you set this flag,
DPNSEND_GUARANTEED must also be set.</p>

<p class=Term1>DPNSEND_GUARANTEED</p>

<p class=Def1>Send the message by a guaranteed method of delivery.</p>

<p class=Term1>DPNSEND_NOCOMPLETE</p>

<p class=Def1>Do not call the <b>DirectPlay8Event.SendComplete</b> method in
the sender's message handler. There is additional internal message overhead
when this flag is set, and the message sends process is significantly slower.
This flag cannot be combined with DPNSEND_NOCOPY.</p>

<p class=Term1>DPNSEND_NOCOPY</p>

<p class=Def1>Use the data in the <i>buffer()</i> parameter type and do not
make an internal copy. This might be a more efficient method of sending data.
However, it is less robust because the sender might be able to modify the
message before the receiver has processed it. This flag cannot be combined with
DPNSEND_NOCOMPLETE or DPNSEND_GUARANTEED.</p>

<p class=Term1>DPNSEND_NOLOOPBACK</p>

<p class=Def1>Do not call the <b>DirectPlay8Event.Receive</b> method in your
message handler when you are sending to yourself. This flag is useful if you
are broadcasting to the entire session, or you are sending a message to a group
that you are a member of.</p>

<p class=Term1>DPNSEND_NONSEQUENTIAL</p>

<p class=Def1>Messages are delivered to the target application in the order
that they are received. If the flag is not set, messages are delivered to the
target application in the order that they are sent, which may necessitate
buffering out-of-sequence messages until the missing messages arrive. </p>

<p class=Term1>DPNSEND_PRIORITY_HIGH</p>

<p class=Def1>Sets the priority of the message to high.</p>

<p class=Term1>DPNSEND_PRIORITY_LOW</p>

<p class=Def1>Sets the priority of the message to low.</p>

<p class=Term1>DPNSEND_SYNC</p>

<p class=Def1>Process the <b>SendTo</b> request synchronously.</p>

<p class=Nsi><span style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNGETSENDQUEUEINFO</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn245"
name="_ftnref245" title=""><span class=MsoFootnoteReference>#</span></a>Used
with the <i>lFlags</i> parameter of <b>DirectPlay8Client.GetSendQueueInfo</b>.
Setting one of these flags instructs the method to only return send-queue
information on the associated send queue instead of the total for all queues.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNGETSENDQUEUEINFO</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNGETSENDQUEUEINFO_PRIORITY_HIGH
= 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNGETSENDQUEUEINFO_PRIORITY_LOW =
4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>
DPNGETSENDQUEUEINFO_PRIORITY_NORMAL = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNGETSENDQUEUEINFO_PRIORITY_HIGH</p>

<p class=Def1>Return information for the high-priority queue.</p>

<p class=Term1>DPNGETSENDQUEUEINFO_PRIORITY_LOW</p>

<p class=Def1>Return information for the low-priority queue.</p>

<p class=Term1>DPNGETSENDQUEUEINFO_PRIORITY_NORMAL</p>

<p class=Def1>Return information for the normal-priority queue.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNSESSIONFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn246"
name="_ftnref246" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lFlags</b> member of the <b>DPN_APPLICATION_DESC</b> type to specify the
type of session.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNSESSIONFLAGS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSESSION_CLIENT_SERVER = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSESSION_MIGRATE_HOST = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSESSION_NODPNSVR = 64
(&amp;H40)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSESSION_REQUIREPASSWORD = 128
(&amp;H80)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNSESSION_CLIENT_SERVER</p>

<p class=Def1>Specify that this type of session is client/server. This flag
cannot be combined with DPNSESSION_MIGRATE_HOST.</p>

<p class=Term1>DPNSESSION_MIGRATE_HOST</p>

<p class=Def1>Enable host migration. This flag is used in peer-to-peer
sessions. This flag cannot be combined with DPNSESSION_CLIENT_SERVER.</p>

<p class=Term1>DPNSESSION_NODPNSVR</p>

<p class=Def1>Specify that you do not want enumerations forwarded to your host
from DPNSVR.</p>

<p class=Term1>DPNSESSION_REQUIREPASSWORD</p>

<p class=Def1>Specify that the session is password protected. If this flag is
set, the <b>Password</b> member of the <b>DPN_APPLICATION_DESC</b> type must be
a valid string.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNSPCAPS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn247"
name="_ftnref247" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the <b>DPN_SP_CAPS</b> type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNSPCAPS </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSPCAPS_SUPPORTSALLADAPTERS = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSPCAPS_SUPPORTSBROADCAST = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DPNSPCAPS_SUPPORTSDPNSRV = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DPNSPCAPS_SUPPORTSALLADAPTERS</p>

<p class=Def1>The service provider is supported on all the adapters present on
the system.</p>

<p class=Term1>DPNSPCAPS_SUPPORTSBROADCAST</p>

<p class=Def1>On IP and IPX applications, the service provider has the ability
to broadcast to find games if not enough addressing information is passed.</p>

<p class=Term1>DPNSPCAPS_SUPPORTSDPNSRV</p>

<p class=Def1>DPNSVR.EXE will provide port sharing for the given SP. Currently
this flag is available on IP and IPX only.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DPNWAITTIME</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn248"
name="_ftnref248" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the <b>DirectPlay8Client.EnumHosts</b>, and <b>DirectPlay8Peer.EnumHosts </b>methods.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DPNWAITTIME </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> INFINITE = -1 (&amp;HFFFFFFFF)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>INFINITE</p>

<p class=Def1>Wait until the enumeration is canceled.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVBUFFERAGGRESSIVENESS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn249"
name="_ftnref249" title=""><span class=MsoFootnoteReference>#</span></a>Contains
flags used in the <b>lBufferAggressiveness</b> member of the <b>DVCLIENTCONFIG</b>
type. For most applications, this can be set to DVBUFFERAGGRESSIVENESS_DEFAULT.
It can also be set to anything in the range of DVBUFFERAGGRESSIVENESS_MIN and
DVBUFFERAGGRESSIVENESS_MAX. In general, the higher the value, the quicker the
adaptive buffering adjusts to changing conditions. The lower the value, the
slower the adaptive buffering adjusts to changing conditions.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVBUFFERAGGRESSIVENESS</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERAGGRESSIVENESS_DEFAULT = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERAGGRESSIVENESS_MAX = 100
(&amp;H64)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERAGGRESSIVENESS_MIN = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVBUFFERAGGRESSIVENESS_DEFAULT</p>

<p class=Def1>The default buffer aggressiveness value.</p>

<p class=Term1>DVBUFFERAGGRESSIVENESS_MAX</p>

<p class=Def1>The maximum buffer aggressiveness value.</p>

<p class=Term1>DVBUFFERAGGRESSIVENESS_MIN</p>

<p class=Def1>The minimum buffer aggressiveness value.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVBUFFERQUALITY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn250"
name="_ftnref250" title=""><span class=MsoFootnoteReference>#</span></a>Contains
flags used in the <b>lBufferQuality</b> member of the <b>DVCLIENTCONFIG</b>
type. For most applications, this should be set to DVBUFFERQUALITY_DEFAULT. It
can be set to anything in the range of DVBUFFERQUALITY_MIN to
DVBUFFERQUALITY_MAX. In general, the higher the value, the higher the quality
of the voice but the also higher the latency. The lower the value, the lower
the latency but also the lower the quality.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVBUFFERQUALITY</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERQUALITY_DEFAULT = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERQUALITY_MAX = 100
(&amp;H64)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVBUFFERQUALITY_MIN = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVBUFFERQUALITY_DEFAULT</p>

<p class=Def1>The default buffer quality value.</p>

<p class=Term1>DVBUFFERQUALITY_MAX</p>

<p class=Def1>The maximum buffer quality value.</p>

<p class=Term1>DVBUFFERQUALITY_MIN</p>

<p class=Def1>The minimum buffer quality value.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVCLIENTCONFIGENUM</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn251"
name="_ftnref251" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lFlags</b> member of the <b>DVCLIENTCONFIG</b> type to control voice
transmission behavior.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVCLIENTCONFIGENUM</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_AUTORECORDVOLUME =
8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_AUTOVOICEACTIVATED
= 32 (&amp;H20)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_ECHOSUPPRESSION =
134217728 (&amp;H8000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>
DVCLIENTCONFIG_MANUALVOICEACTIVATED = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_MUTEGLOBAL = 16
(&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_PLAYBACKMUTE = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVCLIENTCONFIG_RECORDMUTE = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term2>DVCLIENTCONFIG_AUTORECORDVOLUME</p>

<p class=Def2>Activate automatic gain control. With automatic gain control,
Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice adjusts the hardware input volume on
your sound card automatically to get the best input level possible. You can
determine the current input volume by looking at the <b>lRecordVolume</b>
member after a call to <b>DirectPlayVoiceClient8.GetClientConfig</b>.</p>

<p class=Term2>DVCLIENTCONFIG_AUTOVOICEACTIVATED</p>

<p class=Def2>Place the transmission control system into automatic voice
activation mode. In this mode, the sensitivity of voice activation is
determined automatically by the system. The input level is adaptive, adjusting
itself automatically to the input signal. For most applications this should be
the setting used. This flag and the DVCLIENTCONFIG_MANUALVOICEACTIVATED flag
are mutually exclusive.</p>

<p class=Term2>DVCLIENTCONFIG_ECHOSUPPRESSION</p>

<p class=Def2>Activate the echo suppression mode. This mode reduces echo
introduced by configurations with external speakers and extremely sensitive
microphones. While remote player's voices are being played back on the local
speaker, the microphone is automatically muted. If the local player is
transmitting, then the playback of remote player voices is buffered until local
input stops. After local input stops, playback resumes.</p>

<p class=Term2>DVCLIENTCONFIG_MANUALVOICEACTIVATED</p>

<p class=Def2>Place the transmission control system into manual voice
activation mode. In this mode, transmission of voice begins when the input
level passes the level specified by the <b>lThreshold</b> member of the <b>DVCLIENTCONFIG</b>
type. When input levels drop below the specified level, transmission stops.
This flag is mutually exclusive with the DVCLIENTCONFIG_AUTOVOICEACTIVATED
flag.</p>

<p class=Term2>DVCLIENTCONFIG_MUTEGLOBAL</p>

<p class=Def2>Mute playback of the main sound buffer. Only sound buffers
created through calls to <b>DirectPlayVoiceClient8.Create3DSoundBuffer</b> will
be heard.</p>

<p class=Term2>DVCLIENTCONFIG_PLAYBACKMUTE</p>

<p class=Def2>Mute the playback of all DirectPlay Voice output and stop
playback. This also stops decompression of incoming packets so CPU usage is
reduced. Packets are effectively discarded while this flag is specified.</p>

<p class=Term2>DVCLIENTCONFIG_RECORDMUTE</p>

<p class=Def2>Mute the input from the microphone and stop recording. This also
stops compression so CPU usage is reduced.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>In addition to the preceding
flags, the method of transmission is controlled by setting only one of the
following flags or by not specifying either flag.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you do not specify either
DVCLIENTCONFIG_MANUALVOICEACTIVATED or DVCLIENTCONFIG_AUTOVOICEACTIVATED, the
system will operate in push-to-talk mode. In push-to-talk mode, as long as
there is a valid target specified the input from the microphone will be transmitted.
Voice transmission stops when a NULL target is set or the current target leaves
the session or is destroyed.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVERR</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn252"
name="_ftnref252" title=""><span class=MsoFootnoteReference>#</span></a>Contains
the error values for Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice. For more information, see <b>Error
Codes</b>.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVFLAGS</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn253"
name="_ftnref253" title=""><span class=MsoFootnoteReference>#</span></a>Used by
various Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> voice methods.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVFLAGS </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVFLAGS_ALLOWBACK = 16 (&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVFLAGS_NOHOSTMIGRATE = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVFLAGS_QUERYONLY = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVFLAGS_SYNC = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term2>DVFLAGS_ALLOWBACK </p>

<p class=Def2>Enable the <b>Back</b> button on the wizard's Welcome page. If
the user clicks the <b>Back</b> button on the Welcome page, the wizard exits,
and <b>CheckAudioSetup</b> returns DVERR_USERBACK. </p>

<p class=Term2>DVFLAGS_NOHOSTMIGRATE </p>

<p class=Def2>The voice host will not migrate regardless of session and
transport settings. Use this flag when you want to shut down the voice session
completely. </p>

<p class=Term2>DVFLAGS_QUERYONLY</p>

<p class=Def2>Audio setup is not run. Instead, the method checks the registry
to see if the devices have been tested. If the devices have not been tested,
the method returns DVERR_RUNSETUP. If the devices have been tested, the method
returns DV_FULLDUPLEX if the devices support full duplex audio, or
DV_HALFDUPLEX if the devices do not support full duplex audio. </p>

<p class=Term2>DVFLAGS_SYNC </p>

<p class=Def2>Do not return until the operation is completed. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVMESSAGE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn254"
name="_ftnref254" title=""><span class=MsoFootnoteReference>#</span></a>Not
used.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVMESSAGE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID_ALLPLAYERS = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID_NOTARGET = -1
(&amp;HFFFFFFFF)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID_REMAINING = -1
(&amp;HFFFFFFFF)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID_SERVERPLAYER = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVID_SYS = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_BASE = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_CONNECTRESULT = 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_CREATEVOICEPLAYER = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_DELETEVOICEPLAYER = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_DISCONNECTRESULT = 9</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_HOSTMIGRATED = 14</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_INPUTLEVEL = 12</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_MAXBASE = 16 (&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_MINBASE = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_OUTPUTLEVEL = 13</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_PLAYEROUTPUTLEVEL = 16
(&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_PLAYERVOICESTART = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_PLAYERVOICESTOP = 5</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_RECORDSTART = 6</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_RECORDSTOP = 7</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_SESSIONLOST = 3</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_SETTARGET = 15</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_STARTSESSIONRESULT = 10</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVMSGID_STOPSESSIONRESULT = 11</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVNOTIFY</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn255"
name="_ftnref255" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the <b>DVCLIENTCONFIG </b>type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVNOTIFY </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVNOTIFYPERIOD_MINPERIOD = 20
(&amp;H14)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term2>DVNOTIFYPERIOD_MINPERIOD </p>

<p class=Def2>Specifies the minimum period between messages that is allowed. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVPLAYBACKVOLUME</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn256"
name="_ftnref256" title=""><span class=MsoFootnoteReference>#</span></a>Used by
the <b>DVCLIENTCONFIG</b> type.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVPLAYBACKVOLUME</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVPLAYBACKVOLUME_DEFAULT = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term2>CONST_DVPLAYBACKVOLUME</p>

<p class=Def2>Use a default value that is appropriate for most situations. </p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVSESSION</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn257"
name="_ftnref257" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lFlags</b> member of the <b>DVSESSIONDESC</b> type to control session
behavior.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVSESSION</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSION_NOHOSTMIGRATION = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSION_SERVERCONTROLTARGET = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVSESSION_NOHOSTMIGRATION</p>

<p class=Def1>The voice host will not migrate regardless of the transport
settings. If this flag is not specified, the voice host will migrate if the
transport supports it.</p>

<p class=Term1>DVSESSION_SERVERCONTROLTARGET</p>

<p class=Def1>Only the server player can control the clients' speech target. If
the server player does not specify this flag, only the clients can control
their speech target. This flag can be specified only in multicast and mixing sessions.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVSESSIONTYPE</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn258"
name="_ftnref258" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lSessionType</b> member of the <b>DVSESSIONDESC</b> type to specify the
type of Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice session to run. The DVSESSIONTYPE_PEER
flag is not available in client/server sessions; all other flags are valid for
all session types. </p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Type CONST_DVSESSIONTYPE</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSIONTYPE_ECHO = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSIONTYPE_MIXING = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSIONTYPE_MULTICAST = 3</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSESSIONTYPE_PEER = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Type</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVSESSIONTYPE_ECHO</p>

<p class=Def1>Voice messages will be echoed back to the player.</p>

<p class=Term1>DVSESSIONTYPE_MIXING</p>

<p class=Def1>The voice session will use a mixing server. In this mode of
operation, all voice messages are sent to the server, which mixes them and then
forwards a single, premixed stream to each client. This reduces the bandwidth
and CPU usage on clients significantly at the cost of increased bandwidth and
CPU usage on the server.</p>

<p class=Term1>DVSESSIONTYPE_MULTICAST</p>

<p class=Def1>Voice messages will be routed through the session host. This will
save bandwidth on the clients at the expense of bandwidth usage on the server.
This option is useful only if the session host has a high-speed connection.</p>

<p class=Term1>DVSESSIONTYPE_PEER</p>

<p class=Def1>Voice messages will be sent directly between players.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVSOUNDEFFECT</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn259"
name="_ftnref259" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lFlags</b> member of the <b>DVSOUNDDEVICECONFIG</b> type to control
sound behavior.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVSOUNDEFFECT</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_AUTOSELECT = 2</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_HALFDUPLEX = 4</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_NOFOCUS = 536870912
(&amp;H20000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_NORECVOLAVAILABLE =
16 (&amp;H10)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_NORMALMODE = 1</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_SETCONVERSIONQUALITY
= 8</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVSOUNDCONFIG_STRICTFOCUS =
1073741824 (&amp;H40000000)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVSOUNDCONFIG_AUTOSELECT</p>

<p class=Def1>Tell Microsoft<span style='font-size:7.0pt'></span> DirectPlay<span
style='font-size:7.0pt'></span> Voice to attempt to automatically select (or
unmute) the microphone line in the mixer for the specified recording device.</p>

<p class=Term1>DVSOUNDCONFIG_HALFDUPLEX</p>

<p class=Def1>Tell DirectPlay Voice to initialize itself in half-duplex mode.
In half-duplex mode no recording takes place. If the initialization of the
sound system fails in full-duplex mode, this flag will be set by the system.</p>

<p class=Term1>DVSOUNDCONFIG_NOFOCUS</p>

<p class=Def1>Not enabled for this release.</p>

<p class=Term1>DVSOUNDCONFIG_NORECVOLAVAILABLE</p>

<p class=Def1>Indicate that the recording volume cannot be modified.</p>

<p class=Term1>DVSOUNDCONFIG_NORMALMODE</p>

<p class=Def1>Tell DirectPlay Voice to use Microsoft DirectSound<span
style='font-size:7.0pt'></span> Normal Mode when initializing the DirectSound
object. If this flag is not specified the DirectSound object is initialized
with DirectSound Priority Mode. See documentation for <b>DirectSound8.SetCooperativeLevel</b>
for more information.</p>

<p class=Term1>DVSOUNDCONFIG_SETCONVERSIONQUALITY</p>

<p class=Def1>Enable better quality audio at the expense of higher CPU usage.</p>

<p class=Term1>DVSOUNDCONFIG_STRICTFOCUS</p>

<p class=Def1>Not enabled for this release.</p>

<p class=Rh1 style='page-break-after:avoid'>CONST_DVTHRESHOLD</p>

<p class=MsoNormal style='margin-bottom:6.0pt'><a href="#_ftn260"
name="_ftnref260" title=""><span class=MsoFootnoteReference>#</span></a>Used in
the <b>lThreshold</b> member of the <b>DVCLIENTCONFIG</b> type to specify the
input level used to trigger voice transmission if the
DVCLIENTCONFIG_MANUALVOICEACTIVATED flag is specified in the <b>lFlags</b>
member. When the flag is specified, this value can be set to anywhere in the
range of DVTHRESHOLD_MIN to DVTHRESHOLD_MAX. Additionally, DVTHRESHOLD_DEFAULT
can be set to use a default value.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If
DVCLIENTCONFIG_MANUALVOICEACTIVATED or DVCLIENTCONFIG_AUTOVOICEACTIVATED is not
specified in the <b>lFlags</b> member of this structure (indicating
push-to-talk mode), this value must be set to DVTHRESHOLD_UNUSED.</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>Enum CONST_DVTHRESHOLD</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVTHRESHOLD_DEFAULT = -1
(&amp;HFFFFFFFF)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVTHRESHOLD_MAX = 99 (&amp;H63)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVTHRESHOLD_MIN = 0</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'> DVTHRESHOLD_UNUSED = -2
(&amp;HFFFFFFFE)</p>

<p class=ExSyn style='margin-top:0in;margin-right:6.0pt;margin-bottom:0in;
margin-left:6.0pt;margin-bottom:.0001pt'>End Enum</p>

<p class=Rmh style='page-break-after:avoid'>Constants</p>

<p class=Term1>DVTHRESHOLD_DEFAULT</p>

<p class=Def1>Default threshold value.</p>

<p class=Term1>DVTHRESHOLD_MAX</p>

<p class=Def1>Maximum threshold value.</p>

<p class=Term1>DVTHRESHOLD_MIN</p>

<p class=Def1>Minimum threshold value.</p>

<p class=Term1>DVTHRESHOLD_UNUSED</p>

<p class=Def1>Must be set for push-to-talk mode.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<h2 style='page-break-after:avoid'>Error Codes</h2>

<p class=MsoNormal style='margin-bottom:6.0pt'>This table lists the error codes
that can be returned by Microsoft<span style='font-size:7.0pt'></span>
DirectPlay<span style='font-size:7.0pt'></span> methods and functions. Errors
are represented by negative values and cannot be combined. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For a list of the errors each
method or function can raise, see the individual descriptions. <span
style='color:black'>Lists of error codes in the documentation are necessarily
incomplete. For example, any DirectPlay method can return DPERR_OUTOFMEMORY
even though the error code is not explicitly listed as a possible return value
in the documentation for that method.</span></p>

<p class=Term1>DPNERR_ABORTED</p>

<p class=Def1>The operation was canceled before it could be completed.</p>

<p class=Term1>DPNERR_ADDRESSING</p>

<p class=Def1>The address specified is invalid.</p>

<p class=Term1>DPNERR_ALREADYCONNECTED</p>

<p class=Def1>The object is already connected to the session.</p>

<p class=Term1>DPNERR_ALREADYCLOSING</p>

<p class=Def1>An attempt to call <b>Close</b> on a session has been made more
than once.</p>

<p class=Term1>DPNERR_ALREADYDISCONNECTING</p>

<p class=Def1>The client is already disconnecting from the session.</p>

<p class=Term1>DPNERR_ALREADYINITIALIZED</p>

<p class=Def1>The object has already been initialized.</p>

<p class=Term1>DPNERR_ALREADYREGISTERED</p>

<p class=Def1>A message handler has already been registered. You must
unregister the current handler before registering a new one.</p>

<p class=Term1>DPNERR_BUFFERTOOSMALL</p>

<p class=Def1>The supplied buffer is not large enough to contain the requested
data. </p>

<p class=Term1>DPNERR_CANNOTCANCEL</p>

<p class=Def1>The operation could not be canceled.</p>

<p class=Term1>DPNERR_CANTCREATEGROUP</p>

<p class=Def1>A new group cannot be created. </p>

<p class=Term1>DPNERR_CANTCREATEPLAYER</p>

<p class=Def1>A new player cannot be created. </p>

<p class=Term1>DPNERR_CANTLAUNCHAPPLICATION</p>

<p class=Def1>The lobby cannot launch the specified application.</p>

<p class=Term1>DPNERR_CONNECTING</p>

<p class=Def1>The method is in the process of connecting to the network. </p>

<p class=Term1>DPNERR_CONNECTIONLOST</p>

<p class=Def1>The service provider connection was reset while data was being
sent. </p>

<p class=Term1>DPNERR_DOESNOTEXIST</p>

<p class=Def1>Requested element is not part of the address.</p>

<p class=Term1>DPNERR_EXCEPTION</p>

<p class=Def1>An exception occurred when processing the request. </p>

<p class=Term1>DPNERR_GENERIC</p>

<p class=Def1>An undefined error condition occurred. </p>

<p class=Term1>DPNERR_GROUPNOTEMPTY</p>

<p class=Def1>The specified group is not empty.</p>

<p class=Term1>DPNERR_HOSTING</p>

<p class=Def1>&nbsp;</p>

<p class=Term1>DPNERR_HOSTREJECTEDCONNECTION</p>

<p class=Def1>The connection request was rejected. Check the <b>ReplyData</b>
member of the <b>DPNMSG_CONNECT_COMPLETE</b> type for details.</p>

<p class=Term1>DPNERR_HOSTTERMINATEDSESSION</p>

<p class=Def1>The host terminated the session.</p>

<p class=Term1>DPNERR_INCOMPLETEADDRESS</p>

<p class=Def1>The address specified is not complete.</p>

<p class=Term1>DPNERR_INVALIDADDRESSFORMAT</p>

<p class=Def1>The address format is invalid.</p>

<p class=Term1>DPNERR_INVALIDAPPLICATION</p>

<p class=Def1>The GUID supplied for the application is invalid.</p>

<p class=Term1>DPNERR_INVALIDCOMMAND</p>

<p class=Def1>The command specified is invalid.</p>

<p class=Term1>DPNERR_INVALIDFLAGS</p>

<p class=Def1>The flags passed to this method are invalid. </p>

<p class=Term1>DPNERR_INVALIDGROUP</p>

<p class=Def1>The group ID is not recognized as a valid group ID for this game
session. </p>

<p class=Term1>DPNERR_INVALIDHANDLE</p>

<p class=Def1>The handle specified is invalid.</p>

<p class=Term1>DPNERR_INVALIDINSTANCE</p>

<p class=Def1>The GUID for the application instance is invalid.</p>

<p class=Term1>DPNERR_INVALIDINTERFACE</p>

<p class=Def1>The interface parameter is invalid. This value will be returned
in a connect request if the connecting player was not a client in a
client/server game or a peer in a peer-to-peer game.</p>

<p class=Term1>DPNERR_INVALIDLOCALADDRESS</p>

<p class=Def1>The address for the local computer or adapter is invalid.</p>

<p class=Term1>DPNERR_INVALIDOBJECT</p>

<p class=Def1>The DirectPlay object pointer is invalid. </p>

<p class=Term1>DPNERR_INVALIDPARAM</p>

<p class=Def1>One or more of the parameters passed to the method are invalid. </p>

<p class=Term1>DPNERR_INVALIDPASSWORD</p>

<p class=Def1>An invalid password was supplied when attempting to join a
session that requires a password. </p>

<p class=Term1>DPNERR_INVALIDPLAYER</p>

<p class=Def1>The player ID is not recognized as a valid player ID for this
game session. </p>

<p class=Term1>DPNERR_INVALIDPOINTER</p>

<p class=Def1>Pointer specified as a parameter is invalid.</p>

<p class=Term1>DPNERR_INVALIDPRIORITY</p>

<p class=Def1>The specified priority is not within the range of allowed
priorities, which is inclusively from 0 through 65535.</p>

<p class=Term1>DPNERR_INVALIDSTRING</p>

<p class=Def1>String specified as a parameter is invalid.</p>

<p class=Term1>DPNERR_INVALIDREMOTEADDRESS</p>

<p class=Def1>The specified remote address is invalid.</p>

<p class=Term1>DPNERR_INVALIDURL</p>

<p class=Def1>Specified string is not a valid DirectPlay URL.</p>

<p class=Term1>DPNERR_INVALIDVERSION</p>

<p class=Def1>There was an attempt to connect to an invalid version of
DirectPlay.</p>

<p class=Term1>DPNERR_NOCAPS</p>

<p class=Def1>The communication link that DirectPlay is attempting to use is
not capable of this function. </p>

<p class=Term1>DPNERR_NOCONNECTION</p>

<p class=Def1>No communication link was established. </p>

<p class=Term1>DPNERR_NOHOSTPLAYER</p>

<p class=Def1>There is currently no player acting as the host of the session.</p>

<p class=Term1>DPNERR_NOINTERFACE</p>

<p class=Def1>The interface is not supported. </p>

<p class=Term1>DPNERR_NORESPONSE</p>

<p class=Def1>There was no response from the specified target.</p>

<p class=Term1>DPNERR_NOTALLOWED</p>

<p class=Def1>The object is read-only; this function is not allowed on this
object.</p>

<p class=Term1>DPNERR_NOTHOST</p>

<p class=Def1>The client attempted to connect to a nonhost computer.
Additionally, this error value may be returned by a nonhost that tried to set
the application description.</p>

<p class=Term1>DPNERR_OUTOFMEMORY</p>

<p class=Def1>There is insufficient memory to perform the requested operation. </p>

<p class=Term1>DPNERR_PENDING</p>

<p class=Def1>Not an error, this return indicates that an asynchronous
operation has reached the point where it is successfully queued. </p>

<p class=Term1>DPNERR_PLAYERLOST</p>

<p class=Def1>A player has lost the connection to the session. </p>

<p class=Term1>DPNERR_SENDTOOLARGE</p>

<p class=Def1>The buffer was too large.</p>

<p class=Term1>DPNERR_SESSIONFULL</p>

<p class=Def1>The request to connect to the host or server failed because the
maximum number of players allotted for the session has been reached.</p>

<p class=Term1>DPNERR_TIMEDOUT</p>

<p class=Def1>The operation could not complete because it has timed out.</p>

<p class=Term1>DPNERR_UNINITIALIZED</p>

<p class=Def1>The requested object has not been initialized. </p>

<p class=Term1>DPNERR_UNSUPPORTED</p>

<p class=Def1>The function or feature is not available in this implementation
or on this service provider. </p>

<p class=Term1>DPNERR_USERCANCEL</p>

<p class=Def1>The user canceled the operation.</p>

<p class=Term1>&nbsp;</p>

<p class=Term1>DV_OK</p>

<p class=Def1>The request completed successfully. </p>

<p class=Term1>DV_FULLDUPLEX</p>

<p class=Def1>The sound card is capable of full-duplex operation.</p>

<p class=Term1>DV_HALFDUPLEX</p>

<p class=Def1>The sound card can be run only in half-duplex mode.</p>

<p class=Term1>DVERR_BUFFERTOOSMALL</p>

<p class=Def1>The supplied buffer is not large enough to contain the requested
data. </p>

<p class=Term1>DVERR_EXCEPTION</p>

<p class=Def1>An exception occurred when processing the request. </p>

<p class=Term1>DVERR_GENERIC</p>

<p class=Def1>An undefined error condition occurred. </p>

<p class=Term1>DVERR_INVALIDFLAGS</p>

<p class=Def1>The flags passed to this method are invalid. </p>

<p class=Term1>DVERR_INVALIDOBJECT</p>

<p class=Def1>The DirectPlay object pointer is invalid. </p>

<p class=Term1>DVERR_INVALIDPARAM</p>

<p class=Def1>One or more of the parameters passed to the method are invalid. </p>

<p class=Term1>DVERR_INVALIDPLAYER</p>

<p class=Def1>The player ID is not recognized as a valid player ID for this
game session. </p>

<p class=Term1>DVERR_INVALIDGROUP</p>

<p class=Def1>The group ID is not recognized as a valid group ID for this game
session. </p>

<p class=Term1>DVERR_INVALIDHANDLE</p>

<p class=Def1>The handle specified is invalid.</p>

<p class=Term1>DVERR_OUTOFMEMORY</p>

<p class=Def1>There is insufficient memory to perform the requested operation. </p>

<p class=Term1>DVERR_PENDING</p>

<p class=Def1>Not an error, this return indicates that an asynchronous
operation has reached the point where it is successfully queued. </p>

<p class=Term1>DVERR_NOTSUPPORTED</p>

<p class=Def1>The operation is not supported.</p>

<p class=Term1>DVERR_NOINTERFACE</p>

<p class=Def1>The specified interface is not supported. This error could
indicate that you are using an earlier version of DirectX that does not expose
the interface.</p>

<p class=Term1>DVERR_SESSIONLOST</p>

<p class=Def1>The transport has lost the connection to the session.</p>

<p class=Term1>DVERR_NOVOICESESSION</p>

<p class=Def1>The session specified is not a voice session.</p>

<p class=Term1>DVERR_CONNECTIONLOST</p>

<p class=Def1>The connection to the voice session has been lost.</p>

<p class=Term1>DVERR_NOTINITIALIZED</p>

<p class=Def1>The <b>DirectPlayVoiceClient8.Initialize</b> or <b>DirectPlayVoiceServer8.Initialize</b>
method must be called before calling this method.</p>

<p class=Term1>DVERR_CONNECTED</p>

<p class=Def1>The DirectPlay Voice object is connected.</p>

<p class=Term1>DVERR_NOTCONNECTED</p>

<p class=Def1>The DirectPlay Voice object is not connected.</p>

<p class=Term1>DVERR_CONNECTABORTING</p>

<p class=Def1>The connection is being disconnected.</p>

<p class=Term1>DVERR_NOTALLOWED</p>

<p class=Def1>The object does not have the permission to perform this
operation.</p>

<p class=Term1>DVERR_INVALIDTARGET</p>

<p class=Def1>The specified target is not a valid player ID or group ID for
this voice session.</p>

<p class=Term1>DVERR_TRANSPORTNOTHOST</p>

<p class=Def1>The object is not the host of the voice session.</p>

<p class=Term1>DVERR_COMPRESSIONNOTSUPPORTED</p>

<p class=Def1>The specified compression type is not supported on the local
computer.</p>

<p class=Term1>DVERR_ALREADYPENDING</p>

<p class=Def1>An asynchronous call of this type is already pending.</p>

<p class=Term1>DVERR_ALREADYINITIALIZED</p>

<p class=Def1>The object has already been initialized.</p>

<p class=Term1>DVERR_SOUNDINITFAILURE</p>

<p class=Def1>A failure was encountered initializing the sound card.</p>

<p class=Term1>DVERR_TIMEOUT</p>

<p class=Def1>The operation could not be performed in the specified time.</p>

<p class=Term1>DVERR_CONNECTABORTED</p>

<p class=Def1>The connect operation was canceled before it could be completed.</p>

<p class=Term1>DVERR_NO3DSOUND</p>

<p class=Def1>The local computer does not support 3-D sound.</p>

<p class=Term1>DVERR_ALREADYBUFFERED</p>

<p class=Def1>There is already a user buffer for the specified ID.</p>

<p class=Term1>DVERR_NOTBUFFERED</p>

<p class=Def1>There is no user buffer for the specified ID.</p>

<p class=Term1>DVERR_HOSTING</p>

<p class=Def1>The object is the host of the session.</p>

<p class=Term1>DVERR_NOTHOSTING</p>

<p class=Def1>The object is not the host of the session.</p>

<p class=Term1>DVERR_INVALIDDEVICE</p>

<p class=Def1>The specified device is invalid.</p>

<p class=Term1>DVERR_RECORDSYSTEMERROR</p>

<p class=Def1>An error in the recording system occurred.</p>

<p class=Term1>DVERR_PLAYBACKSYSTEMERROR</p>

<p class=Def1>An error in the playback system occurred.</p>

<p class=Term1>DVERR_SENDERROR</p>

<p class=Def1>An error occurred while sending data.</p>

<p class=Term1>DVERR_USERCANCEL</p>

<p class=Def1>The user canceled the operation.</p>

<p class=Term1>DVERR_UNKNOWN</p>

<p class=Def1>An unknown error occurred.</p>

<p class=Term1>DVERR_RUNSETUP</p>

<p class=Def1>The specified audio configuration has not been tested. Call the <b>DirectPlayVoiceTest8.CheckAudioSetup</b>
method.</p>

<p class=Term1>DVERR_INCOMPATIBLEVERSION</p>

<p class=Def1>The client connected to a voice session that is incompatible with
the host.</p>

<p class=Term1>DVERR_INITIALIZED</p>

<p class=Def1>The <b>Initialize</b> method failed because the object has
already been initialized.</p>

<p class=Term1>DVERR_INVALIDPOINTER</p>

<p class=Def1>The pointer specified is invalid.</p>

<p class=Term1>DVERR_NOTRANSPORT</p>

<p class=Def1>The specified object is not a valid transport.</p>

<p class=Term1>DVERR_NOCALLBACK</p>

<p class=Def1>This operation cannot be performed because no callback function
was specified.</p>

<p class=Term1>DVERR_TRANSPORTNOTINIT</p>

<p class=Def1>The specified transport is not yet initialized.</p>

<p class=Term1>DVERR_TRANSPORTNOSESSION</p>

<p class=Def1>The specified transport is valid but is not connected/hosting.</p>

<p class=Term1>DVERR_TRANSPORTNOPLAYER</p>

<p class=Def1>The specified transport is connected/hosting but no local player
exists.</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:6.0pt'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

<div><br clear=all>

<hr align=left size=1 width="33%">

<div id=ftn1>

<p class=MsoFootnoteText><a href="#_ftnref1" name="_ftn1" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address_dplay_vb</p>

</div>

<div id=ftn2>

<p class=MsoFootnoteText><a href="#_ftnref2" name="_ftn2" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.AddComponentLong_dplay_vb</p>

</div>

<div id=ftn3>

<p class=MsoFootnoteText><a href="#_ftnref3" name="_ftn3" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.AddComponentString_dplay_vb</p>

</div>

<div id=ftn4>

<p class=MsoFootnoteText><a href="#_ftnref4" name="_ftn4" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.BuildFromURL_dplay_vb</p>

</div>

<div id=ftn5>

<p class=MsoFootnoteText><a href="#_ftnref5" name="_ftn5" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.Clear_dplay_vb</p>

</div>

<div id=ftn6>

<p class=MsoFootnoteText><a href="#_ftnref6" name="_ftn6" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.Duplicate_dplay_vb</p>

</div>

<div id=ftn7>

<p class=MsoFootnoteText><a href="#_ftnref7" name="_ftn7" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetComponentLong_dplay_vb</p>

</div>

<div id=ftn8>

<p class=MsoFootnoteText><a href="#_ftnref8" name="_ftn8" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetComponentString_dplay_vb</p>

</div>

<div id=ftn9>

<p class=MsoFootnoteText><a href="#_ftnref9" name="_ftn9" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetDevice_dplay_vb</p>

</div>

<div id=ftn10>

<p class=MsoFootnoteText><a href="#_ftnref10" name="_ftn10" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetNumComponents_dplay_vb</p>

</div>

<div id=ftn11>

<p class=MsoFootnoteText><a href="#_ftnref11" name="_ftn11" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetSP_dplay_vb</p>

</div>

<div id=ftn12>

<p class=MsoFootnoteText><a href="#_ftnref12" name="_ftn12" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetURL_dplay_vb</p>

</div>

<div id=ftn13>

<p class=MsoFootnoteText><a href="#_ftnref13" name="_ftn13" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.GetUserData_dplay_vb</p>

</div>

<div id=ftn14>

<p class=MsoFootnoteText><a href="#_ftnref14" name="_ftn14" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.SetDevice_dplay_vb</p>

</div>

<div id=ftn15>

<p class=MsoFootnoteText><a href="#_ftnref15" name="_ftn15" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.SetEqual_dplay_vb</p>

</div>

<div id=ftn16>

<p class=MsoFootnoteText><a href="#_ftnref16" name="_ftn16" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.SetSP_dplay_vb</p>

</div>

<div id=ftn17>

<p class=MsoFootnoteText><a href="#_ftnref17" name="_ftn17" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Address.SetUserData_dplay_vb</p>

</div>

<div id=ftn18>

<p class=MsoFootnoteText><a href="#_ftnref18" name="_ftn18" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client_dplay_vb</p>

</div>

<div id=ftn19>

<p class=MsoFootnoteText><a href="#_ftnref19" name="_ftn19" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.CancelAsyncOperation_dplay_vb</p>

</div>

<div id=ftn20>

<p class=MsoFootnoteText><a href="#_ftnref20" name="_ftn20" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.Close_dplay_vb</p>

</div>

<div id=ftn21>

<p class=MsoFootnoteText><a href="#_ftnref21" name="_ftn21" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.Connect_dplay_vb</p>

</div>

<div id=ftn22>

<p class=MsoFootnoteText><a href="#_ftnref22" name="_ftn22" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.EnumHosts_dplay_vb</p>

</div>

<div id=ftn23>

<p class=MsoFootnoteText><a href="#_ftnref23" name="_ftn23" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetApplicationDesc_dplay_vb</p>

</div>

<div id=ftn24>

<p class=MsoFootnoteText><a href="#_ftnref24" name="_ftn24" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetCaps_dplay_vb</p>

</div>

<div id=ftn25>

<p class=MsoFootnoteText><a href="#_ftnref25" name="_ftn25" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetConnectionInfo_dplay_vb</p>

</div>

<div id=ftn26>

<p class=MsoFootnoteText><a href="#_ftnref26" name="_ftn26" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetCountServiceProviders_dplay_vb</p>

</div>

<div id=ftn27>

<p class=MsoFootnoteText><a href="#_ftnref27" name="_ftn27" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetSendQueueInfo_dplay_vb</p>

</div>

<div id=ftn28>

<p class=MsoFootnoteText><a href="#_ftnref28" name="_ftn28" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetServerAddress_dplay_vb</p>

</div>

<div id=ftn29>

<p class=MsoFootnoteText><a href="#_ftnref29" name="_ftn29" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetServerInfo_dplay_vb</p>

</div>

<div id=ftn30>

<p class=MsoFootnoteText><a href="#_ftnref30" name="_ftn30" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetServiceProvider_dplay_vb</p>

</div>

<div id=ftn31>

<p class=MsoFootnoteText><a href="#_ftnref31" name="_ftn31" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.GetSPCaps_dplay_vb</p>

</div>

<div id=ftn32>

<p class=MsoFootnoteText><a href="#_ftnref32" name="_ftn32" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.RegisterLobby_dplay_vb</p>

</div>

<div id=ftn33>

<p class=MsoFootnoteText><a href="#_ftnref33" name="_ftn33" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.RegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn34>

<p class=MsoFootnoteText><a href="#_ftnref34" name="_ftn34" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.Send_dplay_vb</p>

</div>

<div id=ftn35>

<p class=MsoFootnoteText><a href="#_ftnref35" name="_ftn35" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.SetCaps_dplay_vb</p>

</div>

<div id=ftn36>

<p class=MsoFootnoteText><a href="#_ftnref36" name="_ftn36" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.SetClientInfo_dplay_vb</p>

</div>

<div id=ftn37>

<p class=MsoFootnoteText><a href="#_ftnref37" name="_ftn37" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.SetSPCaps_dplay_vb</p>

</div>

<div id=ftn38>

<p class=MsoFootnoteText><a href="#_ftnref38" name="_ftn38" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Client.UnregisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn39>

<p class=MsoFootnoteText><a href="#_ftnref39" name="_ftn39" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event_dplay_vb</p>

</div>

<div id=ftn40>

<p class=MsoFootnoteText><a href="#_ftnref40" name="_ftn40" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.AddRemovePlayerGroup_dplay_vb</p>

</div>

<div id=ftn41>

<p class=MsoFootnoteText><a href="#_ftnref41" name="_ftn41" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.AppDesc_dplay_vb</p>

</div>

<div id=ftn42>

<p class=MsoFootnoteText><a href="#_ftnref42" name="_ftn42" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.AsyncOpComplete_dplay_vb</p>

</div>

<div id=ftn43>

<p class=MsoFootnoteText><a href="#_ftnref43" name="_ftn43" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.ConnectComplete_dplay_vb</p>

</div>

<div id=ftn44>

<p class=MsoFootnoteText><a href="#_ftnref44" name="_ftn44" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.CreateGroup_dplay_vb</p>

</div>

<div id=ftn45>

<p class=MsoFootnoteText><a href="#_ftnref45" name="_ftn45" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.CreatePlayer_dplay_vb</p>

</div>

<div id=ftn46>

<p class=MsoFootnoteText><a href="#_ftnref46" name="_ftn46" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.DestroyGroup_dplay_vb</p>

</div>

<div id=ftn47>

<p class=MsoFootnoteText><a href="#_ftnref47" name="_ftn47" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.DestroyPlayer_dplay_vb</p>

</div>

<div id=ftn48>

<p class=MsoFootnoteText><a href="#_ftnref48" name="_ftn48" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.EnumHostsQuery_dplay_vb</p>

</div>

<div id=ftn49>

<p class=MsoFootnoteText><a href="#_ftnref49" name="_ftn49" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.EnumHostsResponse_dplay_vb</p>

</div>

<div id=ftn50>

<p class=MsoFootnoteText><a href="#_ftnref50" name="_ftn50" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.HostMigrate_dplay_vb</p>

</div>

<div id=ftn51>

<p class=MsoFootnoteText><a href="#_ftnref51" name="_ftn51" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.IndicateConnect_dplay_vb</p>

</div>

<div id=ftn52>

<p class=MsoFootnoteText><a href="#_ftnref52" name="_ftn52" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.IndicateConnectAborted_dplay_vb</p>

</div>

<div id=ftn53>

<p class=MsoFootnoteText><a href="#_ftnref53" name="_ftn53" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.InfoNotify_dplay_vb</p>

</div>

<div id=ftn54>

<p class=MsoFootnoteText><a href="#_ftnref54" name="_ftn54" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.Receive_dplay_vb</p>

</div>

<div id=ftn55>

<p class=MsoFootnoteText><a href="#_ftnref55" name="_ftn55" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.SendComplete_dplay_vb</p>

</div>

<div id=ftn56>

<p class=MsoFootnoteText><a href="#_ftnref56" name="_ftn56" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Event.TerminateSession_dplay_vb</p>

</div>

<div id=ftn57>

<p class=MsoFootnoteText><a href="#_ftnref57" name="_ftn57" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication_dplay_vb</p>

</div>

<div id=ftn58>

<p class=MsoFootnoteText><a href="#_ftnref58" name="_ftn58" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.Close_dplay_vb</p>

</div>

<div id=ftn59>

<p class=MsoFootnoteText><a href="#_ftnref59" name="_ftn59" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.GetConnectionSettings_dplay_vb</p>

</div>

<div id=ftn60>

<p class=MsoFootnoteText><a href="#_ftnref60" name="_ftn60" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.RegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn61>

<p class=MsoFootnoteText><a href="#_ftnref61" name="_ftn61" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.RegisterProgram_dplay_vb</p>

</div>

<div id=ftn62>

<p class=MsoFootnoteText><a href="#_ftnref62" name="_ftn62" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.Send_dplay_vb</p>

</div>

<div id=ftn63>

<p class=MsoFootnoteText><a href="#_ftnref63" name="_ftn63" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.SetAppAvailable_dplay_vb</p>

</div>

<div id=ftn64>

<p class=MsoFootnoteText><a href="#_ftnref64" name="_ftn64" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.SetConnectionSettings_dplay_vb</p>

</div>

<div id=ftn65>

<p class=MsoFootnoteText><a href="#_ftnref65" name="_ftn65" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.UnRegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn66>

<p class=MsoFootnoteText><a href="#_ftnref66" name="_ftn66" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.UnRegisterProgram_dplay_vb</p>

</div>

<div id=ftn67>

<p class=MsoFootnoteText><a href="#_ftnref67" name="_ftn67" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbiedApplication.UpdateStatus_dplay_vb</p>

</div>

<div id=ftn68>

<p class=MsoFootnoteText><a href="#_ftnref68" name="_ftn68" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient_dplay_vb</p>

</div>

<div id=ftn69>

<p class=MsoFootnoteText><a href="#_ftnref69" name="_ftn69" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.Close_dplay_vb</p>

</div>

<div id=ftn70>

<p class=MsoFootnoteText><a href="#_ftnref70" name="_ftn70" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.ConnectApplication_dplay_vb</p>

</div>

<div id=ftn71>

<p class=MsoFootnoteText><a href="#_ftnref71" name="_ftn71" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.GetCountLocalPrograms_dplay_vb</p>

</div>

<div id=ftn72>

<p class=MsoFootnoteText><a href="#_ftnref72" name="_ftn72" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.GetLocalProgram_dplay_vb</p>

</div>

<div id=ftn73>

<p class=MsoFootnoteText><a href="#_ftnref73" name="_ftn73" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.RegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn74>

<p class=MsoFootnoteText><a href="#_ftnref74" name="_ftn74" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.ReleaseApplication_dplay_vb</p>

</div>

<div id=ftn75>

<p class=MsoFootnoteText><a href="#_ftnref75" name="_ftn75" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.Send_dplay_vb</p>

</div>

<div id=ftn76>

<p class=MsoFootnoteText><a href="#_ftnref76" name="_ftn76" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.SetConnectionSettings_dplay_vb</p>

</div>

<div id=ftn77>

<p class=MsoFootnoteText><a href="#_ftnref77" name="_ftn77" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyClient.UnRegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn78>

<p class=MsoFootnoteText><a href="#_ftnref78" name="_ftn78" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent_dplay_vb</p>

</div>

<div id=ftn79>

<p class=MsoFootnoteText><a href="#_ftnref79" name="_ftn79" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent.Connect_dplay_vb</p>

</div>

<div id=ftn80>

<p class=MsoFootnoteText><a href="#_ftnref80" name="_ftn80" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent.ConnectionSettings_dplay_vb</p>

</div>

<div id=ftn81>

<p class=MsoFootnoteText><a href="#_ftnref81" name="_ftn81" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent.Disconnect_dplay_vb</p>

</div>

<div id=ftn82>

<p class=MsoFootnoteText><a href="#_ftnref82" name="_ftn82" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent.Receive_dplay_vb</p>

</div>

<div id=ftn83>

<p class=MsoFootnoteText><a href="#_ftnref83" name="_ftn83" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8LobbyEvent.SessionStatus_dplay_vb</p>

</div>

<div id=ftn84>

<p class=MsoFootnoteText><a href="#_ftnref84" name="_ftn84" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer_dplay_vb</p>

</div>

<div id=ftn85>

<p class=MsoFootnoteText><a href="#_ftnref85" name="_ftn85" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.AddPlayerToGroup_dplay_vb</p>

</div>

<div id=ftn86>

<p class=MsoFootnoteText><a href="#_ftnref86" name="_ftn86" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.CancelAsyncOperation_dplay_vb</p>

</div>

<div id=ftn87>

<p class=MsoFootnoteText><a href="#_ftnref87" name="_ftn87" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.Close_dplay_vb</p>

</div>

<div id=ftn88>

<p class=MsoFootnoteText><a href="#_ftnref88" name="_ftn88" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.Connect_dplay_vb</p>

</div>

<div id=ftn89>

<p class=MsoFootnoteText><a href="#_ftnref89" name="_ftn89" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.CreateGroup_dplay_vb</p>

</div>

<div id=ftn90>

<p class=MsoFootnoteText><a href="#_ftnref90" name="_ftn90" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.DestroyPeer_dplay_vb</p>

</div>

<div id=ftn91>

<p class=MsoFootnoteText><a href="#_ftnref91" name="_ftn91" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.DestroyGroup_dplay_vb</p>

</div>

<div id=ftn92>

<p class=MsoFootnoteText><a href="#_ftnref92" name="_ftn92" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.EnumHosts_dplay_vb</p>

</div>

<div id=ftn93>

<p class=MsoFootnoteText><a href="#_ftnref93" name="_ftn93" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetApplicationDesc_dplay_vb</p>

</div>

<div id=ftn94>

<p class=MsoFootnoteText><a href="#_ftnref94" name="_ftn94" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetCaps_dplay_vb</p>

</div>

<div id=ftn95>

<p class=MsoFootnoteText><a href="#_ftnref95" name="_ftn95" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetPlayerOrGroup_dplay_vb</p>

</div>

<div id=ftn96>

<p class=MsoFootnoteText><a href="#_ftnref96" name="_ftn96" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetConnectionInfo_dplay_vb</p>

</div>

<div id=ftn97>

<p class=MsoFootnoteText><a href="#_ftnref97" name="_ftn97" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetCountClientsAndGroups_dplay_vb</p>

</div>

<div id=ftn98>

<p class=MsoFootnoteText><a href="#_ftnref98" name="_ftn98" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetCountGroupMembers_dplay_vb</p>

</div>

<div id=ftn99>

<p class=MsoFootnoteText><a href="#_ftnref99" name="_ftn99" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetCountServiceProviders_dplay_vb</p>

</div>

<div id=ftn100>

<p class=MsoFootnoteText><a href="#_ftnref100" name="_ftn100" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetEnumHostResponseAddress_dplay_vb</p>

</div>

<div id=ftn101>

<p class=MsoFootnoteText><a href="#_ftnref101" name="_ftn101" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetGroupInfo_dplay_vb</p>

</div>

<div id=ftn102>

<p class=MsoFootnoteText><a href="#_ftnref102" name="_ftn102" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetGroupMember_dplay_vb</p>

</div>

<div id=ftn103>

<p class=MsoFootnoteText><a href="#_ftnref103" name="_ftn103" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetPeerAddress_dplay_vb</p>

</div>

<div id=ftn104>

<p class=MsoFootnoteText><a href="#_ftnref104" name="_ftn104" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetPeerInfo_dplay_vb</p>

</div>

<div id=ftn105>

<p class=MsoFootnoteText><a href="#_ftnref105" name="_ftn105" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetSendQueueInfo_dplay_vb</p>

</div>

<div id=ftn106>

<p class=MsoFootnoteText><a href="#_ftnref106" name="_ftn106" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetServiceProvider_dplay_vb</p>

</div>

<div id=ftn107>

<p class=MsoFootnoteText><a href="#_ftnref107" name="_ftn107" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.GetSPCaps_dplay_vb</p>

</div>

<div id=ftn108>

<p class=MsoFootnoteText><a href="#_ftnref108" name="_ftn108" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.Host_dplay_vb</p>

</div>

<div id=ftn109>

<p class=MsoFootnoteText><a href="#_ftnref109" name="_ftn109" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.RegisterLobby_dplay_vb</p>

</div>

<div id=ftn110>

<p class=MsoFootnoteText><a href="#_ftnref110" name="_ftn110" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.RegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn111>

<p class=MsoFootnoteText><a href="#_ftnref111" name="_ftn111" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.RemovePlayerFromGroup_dplay_vb</p>

</div>

<div id=ftn112>

<p class=MsoFootnoteText><a href="#_ftnref112" name="_ftn112" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SendTo_dplay_vb</p>

</div>

<div id=ftn113>

<p class=MsoFootnoteText><a href="#_ftnref113" name="_ftn113" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SetApplicationDesc_dplay_vb</p>

</div>

<div id=ftn114>

<p class=MsoFootnoteText><a href="#_ftnref114" name="_ftn114" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SetCaps_dplay_vb</p>

</div>

<div id=ftn115>

<p class=MsoFootnoteText><a href="#_ftnref115" name="_ftn115" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SetGroupInfo_dplay_vb</p>

</div>

<div id=ftn116>

<p class=MsoFootnoteText><a href="#_ftnref116" name="_ftn116" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SetPeerInfo_dplay_vb</p>

</div>

<div id=ftn117>

<p class=MsoFootnoteText><a href="#_ftnref117" name="_ftn117" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.SetSPCaps_dplay_vb</p>

</div>

<div id=ftn118>

<p class=MsoFootnoteText><a href="#_ftnref118" name="_ftn118" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Peer.TerminateSession_dplay_vb</p>

</div>

<div id=ftn119>

<p class=MsoFootnoteText><a href="#_ftnref119" name="_ftn119" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server_dplay_vb</p>

</div>

<div id=ftn120>

<p class=MsoFootnoteText><a href="#_ftnref120" name="_ftn120" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.AddClientToGroup_dplay_vb</p>

</div>

<div id=ftn121>

<p class=MsoFootnoteText><a href="#_ftnref121" name="_ftn121" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.CancelAsyncOperation_dplay_vb</p>

</div>

<div id=ftn122>

<p class=MsoFootnoteText><a href="#_ftnref122" name="_ftn122" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.Close_dplay_vb</p>

</div>

<div id=ftn123>

<p class=MsoFootnoteText><a href="#_ftnref123" name="_ftn123" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.CreateGroup_dplay_vb</p>

</div>

<div id=ftn124>

<p class=MsoFootnoteText><a href="#_ftnref124" name="_ftn124" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.DestroyClient_dplay_vb</p>

</div>

<div id=ftn125>

<p class=MsoFootnoteText><a href="#_ftnref125" name="_ftn125" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.DestroyGroup_dplay_vb</p>

</div>

<div id=ftn126>

<p class=MsoFootnoteText><a href="#_ftnref126" name="_ftn126" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetApplicationDesc_dplay_vb</p>

</div>

<div id=ftn127>

<p class=MsoFootnoteText><a href="#_ftnref127" name="_ftn127" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetCaps_dplay_vb</p>

</div>

<div id=ftn128>

<p class=MsoFootnoteText><a href="#_ftnref128" name="_ftn128" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetClientAddress_dplay_vb</p>

</div>

<div id=ftn129>

<p class=MsoFootnoteText><a href="#_ftnref129" name="_ftn129" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetClientInfo_dplay_vb</p>

</div>

<div id=ftn130>

<p class=MsoFootnoteText><a href="#_ftnref130" name="_ftn130" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetClientOrGroup_dplay_vb</p>

</div>

<div id=ftn131>

<p class=MsoFootnoteText><a href="#_ftnref131" name="_ftn131" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetConnectionInfo_dplay_vb</p>

</div>

<div id=ftn132>

<p class=MsoFootnoteText><a href="#_ftnref132" name="_ftn132" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetCountClientsAndGroups_dplay_vb</p>

</div>

<div id=ftn133>

<p class=MsoFootnoteText><a href="#_ftnref133" name="_ftn133" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetCountGroupMembers_dplay_vb</p>

</div>

<div id=ftn134>

<p class=MsoFootnoteText><a href="#_ftnref134" name="_ftn134" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetCountServiceProviders_dplay_vb</p>

</div>

<div id=ftn135>

<p class=MsoFootnoteText><a href="#_ftnref135" name="_ftn135" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetGroupInfo_dplay_vb</p>

</div>

<div id=ftn136>

<p class=MsoFootnoteText><a href="#_ftnref136" name="_ftn136" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetGroupMember_dplay_vb</p>

</div>

<div id=ftn137>

<p class=MsoFootnoteText><a href="#_ftnref137" name="_ftn137" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetSendQueueInfo_dplay_vb</p>

</div>

<div id=ftn138>

<p class=MsoFootnoteText><a href="#_ftnref138" name="_ftn138" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetServiceProvider_dplay_vb</p>

</div>

<div id=ftn139>

<p class=MsoFootnoteText><a href="#_ftnref139" name="_ftn139" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.GetSPCaps_dplay_vb</p>

</div>

<div id=ftn140>

<p class=MsoFootnoteText><a href="#_ftnref140" name="_ftn140" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.Host_dplay_vb</p>

</div>

<div id=ftn141>

<p class=MsoFootnoteText><a href="#_ftnref141" name="_ftn141" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.RegisterLobby_dplay_vb</p>

</div>

<div id=ftn142>

<p class=MsoFootnoteText><a href="#_ftnref142" name="_ftn142" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.RegisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn143>

<p class=MsoFootnoteText><a href="#_ftnref143" name="_ftn143" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.RemoveClientFromGroup_dplay_vb</p>

</div>

<div id=ftn144>

<p class=MsoFootnoteText><a href="#_ftnref144" name="_ftn144" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SendTo_dplay_vb</p>

</div>

<div id=ftn145>

<p class=MsoFootnoteText><a href="#_ftnref145" name="_ftn145" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SetApplicationDesc_dplay_vb</p>

</div>

<div id=ftn146>

<p class=MsoFootnoteText><a href="#_ftnref146" name="_ftn146" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SetCaps_dplay_vb</p>

</div>

<div id=ftn147>

<p class=MsoFootnoteText><a href="#_ftnref147" name="_ftn147" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SetGroupInfo_dplay_vb</p>

</div>

<div id=ftn148>

<p class=MsoFootnoteText><a href="#_ftnref148" name="_ftn148" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SetServerInfo_dplay_vb</p>

</div>

<div id=ftn149>

<p class=MsoFootnoteText><a href="#_ftnref149" name="_ftn149" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlay8Server.SetSPCaps_dplay_vb</p>

</div>

<div id=ftn150>

<p class=MsoFootnoteText><a href="#_ftnref150" name="_ftn150" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8_dplay_vb</p>

</div>

<div id=ftn151>

<p class=MsoFootnoteText><a href="#_ftnref151" name="_ftn151" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.Connect_dplay_vb</p>

</div>

<div id=ftn152>

<p class=MsoFootnoteText><a href="#_ftnref152" name="_ftn152" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.Create3DSoundBuffer_dplay_vb</p>

</div>

<div id=ftn153>

<p class=MsoFootnoteText><a href="#_ftnref153" name="_ftn153" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.Delete3DSoundBuffer_dplay_vb</p>

</div>

<div id=ftn154>

<p class=MsoFootnoteText><a href="#_ftnref154" name="_ftn154" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.Disconnect_dplay_vb</p>

</div>

<div id=ftn155>

<p class=MsoFootnoteText><a href="#_ftnref155" name="_ftn155" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetCaps_dplay_vb</p>

</div>

<div id=ftn156>

<p class=MsoFootnoteText><a href="#_ftnref156" name="_ftn156" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetClientConfig_dplay_vb</p>

</div>

<div id=ftn157>

<p class=MsoFootnoteText><a href="#_ftnref157" name="_ftn157" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetCompressionType_dplay_vb</p>

</div>

<div id=ftn158>

<p class=MsoFootnoteText><a href="#_ftnref158" name="_ftn158" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetCompressionTypeCount_dplay_vb</p>

</div>

<div id=ftn159>

<p class=MsoFootnoteText><a href="#_ftnref159" name="_ftn159" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetSessionDesc_dplay_vb</p>

</div>

<div id=ftn160>

<p class=MsoFootnoteText><a href="#_ftnref160" name="_ftn160" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetSoundDeviceConfig_dplay_vb</p>

</div>

<div id=ftn161>

<p class=MsoFootnoteText><a href="#_ftnref161" name="_ftn161" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetSoundDevices_dplay_vb</p>

</div>

<div id=ftn162>

<p class=MsoFootnoteText><a href="#_ftnref162" name="_ftn162" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.GetTransmitTargets_dplay_vb</p>

</div>

<div id=ftn163>

<p class=MsoFootnoteText><a href="#_ftnref163" name="_ftn163" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.Initialize_dplay_vb</p>

</div>

<div id=ftn164>

<p class=MsoFootnoteText><a href="#_ftnref164" name="_ftn164" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.SetClientConfig_dplay_vb</p>

</div>

<div id=ftn165>

<p class=MsoFootnoteText><a href="#_ftnref165" name="_ftn165" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.SetCurrentSoundDevices_dplay_vb</p>

</div>

<div id=ftn166>

<p class=MsoFootnoteText><a href="#_ftnref166" name="_ftn166" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.SetTransmitTargets_dplay_vb</p>

</div>

<div id=ftn167>

<p class=MsoFootnoteText><a href="#_ftnref167" name="_ftn167" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.StartClientNotification_dplay_vb</p>

</div>

<div id=ftn168>

<p class=MsoFootnoteText><a href="#_ftnref168" name="_ftn168" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceClient8.UnregisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn169>

<p class=MsoFootnoteText><a href="#_ftnref169" name="_ftn169" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8_dplay_vb</p>

</div>

<div id=ftn170>

<p class=MsoFootnoteText><a href="#_ftnref170" name="_ftn170" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.ConnectResult_dplay_vb</p>

</div>

<div id=ftn171>

<p class=MsoFootnoteText><a href="#_ftnref171" name="_ftn171" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.CreateVoicePlayer_dplay_vb</p>

</div>

<div id=ftn172>

<p class=MsoFootnoteText><a href="#_ftnref172" name="_ftn172" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.DeleteVoicePlayer_dplay_vb</p>

</div>

<div id=ftn173>

<p class=MsoFootnoteText><a href="#_ftnref173" name="_ftn173" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.DisconnectResult_dplay_vb</p>

</div>

<div id=ftn174>

<p class=MsoFootnoteText><a href="#_ftnref174" name="_ftn174" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.HostMigrated_dplay_vb</p>

</div>

<div id=ftn175>

<p class=MsoFootnoteText><a href="#_ftnref175" name="_ftn175" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.InputLevel_dplay_vb</p>

</div>

<div id=ftn176>

<p class=MsoFootnoteText><a href="#_ftnref176" name="_ftn176" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.OutputLevel_dplay_vb</p>

</div>

<div id=ftn177>

<p class=MsoFootnoteText><a href="#_ftnref177" name="_ftn177" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.PlayerOutputLevel_dplay_vb</p>

</div>

<div id=ftn178>

<p class=MsoFootnoteText><a href="#_ftnref178" name="_ftn178" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.PlayerVoiceStart_dplay_vb</p>

</div>

<div id=ftn179>

<p class=MsoFootnoteText><a href="#_ftnref179" name="_ftn179" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.PlayerVoiceStop_dplay_vb</p>

</div>

<div id=ftn180>

<p class=MsoFootnoteText><a href="#_ftnref180" name="_ftn180" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.RecordStart_dplay_vb</p>

</div>

<div id=ftn181>

<p class=MsoFootnoteText><a href="#_ftnref181" name="_ftn181" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.RecordStop_dplay_vb</p>

</div>

<div id=ftn182>

<p class=MsoFootnoteText><a href="#_ftnref182" name="_ftn182" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceEvent8.SessionLost_dplay_vb</p>

</div>

<div id=ftn183>

<p class=MsoFootnoteText><a href="#_ftnref183" name="_ftn183" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8_dplay_vb</p>

</div>

<div id=ftn184>

<p class=MsoFootnoteText><a href="#_ftnref184" name="_ftn184" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.GetCaps_dplay_vb</p>

</div>

<div id=ftn185>

<p class=MsoFootnoteText><a href="#_ftnref185" name="_ftn185" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.GetCompressionType_dplay_vb</p>

</div>

<div id=ftn186>

<p class=MsoFootnoteText><a href="#_ftnref186" name="_ftn186" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.GetCompressionTypeCount_dplay_vb</p>

</div>

<div id=ftn187>

<p class=MsoFootnoteText><a href="#_ftnref187" name="_ftn187" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.GetSessionDesc_dplay_vb</p>

</div>

<div id=ftn188>

<p class=MsoFootnoteText><a href="#_ftnref188" name="_ftn188" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.GetTransmitTargets_dplay_vb</p>

</div>

<div id=ftn189>

<p class=MsoFootnoteText><a href="#_ftnref189" name="_ftn189" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.Initialize_dplay_vb</p>

</div>

<div id=ftn190>

<p class=MsoFootnoteText><a href="#_ftnref190" name="_ftn190" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.SetSessionDesc_dplay_vb</p>

</div>

<div id=ftn191>

<p class=MsoFootnoteText><a href="#_ftnref191" name="_ftn191" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.SetTransmitTargets_dplay_vb</p>

</div>

<div id=ftn192>

<p class=MsoFootnoteText><a href="#_ftnref192" name="_ftn192" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.StartServerNotification_dplay_vb</p>

</div>

<div id=ftn193>

<p class=MsoFootnoteText><a href="#_ftnref193" name="_ftn193" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.StartSession_dplay_vb</p>

</div>

<div id=ftn194>

<p class=MsoFootnoteText><a href="#_ftnref194" name="_ftn194" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.StopSession_dplay_vb</p>

</div>

<div id=ftn195>

<p class=MsoFootnoteText><a href="#_ftnref195" name="_ftn195" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceServer8.UnregisterMessageHandler_dplay_vb</p>

</div>

<div id=ftn196>

<p class=MsoFootnoteText><a href="#_ftnref196" name="_ftn196" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceTest8_dplay_vb</p>

</div>

<div id=ftn197>

<p class=MsoFootnoteText><a href="#_ftnref197" name="_ftn197" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DirectPlayVoiceTest8.CheckAudioSetup_dplay_vb</p>

</div>

<div id=ftn198>

<p class=MsoFootnoteText><a href="#_ftnref198" name="_ftn198" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_AddDataToBuffer_dplay_vb</p>

</div>

<div id=ftn199>

<p class=MsoFootnoteText><a href="#_ftnref199" name="_ftn199" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_AddStringToBuffer_dplay_vb</p>

</div>

<div id=ftn200>

<p class=MsoFootnoteText><a href="#_ftnref200" name="_ftn200" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_GetDataFromBuffer_dplay_vb</p>

</div>

<div id=ftn201>

<p class=MsoFootnoteText><a href="#_ftnref201" name="_ftn201" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_GetStringFromBuffer_dplay_vb</p>

</div>

<div id=ftn202>

<p class=MsoFootnoteText><a href="#_ftnref202" name="_ftn202" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_NewBuffer_dplay_vb</p>

</div>

<div id=ftn203>

<p class=MsoFootnoteText><a href="#_ftnref203" name="_ftn203" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_APPLICATION_INFO_dplay_vb</p>

</div>

<div id=ftn204>

<p class=MsoFootnoteText><a href="#_ftnref204" name="_ftn204" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_CONNECT_INFO_dplay_vb</p>

</div>

<div id=ftn205>

<p class=MsoFootnoteText><a href="#_ftnref205" name="_ftn205" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_CONNECTION_SETTINGS_dplay_vb</p>

</div>

<div id=ftn206>

<p class=MsoFootnoteText><a href="#_ftnref206" name="_ftn206" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_MESSAGE_CONNECT_dplay_vb</p>

</div>

<div id=ftn207>

<p class=MsoFootnoteText><a href="#_ftnref207" name="_ftn207" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_MESSAGE_CONNECTION_SETTINGS_dplay_vb</p>

</div>

<div id=ftn208>

<p class=MsoFootnoteText><a href="#_ftnref208" name="_ftn208" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_MESSAGE_RECEIVE_dplay_vb</p>

</div>

<div id=ftn209>

<p class=MsoFootnoteText><a href="#_ftnref209" name="_ftn209" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPL_PROGRAM_DESC_dplay_vb</p>

</div>

<div id=ftn210>

<p class=MsoFootnoteText><a href="#_ftnref210" name="_ftn210" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_APPLICATION_DESC_dplay_vb</p>

</div>

<div id=ftn211>

<p class=MsoFootnoteText><a href="#_ftnref211" name="_ftn211" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_CAPS_dplay_vb</p>

</div>

<div id=ftn212>

<p class=MsoFootnoteText><a href="#_ftnref212" name="_ftn212" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_CONNECTION_INFO_dplay_vb</p>

</div>

<div id=ftn213>

<p class=MsoFootnoteText><a href="#_ftnref213" name="_ftn213" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_GROUP_INFO_dplay_vb</p>

</div>

<div id=ftn214>

<p class=MsoFootnoteText><a href="#_ftnref214" name="_ftn214" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_PLAYER_INFO_dplay_vb</p>

</div>

<div id=ftn215>

<p class=MsoFootnoteText><a href="#_ftnref215" name="_ftn215" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_SERVICE_PROVIDER_INFO_dplay_vb</p>

</div>

<div id=ftn216>

<p class=MsoFootnoteText><a href="#_ftnref216" name="_ftn216" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPN_SP_CAPS_dplay_vb</p>

</div>

<div id=ftn217>

<p class=MsoFootnoteText><a href="#_ftnref217" name="_ftn217" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_ASYNC_OP_COMPLETE_dplay_vb</p>

</div>

<div id=ftn218>

<p class=MsoFootnoteText><a href="#_ftnref218" name="_ftn218" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_CONNECT_COMPLETE_dplay_vb</p>

</div>

<div id=ftn219>

<p class=MsoFootnoteText><a href="#_ftnref219" name="_ftn219" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_ENUM_HOSTS_QUERY_dplay_vb</p>

</div>

<div id=ftn220>

<p class=MsoFootnoteText><a href="#_ftnref220" name="_ftn220" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_ENUM_HOSTS_RESPONSE_dplay_vb</p>

</div>

<div id=ftn221>

<p class=MsoFootnoteText><a href="#_ftnref221" name="_ftn221" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_INDICATE_CONNECT_dplay_vb</p>

</div>

<div id=ftn222>

<p class=MsoFootnoteText><a href="#_ftnref222" name="_ftn222" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_RECEIVE_dplay_vb</p>

</div>

<div id=ftn223>

<p class=MsoFootnoteText><a href="#_ftnref223" name="_ftn223" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_SEND_COMPLETE_dplay_vb</p>

</div>

<div id=ftn224>

<p class=MsoFootnoteText><a href="#_ftnref224" name="_ftn224" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DPNMSG_TERMINATE_SESSION_dplay_vb</p>

</div>

<div id=ftn225>

<p class=MsoFootnoteText><a href="#_ftnref225" name="_ftn225" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DVCAPS_dplay_vb</p>

</div>

<div id=ftn226>

<p class=MsoFootnoteText><a href="#_ftnref226" name="_ftn226" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DVCLIENTCONFIG_dplay_vb</p>

</div>

<div id=ftn227>

<p class=MsoFootnoteText><a href="#_ftnref227" name="_ftn227" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DVCOMPRESSIONINFO_dplay_vb</p>

</div>

<div id=ftn228>

<p class=MsoFootnoteText><a href="#_ftnref228" name="_ftn228" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DVSESSIONDESC_dplay_vb</p>

</div>

<div id=ftn229>

<p class=MsoFootnoteText><a href="#_ftnref229" name="_ftn229" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_DVSOUNDDEVICECONFIG_dplay_vb</p>

</div>

<div id=ftn230>

<p class=MsoFootnoteText><a href="#_ftnref230" name="_ftn230" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPLAYBUFSIZE_dplay_vb</p>

</div>

<div id=ftn231>

<p class=MsoFootnoteText><a href="#_ftnref231" name="_ftn231" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPLCONNECT_dplay_vb</p>

</div>

<div id=ftn232>

<p class=MsoFootnoteText><a href="#_ftnref232" name="_ftn232" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_CONNECTSETTINGS_dplay_vb</p>

</div>

<div id=ftn233>

<p class=MsoFootnoteText><a href="#_ftnref233" name="_ftn233" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPLSESSION_dplay_vb</p>

</div>

<div id=ftn234>

<p class=MsoFootnoteText><a href="#_ftnref234" name="_ftn234" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNCANCELFLAGS_dplay_vb</p>

</div>

<div id=ftn235>

<p class=MsoFootnoteText><a href="#_ftnref235" name="_ftn235" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNENUMCLIENTGROUPFLAGS_dplay_vb</p>

</div>

<div id=ftn236>

<p class=MsoFootnoteText><a href="#_ftnref236" name="_ftn236" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNERR_dplay_vb</p>

</div>

<div id=ftn237>

<p class=MsoFootnoteText><a href="#_ftnref237" name="_ftn237" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNGROUPINFOFLAGS_dplay_vb</p>

</div>

<div id=ftn238>

<p class=MsoFootnoteText><a href="#_ftnref238" name="_ftn238" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNINFO_dplay_vb</p>

</div>

<div id=ftn239>

<p class=MsoFootnoteText><a href="#_ftnref239" name="_ftn239" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNLOBBY_dplay_vb</p>

</div>

<div id=ftn240>

<p class=MsoFootnoteText><a href="#_ftnref240" name="_ftn240" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNMESSAGEID_dplay_vb</p>

</div>

<div id=ftn241>

<p class=MsoFootnoteText><a href="#_ftnref241" name="_ftn241" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNOPERATIONS_dplay_vb</p>

</div>

<div id=ftn242>

<p class=MsoFootnoteText><a href="#_ftnref242" name="_ftn242" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNPLAYERGROUPFLAGS_dplay_vb</p>

</div>

<div id=ftn243>

<p class=MsoFootnoteText><a href="#_ftnref243" name="_ftn243" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNPLAYINFOFLAGS_dplay_vb</p>

</div>

<div id=ftn244>

<p class=MsoFootnoteText><a href="#_ftnref244" name="_ftn244" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNSENDFLAGS_dplay_vb</p>

</div>

<div id=ftn245>

<p class=MsoFootnoteText><a href="#_ftnref245" name="_ftn245" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNGETSENDQUEUEINFO_dplay_vb</p>

</div>

<div id=ftn246>

<p class=MsoFootnoteText><a href="#_ftnref246" name="_ftn246" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNSESSIONFLAGS_dplay_vb</p>

</div>

<div id=ftn247>

<p class=MsoFootnoteText><a href="#_ftnref247" name="_ftn247" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNSPCAPS_dplay_vb</p>

</div>

<div id=ftn248>

<p class=MsoFootnoteText><a href="#_ftnref248" name="_ftn248" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DPNWAITTIME_dplay_vb</p>

</div>

<div id=ftn249>

<p class=MsoFootnoteText><a href="#_ftnref249" name="_ftn249" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVBUFFERAGGRESSIVENESS_dplay_vb</p>

</div>

<div id=ftn250>

<p class=MsoFootnoteText><a href="#_ftnref250" name="_ftn250" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVBUFFERQUALITY_dplay_vb</p>

</div>

<div id=ftn251>

<p class=MsoFootnoteText><a href="#_ftnref251" name="_ftn251" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVCLIENTCONFIGENUM_dplay_vb</p>

</div>

<div id=ftn252>

<p class=MsoFootnoteText><a href="#_ftnref252" name="_ftn252" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVERR_dplay_vb</p>

</div>

<div id=ftn253>

<p class=MsoFootnoteText><a href="#_ftnref253" name="_ftn253" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVFLAGS_dplay_vb</p>

</div>

<div id=ftn254>

<p class=MsoFootnoteText><a href="#_ftnref254" name="_ftn254" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVMESSAGE_dplay_vb</p>

</div>

<div id=ftn255>

<p class=MsoFootnoteText><a href="#_ftnref255" name="_ftn255" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVNOTIFY_dplay_vb</p>

</div>

<div id=ftn256>

<p class=MsoFootnoteText><a href="#_ftnref256" name="_ftn256" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVPLAYBACKVOLUME_dplay_vb</p>

</div>

<div id=ftn257>

<p class=MsoFootnoteText><a href="#_ftnref257" name="_ftn257" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVSESSION_dplay_vb</p>

</div>

<div id=ftn258>

<p class=MsoFootnoteText><a href="#_ftnref258" name="_ftn258" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVSESSIONTYPE_dplay_vb</p>

</div>

<div id=ftn259>

<p class=MsoFootnoteText><a href="#_ftnref259" name="_ftn259" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVSOUNDEFFECT_dplay_vb</p>

</div>

<div id=ftn260>

<p class=MsoFootnoteText><a href="#_ftnref260" name="_ftn260" title=""><span
class=MsoFootnoteReference><span style='font-size:8.0pt'>#</span></span></a>
IDH_CONST_DVTHRESHOLD_dplay_vb</p>

</div>

</div>

</body>

</html>
