<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>Legal Information</title>
<link disabled rel=stylesheet href=mk:@MSITStore:C:\Program Files (x86)\Microsoft Visual Studio\MSDN98\98VSa\1033\dsmsdn.chm::/../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msi_legal_information"></a>Legal Information</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h1>Windows Installer Programmer's Reference</h1>
<p>
This is a preliminary document and may be changed substantially prior to final commercial release. This document is provided for informational purposes only and Microsoft makes no warranties, either express or implied, in this document. Information in this document is subject to change without notice. The entire risk of the use or the results of the use of this document remains with the user. The names of companies, products, people, characters, and/or data mentioned herein are fictitious and are in no way intended to represent any real individual, company, product, or event, unless otherwise noted. Complying with all applicable copyright laws is the responsibility of the user. No part of this document may be reproduced or transmitted in any form or by any means, electronic or mechanical, for any purpose, without the express written permission of Microsoft Corporation. </p>
<p>
Portions of this document specify and accompany software that is still in development. Some of the information in this documentation may be inaccurate or may not be an accurate representation of the functionality of final documentation or software. Microsoft assumes no responsibility for any damages that might occur directly or indirectly from these inaccuracies.</p>
<p>
Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document.  Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.</p>
<p>
  1985-1998 Microsoft Corporation. All rights reserved.</p>
<p>
ActiveX, BackOffice, DirectX, JScript, Microsoft, Microsoft Press, MS, MS-DOS, MSDN, Visual Basic, Visual C++, Windows, Win32, Win32s, and Windows NT are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries. OS/2 is a registered trademark licensed to Microsoft Corporation.</p>
<p>
Other product and company names mentioned herein may be the trademarks of their respective owners.</p>
<p>&nbsp;</p>

<h1><a name="_msi_roadmap_to_installer_technology_documentation"></a>Roadmap to Windows Installer Documentation</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Microsoft<font face="Symbol"> </font> Windows  installer documentation contains general sections that provide useful information to all developers as well as sections that apply to particular tasks and audiences. To help you find the information you need, the following list describes each section of the installer documentation:
<ul>
<li>
<a href="over_2fjm.htm">About Windows Installer</a> contains high-level information useful to all developers. </li>
<li>
<a href="over_6qb6.htm">Using Windows Installer</a> contains a sample application and procedures that use the installer service functions. </li>
<li>
<a href="msi_8vqd.htm">Installer Function Reference</a> contains reference material for the installer service functions. These functions access an installer package to install and manage an application. </li>
<li>
<a href="novr_0q0e.htm">Installer Package Programmer's Reference</a> contains overview and reference material for developers who create or modify an installer package. This section is primarily for developers writing tools to create packages for application developers using the new installer. The information is also useful for application developers and administrators who want to modify the installer package and installation process through custom actions.</li>
</ul>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_about_windows_installer"></a>About Windows Installer</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To install your applications efficiently and reduce the total cost of ownership (TCO) for your customers, you can use the Microsoft  Windows  installer. The topics in this section cover the major areas of functionality of the installer, such as:
<ul>
<li>
<a href="over_4p7y.htm">Just-In-Time installation</a></li>
<li>
<a href="over_4ucz.htm">Advertising applications and features</a></li>
<li>
<a href="over_8p83.htm">Components and features</a></li>
<li>
<a href="over_2ysz.htm">Merges and transforms</a></li>
<li>
<a href="over_9jjh.htm">Installation mechanism</a></li>
</ul>
<p>
For procedures and a sample application that use installer functions, see <a href="over_6qb6.htm">Using Windows Installer</a>. </p>
<p>&nbsp;</p>

<h1><a name="_msi_just_in_time_installation"></a>Just-In-Time Installation</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
With traditional installation technology, it was necessary to exit an application and rerun setup to perform an installation task. This commonly occurred whenever a user wanted a feature or product they had not chosen during the first run of setup. This often made the process of product configuration inefficient because it required the user to anticipate which functionality they required <i>before</i> they ever used the product.</p>
<p>
Just-in-time installation makes it possible to offer functionality to users and applications in the absence of the files themselves. This notion is known as <a href="dglo_2yyh.htm#_msi_advertise_gly">advertising</a>. The Microsoft  Windows  installer has the capability of advertising functionality and to make just-in-time installations of application features or entire products. Whenever a user or application activates an advertised feature or product the installer proceeds with an installation of the needed components. This speeds up and shortens the configuration process because additional functionality can be accessed without having to exit and rerun another setup procedure. </p>
<p>
When a product uses the installer, a user can choose at setup time which features or applications to install and which to advertise. Then if while running an application the user requests an advertised feature that has not yet been installed, the application will call the installer to enact a just-in-time <a href="over_7226.htm">feature level installation</a> of the necessary files. If the user activates an advertised product that has not yet been installed, the operating system will call the installer to enact a just-in-time <a href="over_1e7i.htm">product level installation</a>.</p>
<p>
For more information about how the installer enacts product and feature level installations see the section <a href="over_4ucz.htm">Advertising Applications and Features</a>.</p>
<p>
Advertisement and just-in-time installation can also facilitate <a href="over_0d84.htm">system management</a> by enabling administrators to designate applications as required or optional for different groups of users. There are two types of advertising known as 'assigning' and 'publishing.' If an administrator assigns an application to a group, then these users can install the application on demand. If however the administrator publishes the application to the group, no entry points will appear to these users and a just-in-time installation will only be activated if another application activates the published application.</p>
<p>
For more information about the two types of advertising see the section <a href="over_5lgn.htm">Assigning and Publishing</a>.</p>
<p>
For information on starting an application for the first time, see <a href="over_392m.htm">Initializing An Application</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_advertising_applications_and_features"></a>Advertising Applications and Features</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Microsoft  Windows  installer supports advertising of applications and features. Advertising is a mechanism whereby an application that is not installed can however be accessed as though it were installed. Only the registry entries and other necessary information are placed on the local computer. When a user activates an advertised application the installer automatically installs the necessary components as described in <a href="over_4p7y.htm">Just-In-Time Installation</a>. </p>
<p>
The installer can access an advertised feature of an installed product without the support of the user's operating system by enacting a <a href="over_7226.htm">feature level installation</a>. The installer however does require the support of the operating system to access an advertised product that has not yet been installed, and in this case the installer must enact a <a href="over_1e7i.htm">product level installation</a>.</p>
<p>
There are two types of advertising known as 'assigning' and 'publishing.' Assigning an application populates the user interface and the application appears essentially installed to the user. Publishing, by contrast, does not populate the user interface. Another application on the user's machine however can activate the published application. The distinction between assigning and publishing is a central part of the installer's capability to enhance <a href="over_0d84.htm">system management</a>. For more information about the two types of advertising see the section <a href="over_5lgn.htm">Assigning and Publishing</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_feature_level_installation"></a>Feature Level Installation</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/over3.gif" border=0></p>
<p>
The figure above illustrates a feature level install that is enacted when a user requests the advertised functionality of an installed application. Because the application is installed it can call the installer's API on the user's behalf and have the requested feature installed. The installer then queries the system to return the current state of the feature. Finally, the installer installs of any missing components required by the feature and returns a path to the components back to the application. </p>
<p>&nbsp;</p>

<h2><a name="_msi_product_level_installation"></a>Product Level Installation</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/over4.gif" border=0></p>
<p>
The figure above illustrates the interaction between the operating system, the installer service, and an uninstalled advertised product during a product level installation. Because an uninstalled product cannot call the installer itself, the installation of the product requires that the operating system employ the installer's API. It is therefore possible to advertise an entire product when using the installer with Windows NT 5.0 because both OLE and the Shell make use of the installer's API. As illustrated in the figure, when a user activates the advertised product from an entry point the operating system calls the installer to install the product. After the installation is completed the installer returns a path to the now installed product back to the operating system which then launches the application.</p>
<p>
Product level installation is a central part of the installer's capability of supporting <a href="over_0d84.htm">system management</a> by using <a href="over_5lgn.htm">assigning and publishing</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_assigning_and_publishing"></a>Assigning and Publishing</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The two types of advertising are assigning and publishing. An application appears installed to a user when that application is assigned to the user. That is, the <b>Start</b> menu contains the appropriate shortcuts, icons are present, files are associated with the application, and registry entries reflect the application's installation. When the user tries to open an assigned application, it is installed as described in <a href="over_4p7y.htm">Just-In-Time Installation</a>.</p>
<p>
Publishing, by contrast, does not populate the user interface. However, if another application attempts to open the published application there is enough information present to install the application. A published application can also be opened through its file association or Multipurpose Internet Mail Extension (MIME) type. A user could also start the installation on demand by using a list of published applications that has been authored into the installer package.</p>
<p>
Assigning and publishing enables an administrator to make applications required or optional to different groups of users. Published applications do not overwrite file associations of assigned applications, so optional applications do not interfere with required applications. This is a central part of how the installer can be used to improve <a href="over_0d84.htm">system management</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_system_management"></a>System Management</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A number of system management benefits result from applications using the installer. </p>
<p>
An administrator can use the installer to tailor an installation to the user's specific needs. Only those features that are useful for a group of users need to be available in the user interface. These features can be upgraded by the administrator without the user's intervention or knowledge.</p>
<p>
The management API enables the installer to manage all file paths on behalf of a product or application. An application using the installer can ask the service for a path to a given component at runtime. This frees applications from dependency on static file paths which often change between machines and can sometimes point to missing files.</p>
<p>
An application using the installer can populate its user interface with features that are run locally or from the source with little or no visible difference to the user. An application runs identically regardless of the actual installation state because the installer resolves component file locations by querying the installation database. It can in some cases be more efficient to run a feature from the source instead of locally. </p>
<p>
The installer can remove unused features from the local hard drive, as well as install features on demand, because the installer increments a usage count when applications request features. Applications therefore can keep track of usage statistics and request that the installer remove components that are not being used. Because the installer database is system-wide, the installer can keep usage counts of a feature for all client applications.</p>
<p>&nbsp;</p>

<h1><a name="_msi_components_and_features"></a>Components and Features</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A Microsoft  Windows  installer application consists of features and components. A feature is a building-block of an application from the user's perspective. A component is a building-block of an application from the programmer's perspective. You can use this system of separating applications into components and features to make installation and system management transparent to the user.</p>
<p>
A feature is a specific capability of an application as seen from the user's perspective. For example, a feature could be a spell-checker, thesaurus or  a group of clip-art. Users want to know what they can do with a program; they are not concerned about the constraints under which you build the application. In other words, users do not care how you actually separate the program into pieces. You can structure features into a hierarchy so that when a child feature is installed, the parent feature is installed as well.</p>
<p>
A component, in contrast, is how you break down an application. Examples of  components are a group of related files, a COM object, or a library.</p>
<p>
When a user selects clip-art files from a feature list, the associated component is installed. The component could be a viewer and a indexer for the clip-art.</p>
<p>
Deciding how to separate an application into components involves a trade-off between performance and resiliency. Each component has a KeyPath  associated with it. This KeyPath can be a file, registry key, or blank which indicates a directory. When a component is used, the installer checks the existence of the KeyPath. If the KeyPath is in its proper location, the installer assumes that the entire component is installed correctly. Thus if you use many small components, the installer checks the validity of the installation thoroughly, but checking many files can slow your application.</p>
<p>
The relationship between features and components also defines the pieces in which an application is installed. From the user's perspective applications are installed one feature at a time; however, the installer resolves these features into components to actually carry out the installation. In other words, applications are installed component-by-component from the operating system's perspective, and installed feature-by-feature from a user's perspective.</p>
<p>
While a many-to-many relationship between features and components is possible, the mechanism is most efficient when the relationship is as one-to-one as possible. It is possible for a component to map to more than one feature, but all parts of the component should do this together. Components are associated with a single folder. All files that are part of a component must reside in the same folder. Also, all parts of a component, whether they are registry entries or files are installed together. Thus, if your proposed component has portions with different setup logic, you must break the component into smaller pieces.</p>
<p>
A feature can use the facilities of one or more components just as a component can be used by more than one feature. In addition, features can have their own hierarchical structure. This makes it easier to install groups of related features together.</p>
<p>
For more information on using features, see the <a href="over_8oj0.htm">Feature Request Model</a> and <a href="over_2qcl.htm">Requesting a Feature</a>. For more information on separating an application into features and components, see <a href="over_69ir.htm">Separating an Application into Features</a> and <a href="over_88hf.htm">Separating an Application into Components</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_separating_an_application_into_features"></a>Separating an Application into Features</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
One of the most important aspects of making an application work effectively with the new installer is separating the application into features and components. For information on separating an application into components, see <a href="over_88hf.htm">Separating an Application into Components</a>. For more information on features, see <a href="over_8p83.htm">Components and Features</a>.</p>
<p>
If you answer no to one or more of the following questions, you might want to reconsider identifying that aspect of your application a feature:
<ul>
<li>
Does the feature present a single functionality to the user?</li>
<li>
Does it make sense to install the feature by itself?</li>
<li>
Conversely, does it make sense to install the entire feature at once?</li>
<li>
Might an administrator want to make the feature available or unavailable depending on the needs of groups of users?</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_separating_an_application_into_components"></a>Separating an Application into Components</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
One of the most important aspects of making an application work effectively with the installer is separating the application into features and components. For information on separating an application into features, see <a href="over_69ir.htm">Separating an Application into Features</a>. For more information on components, see <a href="over_8p83.htm">Components and Features</a>.</p>
<p>
If you answer no to any of these questions, you should consider separating the application into components differently:
<ul>
<li>
Do your application's features and components have a close relationship? </li>
<li>
Do all parts of the component map to a common feature? </li>
<li>
Do all files of a component have a common installation location? </li>
<li>
Do all parts of the component have a common setup logic?</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_feature_request_model"></a>Feature Request Model</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
As you write applications for the installer environment, remember that the file locations and installation state of features are flexible. Because a particular installation can access the files from a variety of locations, the application benefits most from the flexibility the installer provides if the application always requests features from the installer. Requesting features from the installer provides the added advantage of accurately maintained usage metrics. For a procedure that shows how to request a feature, see <a href="over_2qcl.htm">Requesting a Feature</a>.</p>
<p>
If the application calls <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a> before the application accesses a feature, the installer maintains usage metrics. One way an application might use this information is to remove a rarely used feature from the hard drive or to move a frequently used feature from the source medium to the local hard drive.</p>
<p>
To request features in the installer, use <a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a>, <a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a>, <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a>, <a href="msi_7gh1.htm"><b>MsiGetFeatureUsage</b></a>, <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a>, and <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> as shown in the following diagram.</p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/over2.gif" border=0></p>
<p>
</p>
<p>&nbsp;</p>

<h2><a name="_msi_component_management"></a>Component Management</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
As well as being an installation technology, the installer manages the complex array of components found in applications. The installer saves system state to track everything needed for an application to install and run smoothly. It can resolve which applications require a particular component, which files make up that component, and where those files are. The installer can also determine when a file is no longer needed and can safely remove it, reducing wasted disk space.</p>
<p>
There is also an installation database that describes how to install an application in any situation. This database includes tables for registry entries, directory structure, components, features, files, installation sequence, dialog boxes, and controls. For example, if an application requests a particular feature (for more information, see <a href="over_2qcl.htm">Requesting a Feature</a>), and the application requests the installer to install the feature, the installer runs a query that resolves issues such as:
<ul>
<li>
Which components belong to that feature</li>
<li>
Which files belong to the components</li>
<li>
Which registry entries need to be changed</li>
<li>
Which actions need to be performed</li>
</ul>
<p>
This process is shown in the following illustration. </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/over1.gif" border=0></p>
<p>
The installer also enables the application to keep usage metrics on components. So, when a component is not being used, it can be taken off the hard drive, further reducing the disk space requirements. For a stand-alone user, this method can eliminate the usual installation process; this user can simply start using a new application. As features are used, components are migrated off the installation medium and onto the hard drive. After a time, the optimal configuration for that user is locally available. Only the components used regularly take up any disk space. Because installations can become much more efficient, developers are free to incorporate more features without the risk of complicating the setup procedure, or taking up too much disk space.</p>
<p>&nbsp;</p>

<h2><a name="_msi_resiliency"></a>Resiliency</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Another benefit of installer <a href="over_5sl0.htm">component management</a> capabilities is the added resiliency available to applications. </p>
<p>
Because applications have become more complex, they can be prone to difficulties. For example, components can be deleted by a user or even another application, files can become corrupt, components can be replaced with incompatible versions. The installer provides applications the capability to recover gracefully from such situations without presenting the user with error messages. If the installer is unsuccessful at providing a component, the application can respond in the following ways:
<ul>
<li>
Attempt to repair the file if it has become corrupted. </li>
<li>
Reinstall the feature according to one of a number of possible criteria. For example, you can choose to reinstall a feature only if the current version is older than the version available on the source or only if the current file is corrupt in some manner. For information on installing, see <a href="over_37e6.htm">Installing an Application</a>. For information on reinstalling, see <a href="over_3fse.htm">Reinstalling a Feature or Application</a>.</li>
<li>
Reinstall aspects of an application, such as shortcuts and registry entries.</li>
</ul>
<p>
Another way that applications can fail is that the resources the applications require are unavailable. Applications that rely on network resources for <a href="over_4p7y.htm">just-in-time installation</a> are especially susceptible to such failures. However, the installer has also implemented a resiliency feature known as the source list. The source list contains the locations that the installer searches for installation packages. The entries in this list can be network locations, Uniform Resource Locators (URLs), or compact discs. If one of these sources fails, the installer can quickly and seamlessly try the next. </p>
<p>
If an application utilizes these resiliency methods, a great number of recovery methods must fail before the user is presented with an error message.</p>
<p>&nbsp;</p>

<h1><a name="_msi_merges_and_transforms"></a>Merges and Transforms</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Because Microsoft  Windows  installer uses a relational database, you can manipulate the installation process by applying transform and merge operations to the installation database. A transform makes changes to some of the elements of a single database, for example, a transform can be used to change the language in the user interface of an application. A merge combines two databases into a single database. This means that the installation database for a component of the application can be developed separately and then later merged into the main installation database. By using multiple transforms and merges together, the user gains much more control over the installation process with the installer than is possible with other installation technologies.</p>
<p>
Primary uses for transforms include:
<ul>
<li>
Customizing packages for particular groups of users<p>
Transforms can be used to encapsulate the various customizations of a single base package that are required by different groups of users. For example, this is useful in organizations where the finance and staff support departments require different installations of a particular product. A product's base package can be available to everyone at one administrative installation point with the appropriate customizations distributed to each group of users separately. 
</li>
<li>
Synchronizing applications across different languages<p>
Transforms are useful for keeping packages authored at widely separated locations in synchronization during authoring. For example, if an upgrade is first developed for an English version of an application that exists in English and French, a transform can be applied to the upgraded English version that converts it into an upgraded French version.
</li>
<li>
Patching applications<p>
Transforms can be employed to apply a minor fix to an application that does not warrant a major upgrade. 
</li>
</ul>
<p>
Merges are useful to development teams because they allow a large application to be divided into smaller parts that can be recombined later.</p>
<p>
A development team might apply a merge operation in the following way:
<ol>
<li>
Separate into smaller groups and work simultaneously on different components of a large application. </li>
<li>
Each development group can then populate its own installation database without being concerned immediately with the other components of the application. </li>
<li>
After the development of a component is complete, the component's database can be merged into the main installation database for the entire application.</li>
</ol>
<p>
Multiple transforms and merges can be applied to a base package and then applied on-the-fly during installation. This extends the capabilities of the installer to create custom packages and provides a mechanism for efficiently assigning the most appropriate installations to different groups of users.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installation_mechanism"></a>Installation Mechanism</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are two phases of an installation process: acquisition and execution. A rollback phase may also occur if the installation is unsuccessful.</p>
<p>
The exact installation procedure is determined during the acquisition phase. At the beginning of the acquisition phase, an application or a user instructs Microsoft  Windows  installer to install a feature or an application. The installer complies with this request by beginning the required action sequence. The actions query the database and generate a script that gives a step-by-step procedure for performing the installation. For information on installing an application, see <a href="over_392m.htm">Initializing an Application</a> and <a href="over_37e6.htm">Installing an Application</a>.</p>
<p>
During the execution phase, the installer passes the information to a process with elevated privileges to generate an installation script. The process with elevated privileges then runs the script. On a secure system, this gives a user with limited privileges the ability to instigate an installation without compromising system integrity.</p>
<p>
If an installation is unsuccessful, the installer automatically restores the original state of the computer. When the installer processes the installation script it simultaneously generates a rollback script. In addition to the rollback script, the installer saves a copy of every file it deletes during the installation. These files are kept in a hidden, system directory called Config.msi. Once the installation is complete, the rollback script and the saved files are deleted.</p>
<p>&nbsp;</p>

<h1><a name="_msi_using_windows_installer"></a>Using Windows Installer</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To add Microsoft  Windows  installer functionality to your application, you can use the installer service functions. Because the installer is a setup utility and a component management system, an application that uses the installer must incorporate the installer service functions as part of its normal operation. The following topics include a sample application and procedures that explain how to implement installer functionality in your application:
<ul>
<li>
<a href="over_2k36.htm">Sample application for the installer</a></li>
<li>
<a href="over_392m.htm">Initializing an application</a></li>
<li>
<a href="over_6gfi.htm">Getting application information</a></li>
<li>
<a href="over_2qcl.htm">Requesting a feature</a></li>
<li>
<a href="over_37e6.htm">Installing an application</a></li>
<li>
<a href="over_3fse.htm">Reinstalling a feature or application</a></li>
<li>
<a href="over_2bck.htm">Installing a missing component</a></li>
<li>
<a href="over_02nb.htm">Upgrading a Feature or Application by Patching</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_initializing_an_application"></a>Initializing an Application</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To enable the Microsoft  Windows  installer functionality, there are a number of functions an application must call when it is initializing. The following steps describe how to use the installer to initialize an application:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To initialize an application</h5>
<ol>
<li>
Call the <a href="msi_59ph.htm"><b>MsiGetProductCode</b></a> function so the application can identify itself to the installer.<p>
The product code is a required parameter for many installer functions.
</li>
<li>
Call the <a href="msi_6str.htm"><b>MsiGetUserInfo</b></a> function to collect user information the first time the application starts.<p>
If the call to MsiGetUserInfo fails, call the <a href="msi_9crz.htm"><b>MsiCollectUserInfo</b></a> function to collect user information. 
</li>
<li>
Display a default user interface, if necessary, by calling the <a href="msi_2j3d.htm"><b>MsiSetInternalUI</b></a> function. <p>
To author your own user interface, register it with the installer by calling the <a href="msi_5dm1.htm"><b>MsiSetExternalUI</b></a> function.
</li>
<li>
Call the <a href="msi_2ch3.htm"><b>MsiEnableLog</b></a> function to set the logging level. </li>
<li>
Present the user with available features by enumerating the features of your application. You can enumerate features in the following ways:<ul>
<li>
Query the installer feature-by-feature. For example, before the application draws a button or a menu item, the application can call the <a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a> function so the installer can check that the feature is available. </li>
<li>
Enumerate all of the available features at once by calling the <a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a> function. To use this function, the application must call <b>MsiEnumFeatures</b> repeatedly while incrementing an index. </li>
</ul>
</li>
<li>
Get detailed information about the current installation by calling the following enumeration functions repeatedly, incrementing an index variable for each call:<ul>
<li>
Call the <a href="msi_32er.htm"><b>MsiEnumProducts</b></a> function to enumerate products registered with the installer.</li>
<li>
Call the <a href="msi_1mk3.htm"><b>MsiEnumComponents</b></a> function to enumerate components. </li>
<li>
Call the <a href="msi_2veb.htm"><b>MsiEnumComponentQualifiers</b></a> function to enumerate component qualifiers. </li>
<li>
Call the <a href="msi_467n.htm"><b>MsiEnumClients</b></a> function to enumerate the products for a particular component.</li>
</ul>
<p>
If the return value on an enumeration function is ERROR_SUCCESS, there are still more items to be enumerated and the function should be called again with an incremented index variable. If the return value is ERROR_NO_MORE_ITEMS, then all of the items have been enumerated, and the function should not be called again. 
</li>
</ol>
<p>
For more information on initializing an application, see <a href="#_msi_initializing_an_application">Initializing an Application</a> and <a href="over_9jjh.htm">Installation Mechanism</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_getting_application_information"></a>Getting Application Information</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The product database contains information about a product. For more information on obtaining product information with enumeration functions, see <a href="over_392m.htm">Initializing an Application</a>. </p>
<p>
The following steps describe how to get product information:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To get product information</h5>
<ol>
<li>
Verify that a product is installed by calling the <a href="msi_93l1.htm"><b>MsiQueryProductState</b></a> function.</li>
<li>
Open the database and obtain a handle to it by calling the <a href="msi_5f78.htm"><b>MsiOpenProduct</b></a> function.<p>
If the database is contained in an installation package, call the <a href="msi_9n39.htm"><b>MsiOpenPackage</b></a> function.
</li>
<li>
Use the open handle to obtain product properties with the <a href="msi_229l.htm"><b>MsiGetProductProperty</b></a> function, and to obtain descriptive feature information with the <a href="msi_9g4v.htm"><b>MsiGetFeatureInfo</b></a> function.<p>
If you want to obtain product information using the product code, rather than using the open database handle, call the <a href="msi_8wa7.htm"><b>MsiGetProductInfo</b></a> function instead of <b>MsiGetProductProperty</b>.
</li>
<li>
Close an open installation handle by calling the <a href="msi_6g6d.htm"><b>MsiCloseHandle</b></a> function.<p>
The <a href="msi_6nqr.htm"><b>MsiCloseAllHandles</b></a> function is a diagnostic function and should not be used to close handles you know to be open. It is acceptable to call the <b>MsiCloseAllHandles</b> function when the application closes to ensure that all handles have been closed. 
</li>
</ol>
<p>&nbsp;</p>

<h1><a name="_msi_requesting_a_feature"></a>Requesting a Feature</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are several functions an application must call to request features. Before requesting a feature, the application must ensure that the feature is installed. For more information on feature requests, see the <a href="over_8oj0.htm">Feature Request Model</a> in <a href="over_8p83.htm">Components and Features</a>. </p>
<p>
The following steps describe how your application requests a feature:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To request a feature</h5>
<ol>
<li>
Indicate your application's intent to use a feature by calling the <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a> function.</li>
<li>
Determine file locations by calling the <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> function.</li>
<li>
Configure the feature by calling the <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a> function.</li>
<li>
Obtain usage metrics by calling the <a href="msi_7gh1.htm"><b>MsiGetFeatureUsage</b></a> function.</li>
</ol>
<p>
You can also use the <a href="msi_9otw.htm"><b>MsiProvideComponent</b></a> or the <a href="msi_3vn8.htm"><b>MsiProvideQualifiedComponent</b></a> function to request a feature. However, because these functions increment the usage count, use them with caution to prevent inaccurate usage counts. </p>
<p>&nbsp;</p>

<h1><a name="_msi_installing_an_application"></a>Installing an Application</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can install entire products with Microsoft  Windows  installer functions. The following steps describe how to install a product:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install a product</h5>
<ol>
<li>
Run a product through its installation or uninstallation sequence by calling the <a href="msi_75x0.htm"><b>MsiInstallProduct</b></a> function. </li>
<li>
Specify the installation level by calling the <a href="msi_3p9w.htm"><b>MsiConfigureProduct</b></a> function. <p>
You can use the <b>MsiConfigureProduct</b> function to configure an individual component.
</li>
</ol>
<p>
For more information on installing an application, see <a href="over_5id5.htm">Resiliency</a> and <a href="over_9jjh.htm">Installation Mechanism</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reinstalling_a_feature_or_application"></a>Reinstalling a Feature or Application</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Microsoft  Windows  installer can repair, replace, and verify files contained in an application.  A partial or complete application reinstallation might be required if any files or registry entries associated with any feature have become corrupted or are missing.  </p>
<p>
The following list contains several means of reinstalling a feature or product.  The first two methods have been automated by the installer.
<ul>
<li>
Repair, replace, or verify files by calling the <a href="msi_4ag5.htm"><b>MsiReinstallFeature</b></a> function. </li>
<li>
Reinstall the entire product by calling the <a href="msi_9n78.htm"><b>MsiReinstallProduct</b></a> function.</li>
<li>
Reinstall, replace, or verify files with an Installer UI control button via the <a href="href_8gdw.htm"><b>Reinstall ControlEvent</b></a>.</li>
<li>
Reinstall, replace, or verify files from a command line by setting the <a href="pref_19x5.htm"><b>REINSTALL</b> property</a> and the <a href="pref_7bll.htm"><b>REINSTALLMODE</b> property</a>.</li>
</ul>
<p>
For more information on reinstalling a feature or application, see <a href="over_5id5.htm">Resiliency</a>. </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product using the installer</h5>
<ol>
<li>
Call <a href="msi_9n78.htm">MsiReinstallProduct</a>.</li>
</ol>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a feature using the installer</h5>
<ol>
<li>
Call <a href="msi_4ag5.htm">MsiReinstallFeature</a>.</li>
</ol>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product or feature with an installer user interface</h5>
<ol>
<li>
Add a button to the specified dialog box by adding an entry to the <a href="tref_6nad.htm">Control table</a>.</li>
<li>
Add a <a href="href_0x6c.htm">ReinstallMode ControlEvent</a> to the ControlEvent table, with the Dialog_ and Control_ fields referencing the button control you created in step 1. In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the ReinstallMode property). The value in the Ordering column for this event should be 1.</li>
<li>
Add a <a href="href_8gdw.htm">Reinstall ControlEvent</a> event to the <a href="tref_6k11.htm">ControlEvent table</a>, again referencing the same button control. The Argument field for this event will normally be "ALL", to force reinstallation of all features, but you can place the name of a specific feature here. The value in the Ordering column for this event should be 2.</li>
<li>
Add one more event tied to the same button control, to actually initiate the reinstallation. This can be an EndDialog event (with an argument of Return). More typically, however, a NewDialog event would be used here to jump to an Are you sure you want to reinstall? confirmation dialog box. The value in the Ordering column for this event should be 3.<p>
If desired, several Reinstall buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed. In this case, each button is authored as outlined in the preceding procedure, with a different <a href="href_0x6c.htm">ReinstallMode ControlEvent</a> parameter for each button.
</li>
</ol>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To reinstall a product or feature from a command line</h5>
<p>
Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed on the command line.  
<ol>
<li>
From the command prompt, specify the <a href="pref_19x5.htm"><b>REINSTALL</b> property</a>.</li>
<li>
From the command prompt, specify the <a href="pref_7bll.htm"><b>REINSTALLMODE </b>property</a>. <p>
Specifying these properties allows the user to reinstall any or all of the product's features. The type of reinstallation can also be specified. For example, you can specify that only those files that are totally missing should be reinstalled, or that only corrupted files (for example, any executable file whose checksum doesn't match the actual file contents) be replaced. Alternatively, you can specify that the fitness of the current installation be verified, without actually repairing any broken or missing files/registry entries. In this case, for all installed features, the installer reports (typically in a log file) the results of any verification that you specify, such as whether there are any missing or corrupt files, any files of the wrong version, or any missing or incorrect registry entries. At any later time, you can then run the installation again to repair any or all of the detected problems. 
</li>
</ol>
<p>&nbsp;</p>

<h1><a name="_msi_upgrading_a_feature_or_application_by_patching"></a>Upgrading a Feature or Application by Patching</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Microsoft  Windows  installer can upgrade an existing application by patching. In the traditional form of an upgrade an entire new version of a product is installed over the old version. Patching is essentially an efficient form of an upgrade because only the individual file bits needed to update the application are changed. To the user this means that the same upgrade involves downloading a much smaller upgrade patch, rather than the entire product, and that customizations are preserved through the upgrade.</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To apply an upgrade to a product by patching</h5>
<ol>
<li>
Specify the full path to the patch package containing the upgrade. <p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used in these filenames or paths.
</li>
<li value=3>
Specify the path to the product package to receive the upgrade, or choose to have the patch applied to a group of applicable products specified in the <a href="tref_4qxx.htm">Upgrade table</a>.  See previous paragraph.</li>
<li>
Call the <a href="msi_5fe0.htm"><b>MsiApplyPatch</b></a> function.  </li>
</ol>
<p>
'</p>
<p>&nbsp;</p>

<h1><a name="_msi_installing_a_missing_component"></a>Installing a Missing Component</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If the <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> function was successful, the key file is present, and the missing file must be a non-key file. Since Microsoft  Windows  installer installs features, not components, the installer resolves which component the file belongs to and installs the feature that requires the least disk space. </p>
<p>
If the <b>MsiGetComponentPath</b> function unexpectedly fails, you must install missing components. The following steps describe how to install missing components:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install a missing component</h5>
<ul>
<li>
Call the <a href="msi_4k50.htm"><b>MsiInstallMissingComponent</b></a> function if the feature associated with the component is unknown. <p>
Or
<p>
Call the <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a> or <a href="msi_9otw.htm"><b>MsiProvideComponent</b></a> function if the feature associated with the component is known.
</li>
<li>
Call <a href="msi_6vad.htm"><b>MsiInstallMissingFile</b></a> if an application is unable to open a file. </li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_sample_application_for_the_installer"></a>Sample Application for the Installer</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This following simple application shows how to use many Microsoft  Windows  installer service functions. The sample application takes the package of an installed application at the command line and prints all of the features and components associated with the application.</p>
<pre><code>#include &lt;windows.h&gt;
#include &lt;msi.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void ProcessError(UINT uiError,LPTSTR szFunctionName);

#define PATH_BUFFER_SIZE 10  // beginning buffer size for path
#define GUID_LENGTH 39       // includes terminating null

int main(int argc,char *argv[])
{
  DWORD iFeatureIndex=0;      // index for enumerating features
  DWORD iComponentIndex=0;    // index for enumerating components
  DWORD iProductIndex=0;      // index for enumerating products

  LPTSTR lpProductBuf;        // buffer for product code, string GUID
  LPTSTR lpComponentBuf;      // buffer for component code, GUID
  LPTSTR lpFeatureBuf;        // buffer for feature
  LPTSTR lpParentBuf;         // buffer for parent of feature
  LPTSTR lpPathBuf;           // the path to the databases
  LPTSTR lpTempProductBuf;
  
  MSIHANDLE hProduct;         // returned product handle, must be
                              // closed
  INSTALLSTATE isState;       // the install state returned by
                              // MsiGetComponentPath
  
  UINT uiError,uiError2;      // variable to receive errors
    
  DWORD cchProductBufLength;  // number of characters in lpProductBuf
  DWORD cchComponentBufLength;// number of characters in lpComponentBuf
  DWORD cchPathBufLength;     // number of characters in PathBuf
    
  
// allocating space for variables
  
  cchComponentBufLength=GUID_LENGTH;
  cchProductBufLength=GUID_LENGTH;
  cchPathBufLength=PATH_BUFFER_SIZE;
  
  lpFeatureBuf=(LPTSTR) calloc(MAX_FEATURE_CHARS,sizeof(char));
  lpParentBuf=(LPTSTR) calloc(MAX_FEATURE_CHARS,sizeof(char));
  lpPathBuf=(LPTSTR) calloc(PATH_BUFFER_SIZE,sizeof(char));
  
  lpProductBuf=(LPTSTR) calloc(GUID_LENGTH,sizeof(char));
  lpComponentBuf=(LPTSTR) calloc(GUID_LENGTH,sizeof(char));
  lpTempProductBuf=(LPTSTR) calloc(GUID_LENGTH,sizeof(char));
  
  /* determine the current path so that the user doesn't 
have to type it in at the command line */
  
  cchPathBufLength=GetCurrentDirectory(
    cchPathBufLength,
    lpPathBuf);

  /* If the path variable isn't long enough for the path plus the package name, reallocate and try again */
  

  if(cchPathBufLength&gt;PATH_BUFFER_SIZE+1+strlen(argv[1])){
    realloc(lpPathBuf,cchPathBufLength);
    if(cchPathBufLength&gt;PATH_BUFFER_SIZE)
      GetCurrentDirectory(cchPathBufLength,lpPathBuf);
  }

  strcat(lpPathBuf,"\\");
  strcat(lpPathBuf,argv[1]);
  printf ("%s\n",lpPathBuf);
  
  // open the package

  uiError=MsiOpenPackage(lpPathBuf,&amp;hProduct);

  // check for errors

  if (uiError!=ERROR_SUCCESS){
    ProcessError(uiError,"MsiOpenPackage");
    return uiError;
  }
  else
    printf("Package opened\n");
  
/* Many functions require the product code, so you obtain it from 
the ProductCode property. After this function call, the package 
is no longer used. All further information is obtained from the 
configuration database */

  uiError=MsiGetProductProperty(hProduct,
    "ProductCode",
    lpProductBuf,
    &amp;cchProductBufLength);
  
  /* Here you make sure that the product code is properly obtained.  
If there isn't enough room in the variable, you reallocate and try 
again. A while loop is used to ensure that MsiGetProductProperty 
finally does return ERROR_SUCCESS */

  while (uiError!=ERROR_SUCCESS){
    if (ERROR_MORE_DATA==uiError){
      cchProductBufLength++;
      realloc(&amp;lpProductBuf,cchProductBufLength);
      uiError=MsiGetProductProperty(hProduct,
        "ProductCode",
        lpProductBuf,
        &amp;cchProductBufLength);
    }
    else{
      ProcessError(uiError,"MsiGetProductProperty");
      return uiError;
    }
  }
  
  printf("Product code obtained %s\n",lpProductBuf);

  // Here you enumerate all of the features associated with the product

  do{
    uiError=MsiEnumFeatures(lpProductBuf,
      iFeatureIndex,
      lpFeatureBuf,
      lpParentBuf);
    if(ERROR_SUCCESS==uiError){
      printf("Feature: %s\n Parent: %s\n",lpFeatureBuf,lpParentBuf);
      iFeatureIndex++;
    }
  } while (ERROR_SUCCESS==uiError);
  
  if(uiError!=ERROR_NO_MORE_ITEMS){
    ProcessError(uiError,"MsiEnumFeatures");
    return uiError;
  }
  
/* This section enumerates all of the installed components of a 
product and prints a path to their locations. This is more
 complicated than enumerating the features. MsiEnumComponents 
enumerates all of the components present on a particular computer, 
regardless of associated product. You are only interested in the 
components associated with the product given by the product code you 
obtained above. Thus for each component enumerated, you enumerate the 
products that use it. If the product matches the product you are 
interested in, you find the path and print it.
You can use MsiLocateComponent instead of MsiGetComponentPath. In 
fact MsiLocateComponent doesn't require the product code so you could 
eliminate the MsiEnumClients call and list all of the components.  
However, it is possible for two products to use the same component in 
different locations. Without the product code, it is not possible for 
the installer to know which path to return.  For this reason, it is 
recommended that you use MsiGetComponentPath instead of 
MsiLocateComponent. */
  
  do{
    uiError=MsiEnumComponents(iComponentIndex,lpComponentBuf);
    if (ERROR_SUCCESS==uiError){
      iProductIndex=0;
      do{
        uiError2=MsiEnumClients(lpComponentBuf,
          iProductIndex,
          lpTempProductBuf);
        if (!(uiError2==ERROR_SUCCESS||
          uiError2==ERROR_NO_MORE_ITEMS)){
          ProcessError(uiError2,"MsiEnumClients");
          return uiError2;
        }
        iProductIndex++;
        if(0==strcmp(lpTempProductBuf,lpProductBuf)){
          uiError2=ERROR_NO_MORE_ITEMS;          
          isState=MsiGetComponentPath(lpProductBuf,
            lpComponentBuf,
            lpPathBuf,
            &amp;cchPathBufLength);
          while (INSTALLSTATE_MOREDATA==isState){
            lpPathBuf=realloc(lpPathBuf,
              sizeof(char)*cchPathBufLength);
            isState=MsiGetComponentPath(lpProductBuf,
              lpComponentBuf,
              lpPathBuf,
              &amp;cchPathBufLength);
          }
          switch (isState){
          case INSTALLSTATE_LOCAL:
            printf("Locally installed\n");
            break;
          case INSTALLSTATE_SOURCE:
            printf("Installed from source\n");
            break;
          case INSTALLSTATE_SOURCEABSENT:
            printf("Source not available\n");
            break;
          case INSTALLSTATE_DEFAULT:
            printf("Default install state\n");
            break;
          default:
            printf("installstate number:%d\n",isState);
            break;
          }
          printf("Component: %s\nPath: %s\n",lpComponentBuf,lpPathBuf);
        }
      }while(ERROR_SUCCESS==uiError2);
    }
    iComponentIndex++;
  } while (ERROR_SUCCESS==uiError);
  
  if(uiError!=ERROR_NO_MORE_ITEMS){
    ProcessError(uiError,"MsiEnumComponents");
    return uiError;
  }
  
  MsiCloseHandle(hProduct);
  return 0;
}

void ProcessError(UINT uiError,LPTSTR szFunctionName){
  
  printf("An error occurred in %s:",szFunctionName);
  
  switch (uiError){
  case ERROR_BAD_CONFIGURATION:
    printf("The configuration information is corrupt.\n");
    break;
  case ERROR_INSTALL_FAILURE:
    printf("The product could not be opened.\n");
    break;
  case ERROR_INVALID_HANDLE:
    printf("An invalid handle was passed to the function.\n");
    break;
  case ERROR_INVALID_PARAMETER:
    printf("An invalid parameter was passed.\n");
    break;
  case ERROR_UNKNOWN_PRODUCT:
    printf("The specified product is unknown.\n");
    break;
  case ERROR_ACCESS_DENIED:
    printf("Access is denied.\n");
    break;
  default:
    printf("Error number: %d\n",uiError);
    break;
  }
  return;
}
 </code></pre>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_installer_function_reference"></a>Installer Function Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To enable the Microsoft  Windows  installer in your application, you must use the installation functions. This topic lists these functions by category.</p>

<h4><a name="_msi_user_interface_and_logging_functions"></a>User Interface and Logging Functions</h4>
<p>
You can use the following user interface and logging functions in your application:</p>
<p>
<a href="msi_2j3d.htm"><b>MsiSetInternalUI</b></a></p>
<p>
<a href="msi_5dm1.htm"><b>MsiSetExternalUI</b></a></p>
<p>
<a href="msi_2ch3.htm"><b>MsiEnableLog</b></a></p>

<h4><a name="_msi_handle_management_functions"></a>Handle Management Functions</h4>
<p>
You can use the following handle management functions in your application:</p>
<p>
<a href="msi_6g6d.htm"><b>MsiCloseHandle</b></a></p>
<p>
<a href="msi_6nqr.htm"><b>MsiCloseAllHandles</b></a></p>

<h4><a name="_msi_installation_and_configuration_functions"></a>Installation and Configuration Functions</h4>
<p>
You can use the following installation and configuration functions in your application:</p>
<p>
<a href="msi_75x0.htm"><b>MsiInstallProduct</b></a></p>
<p>
<a href="msi_3p9w.htm"><b>MsiConfigureProduct</b></a></p>
<p>
<a href="msi_9n78.htm"><b>MsiReinstallProduct</b></a></p>
<p>
<a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a></p>
<p>
<a href="msi_4ag5.htm"><b>MsiReinstallFeature</b></a></p>
<p>
<a href="msi_4k50.htm"><b>MsiInstallMissingComponent</b></a></p>
<p>
<a href="msi_6vad.htm"><b>MsiInstallMissingFile</b></a></p>

<h4><a name="_msi_component_specific_functions"></a>Component-Specific Functions</h4>
<p>
You can use the following functions to provide components in your application:</p>
<p>
<a href="msi_9otw.htm"><b>MsiProvideComponent</b></a></p>
<p>
<a href="msi_3vn8.htm"><b>MsiProvideQualifiedComponent</b></a></p>
<p>
You can use the following functions to locate components in your application. The state of the feature being used should have been checked previously:</p>
<p>
<a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a></p>
<p>
<a href="msi_7o8k.htm"><b>MsiLocateComponent</b></a></p>

<h4><a name="_msi_application_only_functions"></a>Application-Only Functions</h4>
<p>
Your application can use the following application-only functions:</p>
<p>
<a href="msi_9crz.htm"><b>MsiCollectUserInfo</b></a></p>
<p>
<a href="msi_3ckl.htm"><b>MsiUseFeature</b></a></p>
<p>
<a href="msi_59ph.htm"><b>MsiGetProductCode</b></a></p>

<h4><a name="_msi_system_status_functions"></a>System Status Functions</h4>
<p>
You can use the following functions to query the status of the system:</p>
<p>
<a href="msi_32er.htm"><b>MsiEnumProducts</b></a></p>
<p>
<a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a></p>
<p>
<a href="msi_1mk3.htm"><b>MsiEnumComponents</b></a></p>
<p>
<a href="msi_467n.htm"><b>MsiEnumClients</b></a></p>
<p>
<a href="msi_2veb.htm"><b>MsiEnumComponentQualifiers</b></a></p>
<p>
<a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a></p>
<p>
<a href="msi_93l1.htm"><b>MsiQueryProductState</b></a></p>
<p>
<a href="msi_7gh1.htm"><b>MsiGetFeatureUsage</b></a></p>
<p>
<a href="msi_8wa7.htm"><b>MsiGetProductInfo</b></a></p>
<p>
<a href="msi_6str.htm"><b>MsiGetUserInfo</b></a></p>

<h4><a name="_msi_product_query_functions"></a>Product Query Functions</h4>
<p>
You can use the following functions to query the product: </p>
<p>
<a href="msi_5f78.htm"><b>MsiOpenProduct</b></a></p>
<p>
<a href="msi_9n39.htm"><b>MsiOpenPackage</b></a></p>
<p>
<a href="msi_229l.htm"><b>MsiGetProductProperty</b></a></p>
<p>
<a href="msi_9g4v.htm"><b>MsiGetFeatureInfo</b></a></p>

<h4><a name="_msi_patching_functions"></a>Patching Functions</h4>
<p>
You can use the following functions to patch existing products.</p>
<p>
<a href="msi_5fe0.htm"><b>MsiApplyPatch</b></a></p>
<h4>Database Access Reference Functions</h4>
<p>
In addition to the installer functions listed above, you can manipulate information in the installation database by using the database access functions described in the <a href="qref_9okl.htm">Database Access Reference</a> section. </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiapplypatch"></a>MsiApplyPatch</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
For each product listed by the patch package as eligible to receive the patch, the <b>MsiApplyPatch</b> function invokes an installation and sets the <a href="pref_3wc9.htm">PATCH property</a> to the path of the patch package.</p>
<pre><code><b>UINT WINAPI MsiApplyPatch(
</b>  <b>LPCTSTR</b> <i>szPatchPackage</i><b>,</b>      // location of the patch package
  <b>LPCTSTR</b> <i>szInstallPackage</i><b>,</b>    // location of product to be patched 
                                // &lt;optional&gt;
  <b>INSTALLTYPE</b> <i>eInstallType</i><b>,</b>     // type of install to patch
  <b>LPCTSTR</b> <i>szCommandLine </i>       // command line &lt;property settings&gt;
<b>); </b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szPatchPackage</i></dt>
<dd>
Specifies the full path to the patch package.</dd>
<dt>
<i>szInstallPackage</i></dt>
<dd>
Specifies a path to a product to be patched. This is an optional parameter and if omitted the patch is applied to every product listed in the patch package as eligible to receive the patch.</dd>
<dt>
<i>eInstallType</i></dt>
<dd>
This parameter specifies the type of installation to patch. A value of 1 for INSTALLTYPE_NETWORK_IMAGE sets this for a network installation. The eInstallType parameter is ignored if szInstallPackage is omitted.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Type of Installation</th>
<th align=left width=48%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>INSTALLTYPE_NETWORK_IMAGE</td>
<td width=48%>Indicates a network installation</td>
</tr>
</table><br>

</dd>
<dt>
<i>szCommandLine</i></dt>
<dd>
Specifies command line property settings.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_INSTALL_PACKAGE*</dt>
<dd>
These errors may indicate an error with the patch package or the install package.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msicloseallhandles"></a>MsiCloseAllHandles</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiCloseAllHandles</b> function closes all open installation handles in the process. This is a diagnostic function and should not be used for cleanup.</p>
<pre><code><b>UINT MsiCloseAllHandles();
</b> </code></pre>
<h4>Parameters</h4>
<p>
None</p>
<h4>Return Values</h4>
<p>
This function returns 0 if all handles are closed. Otherwise, the function returns the number of handles open prior to its call.</p>
<h4>Remarks</h4>
<p>
MsiCloseAllHandles will only close handles allocated by the calling thread, and will not affect handles allocated by other threads, such as the install handle passed to custom actions.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_handle_management_functions">Handle Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiclosehandle"></a>MsiCloseHandle</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiCloseHandle</b> function closes an open installation handle.</p>
<pre><code><b>UINT MsiCloseHandle(
</b>  <b>MSIHANDLE</b> <i>hAny</i>    // Installer handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hAny</i></dt>
<dd>
Specifies any open installation handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid handle was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
MsiCloseHandle must be called from the same thread that requested the creation of the handle.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_handle_management_functions">Handle Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msicollectuserinfo"></a>MsiCollectUserInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiCollectUserInfo</b> function obtains and stores the user information and product ID from an installation wizard.</p>
<pre><code><b>UINT MsiCollectUserInfo(
</b>  <b>LPCTSTR</b> <i>szProduct</i>    // product code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code of the product for which the user information is collected.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiCollectUserInfo</b> function is typically called by an application during the first run of the application. The application first calls <a href="msi_6str.htm">MsiGetUserInfo</a>. If that call fails, the application calls <b>MsiCollectUserInfo</b>. <b>MsiCollectUserInfo</b> opens the product's installation package and invokes a wizard sequence that collects user information. Upon completion of the sequence, user information is registered. Since this API requires an authored user interface, the user interface level should be set to full by calling <a href="msi_2j3d.htm">MsiSetInternalUI</a> as INSTALLUILEVEL_FULL..</p>
<p>
The <b>MsiCollectUserInfo</b> invokes a FirstRun action. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_application_only_functions">Application-Only Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiconfigurefeature"></a>MsiConfigureFeature</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiConfigureFeature</b> function configures the installed state for a product feature.</p>
<pre><code><b>UINT MsiConfigureFeature(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>          // product code
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>          // feature ID
  <b>INSTALLSTATE</b> <i>eInstallState</i>  // install state
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product to be configured. </dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature ID for the feature to be configured.</dd>
<dt>
<i>eInstallState</i></dt>
<dd>
Specifies the installation state for the feature. This parameter must be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_ADVERTISE</td>
<td width=56%>The feature is advertised</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_LOCAL</td>
<td width=56%>The feature is installed locally.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_ABSENT</td>
<td width=56%>The feature is uninstalled.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_SOURCE</td>
<td width=56%>The feature is installed to run from source.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_DEFAULT</td>
<td width=56%>The feature is installed to its default location.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiconfigureproduct"></a>MsiConfigureProduct</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiConfigureProduct</b> function installs or uninstalls a product.</p>
<pre><code><b>UINT MsiConfigureProduct(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>            // product code
  <b>int</b> <i>iInstallLevel</i><b>,</b>            // install level
  <b>INSTALLSTATE</b> <i>eInstallState</i>    // install state
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product to be configured.</dd>
<dt>
<i>iInstallLevel</i></dt>
<dd>
Specifies how much of the product should be installed when installing the product to its default state. The <i>iInstallLevel</i> parameter will be ignored, and all features will be installed, if the <i>eInstallState</i> parameter is set to any other value than INSTALLSTATE_DEFAULT.
<p>
This parameter can be one of the following values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Value</th>
<th align=left width=54%>Meaning</th>
</tr>
<tr valign=top>
<td width=46%>INSTALLLEVEL_DEFAULT </td>
<td width=54%>The authored default features are installed.</td>
</tr>
<tr valign=top>
<td width=46%>INSTALLLEVEL_MINIMUM </td>
<td width=54%>Only the required features are installed. You can specify a value between INSTALLLEVEL_MINIMUM and INSTALLLEVEL_MAXIMUM to install a subset of available features.</td>
</tr>
<tr valign=top>
<td width=46%>INSTALLLEVEL_MAXIMUM </td>
<td width=54%>All features are installed. You can specify a value between INSTALLLEVEL_MINIMUM and INSTALLLEVEL_MAXIMUM to install a subset of available features.</td>
</tr>
</table><br>

</dd>
<dt>
<i>eInstallState</i></dt>
<dd>
Specifies the installation state for the product. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_LOCAL</td>
<td width=56%>The product is installed locally.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_ABSENT</td>
<td width=56%>The product is uninstalled.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_SOURCE</td>
<td width=56%>The product is installed to run from source.</td>
</tr>
<tr valign=top>
<td width=44%>INSTALLSTATE_DEFAULT</td>
<td width=56%>The product is installed to its default location.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiConfigureProduct </b>function displays the user interface using the current settings. User interface settings can be changed with <a href="msi_2j3d.htm"><b>MsiSetInternalUI</b></a> and <a href="msi_5dm1.htm"><b>MsiSetExternalUI</b></a>.</p>
<p>
The <i>iInstallLevel </i>parameter will be ignored, and all features of the product will be installed, if the <i>eInstallState</i> parameter is set to any other value than INSTALLSTATE_DEFAULT. To control the installation of individual features when the <i>eInstallState</i> parameter is not set to INSTALLSTATE_DEFAULT use <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienablelog"></a>MsiEnableLog</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnableLog</b> function sets the log mode for all installations that are initiated in the calling process.</p>
<pre><code><b>UINT MsiEnableLog(
  DWORD </b><i>dwLogMode</i><b>,     // </b>flags designating operations to report
<b>  LPCTSTR </b><i>szLogFile</i><b>,   // </b>log file or NULL for external handler
<b>  BOOL </b><i>fAppend</i><b>         // </b>value to indicate append mode
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwLogMode</i></dt>
<dd>
Specifies the log mode. This parameter can be one or more of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=60%>Value</th>
<th align=left width=40%>Meaning</th>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_OUTOFMEMORY</td>
<td width=40%>The out-of-memory error messages are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_ERROR</td>
<td width=40%>The error messages are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_WARNING</td>
<td width=40%>The warning messages are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_USER</td>
<td width=40%>The user requests are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_INFO</td>
<td width=40%>The status messages that are not displayed are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_COMMONDATA</td>
<td width=40%>The parameters for user-interface initialization are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_RESERVED</td>
<td width=40%>Reserved for future use.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_ACTIONSTART</td>
<td width=40%>The start of new installation actions are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_ACTIONDATA</td>
<td width=40%>The data record with the installation action is logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_PROPERTYDUMP </td>
<td width=40%>The property values at termination are logged.</td>
</tr>
<tr valign=top>
<td width=60%>INSTALLLOGMODE_FILESINUSE </td>
<td width=40%>List of files that need to be replaced.</td>
</tr>
</table><br>

</dd>
<dt>
<i>szLogFile</i></dt>
<dd>
Specifies the string that holds the full path to the log file. The file is created if it does not exist.</dd>
<dt>
<i>fAppend</i></dt>
<dd>
Specifies a Boolean value. This value is set to TRUE to append an existing file, and it is set to FALSE to replace the contents.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid log mode was specified.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_user_interface_and_logging_functions">Interface and Logging Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienumclients"></a>MsiEnumClients</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnumClients</b> function enumerates the clients for a given installed component. The function retrieves one product code each time it is called.</p>
<pre><code><b>UINT MsiEnumClients(
</b>  <b>LPCTSTR</b> <i>szComponent</i><b>,</b> // component code, string GUID
  <b>DWORD</b> <i>iProductIndex</i><b>,</b> // 0-based index into client products
  <b>LPTSTR</b> <i>lpProductBuf</i>  // buffer to receive GUID
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component whose clients are to be enumerated.</dd>
<dt>
<i>iProductIndex</i></dt>
<dd>
Specifies the index of the client to retrieve. This parameter should be zero for the first call to the <b>MsiEnumClients</b> function and then incremented for subsequent calls. Because clients are not ordered, any new client has an arbitrary index. This means that the function can return clients in any order.</dd>
<dt>
<i>lpProductBuf</i></dt>
<dd>
Pointer to a buffer that receives the product code. This buffer must be 39 characters long. The first 38 characters are for the GUID, and the last character is for the terminating NULL character.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_NO_MORE_ITEMS</dt>
<dd>
There are no clients to return.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
A value was enumerated.</dd>
<dt>
ERROR_UNKNOWN_COMPONENT</dt>
<dd>
The specified component is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To enumerate clients, an application should initially call the <b>MsiEnumClients</b> function with the <i>iProductIndex</i> parameter set to zero. The application should then increment the <i>iProductIndex</i> parameter and call <b>MsiEnumClients</b> until there are no more clients (that is, until the function returns ERROR_NO_MORE_ITEMS).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienumcomponentqualifiers"></a>MsiEnumComponentQualifiers</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnumComponentQualifiers</b> function enumerates the advertised  qualifiers for the given component. This function retrieves one qualifier each time it is called.</p>
<pre><code><b>UINT MsiEnumComponentQualifiers(
</b>  <b>LPTSTR</b> <i>szComponent</i><b>,</b>           // component ID 
  <b>DWORD</b> <i>iIndex</i><b>,</b>                 // 0-based index into component qualifiers
  <b>LPTSTR</b> <i>lpQualifierBuf</i><b>,</b>        // buffer to return qualifier
  <b>DWORD</b> <i>*pcchQualifierBuf</i><b>,</b>      // in/out qualifier buffer character count
  <b>LPTSTR</b> <i>lpApplicationDataBuf</i><b>,</b>  // buffer to return application-registered data
  <b>DWORD</b> <i>*pcchApplicationDataBuf</i> // in/out <i>lpApplicationDataBuf</i> character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies component whose qualifiers are to be enumerated.</dd>
<dt>
<i>iIndex</i></dt>
<dd>
Specifies the index of the qualifier to retrieve. This parameter should be zero for the first call to the <b>MsiEnumComponentQualifiers</b> function and then incremented for subsequent calls. Because qualifiers are not ordered, any new qualifier has an arbitrary index. This means that the function can return qualifiers in any order. </dd>
<dt>
<i>lpQualifierBuf</i></dt>
<dd>
Pointer to a buffer that receives the qualifier code.</dd>
<dt>
<i>pcchQualifierBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpQualifierBuf</i> parameter. On input this size should include the terminating NULL character. On return, the value does not include the NULL character.</dd>
<dt>
<i>lpApplicationDataBuf</i></dt>
<dd>
Pointer to a buffer that receives the application registered data for the qualifier. This parameter can be NULL.</dd>
<dt>
<i>pcchApplicationDataBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpApplicationDataBuf</i> parameter. On input this size should include the terminating NULL character. On return, the value does not include the NULL character. This parameter can be NULL only if the <i>lpApplicationDataBuf</i> parameter is NULL.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer is to small to hold the requested data.</dd>
<dt>
ERROR_NO_MORE_ITEMS</dt>
<dd>
There are no qualifiers to return.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
A value was enumerated.</dd>
<dt>
ERROR_UNKNOWN_COMPONENT</dt>
<dd>
The specified component is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To enumerate qualifiers, an application should initially call the <b>MsiEnumComponentQualifiers</b> function with the <i>iIndex</i> parameter set to zero. The application should then increment the <i>iIndex</i> parameter and call <b>MsiEnumComponentQualifiers</b> until there are no more products (that is, until the function returns ERROR_NO_MORE_ITEMS).</p>
<p>
When <b>MsiEnumComponentQualifiers</b> returns, the <i>pcchQualifierBuf</i> parameter contains the length of the qualifier string stored in the buffer. The count returned does not include the terminating null character. If the buffer is not big enough, <b>MsiEnumComponentQualifiers</b> returns ERROR_MORE_DATA, and this parameter contains the size of the string, in characters, without counting the NULL character. The same mechanism applies to <i>pcchDescriptionBuf.</i></p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienumcomponents"></a>MsiEnumComponents</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnumComponents</b> function enumerates the installed components for all products. This function retrieves one component code each time it is called.</p>
<pre><code><b>UINT MsiEnumComponents(
</b>  <b>DWORD</b> <i>iComponentIndex</i><b>,</b> // 0-based index into installed components
  <b>LPTSTR</b> <i>lpComponentBuf</i>  // buffer of char count: 39
                         // (size of string GUID)
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>iComponentIndex</i></dt>
<dd>
Specifies the index of the component to retrieve. This parameter should be zero for the first call to the <b>MsiEnumComponents</b> function and then incremented for subsequent calls. Because components are not ordered, any new component has an arbitrary index. This means that the function can return components in any order. </dd>
<dt>
<i>lpComponentBuf</i></dt>
<dd>
Pointer to a buffer that receives the component code.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_NO_MORE_ITEMS </dt>
<dd>
There are no componets to return.</dd>
<dt>
ERROR_SUCCESS </dt>
<dd>
A value was enumerated.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To enumerate components, an application should initially call the <b>MsiEnumComponents</b> function with the <i>iComponentIndex</i> parameter set to zero. The application should then increment the <i>iComponentIndex</i> parameter and call <b>MsiEnumComponents</b> until there are no more components (that is, until the function returns ERROR_NO_MORE_ITEMS).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienumfeatures"></a>MsiEnumFeatures</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnumFeatures</b> function enumerates the published features for a given product. This function retrieves one feature ID each time it is called.</p>
<pre><code><b>UINT MsiEnumFeatures(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>     // product code, string GUID
  <b>DWORD</b> <i>iFeatureIndex</i><b>,</b>   // 0-based index into published features
  <b>LPTSTR</b> <i>lpFeatureBuf</i><b>,</b>   // buffer for feature
  <b>LPTSTR </b><i>lpParentBuf     </i>// buffer for parent of feature
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product whose features are to be enumerated.</dd>
<dt>
<i>iFeatureIndex</i></dt>
<dd>
Specifies the index of the feature to retrieve. This parameter should be zero for the first call to the <b>MsiEnumFeatures</b> function and then incremented for subsequent calls. Because features are not ordered, any new feature has an arbitrary index. This means that the function can return features in any order. </dd>
<dt>
<i>lpFeatureBuf</i></dt>
<dd>
Pointer to a buffer that receives the feature ID. Must be sized to hold a string of length <b>MAX_FEATURE_CHARS</b>.</dd>
<dt>
<i>lpParentBuf</i></dt>
<dd>
Pointer to a buffer that receives the feature ID of the parent of the feature. Must be sized to hold a string of length <b>MAX_FEATURE_CHARS</b>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_NO_MORE_ITEMS </dt>
<dd>
There are no features to return.</dd>
<dt>
ERROR_SUCCESS </dt>
<dd>
A value was enumerated.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The specified product is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To enumerate features, an application should initially call the <b>MsiEnumFeatures</b> function with the <i>iFeatureIndex</i> parameter set to zero. The application should then increment the <i>iFeatureIndex</i> parameter and call <b>MsiEnumFeatures</b> until there are no more features (that is, until the function returns ERROR_NO_MORE_ITEMS).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienumproducts"></a>MsiEnumProducts</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnumProducts</b> function enumerates advertising products. The function retrieves one product code each time it is called.</p>
<pre><code><b>UINT MsiEnumProducts(
</b>  <b>DWORD</b> <i>iProductIndex</i><b>,</b> // 0-based index into registered products
  <b>LPTSTR</b> <i>lpProductBuf</i>  // buffer to receive GUID
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>iProductIndex</i></dt>
<dd>
Specifies the index of the product to retrieve. This parameter should be zero for the first call to the <b>MsiEnumProducts</b> function and then incremented for subsequent calls. Because products are not ordered, any new product has an arbitrary index. This means that the function can return products in any order. </dd>
<dt>
<i>lpProductBuf</i></dt>
<dd>
Pointer to a buffer that receives the product code. This buffer must be 39 characters long. The first 38 characters are for the GUID, and the last character is for the terminating NULL character.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_NO_MORE_ITEMS </dt>
<dd>
There are no products to return.</dd>
<dt>
ERROR_SUCCESS </dt>
<dd>
A value was enumerated.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To enumerate products, an application should initially call the <b>MsiEnumProducts</b> function with the <i>iProductIndex</i> parameter set to zero. The application should then increment the <i>iProductIndex</i> parameter and call <b>MsiEnumProducts</b> until there are no more products (until the function returns ERROR_NO_MORE_ITEMS).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetcomponentpath"></a>MsiGetComponentPath</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetComponentPath</b> function returns the full path to an installed component. If the key path for the component is a registry key then the registry key is returned.</p>
<pre><code><b>INSTALLSTATE MsiGetComponentPath(
  LPCTSTR </b><i>szProduct</i><b>,   </b>//<b> </b>product code for client product
  <b>LPCTSTR</b> <i>szComponent</i><b>,</b> // component ID
  <b>LPTSTR</b> <i>lpPathBuf</i><b>,</b>    // returned path
  <b>DWORD</b> <i>*pcchBuf</i>       // in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the client product.</dd>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component ID of the component to be located.</dd>
<dt>
<i>lpPathBuf</i></dt>
<dd>
Pointer to a variable that receives the path to the component. This parameter can be NULL.</dd>
<dt>
<i>pcchBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpPathBuf</i> parameter. 
<p>
If <i>lpPathBuf</i> is NULL, <i>pcchBuf</i> can be NULL. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_NOTUSED</dt>
<dd>
The component being requested is disabled on the computer.</dd>
<dt>
INSTALLSTATE_ABSENT</dt>
<dd>
The component is not installed.</dd>
<dt>
INSTALLSTATE_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
INSTALLSTATE_INVALIDARG</dt>
<dd>
One of the function parameters is invalid.</dd>
<dt>
INSTALLSTATE_LOCAL</dt>
<dd>
The component is installed locally.</dd>
<dt>
INSTALLSTATE_SOURCE</dt>
<dd>
The component is installed to run from source.</dd>
<dt>
INSTALLSTATE_SOURCEABSENT</dt>
<dd>
The component source is inaccessible.</dd>
<dt>
INSTALLSTATE_UNKNOWN</dt>
<dd>
The product code or component ID is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Upon success of the <b>MsiGetComponentPath</b> function, the <i>pcchBuf</i> parameter contains the length of the string in <i>lpPathBuf</i>.</p>
<p>
The <b>MsiGetComponentPath</b> function might return INSTALLSTATE_ABSENT or INSTALL_STATE_UNKNOWN, for the following reasons:
<ul>
<li>
INSTALLSTATE_ABSENT<p>
The application did not properly ensure that the feature was installed by calling <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a> and, if necessary, <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a>. 
</li>
<li>
INSTALLSTATE_UNKNOWN <p>
The feature is not published. The application should have determined this earlier by calling <a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a> or <a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a>.<b> </b>The application makes these calls while it initializes. An application should only use features that are known to be published. Since INSTALLSTATE_UNKNOWN should have been returned by <b>MsiUseFeature</b> as well, either <b>MsiUseFeature</b> was not called, or its return value was not properly checked.
</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_component_specific_functions">Component-Specific Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetfeatureinfo"></a>MsiGetFeatureInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureInfo</b> function returns descriptive information for a feature.</p>
<pre><code><b>UINT MsiGetFeatureInfo(
  MSIHANDLE</b> <i>hProduct</i><b>,</b>  // product handle obtained from <b>MsiOpenProduct</b>
<b>  LPCTSTR</b> <i>szFeature</i><b>,</b>   // feature name
<b>  DWORD</b> <i>*lpAttributes</i><b>,</b> // attribute flags
<b>  LPTSTR</b> <i>lpTitleBuf</i><b>,</b>   // localized name
<b>  DWORD</b> <i>*pcchTitleBuf</i><b>,</b> // in/out buffer character count
<b>  LPTSTR</b> <i>lpHelpBuf</i><b>,</b>    // description
<b>  DWORD</b> <i>*pcchHelpBuf   </i>// in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hProduct</i></dt>
<dd>
Handle to the product that owns the feature. This handle is obtained from <a href="msi_5f78.htm"><b>MsiOpenProduct</b></a>.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature code for the feature about which information should be returned.</dd>
<dt>
<i>lpAttributes</i></dt>
<dd>
Specifies the attribute flags. Must be one or more of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=81%>Flag</th>
<th align=left width=19%>Value</th>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORLOCAL</td>
<td width=19%>1 &lt;&lt; 0</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORSOURCE</td>
<td width=19%>1 &lt;&lt; 1</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FOLLOWPARENT</td>
<td width=19%>1 &lt;&lt; 2</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_FAVORADVERTISE</td>
<td width=19%>1 &lt;&lt; 3</td>
</tr>
<tr valign=top>
<td width=81%>INSTALLFEATUREATTRIBUTE_DISALLOWADVERTISE</td>
<td width=19%>1 &lt;&lt; 4</td>
</tr>
</table><br>

</dd>
</dl>
<p>
For information on how these flags work together, see the <a href="tref_0a91.htm">Feature table</a>.
<dl>
<dt>
<i>lpTitleBuf</i></dt>
<dd>
Pointer to a buffer to receive the localized descriptive name of the feature.</dd>
<dt>
<i>pcchTitleBuf</i></dt>
<dd>
As input, the size of <i>lpTitleBuf</i>. As output, the number of characters returned in <i>lpTitleBuf.</i></dd>
<dt>
<i>lpHelpBuf</i></dt>
<dd>
Pointer to a buffer to receive the localized descriptive name of the feature.</dd>
<dt>
<i>pcchHelpBuf</i></dt>
<dd>
As input, the size of <i>lpHelpBuf</i>. As output, the number of characters returned in <i>lpHelpBuf.</i>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The product handle is invalid.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters is invalid.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer is too small to hold the requested data.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function returned successfully.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
The feature is not known.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The buffer sizes for the <b>MsiGetFeatureInfo </b>function should include an extra character for the terminating NULL character upon input. If a buffer is too small, the returned string will be truncated with NULL, and the buffer size will contain the number of characters in the whole string, not including the terminating NULL.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_product_query_functions">Product Query Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetfeatureusage"></a>MsiGetFeatureUsage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureUsage</b> returns the usage metrics for a product feature.</p>
<pre><code><b>UINT MsiGetFeatureUsage(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>    // product code
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>    // feature ID
  <b>DWORD *</b><i>pdwUseCount</i><b>,</b>   // returned use count
  <b>WORD *</b>pwDateUsed      // last date used
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product containing the feature.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature code for the feature for which metrics are to be returned.</dd>
<dt>
<i>pdwUseCount</i></dt>
<dd>
Indicates the number of times the feature has been used.</dd>
<dt>
<i>pwDateUsed</i></dt>
<dd>
Specifies the date that the feature was last used. The date is in the MS-DOS  date format, as shown in the following table.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=10%>Bits</th>
<th align=left width=90%>Contents</th>
</tr>
<tr valign=top>
<td width=10%>0-4</td>
<td width=90%>Day of the month (1-31)</td>
</tr>
<tr valign=top>
<td width=10%>5-8</td>
<td width=90%>Month (1 = January, 2 = February, and so on)</td>
</tr>
<tr valign=top>
<td width=10%>9-15</td>
<td width=90%>Year offset from 1980 (add 1980 to get actual year)</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
No usage information is available or the product or feature is invalid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetproductcode"></a>MsiGetProductCode</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetProductCode</b> function returns the product code of an application by using the component code of an installed or advertised component of the application. During initialization, an application must determine under which product code it has been installed or advertised.</p>
<pre><code><b>UINT MsiGetProductCode(
</b>  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>  // component code for application
  <b>LPTSTR</b> <i>lpProductBuf</i>   // buffer to receive GUID
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
This parameter specifies the component code of a component that has been installed or advertised by the application. This will be typically the component code of the component containing the executable file of the application.</dd>
<dt>
<i>lpProductBuf</i></dt>
<dd>
Pointer to a buffer that receives the product code. This buffer must be 39 characters long. The first 38 characters are for the GUID, and the last character is for the terminating NULL character.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The product code could not be determined.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_COMPONENT</dt>
<dd>
The specified component is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
During initialization, an application must determine the product code under which it was installed. An application can be part of different products in different installations. For example, an application can be part of a suite of applications, or it can be installed by itself. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_application_only_functions">Application-Only Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetproductinfo"></a>MsiGetProductInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetProductInfo</b> function returns product information for published and installed products.</p>
<pre><code><b>INSTALLSTATE MsiGetProductInfo(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>   // product code
  <b>LPCTSTR</b> <i>szProperty</i><b>,</b>  // product property
  <b>LPTSTR</b> <i>lpValueBuf</i><b>,</b>   // buffer to return property value
  <b>DWORD</b> <i>*pcchValueBuf</i>  // in/out buffer character count, 
                       // including NULL
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product.</dd>
<dt>
<i>szProperty</i></dt>
<dd>
Specifies the property to be retrieved. The properties in the following list can only be retrieved from applications that are already installed.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=75%>Installed Properties</th>
<th align=left width=25%>Description</th>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_INSTALLEDPRODUCTNAME</td>
<td width=25%>Installed product name</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_VERSIONSTRING</td>
<td width=25%>Product version</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_HELPLINK</td>
<td width=25%>Support link</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_HELPTELEPHONE</td>
<td width=25%>Support telephone</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_INSTALLLOCATION</td>
<td width=25%>Installation location</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_INSTALLSOURCE</td>
<td width=25%>Installation source</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_INSTALLDATE</td>
<td width=25%>Installation date</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_PUBLISHER</td>
<td width=25%>Publisher</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_LOCALPACKAGE</td>
<td width=25%>Local cached package</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_URLINFOABOUT</td>
<td width=25%>URL information</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_URLUPDATEINFO</td>
<td width=25%>URL update information</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_VERSIONMINOR</td>
<td width=25%>Minor product version</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_VERSIONMAJOR</td>
<td width=25%>Major product version</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_PACKAGECODE</td>
<td width=25%>Identifier of package product was installed from</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_VERSION</td>
<td width=25%>Product <p>
version</p>
</td>
</tr>
</table><br>

</dd>
</dl>
<p>
The properties in the following list can also be retrieved from applications that are advertised.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=75%>Advertised Properties</th>
<th align=left width=25%>Description</th>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_TRANSFORMS</td>
<td width=25%>Transforms</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_LANGUAGE</td>
<td width=25%>Product language</td>
</tr>
<tr valign=top>
<td width=75%>INSTALLPROPERTY_PRODUCTNAME</td>
<td width=25%>Human readable product name</td>
</tr>
</table><br>
<dl>
<dt>
<i>lpValueBuf</i></dt>
<dd>
Pointer to a buffer that receives the property value. This parameter can be NULL.</dd>
<dt>
<i>pcchValueBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpValueBuf</i> parameter. This size should include the terminating NULL character. 
<p>
If <i>lpValueBuf</i> is NULL, <i>pcchValueBuf</i> can be NULL.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer is too small to hold the requested data.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The product is unadvertised or uninstalled.</dd>
<dt>
ERROR_UNKNOWN_PROPERTY</dt>
<dd>
The property is unrecognized.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When the <b>MsiGetProductInfo </b>function returns, the <i>pcchValueBuf</i> parameter contains the length of the class string stored in the buffer. The count returned does not include the terminating NULL character. If the buffer is not big enough, <b>MsiGetProductInfo</b> returns ERROR_MORE_DATA, and <b>MsiGetProductInfo</b> contains the size of the string, in characters, without counting the NULL character.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetproductproperty"></a>MsiGetProductProperty</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetProductProperty</b> function retrieves product properties. These properties are in the product database.</p>
<pre><code><b>UINT MsiGetProductProperty(
</b>  <b>MSIHANDLE</b> <i>hProduct</i><b>, </b>  // product handle obtained from <b>MsiOpenProduct</b>
  <b>LPCTSTR</b> <i>szProperty</i><b>,  </b> // property name, case-sensitive
  <b>LPTSTR</b> <i>lpValueBuf</i><b>,</b>    // returned value, NULL if not desired
  <b>DWORD</b> <i>*pcchValueBuf</i>   // in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hProduct</i></dt>
<dd>
Handle to the product obtained from <a href="msi_5f78.htm"><b>MsiOpenProduct</b></a>.</dd>
<dt>
<i>szProperty</i></dt>
<dd>
Specifies the property to retrieve. This is case-sensitive.</dd>
<dt>
<i>lpValueBuf</i></dt>
<dd>
Pointer to a buffer that receives the property value. The value is truncated and null-terminated if <i>lpValueBuf</i> is too small. This parameter can be NULL.</dd>
<dt>
<i>pcchValueBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpValueBuf</i> parameter. This size should include the terminating NULL character.
<p>
If <i>lpValueBuf</i> is NULL, <i>pcchValueBuf</i> can be NULL.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid handle was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer is too small to hold the entire property value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When the <b>MsiGetProductProperty</b> function returns, the <i>pcchValueBuf</i> parameter contains the length of the class string stored in the buffer. The count returned does not include the terminating NULL character. If the buffer is not big enough, <b>MsiGetProductProperty</b> returns ERROR_MORE_DATA, and <b>MsiGetProductProperty</b> contains the size of the string, in characters, without counting the NULL character.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_product_query_functions">Product Query Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetuserinfo"></a>MsiGetUserInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetUserInfo</b> function returns the registered user information for an installed product.</p>
<pre><code><b>USERINFOSTATE MsiGetUserInfo(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>      // product code
  <b>LPTSTR</b> <i>lpUserNameBuf</i><b>,</b>   // buffer to return user name
  <b>DWORD</b> <i>*pcchUserNameBuf</i><b>,</b> // in/out buffer character count,
                          // including NULL
  <b>LPTSTR</b> <i>lpOrgNameBuf</i><b>,</b>    // buffer to return organization name
  <b>DWORD</b> <i>*pcchOrgNameBuf</i><b>,</b>  // in/out buffer character count,
                          // including NULL
  <b>LPTSTR</b> <i>lpSerialBuf</i><b>,</b>     // buffer to return product ID
  <b>DWORD</b> <i>*pcchSerialBuf</i>    // in/out buffer character count,
                          // including NULL
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product to be queried.</dd>
<dt>
<i>lpUserNameBuf</i></dt>
<dd>
Pointer to a variable that receives the name of the user.</dd>
<dt>
<i>pcchUserNameBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpUserNameBuf</i> parameter. This size should include the terminating null character..</dd>
<dt>
<i>lpOrgNameBuf</i></dt>
<dd>
Pointer to a buffer that receives the organization name.</dd>
<dt>
<i>pcchOrgNameBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpOrgNameBuf</i> parameter. This size should include the terminating null character. </dd>
<dt>
<i>lpSerialBuf</i></dt>
<dd>
Pointer to a buffer that receives the product ID.</dd>
<dt>
<i>pcchSerialBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpSerialBuf</i> parameter. This size should include the terminating null character.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
USERINFOSTATE_ABSENT</dt>
<dd>
Some or all of the user information is absent.</dd>
<dt>
USERINFOSTATE_INVALIDARG</dt>
<dd>
One of the function parameters was invalid.</dd>
<dt>
USERINFOSTATE_MOREDATA</dt>
<dd>
A buffer is too small to hold the requested data.</dd>
<dt>
USERINFOSTATE_PRESENT</dt>
<dd>
The function completed successfully.</dd>
<dt>
USERINFOSTATE_UNKNOWN</dt>
<dd>
The product code does not identify a known product.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When the <b>MsiGetUserInfo</b> function returns, the <i>pcchNameBuf</i> parameter contains the length of the class string stored in the buffer. The count returned does not include the terminating NULL character. If the buffer is not big enough, the <b>MsiGetUserInfo</b> function returns USERINFOSTATE_MOREDATA, and <b>MsiGetUserInfo</b> contains the size of the string, in characters, without counting the NULL character.</p>
<p>
The user information is considered to be present even in the absence of a company name.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiinstallmissingcomponent"></a>MsiInstallMissingComponent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiInstallMissingComponent </b>function installs files that are unexpectedly missing.</p>
<pre><code><b>UINT MsiInstallMissingComponent(
</b>  <b>LPCTSTR </b><i>szProduct</i><b>,</b>           // product code
  <b>LPCTSTR</b> <i>szComponent</i><b>,</b><i> </i>        // component ID
<b>  INSTALLSTATE </b><i>eInstallState</i><b>   </b>// install type
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product that owns the component to be installed.</dd>
<dt>
<i>szComponent</i></dt>
<dd>
Identifies the component to be installed.</dd>
<dt>
<i>eInstallState</i></dt>
<dd>
Specifies the way the component should be installed. This parameter must be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>Value</th>
<th align=left width=50%>Meaning</th>
</tr>
<tr valign=top>
<td width=50%>INSTALLSTATE_LOCAL</td>
<td width=50%>The component should be locally installed.</td>
</tr>
<tr valign=top>
<td width=50%>INSTALLSTATE_SOURCE</td>
<td width=50%>The component should be installed to run from the source.</td>
</tr>
<tr valign=top>
<td width=50%>INSTALLSTATE_DEFAULT</td>
<td width=50%>The component should be installed according to the installer defaults.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION </dt>
<dd>
The configuration information is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE </dt>
<dd>
The installation failed.</dd>
<dt>
ERROR_INSTALL_SOURCE_ABSENT </dt>
<dd>
The source was unavailable.</dd>
<dt>
ERROR_INSTALL_SUSPEND </dt>
<dd>
The installation was suspended.</dd>
<dt>
ERROR_INSTALL_USEREXIT </dt>
<dd>
The user exited the installation.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters is invalid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT </dt>
<dd>
The product code is unrecognized.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiInstallMissingComponent</b> function resolves the feature(s) that the component belongs to. Then, the product feature that requires the least additional disk space is installed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msiinstallmissingfile"></a>MsiInstallMissingFile</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiInstallMissingFile</b> function installs files that are unexpectedly missing.</p>
<pre><code><b>UINT MsiInstallMissingFile(
</b>  <b>LPCTSTR </b><i>szProduct</i><b>,</b>      // product code
  <b>LPCTSTR</b> <i>szFile </i>         // file name, without path
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product that owns the file to be installed.</dd>
<dt>
<i>szFile</i></dt>
<dd>
Identifies the file to be installed.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION </dt>
<dd>
The configuration information is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE </dt>
<dd>
The installation failed.</dd>
<dt>
ERROR_INSTALL_SOURCE_ABSENT </dt>
<dd>
The source was unavailable.</dd>
<dt>
ERROR_INSTALL_SUSPEND </dt>
<dd>
The installation was suspended.</dd>
<dt>
ERROR_INSTALL_USEREXIT </dt>
<dd>
The user exited the installation.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
A parameter was invalid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT </dt>
<dd>
The product code is unrecognized.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiInstallMissingFile</b> function obtains the component that the file belongs to from the file table. Then, the product feature that requires the least additional disk space is installed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiinstallproduct"></a>MsiInstallProduct</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiInstallProduct</b> function installs or uninstalls a product.</p>
<pre><code><b>UINT MsiInstallProduct(
</b>  <b>LPCTSTR</b> <i>szPackagePath</i><b>,</b>    // path to package
  <b>LPCTSTR</b> <i>szCommandLine  </i>   // package command line
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szPackagePath</i></dt>
<dd>
Specifies the path to the package.</dd>
<dt>
<i>szCommandLine</i></dt>
<dd>
Specifies the command line property settings. This should be a list of the format <i>Property=Setting Property=Setting.</i>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiInstallProduct</b> function displays the user interface with the current settings and log mode. You can change user interface settings with the <a href="msi_2j3d.htm"><b>MsiSetInternalUI</b></a> and <a href="msi_5dm1.htm"><b>MsiSetExternalUI</b></a> functions. You can set the log mode with the <a href="msi_2ch3.htm"><b>MsiEnableLog</b></a> function.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msilocatecomponent"></a>MsiLocateComponent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiLocateComponent</b> function returns the full path to an installed component without a product code. This function attempts to determine the product using <a href="msi_59ph.htm"><b>MsiGetProductCode</b></a>, but is not guaranteed to find the correct product for the caller. <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> should always be called when possible.</p>
<pre><code><b>INSTALLSTATE MsiLocateComponent(
  LPCTSTR</b> <i>szComponent</i><b>,</b>  // component Id, string GUID
<b>  LPTSTR</b> <i>lpPathBuf</i><b>,</b>     // returned path
<b>  DWORD</b> <i>*pcchBuf</i>        // in/out buffer character count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component ID of the component to be located.</dd>
<dt>
<i>lpPathBuf</i></dt>
<dd>
Pointer to a variable that receives the path to the component. This parameter can be NULL.</dd>
<dt>
<i>pcchBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpPathBuf</i> parameter. 
<p>
If <i>lpPathBuf</i> is NULL, <i>pcchBuf</i> can be NULL. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_NOTUSED</dt>
<dd>
The component being requested is disabled on the computer.</dd>
<dt>
INSTALLSTATE_ABSENT</dt>
<dd>
The component is not installed.</dd>
<dt>
INSTALLSTATE_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
INSTALLSTATE_INVALIDARG</dt>
<dd>
One of the function parameters is invalid.</dd>
<dt>
INSTALLSTATE_LOCAL</dt>
<dd>
The component is installed locally.</dd>
<dt>
INSTALLSTATE_SOURCE</dt>
<dd>
The component is installed to run from source.</dd>
<dt>
INSTALLSTATE_SOURCEABSENT</dt>
<dd>
The component source is inaccessible.</dd>
<dt>
INSTALLSTATE_UNKNOWN</dt>
<dd>
The product code or component ID is unknown.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Upon success of the <b>MsiLocateComponent</b> function, the <i>pcchBuf</i> parameter contains the length of the string in <i>lpPathBuf</i>.</p>
<p>
The <b>MsiLocateComponent</b> function might return INSTALLSTATE_ABSENT or INSTALL_STATE_UNKNOWN, for the following reasons:
<ul>
<li>
INSTALLSTATE_ABSENT<p>
The application did not properly ensure that the feature was installed by calling <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a> and, if necessary, <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a>. 
</li>
<li>
INSTALLSTATE_UNKNOWN <p>
The feature is not published. The application should have determined this earlier by calling <a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a> or <a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a>.<b> </b>The application makes these calls while it initializes. An application should only use features that are known to be published. Since INSTALLSTATE_UNKNOWN should have been returned by <b>MsiUseFeature</b> as well, either <b>MsiUseFeature</b> was not called, or its return value was not properly checked.
</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_component_specific_functions">Component-Specific Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiopenpackage"></a>MsiOpenPackage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiOpenPackage</b> function opens a package for use with the functions that access the product database. The <a href="msi_6g6d.htm"><b>MsiCloseHandle</b></a> function must be called with the handle when the handle is no longer needed.</p>
<pre><code><b>UINT MsiOpenPackage(
</b>  <b>LPCTSTR</b> <i>szPackagePath</i><b>,</b>  // the full path to the package
  <b>MSIHANDLE</b> <i>*hProduct</i>     // returned product handle, must be closed
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szPackagePath</i></dt>
<dd>
Specifies the path to the package.</dd>
<dt>
<i>hProduct</i></dt>
<dd>
Pointer to a variable that receives the product handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration information is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The product could not be opened.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.
</dd>
</dl>
<h4>Remarks</h4>
<p>
MsiOpenPackage can accept an opened database handle in the form "#nnnn", where nnnn is the database handle in string form, i.e. #123, in lieu of a path to the package. This is intended for development tasks such as running validation actions, or for use with database management tools.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_product_query_functions">Product Query Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiopenproduct"></a>MsiOpenProduct</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiOpenProduct</b> function opens a product for use with the functions that access the product database. The <a href="msi_6g6d.htm"><b>MsiCloseHandle</b></a> function must be called with the handle when the handle is no longer needed.</p>
<pre><code><b>UINT MsiOpenProduct(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>   // product code
  <b>MSIHANDLE</b> <i>*hProduct</i>  // returned product handle, must be closed
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code of the product to be opened.</dd>
<dt>
<i>hProduct</i></dt>
<dd>
Pointer to a variable that receives the product handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration information is corrupt.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The product could not be opened.</dd>
<dt>
ERROR_INSTALL_SOURCE_ABSENT </dt>
<dd>
The source was unavailable.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The product code was unrecognized.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_product_query_functions">Product Query Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiprovidecomponent"></a>MsiProvideComponent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiProvideComponent</b> function returns the full component path, performing any necessary installation. This function prompts for source if necessary and increments the usage count for the feature.</p>
<pre><code><b>UINT MsiProvideComponent(
</b>  <b>LPCTSTR</b> <i>szProduct</i>,    // product code in case install required
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>    // feature ID in case install required
  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>  // component ID
  <b>DWORD</b><i> dwInstallMode,</i>  // the install mode
  <b>LPTSTR</b> <i>lpPathBuf</i><b>,</b>     // returned path to component key file
  <b>DWORD</b> <i>*pcchPathBuf</i>    // in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product that contains the feature with the necessary component.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature ID of the feature with the necessary component.</dd>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component code of the necessary component.</dd>
<dt>
<i>dwInstallMode</i></dt>
<dd>
Defines the installation mode. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Value</th>
<th align=left width=53%>Meaning</th>
</tr>
<tr valign=top>
<td width=47%>INSTALLMODE_DEFAULT</td>
<td width=53%>Provide the component, performing any installation, if necessary.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLMODE_EXISTING</td>
<td width=53%>Provide the component only if the feature exists, else return ERROR_FILE_NOT_FOUND.</td>
</tr>
<tr valign=top>
<td width=47%>combination of the REINSTALLMODE flags</td>
<td width=53%>Call <a href="msi_4ag5.htm"><b>MsiReinstallFeature</b></a> to reinstall feature using this parameter for the <i>dwReinstallMode</i> parameter, and then provide the component.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpPathBuf</i></dt>
<dd>
Pointer to a variable that receives the path to the component. This parameter can be NULL.</dd>
<dt>
<i>pcchPathBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpPathBuf</i> parameter. 
<p>
If <i>lpPathBuf</i> is NULL, <i>pcchBuf</i> can be NULL.  

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
ERROR_FILE_NOT_FOUND</dt>
<dd>
The feature is absent or broken. this error is returned for dwInstallMode = INSTALLMODE_EXISTING.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The installation failed.</dd>
<dt>
ERROR_INSTALL_NOTUSED</dt>
<dd>
The component being requested is disabled on the computer.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INSTALL_SERVICE_FAILURE</dt>
<dd>
The installation service could not be accessed.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The installation was suspended and is incomplete.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user canceled the installation.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
The feature ID does not identify a known feature.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The product code does not identify a known product.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Upon success of the <b>MsiProvideComponent</b> function, the <i>pcchPathBuf</i> parameter contains the length of the string in <i>lpPathBuf</i>.</p>
<p>
The <b>MsiProvideComponent</b> function combines the functionality of <a href="msi_3ckl.htm"><b>MsiUseFeature</b></a>, <a href="msi_8cit.htm"><b>MsiConfigureFeature</b></a>, and <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a>. You can use the <b>MsiProvideComponent</b> function to simplify the calling sequence. However, because this function increments the usage count, use it with caution to prevent inaccurate usage counts. The <b>MsiProvideComponent</b> function also provides less flexibility than the series of individual calls. </p>
<p>
If the application is recovering from an unexpected situation, the application has probably already called <b>MsiUseFeature</b> and incremented the usage count. In this case, the application should call <b>MsiConfigureFeature</b> instead of <b>MsiProvideComponent</b> to avoid incrementing the count again.</p>
<p>
The INSTALLMODE_EXISTING option cannot be used in combination with the REINSTALLMODE flag</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_component_specific_functions">Component-Specific Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiprovidequalifiedcomponent"></a>MsiProvideQualifiedComponent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiProvideQualifiedComponent </b>function returns the full component path for a qualified component and performs any necessary installation. This function prompts for source if necessary and increments the usage count for the feature.</p>
<pre><code><b>UINT MsiProvideQualifiedComponent(
</b>  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>  // component ID
  <b>LPCTSTR</b> <i>szQualifier</i><b>,</b>  // specifies which component to access
  <b>DWORD</b><i> dwInstallMode,</i>  // the install mode
  <b>LPTSTR</b> <i>lpPathBuf</i><b>, </b>    // in/out returned path, NULL if not needed
  <b>DWORD</b> <i>*pcchPathBuf</i>    // in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component ID that for the requested component. This may not be the GUID for the component itself but rather a server that provides the correct functionality, as in the ComponentID column of the <a href="tref_7xt1.htm">PublishComponent table</a>.</dd>
<dt>
<i>szQualifier</i></dt>
<dd>
Specifies a qualifier into a list of advertising components (from <a href="tref_7xt1.htm">PublishComponent Table</a>).</dd>
<dt>
<i>dwInstallMode</i></dt>
<dd>
Defines the installation mode. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Value</th>
<th align=left width=53%>Meaning</th>
</tr>
<tr valign=top>
<td width=47%>INSTALLMODE_DEFAULT</td>
<td width=53%>Provide the component, performing any installation, if necessary.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLMODE_EXISTING</td>
<td width=53%>Provide the component only if the feature exists, else return ERROR_FILE_NOT_FOUND.</td>
</tr>
<tr valign=top>
<td width=47%>combination of the REINSTALLMODE flags</td>
<td width=53%>Call <a href="msi_4ag5.htm"><b>MsiReinstallFeature</b></a> to reinstall feature using this parameter for the <i>dwReinstallMode</i> parameter, and then provide the component.</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpPathBuf</i></dt>
<dd>
Pointer to a variable that receives the path to the component. This parameter can be NULL.</dd>
<dt>
<i>pcchPathBuf</i></dt>
<dd>
Pointer to a variable that specifies the size, in characters, of the buffer pointed to by the <i>lpPathBuf</i> parameter. 
<p>
If <i>lpPathBuf</i> is NULL, <i>pcchBuf</i> can be NULL. 

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INDEX_ABSENT</dt>
<dd>
Component qualifier not present.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_FILE_NOT_FOUND</dt>
<dd>
The feature is absent or broken. this error is returned for dwInstallMode = INSTALLMODE_EXISTING.</dd>
<dt>
ERROR_UNKNOWN_COMPONENT</dt>
<dd>
The specified component is unknown.</dd>
<dt>
Any <a href="msi_4rxv.htm">Action Error</a></dt>
<dd>
An error relating to an action occurred.</dd>
<dt>
Any <a href="msi_5svn.htm">Initialization Error</a></dt>
<dd>
An error relating to initialization occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Upon success of the <b>MsiProvideQualifiedComponent</b> function, the <i>pcchPathBuf</i> parameter contains the length of the string in <i>lpPathBuf</i>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_component_specific_functions">Component-Specific Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiqueryfeaturestate"></a>MsiQueryFeatureState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiQueryFeatureState</b> function returns the installed state for a product feature.</p>
<pre><code><b>INSTALLSTATE MsiQueryFeatureState(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>    // product code
  <b>LPCTSTR</b> <i>szFeature</i>     // feature ID
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product that contains the feature of interest.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Identifies the feature of interest.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
INSTALLSTATE_ABSENT</dt>
<dd>
The feature is not installed.</dd>
<dt>
INSTALLSTATE_ADVERTISED</dt>
<dd>
The feature is advertised</dd>
<dt>
INSTALLSTATE_LOCAL</dt>
<dd>
The feature is installed locally.</dd>
<dt>
INSTALLSTATE_SOURCE</dt>
<dd>
The feature is installed to run from source.</dd>
<dt>
INSTALLSTATE_INVALIDARG</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
INSTALLSTATE_UNKNOWN</dt>
<dd>
The product code or feature ID is unknown.</dd>
<dt>
INSTALLSTATE_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiQueryFeatureState</b> function does not validate that the feature is actually accessible.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiqueryproductstate"></a>MsiQueryProductState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiQueryProductState</b> function returns the installed state for a product.</p>
<pre><code><b>INSTALLSTATE MsiQueryProductState(
</b>  <b>LPCTSTR</b> <i>szProduct</i>  // product code
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code that identifies the product to be queried.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
INSTALLSTATE_ABSENT </dt>
<dd>
The product is not installed.</dd>
<dt>
INSTALLSTATE_BAD_CONFIGURATION</dt>
<dd>
The configuration data is corrupt.</dd>
<dt>
INSTALLSTATE_DEFAULT </dt>
<dd>
The product is installed. </dd>
<dt>
INSTALLSTATE_INVALIDARG</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
INSTALLSTATE_UNKNOWN</dt>
<dd>
The product code does not identify a known product.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_system_status_functions">System Status Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msireinstallfeature"></a>MsiReinstallFeature</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiReinstallFeature</b> function validates or corrects problems with features.</p>
<pre><code><b>UINT MsiReinstallFeature(
</b>  <b>LPCTSTR</b> <i>szProduct</i>,       // product code
  <b>LPCTSTR</b> <i>szFeature</i>,       // feature ID
  <b>LPCTSTR</b> <i>dwReinstallMode</i>  // one or more REINSTALLMODE modes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product containing the feature to be reinstalled.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Identifies the feature to be reinstalled. </dd>
<dt>
<i>dwReinstallMode</i></dt>
<dd>
Specifies what to install. This parameter can be one or more of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=63%>Value</th>
<th align=left width=37%>Meaning</th>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_REPAIR</td>
<td width=37%>Repair any defects encountered.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEMISSING</td>
<td width=37%>Reinstall only if the file is missing.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEOLDERVERSION</td>
<td width=37%>Reinstall if the file is missing or is an older version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEEQUALVERSION</td>
<td width=37%>Reinstall if the file is missing or is an equal or older version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEEXACT</td>
<td width=37%>Reinstall if the file is missing or is not an exact version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEVERIFY</td>
<td width=37%>Check sum executables, and reinstall if they are missing or corrupt.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEREPLACE</td>
<td width=37%>Reinstall all files regardless of version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_USERDATA</td>
<td width=37%>Insure required user regular entries.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_MACHINEDATA</td>
<td width=37%>Insure required machine regular entries.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_SHORTCUT</td>
<td width=37%>Validate shortcuts and progman items.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The installation failed.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INSTALL_SERVICE_FAILURE</dt>
<dd>
The installation service could not be accessed.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The installation was suspended and is incomplete.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user canceled the installation.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
The feature ID does not identify a known feature.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The product code does not identify a known product.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiReinstallFeature</b> function can also verify registry entries and shortcuts. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msireinstallproduct"></a>MsiReinstallProduct</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiReinstallProduct</b> function validates or corrects installation problems in products.</p>
<pre><code><b>INSTALLSTATE MsiReinstallProduct(
</b>  <b>LPCTSTR</b> <i>szProduct</i><b>,</b>        // product code
  <b>DWORD</b> <i>dwReinstallMode</i>     // one or more REINSTALLMODE modes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product to be reinstalled.</dd>
<dt>
<i>dwReinstallMode</i></dt>
<dd>
Specifies the reinstall mode. This parameter can be one or more of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=63%>Value</th>
<th align=left width=37%>Meaning</th>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_REPAIR</td>
<td width=37%>Repair any defects encountered.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEMISSING</td>
<td width=37%>Reinstall only if the file is missing.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEOLDERVERSION</td>
<td width=37%>Reinstall if the file is missing or is an older version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEEQUALVERSION</td>
<td width=37%>Reinstall if the file is missing or is an equal or older version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEEXACT</td>
<td width=37%>Reinstall if the file is missing or is not an exact version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEVERIFY</td>
<td width=37%>Check sum executables, and reinstall if they are missing or corrupt.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_FILEREPLACE</td>
<td width=37%>Reinstall all the files regardless of version.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_USERDATA</td>
<td width=37%>Insure required user regular entries.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_MACHINEDATA</td>
<td width=37%>Insure required machine regular entries.</td>
</tr>
<tr valign=top>
<td width=63%>REINSTALLMODE_SHORTCUT</td>
<td width=37%>Validate shortcuts and progman items.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The installation failed.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INSTALL_SERVICE_FAILURE</dt>
<dd>
The installation service could not be accessed.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The installation was suspended and is incomplete.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user canceled the installation.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function completed successfully.</dd>
<dt>
ERROR_UNKNOWN_PRODUCT</dt>
<dd>
The product code does not identify a known product.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiReinstallProduct</b> function typically validates or corrects installations.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_installation_and_configuration_functions">Installation and Configuration Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetexternalui"></a>MsiSetExternalUI</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetExternalUI</b> function enables an external user-interface handler. This user interface is then used for all subsequent calls to user-interface-generating installer functions in this process.</p>
<pre><code><b>INSTALLUI_HANDLER MsiSetExternalUI(
</b>  <b>INSTALLUI_HANDLER</b> <i>puiHandler</i><b>,</b> // UI handler
  <b>DWORD</b> <i>dwMessageFilter</i>,        // bit flags designating which messages to handle
  <b>LPVOID</b> <i>pvContext</i>              // application context
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>puiHandler</i></dt>
<dd>
Specifies a callback function that conforms to the <a href="msi_2g4y.htm"><b>INSTALLUI_HANDLER</b></a> specification.</dd>
<dt>
<i>dwMessageFilter</i></dt>
<dd>
Specifies which messages to handle.</dd>
<dt>
<i>pvContext</i></dt>
<dd>
Pointer to an application context. This context is returned to the application through the user-interface handler.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value is the previously set external handler, or 0 if there was no previously set handler. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_user_interface_and_logging_functions">Interface and Logging Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetinternalui"></a>MsiSetInternalUI</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetInternalUI</b> function enables the installer's internal user interface. This user interface is then used for all subsequent calls to user-interface-generating installer functions in this process.</p>
<pre><code><b>INSTALLUILEVEL MsiSetInternalUI(
</b>  <b>INSTALLUILEVEL</b> <i>dwUILevel</i><b>,</b>  // UI level
  <b>HWND</b> <i>*phWnd</i>                // handle of owner window
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwUILevel</i></dt>
<dd>
Specifies the level of complexity of the user interface. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Value</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_FULL</td>
<td width=49%>Authored user interface with wizards, progress, and errors.</td>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_REDUCED</td>
<td width=49%>Authored user interface with wizard dialog boxes suppressed.</td>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_BASIC</td>
<td width=49%>Simple progress and error handling.</td>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_DEFAULT</td>
<td width=49%>The installer chooses an appropriate user interface level.</td>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_NOCHANGE</td>
<td width=49%>The installation level is not changed.</td>
</tr>
<tr valign=top>
<td width=51%>INSTALLUILEVEL_NONE</td>
<td width=49%>Completely silent installation.</td>
</tr>
</table><br>

</dd>
<dt>
<i>phWnd</i></dt>
<dd>
Pointer to a window. This window becomes the owner of any user interface created. A pointer to the previous owner of the user interface is returned. If this parameter is NULL, the owner of the user interface does not change.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The previous user interface level is returned. If an invalid <i>dwUILevel</i> is passed, then INSTALLUILEVEL_NOCHANGE<i> </i>is returned.</p>
<h4>Remarks</h4>
<p>
The <b>MsiSetInternalUI</b> function is useful when the installer must display a user interface. For example, if a feature is installed, but the source is a compact disc that must be inserted, the installer prompts the user for the compact disc. Depending on the nature of the installation, the application might also display progress indicators or query the user for information. </p>
<p>
When Msi.dll is loaded, the user interface level is set to DEFAULT and the user interface owner is set to 0 (that is, the initial user interface owner is the desktop).</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_user_interface_and_logging_functions">Interface and Logging Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiusefeature"></a>MsiUseFeature</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiUseFeature</b> function increments the usage count for a particular feature and indicates the installation state for that feature. This function should be used to indicate an application's intent to use a feature.</p>
<pre><code><b>INSTALLSTATE MsiUseFeature(
  LPCTSTR </b><i>szProduct</i><b>,</b><i>   </i>// product that owns the feature
<b>  LPCTSTR </b><i>szFeature    </i>// feature to be used
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szProduct</i></dt>
<dd>
Specifies the product code for the product that owns the feature to be used.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Identifies the feature to be used.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
INSTALLSTATE_ABSENT</dt>
<dd>
The feature is not installed.</dd>
<dt>
INSTALLSTATE_ADVERTISED</dt>
<dd>
The feature is advertised</dd>
<dt>
INSTALLSTATE_LOCAL</dt>
<dd>
The feature is locally installed and available for use.</dd>
<dt>
INSTALLSTATE_SOURCE</dt>
<dd>
The feature is installed from the source and available for use.</dd>
<dt>
INSTALLSTATE_UNKNOWN</dt>
<dd>
The feature is not published.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiUseFeature</b> function should only be used on features known to be published. INSTALLSTATE_UNKNOWN indicates that the program is trying to use a feature that is not published. The application should determine whether the feature is published before calling <b>MsiUseFeature</b> by calling <a href="msi_4e3p.htm"><b>MsiQueryFeatureState</b></a> or <a href="msi_0e9f.htm"><b>MsiEnumFeatures</b></a>. The application should make these calls while it initializes. An application should only use features that are known to be published.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="msi_8vqd.htm#_msi_application_only_functions">Application-Only Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiverifypackage"></a>MsiVerifyPackage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiVerifyPackage</b> function verifies that the given file is an installation package.</p>
<pre><code><b>UINT MsiVerifyPackage(
</b>  <b>LPCTSTR</b> <i>szPackagePath</i>  // location of package
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szPackagePath</i></dt>
<dd>
Specifies the path and file name of the package.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_PACKAGE_INVALID</dt>
<dd>
The file is not a valid package.</dd>
<dt>
ERROR_INSTALL_PACKAGE_OPEN_FAILED</dt>
<dd>
The file could not be opened.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
The parameter is not valid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The file is a package.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<p>&nbsp;</p>

<h1><a name="_msi_initialization_errors"></a>Initialization Errors</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=71%>Error Code</th>
<th align=left width=29%>Error</th>
</tr>
<tr valign=top>
<td width=71%>ERROR_SUCCESS</td>
<td width=29%>initialization complete</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_ALREADY_INITIALIZED</td>
<td width=29%>this engine object is already initialized</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INVALID_COMMAND_LINE</td>
<td width=29%>invalid command line syntax</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_ALREADY_RUNNING</td>
<td width=29%>an installation is already in progress</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_PACKAGE_OPEN_FAILED</td>
<td width=29%>database could not be opened</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_PACKAGE_INVALID</td>
<td width=29%>incompatible database</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_PACKAGE_VERSION</td>
<td width=29%>installer version does not support database format</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_PLATFORM_UNSUPPORTED</td>
<td width=29%>the platform specified by the  <a href="sref_80hl.htm">Template Summary property</a> is not supported.</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_SERVICE_FAILURE_FAILURE</td>
<td width=29%>install server could not be accessed</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_BAD_CONFIGURATION</td>
<td width=29%>configuration data is corrupt</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_UI_FAILURE</td>
<td width=29%>could not initialize handler interface</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_LOG_FAILURE</td>
<td width=29%>could not open log file in requested mode</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_LANGUAGE_UNSUPPORTED</td>
<td width=29%>no acceptable language could be found</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_TRANSFORM_FAILURE</td>
<td width=29%>database transform failed to merge</td>
</tr>
<tr valign=top>
<td width=71%>ERROR_INSTALL_PACKAGE_REJECTED</td>
<td width=29%>digital signature rejected</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_action_errors"></a>Action Errors</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=58%>Error Code</th>
<th align=left width=42%>Error</th>
</tr>
<tr valign=top>
<td width=58%>ERROR_INVALID_PARAMETER</td>
<td width=42%>One of the parameters was invalid</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_SUCCESS </td>
<td width=42%>Action completed successfully</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_UNKNOWN_PRODUCT </td>
<td width=42%>Product code is unrecognized</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_INSTALL_FAILURE </td>
<td width=42%>Install failed</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_BAD_CONFIGURATION </td>
<td width=42%>Corrupt configuration information</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_INSTALL_SOURCE_ABSENT </td>
<td width=42%>The source was unavailable</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_INSTALL_SUSPEND </td>
<td width=42%>The install was suspended</td>
</tr>
<tr valign=top>
<td width=58%>ERROR_INSTALL_USEREXIT </td>
<td width=42%>The user exited the install</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_installui_handler"></a>INSTALLUI_HANDLER</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>INSTALLUI_HANDLER</b> function prototype defines a callback function that the Installer Service calls for progress notification and error messages.</p>
<pre><code><b>INT(WINAPI*INSTALLUI_HANDLER)(
</b>  <b>LPVOID</b> <i>pvContext</i><b>,</b>   // application context
  <b>UINT</b> <i>iMessageType</i><b>,</b>  // message type
  <b>LPCTSTR</b> <i>szMessage</i>   // message
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pvContext</i></dt>
<dd>
Enables the application to determine its context when it is called back.</dd>
<dt>
<i>iMessageType</i></dt>
<dd>
Specifies a combination of one message box style, one message box icon type, one default button, and one installation message type. This parameter must be one of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Message Box StylesFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_ABORTRETRYIGNORE</td>
<td width=56%>The message box contains the <b>Abort</b>, <b>Retry</b>, and <b>Ignore</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_OK</td>
<td width=56%>The message box contains the <b>OK</b> button. This is the default.</td>
</tr>
<tr valign=top>
<td width=44%>MB_OKCANCEL</td>
<td width=56%>The message box contains the <b>OK</b> and <b>Cancel</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_RETRYCANCEL</td>
<td width=56%>The message box contains the <b>Retry</b> and <b>Cancel</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_YESNO</td>
<td width=56%>The message box contains the <b>Yes</b> and <b>No</b> buttons.</td>
</tr>
<tr valign=top>
<td width=44%>MB_YESNOCANCEL</td>
<td width=56%>The message box contains the <b>Yes</b>, <b>No</b>, and <b>Cancel</b> buttons.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Message Box IconTypesFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_ICONEXCLAMATION, MB_ICONWARNING</td>
<td width=56%>An exclamation point appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONINFORMATION, MB_ICONASTERISK</td>
<td width=56%>The information sign appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONQUESTION</td>
<td width=56%>A question mark appears in the message box.</td>
</tr>
<tr valign=top>
<td width=44%>MB_ICONSTOP, MB_ICONERROR, MB_ICONHAND</td>
<td width=56%>A stop sign appears in the message box.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Default ButtonsFlag</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON1</td>
<td width=56%>The first button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON2</td>
<td width=56%>The second button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON3</td>
<td width=56%>The third button is the default button.</td>
</tr>
<tr valign=top>
<td width=44%>MB_DEFBUTTON4</td>
<td width=56%>The fourth button is the default button.</td>
</tr>
</table><br>


<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=54%>Install Message TypesFlag</th>
<th align=left width=46%>Meaning</th>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_OUTOFMEMORY</td>
<td width=46%>Out-of-memory message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ERROR</td>
<td width=46%>Formatted error message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_WARNING</td>
<td width=46%>Formatted warning message</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_USER</td>
<td width=46%>User request message.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_INFO</td>
<td width=46%>Informative message for log</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_DIAGNOSTIC</td>
<td width=46%>Debug notification. This message displays if there is no log.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_COMMONDATA</td>
<td width=46%>Dialog information for UI.  Type of data is specified in the first field, parameters follow in remaining fields. Fields are separated by colons. Types of COMMONDATA messages are:<p>
1:<i>LanguageID</i></p>
<p>
2:<i>Dialog Caption</i></p>
<p>
3:<i>Boolean, 1 to show cancel button, 0 to hide</i></p>
</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONSTART</td>
<td width=46%>Start of action message. This message includes the action name and description.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONDATA</td>
<td width=46%>Formatted data associated with the individual action item.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_PROGRESS</td>
<td width=46%>Progress gauge information. This message includes information on units so far and total number of units.</td>
</tr>
<tr valign=top>
<td width=54%>INSTALLMESSAGE_ACTIONDONE</td>
<td width=46%>End of action sequence. Indicates an exit-modeless dialog box.</td>
</tr>
</table><br>


<p>
The following defaults should be used if any of the preceding messages are missing: MB_OK, no icon, and MB_DEFBUTTON1. There is no default installation message type; a message type is always specified.
</dd>
<dt>
<i>szMessage</i></dt>
<dd>
Specifies the message text.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
-1</dt>
<dd>
An error was found in the message handler.</dd>
<dt>
0</dt>
<dd>
No action was taken.
</dd>
</dl>
<p>
The following return values map to the buttons specified by the message box style.</p>
<p>
IDOK<br>
IDCANCEL<br>
IDABORT<br>
IDRETRY<br>
IDIGNORE<br>
IDYES<br>
IDNO</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_roadmap_to_installer_database_documentation"></a>Roadmap to Installer Database Documentation</h1>
<p>
The Microsoft<font face="Symbol"> </font> Windows  installer database documentation contains overview and reference material for developers who want to write tools that create or modify installer packages. Complete installer packages are then adopted by application developers as means to manage the installation of their applications. Some of the general information in this section is also useful for application developers and administrators who want to modify existing installer packages and installation processes by using custom actions. To help you find the information you need, the following list shows the main sections in the installer database documentation:
<ul>
<li>
<a href="novr_83kx.htm">Installer Database Schema</a></li>
<li>
<a href="qovr_07qr.htm">Database Access</a></li>
<li>
<a href="hand_0alh.htm">User Interface</a></li>
<li>
<a href="acts_4lmb.htm">Standard Actions</a></li>
<li>
<a href="prop_1xyr.htm">Properties</a></li>
<li>
<a href="sovr_99yl.htm">Summary Information Stream</a></li>
<li>
<a href="auto_8uqt.htm">Automation Interface</a></li>
<li>
<a href="dglo_5yih.htm">Glossary</a></li>
<li>
<a href="app_47g8.htm">Appendix</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_installer_database_schema"></a>Installer Database Schema</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is primarily for developers who want to write tools that create new installer packages and who therefore need detailed information about the installer's relational database. Complete installer packages are adopted by application developers as an efficient means to manage the installation of their applications. Some knowledge of the installation database is also useful to application developers and administrators who want to modify existing installer packages and installation processes using custom actions. For general information on the installer and component management technology, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
The installer database contains all the necessary information for the installation of an application. Therefore developers of tools for the creation of install packages, and developers creating install packages without using such tools, will need to understand the installer database. The following topics cover the major areas of functionality of the installer database:</p>
<p>
<a href="novr_5s4l.htm">About the Installer Database</a></p>
<p>
<a href="novr_1605.htm">Using the Installer Database</a></p>
<p>
<a href="tref_33j9.htm">Installer Database Reference</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_about_the_installer_database"></a>About the Installer Database</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer database consists of many inter-related tables that together comprise a relational database of the information necessary to install a group of applications. Because the database is relational, changes made to one table get propagated automatically throughout the database. This is a very efficient process for introducing consistent changes into the installation process and means that users can more easily customize a large application or group of applications. The database tables therefore reflect the general layout of the entire group of applications, including:
<ul>
<li>
Available features</li>
<li>
Components</li>
<li>
Relationship between features and components</li>
<li>
Necessary registry settings</li>
<li>
User interface for the application</li>
</ul>
<p>
To create an installation database, you must populate the tables with all the information about the applications and the installation process. Manually authoring all these tables becomes a large task even for a moderate size installation, therefore some third-party tools are available to assist with building the installer database. It is helpful for understanding the scheme of the installer database to break it up into groups of related tables. The following sections describe groups of related tables.</p>
<p>
<a href="novr_29f4.htm">Core Tables Group</a></p>
<p>
<a href="novr_3gz4.htm">File Tables Group</a></p>
<p>
<a href="novr_4300.htm">Registry Tables Group</a></p>
<p>
<a href="novr_8lv4.htm">System Tables Group</a></p>
<p>
<a href="novr_3ovk.htm">Locator Tables Group</a></p>
<p>
<a href="novr_90z4.htm">Program Information Tables Group</a></p>
<p>
<a href="novr_6zao.htm">Installation Procedure Tables Group</a></p>
<p>
For a complete list of all tables in an installation database, see <a href="tref_07n7.htm">Installation Database Tables</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_core_tables_group"></a>Core Tables Group</h3>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/core.gif" border=0></p>
<p>
The core group consists of tables describing the fundamental features and components of the application and the installer package. Developers of install packages should therefore consider how to populate these tables first because the organization of much of the database will become apparent from the content of this group.
<ul>
<li>
The <a href="tref_0a91.htm">Feature table</a> lists all features belonging to the application.</li>
<li>
The <a href="tref_83qd.htm">Condition table</a> contains the conditional expressions that determine whether or not a particular feature will be installed.</li>
<li>
The <a href="tref_52hx.htm">FeatureComponents table</a> describes which components belong to each feature.</li>
<li>
The <a href="tref_09np.htm">Component table</a> lists all components belonging to the installation.</li>
<li>
The <a href="tref_6an9.htm">Directory table</a> lists the directories that are needed during the installation. Because each component must be associated with one and only one directory, the Component table is closely related to this table and has an external key to the Directory table.</li>
<li>
The <a href="tref_7xt1.htm">PublishComponent table</a> lists the features and components that are published for use by other applications. <a href="over_5lgn.htm">Assigning and publishing</a> are the two types of feature advertisement.</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_file_tables_group"></a>File Tables Group</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/filegrp.gif" border=0></p>
<p>
An installer package developer should consider populating the file table group of tables after breaking the application into <a href="over_8p83.htm">components and features</a> and after populating the <a href="novr_29f4.htm">core tables group</a>. The file table group contains all of the files belonging to the installation and most of these files are listed in the <a href="tref_4n6t.htm">File table</a>. The <a href="tref_6an9.htm">Directory table</a> is not shown in the figure but is closely related to the file table group. The Directory table gives the directory structure of the installation. Every file belongs to one and only one component and no component belongs to more than one directory of the same level; therefore, because the File table and Directory table have an external key into the Component table, the database contains the entire structure of the installation. This fact become important when searching for applications.</p>
<p>
The file group of tables contains all of the tables that are related to files.
<ul>
<li>
The <a href="tref_4n6t.htm">File table</a> lists files belonging to the installation. Files that are not listed in the File table include disk files, which are listed in Media table.  Because every file belongs to a component, the File table has an external key into the Component table</li>
<li>
The <a href="tref_9tnp.htm">Font table</a> lists font files to be registered with the system.</li>
<li>
The <a href="tref_6rxh.htm">Resource table</a> lists resource data files to be inserted into executables or DLLs.</li>
<li>
The <a href="tref_0llx.htm">SelfReg table</a> lists module files of the installation that are self-registered.</li>
<li>
The <a href="tref_4mlh.htm">Media table</a> lists the source media and disks belonging to the installation.</li>
<li>
The <a href="tref_47l1.htm">BindImage table</a> lists files that are bound to DLLs imported by executables. </li>
<li>
The <a href="tref_5un9.htm">MoveFile table</a> specifies which files are moved during the installation.</li>
<li>
The <a href="tref_310l.htm">DuplicateFile table</a> specifies which files are duplicated during the installation.</li>
<li>
The <a href="tref_56jp.htm">IniFile table</a> The IniFile table lists the .ini files and the information that the application needs to set in the file.</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_registry_tables_group"></a>Registry Tables Group</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/registry.gif" border=0></p>
<p>
The installer has specific tables for the different types of registry entries. When populating the registry tables group it is important to try to minimize the number of entries put into the <a href="tref_3obp.htm">Registry table</a> and maximize the use of the other, specific, registry tables. This is because the installer cannot distinguish between different types of registry entries in the Registry table and cannot use the internal logic necessary to take full advantage of all of the installer features. For example, making registry entries into specific tables maximizes the benefits to the application from advertising applications and features. </p>
<p>
The figure shows the registry entry group of tables and as well as the <a href="tref_09np.htm">Component table</a>, <a href="tref_0a91.htm">Feature table</a>, and <a href="tref_4n6t.htm">File table</a>. Although the latter are not directly involved with populating the registry, they are included in the figure because they are essential to the logic of the registry entry group .</p>
<p>
The registry entry group contain the following tables of specific registry entries
<ul>
<li>
The <a href="tref_3obp.htm">Registry table</a> holds the information that the application needs to put into the system registry.</li>
<li>
The <a href="tref_219h.htm">Extension table</a> contains all of the extensions your application uses along with the features and components associated with the extensions. </li>
<li>
The <a href="tref_3kdh.htm">Verb table</a> associates command-verb information with the file extensions listed in the <a href="tref_219h.htm">Extension table</a>. This results in an indirect link between the Verb and Features table that is needed for feature advertisement.</li>
<li>
The <a href="tref_3085.htm">TypeLib table</a> provides information that needs to be placed in the registry for the advertisement and registration of type libraries.</li>
<li>
The <a href="tref_3sh1.htm">MIME table</a> associates a MIME context type with a CLSID or a file extension. This results in a path between the MIME and Feature Table that is needed for feature advertisement. </li>
<li>
The <a href="tref_0llx.htm">SelfReg table</a> provides information needed to self-register modules. Self-registration is provided by the installer only for backward compatibility and it is not recommended as a method for populating the registry, however if there are any modules in your application that must register themselves, use the SelfReg table.</li>
<li>
The <a href="tref_7vmt.htm">Icon table</a> provides icon information which is copied to a file as a part of product advertisement. </li>
<li>
The <a href="tref_5n8l.htm">Class table</a> is used to register Class IDs and other information for COM objects. This table contains COM server-related information that must be generated as a part of the product advertisement.</li>
<li>
The <a href="tref_4x5x.htm">ProgId table</a> associates program IDs with class IDs.</li>
<li>
</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_system_tables_group"></a>System Tables Group</h3>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The tables of the system tables group track the tables and columns of the installation database. 
<ul>
<li>
The <a href="tref_2fl1.htm">_Tables table</a> tracks all the tables in the database. This includes tables that you may have created for your own custom actions. Query this table to find out if a table exists.</li>
<li>
The <a href="tref_4rj9.htm">_Columns table</a> tracks every column in the installation database. Query this table to find out if a given column exists.</li>
<li>
The <a href="tref_8fl1.htm">_Validation table</a>. The _Validation table tracks the types and allowed ranges of every column in the database. The _Validation table is used during the database validation process to ensure that all columns are accounted for and have the correct values. This table is not shipped with the installer database.</li>
<li>
The <a href="tref_2yjp.htm">_Sequence Table</a> is used during the database validation process to ensure that all sequenced actions are in the correct order. The _Sequence table lists all the sequencing restrictions of all actions used in the installer database. </li>
<li>
The <a href="tref_45id.htm">_InstallValidate Table</a> is used with the _Sequence table during the validation process to ensure that the actions occur in the correct order.</li>
<li>
The <a href="tref_5e1x.htm">_Required Table</a> tracks the number of primary keys for all the tables in the database. It is only used during the database validation process.</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_locator_tables_group"></a>Locator Tables Group</h3>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Locator Tables Group of tables are used to locate files and applications. To search for a file first determine the file signature and then locate the file. The Locator tables are used to search the registry, installer configuration data, directory tree, or .ini files for the unique signature of a file. The file signature can then be checked in the <a href="tref_149x.htm">Signature table</a> to make sure a particular file is really the file being sought and not another file with the same name. If a record in a locator table does not contain a key into the Signature table, then the record refers to a directory and not a file.</p>
<p>
The component controlling a file is found in the <a href="tref_4n6t.htm">File table</a> through the external key to the <a href="tref_09np.htm">Component table</a>. The installer resolves the location of a file through the Component table because every file belongs to one component. The location of a component is found through an external key in the Component table to the <a href="tref_6an9.htm">Directory table</a>.</p>
<p>
The location of an application is found by searching for files that make up the application. The installer also provides two tables for searching for previous versions of an application: the <a href="tref_0w9x.htm">AppSearch table</a> and the <a href="tref_8nad.htm">CCPSearch table</a>.</p>
<p>
The following tables make up the Locator tables group and are used to determine the file signature.
<ul>
<li>
The <a href="tref_91wl.htm">RegLocator table</a> holds the information needed to search for a file or directory in the registry.</li>
<li>
The <a href="tref_00o5.htm">IniLocator table</a> holds the information needed to search for a .ini file. The .ini file must be present in the default Microsoft  Windows  directory.</li>
<li>
The <a href="tref_771h.htm">CompLocator table</a> holds the information needed to search for a file or a directory using the installer's configuration data.</li>
<li>
The <a href="tref_3azp.htm">DrLocator table</a> holds the information needed to search for a file or directory in the directory tree.</li>
<li>
The <a href="tref_0w9x.htm">AppSearch table</a> contains the properties that must be set to the search result of a corresponding file signature.</li>
<li>
The <a href="tref_8nad.htm">CCPSearch table</a> contains the list of file signatures, at least one of which needs to be present on a user's computer for the Compliance Checking Program (CCP). .</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_program_information_tables_group"></a>Program Information Tables Group</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Program Information Tables group contain important information that used throughout the installation.
<ul>
<li>
The <a href="tref_21d1.htm">Property table</a> provides a means to specify all of the <a href="prop_1xyr.htm">properties</a> of an installation.</li>
<li>
The <a href="tref_04px.htm">Binary table</a> holds the binary data for items such as bitmaps, animations, and icons. The binary table is also used to store data for custom actions. This table can contain a bitmap for a billboard, the icon for your program, or the executable form of a custom action.</li>
<li>
The <a href="tref_5dk5.htm">Error table</a> is used to look up error message formatting templates when processing errors with an error code set. This is for the usual case where there is no formatting template set. The installer has its own error processing mechanism. Errors are passed as records.</li>
<li>
<a href="tref_2i91.htm">Shortcut table</a> the shortcut table holds the information the application needs to create Shortcuts on the user's computer.</li>
<li>
The <a href="tref_9u5h.htm">ReserveCost table</a> contains the disk space necessary for each component to work properly.</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_installation_procedure_tables_group"></a>Installation Procedure Tables Group</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The tables in the Installation Procedure group control tasked performed during the installation by <a href="acts_4lmb.htm">standard actions</a> and <a href="cact_5t2r.htm">custom actions</a>.</p>
<p>
Some of the tables in this group control a high level action by providing a sequence of actions. Each of the following sequence tables controls a portion of a high level action. 
<ul>
<li>
The <a href="tref_1git.htm">InstallUISequence table</a> </li>
<li>
The <a href="tref_5pid.htm">InstallExecuteSequence table</a> </li>
<li>
The <a href="tref_5lnp.htm">AdminUISequence table</a> </li>
<li>
The <a href="tref_70f9.htm">AdminExecuteSequence table</a> </li>
<li>
The <a href="tref_3rvp.htm">AdvtUISequence table</a> </li>
<li>
The <a href="tref_5mn9.htm">AdvtExecuteSequence table</a> </li>
</ul>
<p>
There may be situations in which an installation needs to do something that is not possible using only <a href="acts_4lmb.htm">standard actions</a>. To provide the greatest degree of flexibility, the installer provides setup authors the ability to create their own custom actions. If you have any custom actions, you should register them with the installer by populating the CustomAction Table.
<ul>
<li>
The <a href="tref_71b9.htm">CustomAction table</a> provides the means of integrating custom code and data into the installation process. The code that is executed can be a stream contained within the database, a recently installed file, or an existing executable.</li>
</ul>
<p>
Developers of installer packages will populate the Upgrade Table to create an installer package that upgrades an existing product.
<ul>
<li>
The <a href="tref_4qxx.htm">Upgrade table</a> contains information on how the installer should perform an upgrade of a product and how to handle installations when related versions of the product are already installed.</li>
</ul>
<p>
The following tables extend the installer's capabilities to manipulate files and folders during the installation.
<ul>
<li>
The <a href="tref_7gth.htm">RemoveFile table</a> contains a list of files that are removed during the installation. </li>
<li>
The <a href="tref_9k6d.htm">RemoveIniFile table</a> contains the information an application needs to remove from .ini files.</li>
<li>
The <a href="tref_3wmd.htm">RemoveRegistry table</a> contains the information which is deleted from the system registry when the corresponding component is selected to be installed.</li>
<li>
The <a href="tref_152d.htm">CreateFolder table</a> lists the folders that must be created during the installation. Although the installer creates folders as they are needed, these are removed as soon as they are empty. Folders list in the CreateFolder table are not deleted until the component is uninstalled.</li>
<li>
The <a href="tref_5un9.htm">MoveFile table</a> contains a list of files to be moved or copied from a specified source directory on the user's computer to a destination directory. It is not necessary to use the MoveFile table to describe the files associated with the components you are installing.</li>
</ul>
<p>
To set up necessary conditions that must be met to initiate the installation populate the LaunchCondition table. 
<ul>
<li>
The <a href="tref_90f9.htm">LaunchCondition table</a> contains a list of conditions, all of which must be satisfied for the action to succeed.</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_using_the_installer_database"></a>Using the Installer Database</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The database enables the developer of an installation package to control the transfer of an application from a source to a target image. The layout of both the source and target images of the application are specified in the <a href="tref_6an9.htm">Directory table</a> and the actions that install the application are specified in six sequence tables: 
<ul>
<li>
The <a href="tref_1git.htm">InstallUISequence table</a> </li>
<li>
The <a href="tref_5pid.htm">InstallExecuteSequence table</a> </li>
<li>
The <a href="tref_5lnp.htm">AdminUISequence table</a> </li>
<li>
The <a href="tref_70f9.htm">AdminExecuteSequence table</a> </li>
<li>
The <a href="tref_3rvp.htm">AdvtUISequence table</a> </li>
<li>
The <a href="tref_5mn9.htm">AdvtExecuteSequence table</a> </li>
</ul>
<p>
The following topics describe how to use these tables:
<ul>
<li>
<a href="novr_3wth.htm">Using the Directory Table</a></li>
<li>
<a href="novr_3mqt.htm">Using a Sequence Table</a></li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_using_the_directory_table"></a>Using the Directory Table</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <a href="tref_6an9.htm">Directory table</a> indicates the layout of your application. The following is an example of a Directory table.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Directory</th>
<th align=left width=33%>Directory_Parent</th>
<th align=left width=34%>DefaultDir</th>
</tr>
<tr valign=top>
<td width=33%>TARGETDIR</td>
<td width=33%></td>
<td width=34%>SOURCEDIR</td>
</tr>
<tr valign=top>
<td width=33%>EXEDIR</td>
<td width=33%>TARGETDIR</td>
<td width=34%>App</td>
</tr>
<tr valign=top>
<td width=33%>DLLDIR</td>
<td width=33%>EXEDIR</td>
<td width=34%>Bin</td>
</tr>
<tr valign=top>
<td width=33%>DesktopFolder</td>
<td width=33%>TARGETDIR</td>
<td width=34%>Desktop</td>
</tr>
</table><br>
<p>
Each row of the Directory table indicates a directory both at the source and the target. For example, assume the installation package resides at \\applications\source\. Because the Directory_Parent field of the first row is Null, this record indicates the root directories for both the source and the target. For the source, the value of this directory is given by the DefaultDir field. The <a href="pref_6uwp.htm">SOURCEDIR property</a> defaults to the location of the installation package. Thus, unless the SOURCEDIR property is overridden, the root source directory is \\applications\source\.</p>
<p>
The Directory field of the first record indicates the location of the root target directory. In this case, the value of the <a href="pref_73ax.htm">TARGETDIR property</a> indicates this directory. Typically, the value of the TARGETDIR property is set at the command line or through a user interface. In this case, assume the TARGETDIR property is set to C:\Program Files\Target\.</p>
<p>
For the second record, the Directory_Parent field is not Null. Therefore, this record indicates a non-root directory for both the source and the target. For a non-root source directory, the source directory indicated by the record described in the Directory_Parent field is the parent directory. For the second record, the Directory_Parent field is TARGETDIR. As shown earlier, the source directory indicated by the TARGETDIR record resolved to \\applications\source\. Thus, the source directory indicated by the second record is \\applications\source\App\.</p>
<p>
A similar process works for the target directory. The value of the parent directory for the target directory described in the second record is the target directory resolved by the Directory_Parent field. Again, the Directory_Parent field contains the value TARGETDIR. This indicates the first record that resolves to a target directory of C:\Program Files\Target\. The Directory field contains an author-defined property called EXEDIR. If this property is set, then its value gives the full path of the directory. Thus, if this property is set to C:\Data\Common\, the value of the target directory indicated by the second record is C:\Data\Common\. If it is not set, the target directory takes the name given by the DefaultDir field. In this case, the target directory is C:\Program Files\Target\App\.</p>
<p>
The same process works for the third record. If EXEDIR and DLLDIR are not set, the target directory is C:\Program Files\Target\App\Bin, and the source directory is \\applications\source\App\Bin\.</p>
<p>
The fourth record uses the <a href="pref_4g6x.htm">DesktopFolder property</a>. If the location of the user's desktop is C:\Winnt\Profiles\User\Desktop\, the target directory resolves to C:\Winnt\Profiles\User\Desktop\. The source directory resolves to \\applications\source\Desktop\.</p>
<p>
There are two additional syntax features that can be used in the DefaultDir column of the Directory table. For a non-root source directory, a period (.) entered in the DefaultDir column indicates that the directory should be located in its parent directory without a subdirectory. To specify different source and target directory paths, separate the target and source paths in the DefaultDir column with a colon as follows: [targetpath]:[sourcepath]. These features can be used together to add levels to either the source or target paths for a single directory. For example, consider this example of a Directory table.:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Directory</th>
<th align=left width=33%>Directory_Parent</th>
<th align=left width=34%>DefaultDir</th>
</tr>
<tr valign=top>
<td width=33%>TARGETDIR</td>
<td width=33%></td>
<td width=34%>SOURCEDIR</td>
</tr>
<tr valign=top>
<td width=33%>MyAppDir</td>
<td width=33%>TARGETDIR</td>
<td width=34%>MyApp</td>
</tr>
<tr valign=top>
<td width=33%>BinDir</td>
<td width=33%>MyAppDir</td>
<td width=34%>Bin</td>
</tr>
<tr valign=top>
<td width=33%>Binx86Dir</td>
<td width=33%>BinDir</td>
<td width=34%>.:x86</td>
</tr>
<tr valign=top>
<td width=33%>BinAlphaDir</td>
<td width=33%>BinDir</td>
<td width=34%>.:Alpha</td>
</tr>
</table><br>
<p>
The source and target paths resolve for the MyAppDir, BinDir, Binx86Dir, and BinAlphaDir rows as follows. </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=21%>Record</th>
<th align=left width=35%>Target Paths</th>
<th align=left width=44%>Source Paths</th>
</tr>
<tr valign=top>
<td width=21%>MyAppDir:</td>
<td width=35%>[TARGETDIR]MyApp</td>
<td width=44%>[SOURCEDIR]MyApp</td>
</tr>
<tr valign=top>
<td width=21%>BinDir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin</td>
</tr>
<tr valign=top>
<td width=21%>Binx86Dir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin\x86</td>
</tr>
<tr valign=top>
<td width=21%>BinAlphaDir:</td>
<td width=35%>[TARGETDIR]MyApp\Bin</td>
<td width=44%>[SOURCEDIR]MyApp\Bin\Alpha</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h2><a name="_msi_using_a_sequence_table"></a>Using a Sequence Table</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The authoring of the sequence tables is an essential part of developing an installer package because these tables specify the flow of the installation process. Sequence tables are the only place in an installer package where the flow can be specified. The flow is always linear and there can be no branching or looping.</p>
<p>
There are six sequence tables in the installer database:
<ul>
<li>
The <a href="tref_1git.htm">InstallUISequence table</a> </li>
<li>
The <a href="tref_5pid.htm">InstallExecuteSequence table</a> </li>
<li>
The <a href="tref_5lnp.htm">AdminUISequence table</a> </li>
<li>
The <a href="tref_70f9.htm">AdminExecuteSequence table</a> </li>
<li>
The <a href="tref_3rvp.htm">AdvtUISequence table</a> </li>
<li>
The <a href="tref_5mn9.htm">AdvtExecuteSequence table</a> </li>
</ul>
<p>
Upon the execution of one of the top-level actions, <a href="aref_986m.htm">INSTALL</a>, <a href="aref_2o8e.htm">ADVERTISE</a>, and <a href="aref_4hbi.htm">ADMIN</a>, the installer begins advancing through the sequence of actions listed in one of the user interface, execution, or advertise sequence tables. The installer contains internal logic that determines which of the sequence tables to use.
<ul>
<li>
The user interface (UI) sequence tables contain the exit dialogs and actions coming before the <a href="aref_9fzi.htm">InstallValidate action</a>. Actions from InstallValidate to the end of the install sequence are located in the execution sequence tables. The actions needed to advertise products and features are located in the advertise sequence tables. </li>
<li>
A typical UI sequence table will begin with costing initialization actions, then the user interface actions, and then the <a href="aref_3b1q.htm">ExecuteAction action</a>, which starts the execution of the installation. Here is an example of a sequence table.</li>
</ul>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Action</th>
<th align=left width=42%>Condition</th>
<th align=left width=25%>Sequence</th>
</tr>
<tr valign=top>
<td width=33%><a href="aref_6jhq.htm">LaunchConditions</a></td>
<td width=42%></td>
<td width=25%>10</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_16zy.htm">AppSearch</a></td>
<td width=42%></td>
<td width=25%>30</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_77se.htm">CCPSearch</a></td>
<td width=42%>CCP_TEST</td>
<td width=25%>40</td>
</tr>
<tr valign=top>
<td width=33%>CCPDialog</td>
<td width=42%>NOT_CCP_SUCCESS</td>
<td width=25%>50</td>
</tr>
<tr valign=top>
<td width=33%>MyCustomConfig</td>
<td width=42%>NOT <a href="pref_8ws9.htm">Installed</a></td>
<td width=25%>80</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_4bam.htm">CostInitialize</a></td>
<td width=42%></td>
<td width=25%>90</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_2f8u.htm">FileCost</a></td>
<td width=42%></td>
<td width=25%>100</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_22we.htm">CostFinalize</a></td>
<td width=42%></td>
<td width=25%>110</td>
</tr>
<tr valign=top>
<td width=33%>InstallDialog</td>
<td width=42%>NOT <a href="pref_8ws9.htm">Installed</a></td>
<td width=25%>120</td>
</tr>
<tr valign=top>
<td width=33%>MaintenanceDialog</td>
<td width=42%><a href="pref_8ws9.htm">Installed</a> AND NOT <a href="pref_31tl.htm">Resume</a></td>
<td width=25%>130</td>
</tr>
<tr valign=top>
<td width=33%>ActionDialog</td>
<td width=42%></td>
<td width=25%>150</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_529a.htm">RegisterProduct</a></td>
<td width=42%></td>
<td width=25%>170</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_9fzi.htm">InstallValidate</a></td>
<td width=42%></td>
<td width=25%>210</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_3hym.htm">InstallFiles</a></td>
<td width=42%></td>
<td width=25%>330</td>
</tr>
<tr valign=top>
<td width=33%>MyCustomAction</td>
<td width=42%>$MyComponent &gt; 2</td>
<td width=25%>440</td>
</tr>
<tr valign=top>
<td width=33%><a href="aref_8l9q.htm">InstallFinalize</a></td>
<td width=42%></td>
<td width=25%>510</td>
</tr>
</table><br>
<p>
The sequence tables have three columns: Action, Condition, and Sequence. The Action column names the standard or custom action, or user interface wizard, the installer will execute. The Sequence column indicates the place of the record in the sequence and each record in the sequence table is sampled in order. The Condition column is a logical expression that causes the action to be executed if the expression is True and skipped if the expression is False. Conditions can be thought of as jumps and so the linear flow may not execute every action.</p>
<p>
The following actions in this sequence table are defined by the installer and are therefore examples of <a href="acts_4lmb.htm">standard actions</a>. </p>
<p>
<a href="aref_6jhq.htm">LaunchConditions</a><br>
<a href="aref_16zy.htm">AppSearch</a><br>
<a href="aref_77se.htm">CCPSearch</a><br>
<a href="aref_4bam.htm">CostInitialize</a><br>
<a href="aref_2f8u.htm">FileCost</a><br>
<a href="aref_22we.htm">CostFinalize</a><br>
<a href="aref_529a.htm">RegisterProduct</a><br>
<a href="aref_3hym.htm">InstallFiles</a><br>
<a href="aref_8l9q.htm">InstallFinalize</a></p>
<p>
The following actions were defined by the table's author and are therefore examples of <a href="cact_5t2r.htm">custom actions</a> and must be listed in the <a href="tref_71b9.htm">CustomAction table</a>.</p>
<p>
MyCustomConfig<br>
MyCustomAction</p>
<p>
The remaining entries in the Action field are dialogs. They therefore must be entries into the <a href="tref_51wl.htm">Dialog table</a>.</p>
<p>
CCPDialog<br>
InstallDialog<br>
MaintenanceDialog<br>
ActionDialog</p>
<p>
The Condition column causes the installer to skip the action if the property or expression in this field is False. The <a href="pref_8ws9.htm">Installed property</a> and the <a href="pref_31tl.htm">Resume property</a> are example of properties that are set by the installer. The Installed property is set to true if the product is already installed and the Resume property is set if resuming a suspended installation. The CCP_TEST and the NOT_CCP_SUCCESS properties are examples of properties that can be set at the command line by the user installing the application. </p>
<p>
All actions will therefore run in sequence with the following conditional steps. 
<ul>
<li>
The CPPSearch is run only if CCP_TEST is set.</li>
<li>
CCPDialog is run only if NOT_CCP_SUCCESS is set.</li>
<li>
MaintenanceDialog is run only if this product is already installed and if this is not an installation that is being resume after being suspended.</li>
<li>
MyCustomAction is run only if the expression in the Condition column is True. The expression $MyComponent &gt; 2 refers to the action state of the component called MyComponent. This condition indicates that MyCustomAction should only be run if MyComponent is set to be installed. For more information on Action states and Selection states, see the <a href="vref_84xl.htm"><b>FeatureRequestState</b> property</a>, the <a href="tref_0a91.htm">Feature table</a>, and the <a href="aref_3hym.htm">InstallFiles action</a>.</li>
</ul>
<p>
For more examples of properties see <a href="prop_29tf.htm">Using Properties</a> and for more information on how expressions are evaluated see <a href="qref_6je6.htm">MsiEvaluateCondition</a>.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_installer_database_reference"></a>Installation Database Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and developers who want to learn more about the Microsoft  Windows  installer database tables. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installation_database_tables"></a>Installation Database Tables</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Following is a list of the Microsoft  Windows  installer database tables:
<ul>
<li>
<a href="tref_7het.htm">ActionText Table</a></li>
<li>
<a href="tref_70f9.htm">AdminExecuteSequence Table</a></li>
<li>
<a href="tref_5lnp.htm">AdminUISequence Table</a></li>
<li>
<a href="tref_5mn9.htm">AdvtExecuteSequence Table</a></li>
<li>
<a href="tref_3rvp.htm">AdvtUISequence Table</a></li>
<li>
<a href="tref_0w9x.htm">AppSearch Table</a></li>
<li>
<a href="tref_78it.htm">BBControl Table</a></li>
<li>
<a href="tref_0c4l.htm">Billboard Table</a></li>
<li>
<a href="tref_04px.htm">Binary Table</a></li>
<li>
<a href="tref_47l1.htm">BindImage Table</a></li>
<li>
<a href="tref_8nad.htm">CCPSearch Table</a></li>
<li>
<a href="tref_3fmt.htm">CheckBox Table</a></li>
<li>
<a href="tref_5n8l.htm">Class Table</a></li>
<li>
<a href="tref_9wit.htm">ComboBox Table</a></li>
<li>
<a href="tref_771h.htm">CompLocator Table</a></li>
<li>
<a href="tref_09np.htm">Component Table</a></li>
<li>
<a href="tref_83qd.htm">Condition Table</a></li>
<li>
<a href="tref_6nad.htm">Control Table</a></li>
<li>
<a href="tref_4vhh.htm">ControlCondition Table</a></li>
<li>
<a href="tref_6k11.htm">ControlEvent Table</a></li>
<li>
<a href="tref_152d.htm">CreateFolder Table</a></li>
<li>
<a href="tref_71b9.htm">CustomAction Table</a></li>
<li>
<a href="tref_51wl.htm">Dialog Table</a></li>
<li>
<a href="tref_6an9.htm">Directory Table</a></li>
<li>
<a href="tref_3azp.htm">DrLocator Table</a></li>
<li>
<a href="tref_310l.htm">DuplicateFile table</a></li>
<li>
<a href="tref_025h.htm">Environment table</a></li>
<li>
<a href="tref_5dk5.htm">Error Table</a></li>
<li>
<a href="tref_6m3p.htm">EventMapping Table</a></li>
<li>
<a href="tref_219h.htm">Extension Table</a></li>
<li>
<a href="tref_0a91.htm">Feature Table</a></li>
<li>
<a href="tref_52hx.htm">FeatureComponents Table</a></li>
<li>
<a href="tref_4n6t.htm">File Table</a></li>
<li>
<a href="tref_9tnp.htm">Font Table</a></li>
<li>
<a href="tref_7vmt.htm">Icon Table</a></li>
<li>
<a href="tref_56jp.htm">IniFile Table</a></li>
<li>
<a href="tref_00o5.htm">IniLocator Table</a></li>
<li>
<a href="tref_5pid.htm">InstallExecuteSequence Table</a></li>
<li>
<a href="tref_1git.htm">InstallUISequence Table</a></li>
<li>
<a href="tref_90f9.htm">LaunchCondition Table</a></li>
<li>
<a href="tref_5f1h.htm">ListBox Table</a></li>
<li>
<a href="tref_0vs5.htm">ListView Table</a></li>
<li>
<a href="tref_4mlh.htm">Media Table</a></li>
<li>
<a href="tref_3sh1.htm">MIME Table</a></li>
<li>
<a href="tref_5un9.htm">MoveFile Table</a></li>
<li>
<a href="tref_0mat.htm">ODBCAttribute Table</a></li>
<li>
<a href="tref_359h.htm">ODBCDataSource Table</a></li>
<li>
<a href="tref_457p.htm">ODBCDriver Table</a></li>
<li>
<a href="tref_3yat.htm">ODBCSourceAttribute Table</a></li>
<li>
<a href="tref_6msl.htm">ODBCTranslator Table</a></li>
<li>
<a href="tref_0h5x.htm">Patch Table</a></li>
<li>
<a href="tref_8put.htm">PatchPackage Table</a></li>
<li>
<a href="tref_4x5x.htm">ProgId Table</a></li>
<li>
<a href="tref_21d1.htm">Property Table</a></li>
<li>
<a href="tref_7xt1.htm">PublishComponent Table</a></li>
<li>
<a href="tref_4t7p.htm">RadioButton Table</a></li>
<li>
<a href="tref_3obp.htm">Registry Table</a></li>
<li>
<a href="tref_91wl.htm">RegLocator Table</a></li>
<li>
<a href="tref_7gth.htm">RemoveFile Table</a></li>
<li>
<a href="tref_9k6d.htm">RemoveIniFile Table</a></li>
<li>
<a href="tref_3wmd.htm">RemoveRegistry Table</a></li>
<li>
<a href="tref_9u5h.htm">ReserveCost Table</a></li>
<li>
<a href="tref_6rxh.htm">Resource Table</a></li>
<li>
<a href="tref_0llx.htm">SelfReg Table</a></li>
<li>
<a href="tref_1691.htm">ServiceControl Table</a></li>
<li>
<a href="tref_81r9.htm">ServiceInstall Table</a></li>
<li>
<a href="tref_2i91.htm">Shortcut Table</a></li>
<li>
<a href="tref_149x.htm">Signature Table</a></li>
<li>
<a href="tref_30px.htm">TextStyle Table</a></li>
<li>
<a href="tref_3085.htm">TypeLib Table</a></li>
<li>
<a href="tref_0vz9.htm">UIText Table</a></li>
<li>
<a href="tref_4qxx.htm">Upgrade Table</a></li>
<li>
<a href="tref_3kdh.htm">Verb Table</a></li>
<li>
<a href="tref_8fl1.htm">_Validation Table</a></li>
<li>
<a href="tref_4rj9.htm">_Columns Table</a></li>
<li>
<a href="tref_45id.htm">_InstallValidate Table</a></li>
<li>
<a href="tref_5e1x.htm">_Required Table</a></li>
<li>
<a href="tref_2yjp.htm">_Sequence Table</a></li>
<li>
<a href="tref_2fl1.htm">_Tables Table</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_column_data_types"></a>Column Data Types</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The columns of the database tables are formatted in one of the following data types:
<ul>
<li>
<a href="#_msi_text">Text</a></li>
<li>
<a href="#_msi_uppercase">UpperCase</a></li>
<li>
<a href="#_msi_lowercase">LowerCase</a></li>
<li>
<a href="#_msi_integer">Integer</a></li>
<li>
<a href="#_msi_doubleinteger">DoubleInteger</a></li>
<li>
<a href="#_msi_time_date">Time/Date</a></li>
<li>
<a href="#_msi_identifier">Identifier</a></li>
<li>
<a href="#_msi_property">Property</a></li>
<li>
<a href="#_msi_filename">Filename</a></li>
<li>
<a href="#_msi_wildcardfilename">WildCardFilename</a></li>
<li>
<a href="#_msi_path">Path</a></li>
<li>
<a href="#_msi_paths">Paths</a></li>
<li>
<a href="#_msi_anypath">AnyPath</a></li>
<li>
<a href="#_msi_defaultdir">DefaultDir</a></li>
<li>
<a href="#_msi_regpath">RegPath</a></li>
<li>
<a href="#_msi_formatted">Formatted</a></li>
<li>
<a href="#_msi_keyformatted">KeyFormatted</a></li>
<li>
<a href="#_msi_template">Template</a></li>
<li>
<a href="#_msi_condition">Condition</a></li>
<li>
<a href="#_msi_guid">GUID</a></li>
<li>
<a href="#_msi_version">Version</a></li>
<li>
<a href="#_msi_language">Language</a></li>
<li>
<a href="#_msi_binary">Binary</a></li>
<li>
<a href="#_msi_customsource">CustomSource</a></li>
<li>
<a href="#_msi_cabinet">Cabinet</a></li>
<li>
<a href="#_msi_shortcut">Shortcut</a></li>
</ul>

<h3><a name="_msi_text"></a>Text</h3>
<p>
The Text data type is a text string. No validation is done on this string.</p>

<h3><a name="_msi_uppercase"></a>UpperCase</h3>
<p>
The UpperCase data type is a text string that must be all uppercase.</p>

<h3><a name="_msi_lowercase"></a>LowerCase</h3>
<p>
The LowerCase data type is a text string that must be all lowercase.</p>

<h3><a name="_msi_integer"></a>Integer</h3>
<p>
The Integer data type is a two-byte integer value. Unless otherwise restricted, the range of legal values is from -32,767 to +32,767.</p>

<h3><a name="_msi_doubleinteger"></a>DoubleInteger</h3>
<p>
The DoubleInteger data type is a four-byte integer value. Unless otherwise restricted, the range of legal values is from - 2,147,483,647 to +2,147,483,647.</p>

<h3><a name="_msi_time_date"></a>Time/Date</h3>
<p>
The Time/Date data type has the time and the date stored individually, using unsigned integers as bit fields, packed as follows.</p>
<h4>Time</h4>
<p>
Time is encoded in an unsigned 2-byte integer with the following bit fields:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=39%>Contents</th>
<th align=left width=29%>Bits</th>
<th align=left width=32%>Value Range</th>
</tr>
<tr valign=top>
<td width=39%>hours</td>
<td width=29%>0 1 2 3 4</td>
<td width=32%>0-23</td>
</tr>
<tr valign=top>
<td width=39%>minutes</td>
<td width=29%>5 6 7 8 9 A</td>
<td width=32%>0-59</td>
</tr>
<tr valign=top>
<td width=39%>2-second intervals</td>
<td width=29%>B C D E F</td>
<td width=32%>0-29</td>
</tr>
</table><br>
<h4>Date</h4>
<p>
Date is encoded in an unsigned 2-byte integer with the following bit fields:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%>Contents</th>
<th align=left width=31%>Bits</th>
<th align=left width=47%>Value Range</th>
</tr>
<tr valign=top>
<td width=22%>year</td>
<td width=31%>0 1 2 3 4 5 6</td>
<td width=47%>0-119 (relative to 1980)</td>
</tr>
<tr valign=top>
<td width=22%>month</td>
<td width=31%>7 8 9 A</td>
<td width=47%>1-12</td>
</tr>
<tr valign=top>
<td width=22%>day</td>
<td width=31%>B C D E F</td>
<td width=47%>1-31</td>
</tr>
</table><br>

<h3><a name="_msi_identifier"></a>Identifier</h3>
<p>
The Identifier data type is a text string. Identifiers may contain letters, digits, underscores (_), or periods (.). However, every identifier must begin with either a letter or an underscore.</p>

<h3><a name="_msi_property"></a>Property</h3>
<p>
The Property data type is a valid <a href="#_msi_identifier">Identifier</a> with the additional syntax "<code>%<i>identifier</i></code>," which represents an environment variable.</p>

<h3><a name="_msi_filename"></a>Filename</h3>
<p>
The Filename data type is a text string containing a file name or folder. By default, the file name is assumed to use short file name syntax; that is, eight-character name, period (.), and 3-character extension. To include a long file name, separate it from the short file name with a vertical bar (|). For example, the following two strings are valid:</p>
<pre><code>status.txt
projec~1.txt|Project Status.txt
 </code></pre>
<p>
Short and long file names must not contain the following characters:</p>
<pre><code>\   ?   |   &gt;  &lt;   :  /  *  "
 </code></pre>
<p>
In addition, short file names must not contain the following characters:</p>
<pre><code>+  ,  ;  =  [  ] 
 </code></pre>
<p>
Short file names may not include a space, although a long file name may. No space is allowed preceding the vertical bar (|) separator for the short file name/long file name syntax. If a space exists after the pipe separator, then the long file name must have a space at the beginning of the file name. No full-path syntax is allowed.</p>

<h3><a name="_msi_wildcardfilename"></a>WildCardFilename</h3>
<p>
The WildCardFilename data type is a <a href="#_msi_filename">Filename</a> that may also contain the wild card characters "?" for any single character or "*" for zero or more occurrences of any character.</p>
<p>
During validation, "*" is treated as representing two or more characters. For example, "weather*.txt" would not pass validation because it does not fit into the eight-character name, period (.), and 3-character extension filename format. However, "weather?.txt" would pass validation.</p>

<h3><a name="_msi_path"></a>Path</h3>
<p>
The Path data type is a text string containing a valid full path. </p>
<p>
The string may also contain a property name enclosed in square brackets (<code>[ ]</code>). In such a case, the name of the property, including the brackets, are replaced in the string by the value of the property. The property name and brackets may not be preceded or succeeded by any alphabetic characters. For example, "<code>\\server\share\[username]</code>" is valid, but "<code>\\server\share\abc[username]</code>" is not.</p>
<p>
Examples:
<ul>
<li>
UNC path: <code>\\server\share</code></li>
<li>
Local drive: <code>c:\temp</code></li>
<li>
With a property name: <code>[DRIVE]\temp</code></li>
</ul>

<h3><a name="_msi_paths"></a>Paths</h3>
<p>
The Paths data type is a text string containing a list of Path data types, separated by semicolons (;).</p>

<h3><a name="_msi_anypath"></a>AnyPath</h3>
<p>
The AnyPath data type is a text string containing either a full <a href="#_msi_path">Path</a> or a relative subpath.</p>
<p>
Examples:
<ul>
<li>
\\server\share\temp</li>
<li>
c:\temp</li>
<li>
\temp</li>
</ul>

<h3><a name="_msi_defaultdir"></a>DefaultDir</h3>
<p>
The DefaultDir data type is a text string containing either a valid <a href="#_msi_filename">Filename</a> or a valid <a href="#_msi_identifier">Identifier</a>. This is used only in the <a href="tref_6an9.htm">Directory table</a>. It must be an identifier if the directory is a root directory. If the directory is a non-root, this value must be a filename or a filename:filename pair. Note that "." is allowed as a file name and has special meaning in the Directory table.</p>

<h3><a name="_msi_regpath"></a>RegPath</h3>
<p>
The RegPath data type is a text string containing a Registry path. Registry paths can include properties, as with the <a href="#_msi_formatted">Formatted</a> data type. A RegPath may not begin or end with a backslash (\). The [#file key] and [$component key] can be embedded in the path or preceded by other characters.</p>

<h3><a name="_msi_formatted"></a>Formatted</h3>
<p>
The Formatted data type is a text string that is processed to resolve embedded property names, table keys, environment variable references, and other special substrings. The following conventions are recognized to resolve the string:
<ul>
<li>
Square brackets ([  ]) or curly braces ({  }) with no matching pair are left in the text.</li>
<li>
If a substring of the form <code>[<i>propertyname</i>]</code> is encountered, it is replaced by the value of the property. If <i><code>propertyname</code></i> is not a valid property, then the substring is left unchanged.<p>
The square brackets may be iterated and the property names are resolved from inside out. For example, suppose the substring <code>[[PropertyA]]</code> appears in the text. First, the value of property PropertyA is retrieved. If the value is a valid property name, such as PropertyB, then the value of PropertyB is retrieved, and the entire substring <code>[[PropertyA]]</code> is substituted with the value of PropertyB. If PropertyA is not a valid property name, or if the value of PropertyA is not a valid property name, then the substring is blank.
</li>
<li>
If a substring of the form <code>[%<i>environmentvariable</i>]</code> is found, the value of the environment variable is substituted for the substring.</li>
<li>
If a substring of the form <code>[\<i>x</i>]</code> is found, it is replaced by the character <i><code>x</code></i> , where <i><code>x</code></i> is one character, without any further processing. Only the first character after the backslash is kept; everything else is removed. </li>
<li>
If a substring is enclosed in curly braces (<code>{ }</code>), and it contains no property names enclosed in square brackets (<code>[ ]</code>), the substring is left unchanged, including the curly braces.</li>
<li>
If a substring is enclosed in curly braces (<code>{ }</code>), and it contains one or more property names enclosed in square brackets (<code>[ ]</code>), then, if all the property names are valid, the text (with the resolved substitutions) is displayed without the curly braces.</li>
<li>
If a substring of the form [~] is found, it is replaced with the Null character. This is used to author REG_MULTI_SZ character strings in the <a href="tref_3obp.htm">Registry table</a>.<p>
If no properties are found, all the text in the braces, including the braces themselves, is removed.
</li>
</ul>

<h3><a name="_msi_keyformatted"></a>KeyFormatted</h3>
<p>
The KeyFormatted data type is a text string, identical to <a href="#_msi_formatted">Formatted</a>, except with the following additional keys:
<ul>
<li>
If a substring of the form <code>[#<i>filekey</i>]</code> is found, it is replaced by the full path of the file, with the value <i><code>filekey</code></i> used as a key into the <a href="tref_4n6t.htm">File table</a>. </li>
<li>
If a substring of the form <code>[$<i>componentkey</i>]</code> is found, it is replaced by the install directory of the component, with the value <i><code>componentkey</code></i> used as a key into the <a href="tref_09np.htm">Component table</a>.<p>
The state of the Action column in the Component table affects the install directory used to replace the substring. If the component is selected to be installed locally, the target directory is used. If the component is selected to run from source, the source directory is used. If the component is not selected or missing, the substring is removed.
</li>
</ul>
<p>
Multiple instances of KeyFormatted properties are allowed and the KeyFormatted properties can be embedded within a string.</p>

<h3><a name="_msi_template"></a>Template</h3>
<p>
The Template data type is a text string that may contain properties that are enclosed in brackets (<code>[ ]</code>). The template type allows all of the <a href="#_msi_formatted">Formatted</a> type formats, plus [<i>1</i>] where <i>1</i> is a number.</p>

<h3><a name="_msi_condition"></a>Condition</h3>
<p>
The Condition data type is a text string containing a valid conditional statement that can be evaluated as True or False.</p>

<h3><a name="_msi_guid"></a>GUID</h3>
<p>
The GUID data type is a text string representing a Class identifier (ID). COM must be able to convert the string to a valid Class ID.</p>

<h3><a name="_msi_version"></a>Version</h3>
<p>
The Version data type is a text string containing a valid version string. A version string has the format</p>
<pre><code><i>xx</i>.<i>xx</i>.<i>xxxx</i>.<i>xxxx</i>
 </code></pre>
<p>
where <i><code>x</code></i> is a digit. Version is only used in the <a href="tref_4n6t.htm">File table</a>. If a file has a version, it must also have a language associated with it. If the language is neutral, specify 0 (zero) in the Language column of the File table.</p>

<h3><a name="_msi_language"></a>Language</h3>
<p>
The Language data type is a text string containing one or more valid numeric language IDs. If there are two or more language IDs, they must be separated by commas.</p>

<h3><a name="_msi_binary"></a>Binary</h3>
<p>
The Binary data type is a binary data stream containing any type of binary data. Examples include a bitmap or executable code.</p>

<h3><a name="_msi_customsource"></a>CustomSource</h3>
<p>
The CustomSource data type is either a valid <a href="#_msi_identifier">Identifier</a> or an external key depending on the Type column of the <a href="tref_71b9.htm">CustomAction table</a>. It can be an external key into the <a href="tref_04px.htm">Binary table</a>, <a href="tref_4n6t.htm">File table</a>, <a href="tref_6an9.htm">Directory table</a>, and <a href="tref_21d1.htm">Property table</a>. Although, as an external key into the Property table, it isn't evaluated because properties can be added at run-time.</p>

<h3><a name="_msi_cabinet"></a>Cabinet</h3>
<p>
The Cabinet data type is usually used in the Cabinet column of the <a href="tref_4mlh.htm">Media table</a>. If the cabinet name is preceded by the pound sign (#), the characters following it are interpreted as a <a href="#_msi_filename">Filename</a>. The (#) is used to denote a cabinet located in a stream inside the database.</p>

<h3><a name="_msi_shortcut"></a>Shortcut</h3>
<p>
The Shortcut data type is usually used in the Target column of the <a href="tref_2i91.htm">Shortcut table</a>. If it contains square brackets (<code>[ ]</code>), the shortcut target is evaluated as a <a href="#_msi_keyformatted">KeyFormatted</a> string. Otherwise, the shortcut is evaluated as an <a href="#_msi_identifier">Identifier</a> and must be a valid foreign key into the <a href="tref_0a91.htm">Feature table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi__rowstate_column"></a>_RowState Column</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The reserved column name _RowState represents the non-persistent state associated with each table row in an installer database table. The pseudo-column is of type <a href="tref_6b77.htm#_msi_integer">Integer</a>, and the value consists of a set of bit flags. All the bits are readable, but only the UserInfo and Temporary bits can be set. This data is available only as long as the tables are locked or in use (that is, while a view containing the tables exists). The following table shows the attributes a row can have:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=24%>Name</th>
<th align=left width=18%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=24%>iraUserInfo</td>
<td width=18%>0x01</td>
<td width=58%>The attribute is for external use. This value can be updated.</td>
</tr>
<tr valign=top>
<td width=24%>iraTemporary</td>
<td width=18%>0x02</td>
<td width=58%>The row is not persistent. This value can be updated.</td>
</tr>
<tr valign=top>
<td width=24%>iraModified</td>
<td width=18%>0x04</td>
<td width=58%>A row has been updated.</td>
</tr>
<tr valign=top>
<td width=24%>iraInserted</td>
<td width=18%>0x08</td>
<td width=58%>A row has been inserted.</td>
</tr>
<tr valign=top>
<td width=24%>iraMergeFailed</td>
<td width=18%>0x0F</td>
<td width=58%>An attempt was made to merge with non-identical, non-key data.</td>
</tr>
</table><br>
<p>
Bits 6 through 8 are reserved.</p>
<p>&nbsp;</p>

<h1><a name="_msi_actiontext_table"></a>ActionText Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ActionText table contains text to be displayed in a progress dialog and written to the log for actions that take a noticeably long time to execute. The text displayed consists of the action description and optionally formatted data from the action.</p>
<p>
The ActionText table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=25%>Column</th>
<th align=left width=43%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=25%>Action</td>
<td width=43%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=25%>Description</td>
<td width=43%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=25%>Template</td>
<td width=43%><a href="tref_6b77.htm#_msi_template">Template</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action.
<p>
Primary table key.
</dd>
<dt>
Description</dt>
<dd>
Localized description displayed in the progress dialog or written to the log when the action is executing.</dd>
<dt>
Template</dt>
<dd>
Optional localized format template used to format action data records for display during action execution. If no template is supplied, the action data is not displayed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The entries in the ActionText table typically refer to actions in sequence tables. However, there are other "pseudo-actions" performed by the installer that are not listed in the sequence table but still require text to be specified in this table. These required entries are listed below. The action name and template must be authored exactly as given, but the description may be customized.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Action</th>
<th align=left width=34%>Description</th>
<th align=left width=35%>Template</th>
</tr>
<tr valign=top>
<td width=31%>Rollback</td>
<td width=34%>Undoes actions.</td>
<td width=35%>[1]</td>
</tr>
<tr valign=top>
<td width=31%>RollbackCleanup</td>
<td width=34%>Removes old files.</td>
<td width=35%>[1]</td>
</tr>
<tr valign=top>
<td width=31%>GenerateScript</td>
<td width=34%>Generates system operations for action.</td>
<td width=35%>[1]</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_adminexecutesequence_table"></a>AdminExecuteSequence Table</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AdminExecuteSequence table lists Admin actions that are executed when the top-level <a href="aref_4hbi.htm">ADMIN action</a> is executed. The columns and Special Terminate Actions definitions are identical to those of the <a href="tref_5pid.htm">InstallExecuteSequence table</a>.</p>
<p>
ADMIN actions in the install sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and any exit dialogs, are located in the <a href="tref_5lnp.htm">AdminUISequence table</a>. ADMIN actions from the InstallValidate action through the end of the install sequence are in the AdminExecuteSequence table. Because the AdminExecuteSequence table needs to stand alone, it has any necessary initialization actions such as LaunchConditions, CostInitialize, FileCost, and CostFinalize.</p>
<p>
The AdminExecuteSequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=34%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=34%>Action</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Condition</td>
<td width=35%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Sequence</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a standard action, user interface wizard, or a custom action listed in the <a href="tref_71b9.htm">CustomAction table</a>.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to False, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the Action Sequencer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>This value</th>
<th align=left width=74%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=26%>-1</td>
<td width=74%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=26%>-2</td>
<td width=74%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=26%>-3</td>
<td width=74%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=26%>-4</td>
<td width=74%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_adminuisequence_table"></a>AdminUISequence Table</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AdminUISequence table lists ADMIN actions that are executed when the top-level <a href="aref_4hbi.htm">ADMIN action</a> is executed. The columns and Special Terminate Actions definitions are identical to those of the <a href="tref_1git.htm">InstallUISequence table</a>.</p>
<p>
ADMIN actions in the install sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and any exit dialogs, are located in the AdminUISequence table. All actions from the InstallValidate through the end of the install sequence are in the <a href="tref_70f9.htm">AdminExecuteSequence table</a>. Because the AdminExecuteSequence table needs to stand alone, it has any necessary initialization actions such as <a href="aref_6jhq.htm">LaunchConditions</a>, <a href="aref_4bam.htm">CostInitialize</a>, <a href="aref_2f8u.htm">FileCost</a>, and <a href="aref_22we.htm">CostFinalize</a>, and it has the <a href="aref_3b1q.htm">ExecuteAction action</a>.</p>
<p>
The AdminUISequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=34%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=34%>Action</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Condition</td>
<td width=35%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Sequence</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a standard action, user interface wizard, or a custom action listed in the <a href="tref_71b9.htm">CustomAction table</a>.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to False, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the Action Sequencer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>This value</th>
<th align=left width=74%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=26%>-1</td>
<td width=74%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=26%>-2</td>
<td width=74%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=26%>-3</td>
<td width=74%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=26%>-4</td>
<td width=74%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_advtexecutesequence_table"></a>AdvtExecuteSequence Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AdvtExecuteSequence table lists advertise actions the installer executes when the top-level <a href="aref_2o8e.htm">ADVERTISE action</a> is executed. The columns and Special Terminate Actions definitions are identical to those of the <a href="tref_5pid.htm">InstallExecuteSequence table</a>.</p>
<p>
Advertise actions in the sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and any exit dialogs, are located in the <a href="tref_3rvp.htm">AdvtUISequence table</a>. All actions from the InstallValidate action through the end of the install sequence are in the AdvExecuteSequence table.</p>
<p>
The AdvtExecuteSequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=33%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=33%>Action</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=33%>Condition</td>
<td width=35%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Sequence</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a built-in action, a custom action, or a user interface wizard.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to expFalse, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the installer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>This value</th>
<th align=left width=74%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=26%>-1</td>
<td width=74%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=26%>-2</td>
<td width=74%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=26%>-3</td>
<td width=74%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=26%>-4</td>
<td width=74%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<p>
The actions that may be in the AdvtExecuteSequence table are:</p>
<p>
<a href="aref_10dq.htm">PublishProduct</a><br>
<a href="aref_8bou.htm">PublishFeatures</a><br>
<a href="aref_2r3i.htm">PublishComponents</a><br>
<a href="aref_04oe.htm">RegisterClassInfo</a><br>
<a href="aref_1epa.htm">RegisterExtensionInfo</a><br>
<a href="aref_9r8u.htm">RegisterMIMEInfo</a><br>
<a href="aref_31ri.htm">RegisterTypeLibraries</a><br>
<a href="aref_7uzy.htm">CreateShortcuts</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_advtuisequence_table"></a>AdvtUISequence Table</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AdvtUISequence table lists advertise actions the installer executes when the top-level <a href="aref_2o8e.htm">ADVERTISE action</a> is called. The columns and Special Terminate Actions definitions are identical to those of the <a href="tref_5pid.htm">InstallExecuteSequence table</a>.</p>
<p>
Advertise actions in the sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and any exit dialogs, are located in the AdvtUISequence table. Advertise actions from the InstallValidate action through the end of the sequence are in the <a href="tref_5mn9.htm">AdvtExecuteSequence table</a>.</p>
<p>
The AdvtUISequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=33%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=33%>Action</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=33%>Condition</td>
<td width=35%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Sequence</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a built-in action, a custom action, or a user interface wizard.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to expFalse, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the installer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>This value</th>
<th align=left width=74%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=26%>-1</td>
<td width=74%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=26%>-2</td>
<td width=74%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=26%>-3</td>
<td width=74%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=26%>-4</td>
<td width=74%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<p>
The actions that may be in the AdvtUISequence table are:</p>
<p>
<a href="aref_10dq.htm">PublishProduct</a><br>
<a href="aref_8bou.htm">PublishFeatures</a><br>
<a href="aref_2r3i.htm">PublishComponents</a><br>
<a href="aref_04oe.htm">RegisterClassInfo</a><br>
<a href="aref_1epa.htm">RegisterExtensionInfo</a><br>
<a href="aref_9r8u.htm">RegisterMIMEInfo</a><br>
<a href="aref_31ri.htm">RegisterTypeLibraries</a><br>
<a href="aref_7uzy.htm">CreateShortcuts</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_appsearch_table"></a>AppSearch Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AppSearch table contains the properties that must be set to the search result of a corresponding file signature. </p>
<p>
The AppSearch table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Property</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Signature_</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
When the AppSearch action is run, this property is set to the location of the file indicated by the Signature_ column.</dd>
<dt>
Signature_</dt>
<dd>
The Signature_ represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>, <a href="tref_91wl.htm">RegLocator table</a>, <a href="tref_00o5.htm">IniLocator table</a>, <a href="tref_771h.htm">CompLocator table</a>, and <a href="tref_3azp.htm">DrLocator table</a>. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is used by the <a href="aref_16zy.htm">AppSearch action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_bbcontrol_table"></a>BBControl Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The BBControl table contains the controls to be displayed on the specified billboard.</p>
<p>
The BBControl table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=34%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=34%></td>
<td width=35%></td>
<td width=13%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=34%>Billboard_</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>BBControl</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Type</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>X</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Y</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Width</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Height</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Attributes</td>
<td width=35%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Text</td>
<td width=35%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Billboard_</dt>
<dd>
Name of the billboard.
<p>
External key to column one of the <a href="tref_0c4l.htm">Billboard table</a>.
</dd>
<dt>
BBControl</dt>
<dd>
Name of the control. This name must be unique within a billboard but can be repeated on different billboards. Combined with the Billboard_ column, they form the primary key to this table.</dd>
<dt>
Type</dt>
<dd>
The type of the control. For a list of supported control types, see <a href="hand_8mrb.htm">Control Overview</a>. It is not advisable to put any control other than the static ones (that is, text, bitmap, icon) on a billboard. The author can also specify a custom control type. </dd>
<dt>
X</dt>
<dd>
Horizontal coordinate of the upper-left corner of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Y</dt>
<dd>
Vertical coordinate of the upper-left corner of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Width</dt>
<dd>
Width of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Height</dt>
<dd>
Height of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Attributes</dt>
<dd>
A 32-bit word that specifies the attribute flags to be applied to this control. For a list of supported control attributes, see <a href="hand_8mrb.htm">Control Overview</a>.
<p>
Non-negative numbers only.
</dd>
<dt>
Text</dt>
<dd>
A string used to set the initial text contained within a control (if appropriate). If the text is too long to be displayed on the control, the string is truncated. This column may be left blank. If the control is a pushbutton or a checkbox that contains a picture (icon or bitmap), this column is the name of the picture (a key into the <a href="tref_04px.htm">Binary table</a>). It is not possible to show both a picture and text on the same button.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The integer values for x, y, width, and height are in the installer units, not dialog units. An installer unit is equal to one-twelfth the height of the system font. Coordinates for the controls are relative to the billboard.</p>
<p>&nbsp;</p>

<h1><a name="_msi_billboard_table"></a>Billboard Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Billboard table lists the billboards displayed in the full user interface. A billboard is a part of a dialog that dynamically changes on progress or through action data messages.</p>
<p>
The Billboard table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Billboard</td>
<td width=37%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Feature_</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Action</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>Ordering</td>
<td width=37%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Billboard</dt>
<dd>
Name of the billboard.</dd>
<dt>
Feature_</dt>
<dd>
An external key into the <a href="tref_0a91.htm">Feature table</a>. The billboard is shown only if this feature is being installed.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Action</dt>
<dd>
The name of an action. The billboard is displayed during the progress messages received from this action.</dd>
<dt>
Ordering</dt>
<dd>
If there is more than one billboard corresponding to an action, they are displayed in the order defined by this column.
<p>
Non-negative numbers only.

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_binary_table"></a>Binary Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Binary table holds the binary data for items such as bitmaps, animations, and icons. The binary table is also typically used to store data for custom actions.</p>
<p>
The Binary table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Name</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Data</td>
<td width=38%><a href="tref_6b77.htm#_msi_binary">Binary</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Name</dt>
<dd>
A unique key that identifies the particular binary data. If the binary data is for a control, the key appears in the Text column of the associated control in the <a href="tref_6nad.htm">Control table</a>. This key must be unique among all controls requiring binary data.</dd>
<dt>
Data</dt>
<dd>
The unformatted binary data.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_bindimage_table"></a>BindImage Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The BindImage table contains information about each executable that needs to be bound to the DLLs imported by it. </p>
<p>
The BindImage table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>File_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Path</td>
<td width=40%><a href="tref_6b77.htm#_msi_paths">Paths</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File_</dt>
<dd>
The index into the <a href="tref_4n6t.htm">File table</a>. This must be an executable file.
<p>
External key to column one of the File table.
</dd>
<dt>
Path</dt>
<dd>
A list of paths, separated by semicolons, that represent the paths to be searched to find the import DLLs. The list is usually a list of properties, each enclosed within square brackets (<code>[ ]</code>) .
</dd>
</dl>
<h4>Remarks</h4>
<p>
The installer computes the virtual address of each function that is imported from all DLLs, and the computed virtual address is then saved in the importing image's Import Address Table (IAT).</p>
<p>
This table is referred to when the <a href="aref_3ar2.htm">BindImage action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_ccpsearch_table"></a>CCPSearch Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CCPSearch table contains the list of file signatures, at least one of which needs to be present on a user's computer for the Compliance Checking Program (CCP). </p>
<p>
The CCPSearch table has the following column.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Signature_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Column</h4>
<dl>
<dt>
Signature_</dt>
<dd>
The Signature_ represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>, <a href="tref_91wl.htm">RegLocator table</a>, <a href="tref_00o5.htm">IniLocator table</a>, <a href="tref_771h.htm">CompLocator table</a>, and <a href="tref_3azp.htm">DrLocator table</a>. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_77se.htm">CCPSearch action</a> or the <a href="aref_5pgu.htm">RMCCPSearch action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_checkbox_table"></a>CheckBox Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CheckBox table lists the values for the checkboxes. </p>
<p>
The CheckBox table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=28%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=28%></td>
<td width=39%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=28%>Property</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=28%>Value</td>
<td width=39%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
A named property to be tied to this item.</dd>
<dt>
Value</dt>
<dd>
The value string associated with this item. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the checkbox is turned on, the corresponding property is set to the described value. If there is no value specified or this table does not exist, the property is set to its original value when the checkbox is turned on. If the original value is Null, the property is set to "1".</p>
<p>
<b>Formatting</b></p>
<p>
The contents of the Value column are formatted by the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function when the control is created. Therefore, it can contain any expression that the <b>MsiFormatRecord</b> function can interpret. The Value column is formatted only when the control is created, and it is not updated if a property involved in an expression is modified during the life of the control. </p>
<p>&nbsp;</p>

<h1><a name="_msi_class_table"></a>Class Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Class table contains COM server-related information that must be generated as a part of the product advertisement. Each row may generate a set of registry keys and values. The associated ProgId information is included in this table.</p>
<p>
The Class table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=33%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=33%>CLSID</td>
<td width=35%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=33%>Context</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=33%>ProgId_Default</td>
<td width=35%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Description</td>
<td width=35%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Insertable</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>AppId</td>
<td width=35%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>FileTypeMask</td>
<td width=35%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Icon_</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>IconIndex</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>DefInprocHandler</td>
<td width=35%><a href="tref_6b77.htm#_msi_filename">Filename</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Argument</td>
<td width=35%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=33%>Feature_</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=33%>Component_</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
CLSID</dt>
<dd>
The Class identifier (ID) of a COM server.</dd>
<dt>
Context</dt>
<dd>
The server context for this server.
<p>
May be one of the following values:

<p class=indent1>
LocalServer</p>

<p class=indent1>
LocalServer32</p>

<p class=indent1>
InprocServer</p>

<p class=indent1>
InprocServer32</p>
</dd>
<dt>
ProgId</dt>
<dd>
The default Program ID associated with this Class ID.</dd>
<dt>
Description</dt>
<dd>
Localized description associated with the Class ID and Program ID.</dd>
<dt>
Insertable</dt>
<dd>
Writes the Insertable key if it is non-zero and non-null.
<p>
Non-negative numbers only.
</dd>
<dt>
AppId</dt>
<dd>
Application ID containing DCOM information for the associated application (string <a href="tref_6b77.htm#_msi_guid">GUID</a>). Not used in installer version 1.0.</dd>
<dt>
FileTypeMask</dt>
<dd>
Contains information for the HKCR (this CLSID) key. 
<p>
If multiple patterns exist, they must be delimited by a semicolon, and numeric subkeys are generated: 0,1,2...
</dd>
<dt>
Icon_</dt>
<dd>
External key into the <a href="tref_7vmt.htm">Icon table</a> specifying the icon file associated with this CLSID. Is written under the DefaultIcon key associated with the ProgId.
<p>
External key to column one of the Icon table .
</dd>
<dt>
IconIndex</dt>
<dd>
Icon index into the icon file. This can be Null.
<p>
Non-negative numbers only.
</dd>
<dt>
DefInprocHandler</dt>
<dd>
Default inproc handler. 
<p>
May be optionally provided only for Context = LocalServer or LocalServer32. A non-numeric value is treated as a system file that serves as the 32-bit InprocHandler (appearing as the InprocHandler32 value).

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>1 = default (system)</td>
<td width=52%>16-bit InprocHandler (appearing as the InprocHandler value)</td>
</tr>
<tr valign=top>
<td width=48%>2 = default (system) </td>
<td width=52%>32-bit InprocHandler (appearing as the InprocHandler32 value)</td>
</tr>
<tr valign=top>
<td width=48%>3 = default (system) </td>
<td width=52%>16-bit as well as 32-bit InprocHandlers</td>
</tr>
</table><br>

</dd>
<dt>
Argument</dt>
<dd>
This column is optional only when the Context column is set to the LocalServer or LocalServer32 server context. The text is registered as the argument against the OLE server and is used by OLE for invoking the server.</dd>
<dt>
Feature_</dt>
<dd>
External key into the <a href="tref_0a91.htm">Feature table</a> specifying the feature that provides the COM server.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> specifying the component whose key file provides the COM server.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_04oe.htm">RegisterClassInfo action</a> or the <a href="aref_8wby.htm">UnregisterClassInfo action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_combobox_table"></a>ComboBox Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The lines of a combobox are not treated as individual controls; they are part of some combobox that functions as a control. This table lists the values for all comboboxes.</p>
<p>
The ComboBox table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Property</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Order</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Value</td>
<td width=44%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Text</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
A named property to be tied to this item. All the items tied to the same property become part of the same combobox.</dd>
<dt>
Order</dt>
<dd>
A positive integer used to determine the ordering of the items that appear in a single combobox list. The integers do not have to be consecutive. If a combobox is defined as ordered, all the items should have an Order value. If the combobox is defined as unordered, this column is ignored.
<p>
Positive numbers only.
</dd>
<dt>
Value</dt>
<dd>
The value string associated with this item. Selecting this line of the combobox sets the associated property (specified in Property) to this value. </dd>
<dt>
Text</dt>
<dd>
The visible text to be assigned to the item. If this entry or the entire column is missing, the text defaults to the corresponding entry in Value.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Formatting</b></p>
<p>
The contents of the Value and Text fields are formatted by the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function when the control is created, so they can contain any expression that the <b>MsiFormatRecord</b> function can interpret. The formatting occurs only when the control is created, and it is not updated if a property involved in the expression is modified during the life of the control.</p>
<p>&nbsp;</p>

<h1><a name="_msi_complocator_table"></a>CompLocator Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CompLocator table holds the information needed to find a file or a directory using the installer configuration data.</p>
<p>
The CompLocator table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>Signature_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>ComponentID</td>
<td width=39%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Type</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Signature_</dt>
<dd>
This column represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>. If the key is absent from the Signature table, the search is assumed to be for the presence of a directory pointed to by the CompLocator Table.</dd>
<dt>
ComponentID</dt>
<dd>
The component ID of the component whose key path is to be used for the search.</dd>
<dt>
Type</dt>
<dd>
A Boolean value that determines if the key path of the component is a file name or a directory location.
<p>
The following table lists valid values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=24%>This value</th>
<th align=left width=76%>Indicates that the key path represents a</th>
</tr>
<tr valign=top>
<td width=24%>0</td>
<td width=76%>directory</td>
</tr>
<tr valign=top>
<td width=24%>1</td>
<td width=76%>file name</td>
</tr>
</table><br>

</dd>
</dl>
<p>
If this column is absent, the value is assumed to be one (file name).</p>
<h4>Remarks</h4>
<p>
This table's columns are generally not localized. If an author decides to search for products in multiple languages, then there can be a separate entry included in the table for each language.</p>
<p>&nbsp;</p>

<h1><a name="_msi_component_table"></a>Component Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Component table lists components. </p>
<p>
The Component table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Component</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>ComponentID</td>
<td width=37%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=31%>Directory_</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>Attributes</td>
<td width=37%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=31%>Condition</td>
<td width=37%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=31%>KeyPath</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Component</dt>
<dd>
Identifies the component record.
<p>
Primary table key.
</dd>
<dt>
ComponentID</dt>
<dd>
A string GUID unique to this component, version, and language.
<p>
Table key.
</dd>
<dt>
Directory_</dt>
<dd>
External key of an entry in the <a href="tref_6an9.htm">Directory table</a>. This is a property name whose value contains the actual path, set either by the <a href="aref_16zy.htm">AppSearch action</a> or with the default setting obtained from the Directory table.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Attributes</dt>
<dd>
Remote execution option.
<p>
The first two bits indicate whether the component can be run from source. The following table lists valid values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>This value</th>
<th align=left width=68%>Indicates that the item </th>
</tr>
<tr valign=top>
<td width=32%>0 (irsLocalOnly)</td>
<td width=68%>Cannot be run from the source.</td>
</tr>
<tr valign=top>
<td width=32%>1 (irsSourceOnly)</td>
<td width=68%>Can run only from the source.</td>
</tr>
<tr valign=top>
<td width=32%>2 (irsOptional)</td>
<td width=68%>Can run either locally or from the source.</td>
</tr>
</table><br>


<p>
The rest of the significant bits are bit flags.

<p>
The 3rd bit is the irsRegistryKeyPath bit. 

<p>
If the third bit is set, the KeyPath column, if not Null, is interpreted as a key into the <a href="tref_3obp.htm">Registry table</a>. If this bit is not set, the KeyPath column, if not Null, is interpreted as a key into the <a href="tref_4n6t.htm">File table</a>.

<p>
The 4th bit is the icaSharedDllRefCount bit. If the 4th bit is set, the installer will always increment the reference count in the shared DLL registry. If the 4th bit is not set, then the installer will only increment the reference count if it already exists.

<p>
The 5th bit is the icaPermanent bit. If the 5th bit is set then the component will not be removed on uninstall.
</dd>
<dt>
Condition</dt>
<dd>
A conditional statement that indicates if a component should be installed. If the condition is Null or evaluates to True, the component is enabled. If the condition evaluates to False, the component is disabled. If a component is disabled, it will not be installed regardless of the Action state associated with the component. For information on the conditional expression syntax, see the <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a> function.</dd>
<dt>
KeyPath</dt>
<dd>
This value points to the component member that will be used for detection. It is also the path that is returned by the <a href="msi_3fxk.htm"><b>MsiGetComponentPath</b></a> function. If not Null, KeyPath is either the primary key into the File table or the Registry table based on the irsRegistryKeyPath bit in the Attributes column. In both cases, the entity (file or folder) should belong to this component. If Null, the folder of the Component (Component.Directory_) is used as the key path. Two components can not share the same key path value.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For a discussion of the relationship between components and features, see <a href="tref_0a91.htm">Feature Table</a>.</p>
<p>
The installer keeps track of shared DLLs independently of the shared DLL reference count in the registry. If a reference count for a shared DLL exists in the registry, then the installer will always increment the count when it is installing the file and decrement it when it is uninstalling. However, if the icaSharedDllRefCount bit is not set and the reference count does not already exist, the installer will not create one.</p>
<p>
If the icaSharedDllRefCount bit is not set, another application could remove the component even if it is still needed. To see how this could happen, consider the following scenario:
<ul>
<li>
An application that uses the installer installs a shared component.</li>
<li>
The icaSharedDllRefCount is not set and there is no reference count. Thus the installer does not begin a reference count.</li>
<li>
A legacy application that shares this component and does not use the installer is installed.</li>
<li>
The legacy application creates and increments a reference count for the shared component.</li>
<li>
The legacy application is uninstalled.</li>
<li>
The reference count for the shared component is decremented to zero and the component is removed.</li>
<li>
The application using the installer no longer has access to the component.</li>
</ul>
<p>
To avoid this behavior, set the icaSharedDllRefCount bit.</p>
<p>&nbsp;</p>

<h1><a name="_msi_condition_table"></a>Condition Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Condition table can be used to modify the selection state of any entry in the <a href="tref_0a91.htm">Feature table</a> based on a conditional expression.</p>
<p>
The Condition table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%>Feature_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Level</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Condition</td>
<td width=40%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Feature_</dt>
<dd>
External key to a Feature entry in the Feature table.
<p>
External key into column one of the Feature table.
</dd>
<dt>
Level</dt>
<dd>
New selection Level to set in the Feature table if Condition evaluates to TRUE.</dd>
<dt>
Condition</dt>
<dd>
If this conditional expression evaluates to TRUE, the Level value in the Feature entry of the Feature table is set to the Level value in this table. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If Condition evaluates to True, the corresponding Level value in the Feature table is set to the value specified in the Condition table Level column.</p>
<p>
Using this mechanism, any feature can be permanently disabled (by setting the Level to 0), set to be always installed (by setting the Level to 1), or set to a different install priority (by setting Level to an intermediate value). The Level may be set based on any conditional statement, such as a test for platform, operating system, or a particular property setting.</p>
<p>
This table is referred to when the <a href="aref_22we.htm">CostFinalize action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_control_table"></a>Control Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Control table defines the controls that appear on each dialog.</p>
<p>
The Control table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>Dialog_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Control</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Type</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>X</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Y</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Width</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Height</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Attributes</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Property</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Text</td>
<td width=39%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Control_Next</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Help</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Dialog_</dt>
<dd>
External key to the <a href="tref_51wl.htm">Dialog table</a>, the name of the dialog.
<p>
External key to column one of the Dialog table.
</dd>
<dt>
Control</dt>
<dd>
Name of the control. This name must be unique within a dialog but can be repeated on different dialogs. Combined with the Dialog_ column, they form the primary key to this table.</dd>
<dt>
Type</dt>
<dd>
The type of the control. For a list of supported control types, see <a href="hand_8mrb.htm">Control Overview</a>. The author can specify a custom control type. </dd>
<dt>
X</dt>
<dd>
Horizontal coordinate of the upper-left corner of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Y</dt>
<dd>
Vertical coordinate of the upper-left corner of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Width</dt>
<dd>
Width of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Height</dt>
<dd>
Height of the bounding rectangle of the control.
<p>
Non-negative numbers only.
</dd>
<dt>
Attributes</dt>
<dd>
A 32-bit word that specifies the stylebit flags to be applied to this control. For a list of supported control stylebits, see <a href="href_2z6t.htm#_msi_control_stylebits_list">Control Stylebits List</a>.
<p>
Non-negative numbers only.
</dd>
<dt>
Property</dt>
<dd>
The name of a defined property to be linked to this control. Radio button, listbox, and combobox values are tied into a group by being linked to the same property. This column is required for all active controls and is ignored for others.</dd>
<dt>
Text</dt>
<dd>
A string used to set the initial text contained within a control (if appropriate). If the text is too long to be displayed on the control, the string is truncated. The text string may be blank. This text can contain embedded properties. For the syntax of this string, see the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function. For the <a href="href_7ing.htm">VolumeCostList control</a>, the <a href="href_6omk.htm">ListView control</a>, the <a href="href_09f0.htm">DirectoryList control</a>, and the <a href="href_3w30.htm">SelectionTree control</a>, you can enter short descriptive text. This text will never be seen by the user, but will be read by the screen readers as the description of the given control. This field can also contain other special information specific to the given control type. For details, see the documentation for the specific control type.</dd>
<dt>
Control_Next</dt>
<dd>
The name of another control on the same dialog. The tab order of the controls on the dialog follow this link, and the links must form one cycle. Some controls (for example, static text) can be left out of the cycles completely, in which case this entry may be left blank.
<p>
External key to column two of the Control table.
</dd>
<dt>
Help</dt>
<dd>
The Help strings used with the button. The text is optional. The string is divided into two parts, divided by a separator character (|). The first part of the string is used as ToolTip text (this text is shown by screen readers for controls that contain a picture). The second part is used for context-sensitive Help. The separator character is required even if only one of the two kinds of text is present.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The integer values for x, y, width, and height are in the installer units, not dialog units. An installer unit is equal to one-twelfth the height of the system font. Coordinates for the controls are relative to the billboard.</p>
<p>&nbsp;</p>

<h1><a name="_msi_controlcondition_table"></a>ControlCondition Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ControlCondition table allows the author to specify special actions to be applied to controls based on the value of a property. For example, using this table the author could choose to hide a control based on the VersionNT property.</p>
<p>
The ControlCondition table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=41%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=26%>Dialog_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Control_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Action</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Condition</td>
<td width=41%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Dialog_</dt>
<dd>
An external key that, combined with the Control_ key, uniquely identifies a control.
<p>
External key to column one of the <a href="tref_51wl.htm">Dialog table</a>.
</dd>
<dt>
Control_</dt>
<dd>
An external key that, combined with the Dialog_ key, uniquely identifies a control.
<p>
External key to column two of the <a href="tref_6nad.htm">Control table</a>.
</dd>
<dt>
Action</dt>
<dd>
The desired action to be taken on the specified control. 
<p>
The possible actions are shown in the following table.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%>Value</th>
<th align=left width=72%>Meaning</th>
</tr>
<tr valign=top>
<td width=28%>Default</td>
<td width=72%>Set control as the default.</td>
</tr>
<tr valign=top>
<td width=28%>Disable</td>
<td width=72%>Disable the control.</td>
</tr>
<tr valign=top>
<td width=28%>Enable</td>
<td width=72%>Enable the control.</td>
</tr>
<tr valign=top>
<td width=28%>Hide</td>
<td width=72%>Hide the control.</td>
</tr>
<tr valign=top>
<td width=28%>Show</td>
<td width=72%>Display the control.</td>
</tr>
</table><br>

</dd>
<dt>
Condition</dt>
<dd>
A standard conditional statement that specifies under which conditions the action should be triggered. This column may not be left blank. If this statement does not evaluate to TRUE, the action does not take place. If it is set to 1, the action is always applied. For information on the conditional syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_controlevent_table"></a>ControlEvent Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ControlEvent table allows the author to specify exactly what should happen when the user interacts with any control within a dialog. For example, a click of a pushbutton can be defined to trigger a transition to another dialog, to exit a dialog sequence, or to begin file installation. </p>
<p>
The ControlEvent table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Dialog_</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Control_</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Event</td>
<td width=44%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Argument</td>
<td width=44%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Condition</td>
<td width=44%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%>Y</td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>Ordering</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Dialog_</dt>
<dd>
An external key that, combined with the Control_ key, uniquely identifies a control.
<p>
External key to column one of the <a href="tref_51wl.htm">Dialog table</a>.
</dd>
<dt>
Control_</dt>
<dd>
An external key that, combined with the Dialog_ key, uniquely identifies a control.
<p>
External key to column two of the <a href="tref_6nad.htm">Control table</a>.
</dd>
<dt>
Event</dt>
<dd>
An identifier that specifies the type of event that should take place when the user interacts with the control specified by Dialog_ and Control_. Any control type can register as a publisher or subscriber of some event. For a list of possible values, see <a href="hand_8mrb.htm">Control Overview</a>. To set a property, put [Property_Name] in this field and the new value in the argument field ({ } for Null).</dd>
<dt>
Argument</dt>
<dd>
A value used as a modifier when triggering a particular event. For example, the argument of the <a href="href_9myc.htm">NewDialog ControlEvent</a> or the <a href="href_0qus.htm">SpawnDialog ControlEvent</a> is the name of the dialog. The argument of the <a href="aref_986m.htm">Install action</a> is a number defining the install level, and so forth.</dd>
<dt>
Condition</dt>
<dd>
A standard conditional statement that specifies under which conditions an event should be triggered. If this statement does not evaluate to TRUE, the event does not take place. May be left blank.</dd>
<dt>
Ordering</dt>
<dd>
An integer used to order several events tied to the same control. May be left blank.
<p>
Non-negative numbers only.

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_createfolder_table"></a>CreateFolder Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CreateFolder table contains references to folders that need to be explicitly created for a component. </p>
<p>
The CreateFolder table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Directory_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Component_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Directory_</dt>
<dd>
External key into the <a href="tref_6an9.htm">Directory table</a>.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a>.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
These folders are created when the component is installed. An attempt is made to remove such folders only when the component is uninstalled or moved to run-from-source, not just when the folders become empty. Folders created by the installer but not listed in this table are removed whenever they become empty.</p>
<p>
This table is referred to when the <a href="aref_6p0u.htm">CreateFolders action</a> or the <a href="aref_0pf2.htm">RemoveFolders action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_customaction_table"></a>CustomAction Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CustomAction table provides the means of integrating custom code and data into the installation process. The code that is executed can be a stream contained within the database, a recently installed file, or an existing executable.</p>
<p>
The CustomAction table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=39%>Column</th>
<th align=left width=31%>Type</th>
<th align=left width=12%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=39%>Action</td>
<td width=31%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=12%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=39%>Type</td>
<td width=31%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=12%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=39%>Source</td>
<td width=31%><a href="tref_6b77.htm#_msi_customsource">CustomSource</a></td>
<td width=12%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=39%>Target</td>
<td width=31%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=12%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of action. The action normally appears in a sequence table unless it is called by other custom actions. If the name matches any built-in action, the custom action is never called.
<p>
Primary table key.
</dd>
<dt>
Type</dt>
<dd>
The numeric custom action type.
<p>
One of icvEnum, as described in <a href="cact_1dbn.htm">Custom Action Types</a>.
</dd>
<dt>
Source</dt>
<dd>
External key into the table containing the source of the code.
<p>
External key, referencing column one of one of the following tables containing the source of the code:

<p class=indent1>
<a href="tref_6an9.htm">Directory table</a> for calling existing executables.</p>

<p class=indent1>
<a href="tref_4n6t.htm">File table</a> for calling executables and DLLs that have just been installed.</p>

<p class=indent1>
<a href="tref_04px.htm">Binary table</a> for calling executables, DLLs, and data stored in the database.</p>

<p class=indent1>
<a href="tref_21d1.htm">Property table</a> for calling executables whose paths are held by a property.</p>
</dd>
<dt>
Target</dt>
<dd>
Execution parameter. 
<p>
The value depends on the type of custom action being performed.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Target contains this value</th>
<th align=left width=52%>When performing this action</th>
</tr>
<tr valign=top>
<td width=48%>Entry point (required)</td>
<td width=52%>Calling a DLL.</td>
</tr>
<tr valign=top>
<td width=48%>Executable name with arguments (required)</td>
<td width=52%>Calling an existing executable.</td>
</tr>
<tr valign=top>
<td width=48%>Command line arguments (optional)</td>
<td width=52%>Calling an executable just installed.</td>
</tr>
<tr valign=top>
<td width=48%>Target file name (required)</td>
<td width=52%>Creating a file from custom data.</td>
</tr>
<tr valign=top>
<td width=48%>Null</td>
<td width=52%>Executing script code.</td>
</tr>
</table><br>

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_dialog_table"></a>Dialog Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Dialog table contains all the dialogs that appear in the user interface in both full and reduced modes.</p>
<p>
The Dialog table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=28%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=28%></td>
<td width=40%></td>
<td width=14%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=28%>Dialog</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Hcentering</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Vcentering</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Width</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Height</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Attributes</td>
<td width=40%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=28%>Title</td>
<td width=40%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=28%>Control_First</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=28%>Control_Default</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=28%>Control_Cancel</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=18%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Dialog</dt>
<dd>
Primary key, name of the dialog.</dd>
<dt>
Hcentering</dt>
<dd>
Horizontal position of the dialog on a 0-100 scale. 
<p>
Range = 0 to 100 (0 is the left edge of the screen, 100 is the right edge).
</dd>
<dt>
Vcentering</dt>
<dd>
Vertical position of the dialog on a 0-100 scale. 
<p>
Range = 0 to 100. (0 is the top of the screen, 100 is the bottom).
</dd>
<dt>
Width</dt>
<dd>
Width of the bounding rectangle of the dialog.
<p>
Non-negative numbers only.
</dd>
<dt>
Height</dt>
<dd>
Height of the bounding rectangle of the dialog.
<p>
Non-negative numbers only.
</dd>
<dt>
Attributes</dt>
<dd>
A 32-bit word that specifies the attribute flags to be applied to this dialog. 
<p>
Non-negative numbers only. For a list of options, see <a href="href_2z6t.htm#_msi_dialog_stylebits_list">Dialog Stylebits List</a>.
</dd>
<dt>
Title</dt>
<dd>
A text string specifying the title to be displayed in the title bar of the dialog window. </dd>
<dt>
Control_First</dt>
<dd>
An external key that, combined with the Dialog column, forms the primary key of the <a href="tref_6nad.htm">Control table</a>. This defines the control that has the focus when the dialog is created. This column is ignored on the Error dialog.
<p>
External key to column two of the Control table.

<p>
For compatibility with screen readers, when authoring a dialog with an Edit, PathEdit, ListView, ComboBox or VolumeSelectCombo control as the first active control, you must make the text field belonging to the edit field the first active control in this column. Since static text can not take focus, when the dialog is created the edit field has the focus initially as intended   but doing this ensures that screen readers show the correct information.
</dd>
<dt>
Control_Default</dt>
<dd>
An external key that, combined with the Dialog entry, forms the primary key of the Control table. This defines the default control (that is, hitting the Return key is equivalent to clicking this control). If this column is left blank, no default control is defined. This column is ignored on the Error dialog.
<p>
External key to column two of the Control table.
</dd>
<dt>
Control_Cancel</dt>
<dd>
An external key that, combined with the Dialog entry, forms the primary key of the Control table. This defines the cancel control (that is, hitting the Esc key or clicking the Close icon on the dialog is equivalent to clicking this control). If this column is left blank, no cancel control is defined. This column is ignored on the Error dialog.
<p>
External key to column two of the Control table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The integer values for width and height are in the installer units, not dialog units. An installer unit is equal to one-twelfth the height of the system font.</p>
<p>
<b>Wizard Dialogs</b></p>
<p>
The two centering values are ignored for subsequent dialogs in a wizard sequence (that is, those created by a <a href="href_9myc.htm">NewDialog ControlEvent</a>). Subsequent dialogs display in the same position as the previous dialog, as defined by the author, or as positioned by the user.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directory_table"></a>Directory Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Directory table represents the directory layout for the product. Each row of the table indicates a directory both at the source and the target.</p>
<p>
The Directory table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=37%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=31%>Directory</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Directory_Parent</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>DefaultDir</td>
<td width=37%><a href="tref_6b77.htm#_msi_defaultdir">DefaultDir</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Directory</dt>
<dd>
The Directory column contains an unique identifier for a directory or directory path. This column can contain the full path to a target directory or a property set to the full path of a target directory. If this column contains a property which is not set, then the target directory takes the name listed in the DefaultDir column and has the parent directory given in the Directory_Parent column. 
<p>
If the Directory_Parent column is Null or equal to the value of the Directory column, then the Directory column represents a root target directory of the installation.
</dd>
<dt>
Directory_Parent</dt>
<dd>
This column is a reference to the directory's parent directory. A record that has a Directory_Parent column equal to Null or equal to the Directory column represents a root directory. To resolve the full path of the parent directory, use the reference in the Directory_Parent column as an external key into the Directory column. For example, if a folder has a parent directory named PDIR, the parent directory of PDIR is given in the Directory_Parent column of the row with PDIR in the Directory column.</dd>
<dt>
DefaultDir</dt>
<dd>
The DefaultDir column contains the directory's name under the parent directory. By default, this is the name of both the target and source directories. To specify different source and target directory names, separate the target and source names with a colon as follows: [targetname]:[sourcename].
<p>
If the value of the Directory_Parent column is Null or equal to the Directory column, then the DefaultDir column is the name of a root source directory. 

<p>
For a non-root source directory, a period (.) entered in the DefaultDir column indicates that the directory should be located in its parent directory without a subdirectory.

<p>
The directory names in this column may be formatted as short filename | long filename pairs.

</dd>
</dl>
<h4>Remarks</h4>
<p>
Each record in the table represents a directory in both the source and the destination images. Every Directory table must have a root entry with a Directory column value equal to the <a href="pref_73ax.htm">TARGETDIR property</a>.</p>
<p>
During an ADMIN install the resulting admin image should resemble the source. To copy the admin image into the root directory named TARGETDIR, use the source directory names when resolving the target directories.</p>
<p>
Directory resolution is performed during the <a href="aref_22we.htm">CostFinalize action</a> and is done as follows:</p>
<p>
<b>Root Destination Directories</b></p>
<p>
Root directories entries are those with a Null Directory_Parent value or a Directory_Parent value identical to the Directory value. The value in the Directory column is interpreted as the name of a property defining the location of the destination directory. If the property is defined, the destination directory is resolved to the property's value. If the property is undefined, the ROOTDRIVE property is used instead to resolve the path.</p>
<p>
<b>Root Source Directories</b></p>
<p>
The value of the DefaultDir column for root entries is interpreted as the name of a property defining the source location of this directory This property must be defined or an error occurs. This is typically the <a href="pref_6uwp.htm">SOURCEDIR property</a>.</p>
<p>
<b>Non-root Destination Directories</b></p>
<p>
The Directory value for a non-root directory is also interpreted as the name of a property defining the location of the destination. If the property is defined, the destination directory is resolved to the property's value. If the property is not defined, the destination directory is resolved to a subdirectory beneath the resolved destination directory for the Directory_Parent entry. The DefaultDir value defines the name of the subdirectory.</p>
<p>
<b>Non-root Source Directories</b></p>
<p>
The source directory for a non-root directory is resolved to a subdirectory of the resolved source directory for the Directory_Parent entry. Again, the DefaultDir value defines the name of the subdirectory.</p>
<p>
<b>Short or Long File Names</b></p>
<p>
When resolving destination directories, the short file names specified in the DefaultDir column are used if either the SHORTFILENAMES property is set or the volume the directory is located on does not support long file names. Otherwise, the long file name is used.</p>
<p>
For more information about the Directory table, including samples, see <a href="novr_3wth.htm">Using the Directory Table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_drlocator_table"></a>DrLocator Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DrLocator table holds the information needed to find a file or directory by searching the directory tree.</p>
<p>
The DrLocator table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=38%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=30%>Signature_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Parent</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Path</td>
<td width=38%><a href="tref_6b77.htm#_msi_anypath">AnyPath</a></td>
<td width=13%>Y</td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Depth</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Signature_</dt>
<dd>
The Signature_ represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>. If the key is absent from the Signature table, the search is assumed to be for the presence of a directory pointed to by the DrLocator table.
<p>
External key to column one of the Signature table.
</dd>
<dt>
Parent</dt>
<dd>
The parent directory signature. This is a key into one of the following tables: <a href="tref_91wl.htm">RegLocator table</a>, the <a href="tref_00o5.htm">IniLocator table</a>, the <a href="tref_771h.htm">CompLocator table</a>, or the DrLocator table. If it is Null and the Path column does not expand to a full path, all the fixed drives of the user system are searched using the Path.</dd>
<dt>
Path</dt>
<dd>
The path on the user system. This is a either a subpath below the value of the Parent or a full path. The path may contain properties enclosed within square brackets (<code>[ ]</code>) that are expanded.</dd>
<dt>
Depth</dt>
<dd>
The depth below the path to which the Signature_ is recursively searched. If absent, the depth is assumed to be zero.
<p>
Non-negative numbers only.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table's columns are generally not localized. If an author decides to search for products in multiple languages, then there can be a separate entry included in the table for each language.</p>
<p>&nbsp;</p>

<h1><a name="_msi_duplicatefile_table"></a>DuplicateFile Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DuplicateFile table contains a list of files that are to be duplicated, either to a different directory than the original file or to the same directory but with a different name. The original file must be a file installed by the <a href="aref_3hym.htm">InstallFiles action</a>. </p>
<p>
The DuplicateFile table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>FileKey</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>File_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>DestName</td>
<td width=38%><a href="tref_6b77.htm#_msi_filename">Filename</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>DestFolder</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
FileKey</dt>
<dd>
Primary key, non-localized token, used to uniquely identify a particular DuplicateFile record.</dd>
<dt>
Component_</dt>
<dd>
Foreign key referencing an entry in the <a href="tref_09np.htm">Component table</a>. If this component is not selected for installation or removal, no action is taken on the associated DuplicateFile entry.
<p>
External key to column one of the Component table.
</dd>
<dt>
File_</dt>
<dd>
Foreign key referencing an entry in the <a href="tref_4n6t.htm">File table</a> representing the original file to be duplicated.</dd>
<dt>
DestName</dt>
<dd>
Name to be given to the duplicate file. If blank, the destination file is given the same name as the original file</dd>
<dt>
DestFolder</dt>
<dd>
Name of a property whose value is the full path where the duplicate file is to be copied. If this directory is the same as the directory containing the original file and the name for the proposed duplicate file is the same as the original file, no action takes place.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The table is processed by the <a href="aref_7yr2.htm">DuplicateFiles action</a> and the <a href="aref_3tpq.htm">RemoveDuplicateFiles action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_environment_table"></a>Environment Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Environment table is used to set the values of environment variables.</p>
<p>
The Environment table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Environment</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Name</td>
<td width=40%><a href="tref_6b77.htm#_msi_filename">Filename</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Value</td>
<td width=40%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=27%>Component_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Environment</dt>
<dd>
This is the primary key of the table and is a non-localized token.</dd>
<dt>
Name</dt>
<dd>
This column is the name of the environment variable. The key values will be written or removed depending upon which of the characters in the following table are prefixed to the name.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Prefix</th>
<th align=left width=68%>Meaning</th>
</tr>
<tr valign=top>
<td width=32%>=</td>
<td width=68%>The name/value is to be created when installed.</td>
</tr>
<tr valign=top>
<td width=32%>+</td>
<td width=68%>The name/value is to be created, if absent, when installed.</td>
</tr>
<tr valign=top>
<td width=32%>-</td>
<td width=68%>The name/value is to be deleted, if present, when the component is uninstalled.</td>
</tr>
<tr valign=top>
<td width=32%>=-</td>
<td width=68%>The value is set on install and removed on uninstall. This is the usual behavior.</td>
</tr>
<tr valign=top>
<td width=32%>=+</td>
<td width=68%>This is not a valid prefix</td>
</tr>
<tr valign=top>
<td width=32%>*</td>
<td width=68%>The name refers to a system environment variable and by default the value will be written to the user's environment. This prefix is used with Windows NT. </td>
</tr>
</table><br>


<p>
If the Value field in the table includes a [~], then the prefix characters apply to only the specified portion of the string. The use of [~] is described below in the Value column section.

<p>
The environment variable is removed if the Value field of the table is blank. Therefore, with a blank in the Value field, an [=] prefix deletes the environment variable on install and a [-] prefix deletes any current values on uninstall.
</dd>
<dt>
Value</dt>
<dd>
This column contains the value that is to be set as a formatted string. The contents of this field are modified as follows by using the character [~].
<p>
If [~] precedes the string, then the string will be attached at the end of the existing value.

<p>
If [~] follows the end of the string, then the string will be inserted at the beginning of the existing value.

<p>
If no [~] is present, then the string represents the entire value to be set or deleted.

<p>
If the Value field is blank, then the variable will be removed.

<p>
The character adjacent to the [~] in a preceding or appending value acts as a delimiter and separates one value from the next. For example, to add a value to the end of a semi-colon delimited list use "[~];new value".
</dd>
<dt>
Component_</dt>
<dd>
External key to column one of the <a href="tref_09np.htm">Component table</a>. This column specifies the component whose key file provides the extension server.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_error_table"></a>Error Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Error table is used to look up error message formatting templates when processing errors with an error code set, but without a formatting template set (this is the normal situation). </p>
<p>
The Error table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Error</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Message</td>
<td width=40%><a href="tref_6b77.htm#_msi_template">Template</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Error</dt>
<dd>
The integer error number, obtained from header file IError(...) macros.
<p>
Non-negative numbers only.
</dd>
<dt>
Message</dt>
<dd>
Error formatting template. This table is initially generated by the build process to contain the debug format templates.
<p>
The following table lists reserved messages.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Number</th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%>0 (imsgInfo)</td>
<td width=68%>Header for log-only messages, for example, "Info [1]. "</td>
</tr>
<tr valign=top>
<td width=32%>1 (imsgWarning)</td>
<td width=68%>Header for warning messages, for example, "Warning [1]."</td>
</tr>
<tr valign=top>
<td width=32%>2 (imsgError)</td>
<td width=68%>Header for error messages, for example, "Error [1]."</td>
</tr>
<tr valign=top>
<td width=32%>3 (imsgNotice)</td>
<td width=68%>Header for notifications (log-only if log enabled), for example, "Notice [1]."</td>
</tr>
<tr valign=top>
<td width=32%>4 (imsgActionStart)</td>
<td width=68%>Format template for action start message, for example, "Action: [1]. [2]"</td>
</tr>
<tr valign=top>
<td width=32%>5 (imsgDebugError)</td>
<td width=68%>Format template for debug error code in final build.</td>
</tr>
<tr valign=top>
<td width=32%>6 (imsgDefaultError)</td>
<td width=68%>Default format template if the error is not in the Error table.</td>
</tr>
<tr valign=top>
<td width=32%>7 (imsgLogHeader)</td>
<td width=68%>Log header line (printf template for date/time).</td>
</tr>
<tr valign=top>
<td width=32%>8 (imsgLogTrailer)</td>
<td width=68%>Log trailer line (printf template for date/time).</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The template does not include formatting for the error number in field 1. When processing the error, the installer attaches a header prefix to the template depending on the message type as described in the previous table. These headers are also stored in the Error table.</p>
<p>&nbsp;</p>

<h1><a name="_msi_eventmapping_table"></a>EventMapping Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The EventMapping table lists the controls that subscribe to some event and lists the attribute to be changed when the event is published. </p>
<p>
The EventMapping table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Dialog_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Control_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Event</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Attribute</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Dialog_</dt>
<dd>
An external key that, combined with the Control_ key, uniquely identifies a control.
<p>
External key to column one of the <a href="tref_51wl.htm">Dialog table</a>.
</dd>
<dt>
Control_</dt>
<dd>
An external key that, combined with the Dialog_ key, uniquely identifies a control.
<p>
External key to column two of the <a href="tref_6nad.htm">Control table</a>.
</dd>
<dt>
Event</dt>
<dd>
An identifier that specifies the type of the event that the control subscribes to.</dd>
<dt>
Attribute</dt>
<dd>
The name of the control attribute that is set when this event is received. The argument of the event is passed as the argument of the Attribute call to change this attribute of the control. This column may be left blank if no attribute of the control should be changed by the publisher; in this case the publisher can still enable, disable, hide, or unhide the control.
</dd>
</dl>
<h4>Remarks</h4>
<p>
More than one control on a dialog can be specified as a subscriber to the same event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_extension_table"></a>Extension Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Extension table contains file extension servers information that must be generated as a part of the product advertisement. Each row generates a set of registry keys and values.</p>
<p>
The Extension table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=35%>Column</th>
<th align=left width=34%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=35%>Extension</td>
<td width=34%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=35%>ProgId_</td>
<td width=34%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=35%>ShellNew</td>
<td width=34%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=35%>ShellNewValue</td>
<td width=34%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=35%>Feature_</td>
<td width=34%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=35%>Component_</td>
<td width=34%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Extension</dt>
<dd>
The extension associated with the table row. The extension can be up to 255 characters.</dd>
<dt>
ProgId_</dt>
<dd>
Program ID associated with this extension. If present, the ShellNew key is created under this key   otherwise it is placed directly under the extension key. Foreign key into the <a href="tref_4x5x.htm">ProgId table</a>.</dd>
<dt>
ShellNew</dt>
<dd>
Subkey for the type of ShellNew Data: FileName, Command, Data, or NullFile.</dd>
<dt>
ShellNewValue</dt>
<dd>
Value written for ShellNew. May reference Feature/Component.</dd>
<dt>
Feature_</dt>
<dd>
External key into the <a href="tref_0a91.htm">Feature table</a> specifying the feature that provides the extension server.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> specifying the component whose key file provides the extension server.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_1epa.htm">RegisterExtensionInfo action</a> or the <a href="aref_738u.htm">UnRegisterExtensionInfo action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_feature_table"></a>Feature Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Feature table defines the logical tree structure of features. </p>
<p>
The Feature table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=36%>Column</th>
<th align=left width=33%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=36%>Feature</td>
<td width=33%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=36%>Feature_Parent</td>
<td width=33%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=36%>Title</td>
<td width=33%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=36%>Description</td>
<td width=33%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=36%>Display</td>
<td width=33%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=36%>Level</td>
<td width=33%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=36%>Directory_</td>
<td width=33%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=36%>Attributes</td>
<td width=33%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Feature</dt>
<dd>
Primary key used to identify a particular feature record.
<p>
Primary table key.
</dd>
<dt>
Feature_Parent</dt>
<dd>
Optional key of a parent record in the same table. If the parent feature is not selected, this feature is not installed. 
<p>
Key pointing to the Feature column of this table. Null indicates that this feature has no parent (root item). The Feature_Parent column must not equal the Feature column of the same record (that is, an item cannot be its own parent).
</dd>
<dt>
Title</dt>
<dd>
Short text identifying a visible feature item.</dd>
<dt>
Description</dt>
<dd>
Longer descriptive text describing a visible feature item.</dd>
<dt>
Display</dt>
<dd>
Numeric sort order, used to specify the order in which the feature is to be displayed in the user interface. The value also determines if the feature is initially displayed expanded or collapsed. 
<p>
If the value is Null or zero, the record is not displayed. If the value is odd, the feature node is expanded initially. If the value is even, the feature node is collapsed initially.
</dd>
<dt>
Level</dt>
<dd>
The install level at which the entry is initially selected. Processing the <a href="tref_83qd.htm">Condition table</a> can modify the Level value. For more details, see Install Level in the Remarks section that follows.
<p>
An install level of zero disables the item and prevents it from being displayed.
</dd>
<dt>
Directory_</dt>
<dd>
The Directory column contains the name of a directory that can be configured by a <a href="hand_9llz.htm">Selection Dialog</a>. The Browse button becomes  when the column is non-null, and when the particular feature is selected in the user interface. The <a href="prop_1xyr.htm">properties</a> used in this column must be public and have an identifier consisting entirely of uppercase letters. This column is a key into the <a href="tref_6an9.htm">Directory table</a> and any of the directories indicated to be configurable here will also belong to that table. </dd>
<dt>
Attributes</dt>
<dd>
Remote execution option.
<p>
The lowest two bits indicate the favored state of the feature. The following table lists valid values for these two bits.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>This value</th>
<th align=left width=70%>Means this feature will be installed</th>
</tr>
<tr valign=top>
<td width=30%>0 (ifrsFavorLocal)</td>
<td width=70%>Locally, if possible.</td>
</tr>
<tr valign=top>
<td width=30%>1 (ifrsFavorSource)</td>
<td width=70%>To run from the source, if possible.</td>
</tr>
<tr valign=top>
<td width=30%>2 (ifrsFavorParent)</td>
<td width=70%>Using the remote execution option of the parent feature. This is not allowed for parent features.</td>
</tr>
</table><br>

</dd>
</dl>
<p>
The rest of the significant bits are bit flags.
<ul>
<li>
The 3rd bit is the ifrsFavorAdvertise bit.</li>
<li>
The 4th bit is the ifrsDisallowAdvertise bit. The ifrsFavorAdvertise and the ifrsDisallowAdvertise bits cannot both be set for a particular feature.</li>
<li>
The 5th bit is the ifrsUIDisallowAbsent bit.</li>
</ul>
<p>
These bits work together in the following manner.
<ol>
<li>
If the application has not already been installed by the installer and if no feature state request has been made via any of the following properties: <a href="pref_3dvd.htm">ADDLOCAL</a>, <a href="pref_7g1l.htm">ADDSOURCE</a>, <a href="pref_7yex.htm">ADDDEFAULT</a>, <a href="pref_3htl.htm">COMPADDLOCAL</a>, <a href="pref_4gvt.htm">COMPADDSOURCE</a>, <a href="pref_89yx.htm">FILEADDLOCAL</a>, <a href="pref_0id5.htm">FILEADDSOURCE</a>, <a href="pref_8ho9.htm">REMOVE</a>, <a href="pref_19x5.htm">REINSTALL</a>, or <a href="pref_6k8p.htm">ADVERTISE</a>, then:<ul>
<li>
If the feature install level is greater than or equal to the current install level, or is 0, then the default state is NULL (i.e. no change).</li>
<li>
Otherwise, if the ifrsFavorAdvertise bit is set, its default state is set to Advertise.</li>
<li>
The lower 2 bits determine the default state.</li>
</ul>
</li>
<li>
If a feature is to be installed to the authored default (the ADDDEFAULT property has the feature as part of its value list), the ifrsFavorAdvertise bit is always ignored. The state is determined by the lower 2 bits.</li>
<li>
If a feature is to be installed to the Advertise state via the ADVERTISE property, and if the ifrsDisallowAdvertise bit is not set, the state is set to Advertise. Otherwise, the state is determined by the lower 2 bits.</li>
<li>
If a feature is to be installed to the Advertise state and its parent must be installed, the Advertise state is preferred for the parent unless ifrsDisallowAdvertise bit is set for the parent   in which case the state (of the parent) is determined by the lower 2 bits.</li>
<li>
If a feature is to be installed to the Advertise state, the Advertise state for the children is preferred unless ifrsDisallowAdvertise bit is set for the child   in which case the state (of the child) is set to Absent.</li>
<li>
The Advertise state is relevant only to features and not to the components of the features. Hence feature state transitions to and from the Advertise state are to be treated as transitions to and from the Absent state for the constituent components.</li>
<li>
The user interface does not display the option to change to the Absent or the Advertise state if the corresponding ifrsUIDisallowAbsent bit or ifrsDisallowAdvertise bit is set for that feature.</li>
</ol>
<p>
If this column is left blank, the value defaults to zero (ifrsFavorLocal). For more information about Attributes options, see Attributes Column in the Remarks section that follows. For more information on how features are selected for installation, see <a href="vref_84xl.htm">FeatureRequestState property</a>.</p>
<h4>Remarks</h4>
<p>
Several additional temporary columns are added to this table when it is loaded into memory for computations used by costing and user interface selection.</p>
<p>
<b>Features and Components</b></p>
<p>
A feature is a distinct subset of a product consisting of one or more components. Each component is defined in the <a href="tref_09np.htm">Component table</a>, and the link between a feature and its components is defined in the <a href="tref_52hx.htm">FeatureComponents table</a>.</p>
<p>
Any component can be shared between two or more features. If two or more features refer to the same component, that component is selected for installation if any of the associated features are selected. For more information about shared components, see the Attributes Column that follows.</p>
<p>
<b>Install Level</b></p>
<p>
For any installation, there is a defined Install Level, which is an integral value from 1 to 32,767. The initial value is determined by the <a href="pref_9bzt.htm">InstallLevel property</a>, which is set in the <a href="tref_21d1.htm">Property table</a>.</p>
<p>
A feature is installed only if the feature Level value is less than or equal to the current Install Level. Once the installation is initialized, the installer user interface could be authored to give the user the opportunity to modify the Install Level of any feature in the <a href="#_msi_feature_table">Feature table</a>. For example, the author could define Install Level values that represent specific installation options, such as Complete, Typical, or Minimum, and then create a dialog that allows the user to select one of these states. Depending on the state the user selects, the dialog would set the InstallLevel property to the corresponding value. If the author assigns Typical a level of 100 and the user selects Typical, only those features with a Level of 100 or less are installed. In addition, the Custom option could lead to another dialog containing a Selection Tree control. The Selection Tree would then allow the user to individually change whether each feature is installed.</p>
<p>
<b>Attributes Column</b></p>
<p>
If a feature is marked as ifrsFavorLocal and this feature is to be installed, all components that are related to this feature (and are not marked for source install) are installed locally. Those components marked as irsSourceOnly in the <a href="tref_09np.htm">Component table</a> are still installed to run from the source CD/server. Similarly, the components of features marked ifrsFavorSource are installed to run from the source CD/server (unless marked to be installed locally). A component (not marked irsSourceOnly) that is shared among two or more features is installed locally if at least one of those features is marked ifrsFavorLocal, even if the other features are marked ifrsFavorSource.</p>
<p>&nbsp;</p>

<h1><a name="_msi_featurecomponents_table"></a>FeatureComponents Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The FeatureComponents table defines the relationship between features and components. Specifically, for each feature, this table lists all the components that make up a feature. </p>
<p>
The FeatureComponents table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%>Feature_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Component_</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Feature_</dt>
<dd>
External key into the Feature<a href="tref_0a91.htm"> table</a>.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a>.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
Components can be shared by two or more features (that is, the same component can be referred to by more than one feature).</p>
<p>
This table is referred to when the <a href="aref_8bou.htm">PublishFeatures action</a> or the <a href="aref_6ywe.htm">UnpublishFeatures action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_file_table"></a>File Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The File table contains the complete list of source files with their various attributes, ordered by a unique, non-localized identifier. Files can be stored on the source media either as individual files, or compressed within a cabinet file.</p>
<p>
The File table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=34%>Column</th>
<th align=left width=35%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=34%>File</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>Component_</td>
<td width=35%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>FileName</td>
<td width=35%><a href="tref_6b77.htm#_msi_filename">Filename</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=34%>FileSize</td>
<td width=35%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Version</td>
<td width=35%><a href="tref_6b77.htm#_msi_version">Version</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Language</td>
<td width=35%><a href="tref_6b77.htm#_msi_language">Language</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Attributes</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=34%>Sequence</td>
<td width=35%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File</dt>
<dd>
A non-localized token that matches a file identifier in the cabinet. For uncompressed files, this field is ignored.</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> that references the Component that controls the file.
<p>
External key to column one of the Component table.
</dd>
<dt>
FileName</dt>
<dd>
File name used for installation. The name may be localized. This may be formatted as a short file name | long file name pair.</dd>
<dt>
FileSize</dt>
<dd>
Size of the file in bytes.
<p>
Non-negative value only.
</dd>
<dt>
Version</dt>
<dd>
For versioned files, this is the version string. For non-versioned files, this is blank.
<p>
The Version field can also be set to contain the primary key of another record in the same table, producing a Companion File reference. In this case the version column is an external key to column one of the <a href="#_msi_file_table">File table</a>. See the remarks section for more information.
</dd>
<dt>
Language</dt>
<dd>
List of decimal language IDs, separated by commas.</dd>
<dt>
Attributes </dt>
<dd>
Integer containing bit flags representing file attributes.
<p>
The following table shows the definition of the bit field. 

<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Bit position</th>
<th align=left width=33%>Decimal equivalent</th>
<th align=left colspan=2 width=38%>Description</th>
</tr>
<tr valign=top>
<td width=29%>0</td>
<td colspan=2 width=33%>1</td>
<td width=38%>Read-Only </td>
</tr>
<tr valign=top>
<td width=29%>1</td>
<td colspan=2 width=33%>2</td>
<td width=38%>Hidden </td>
</tr>
<tr valign=top>
<td width=29%>2</td>
<td colspan=2 width=33%>4</td>
<td width=38%>System </td>
</tr>
<tr valign=top>
<td width=29%>8</td>
<td colspan=2 width=33%>256</td>
<td width=38%>Split - the file is split between two or more compression cabinets</td>
</tr>
<tr valign=top>
<td width=29%>9</td>
<td colspan=2 width=33%>512</td>
<td width=38%>Vital - this file is vital for the proper operation of the component to which it belongs</td>
</tr>
<tr valign=top>
<td width=29%>10</td>
<td colspan=2 width=33%>1024</td>
<td width=38%>ValidCheckSum</td>
</tr>
<tr valign=top>
<td width=29%>13</td>
<td colspan=2 width=33%>8192</td>
<td width=38%>Uncompressed - the file is uncompressed on the source media</td>
</tr>
</table><br>


<p>
If the "Vital" bit within the Attributes column is set, and if the component to which the file belongs is selected for installation, then the installer must be able to install this file for the installation to be completed successfully. If the installer is unable to install the file for some reason (for example, if the source file cannot be located within the source image), then an error dialog will appear with the options "Retry" or "Cancel". For a file that does not have the "Vital" bit set, the options in case of an install error will be "Abort", "Retry", and "Ignore" (that is, the user will have the option to complete the install successfully without installing that file). 

<p>
The "ValidCheckSum" bit within the Attributes column should be set for every executable file in the installation that has a valid checksum stored in the Portable Executable (PE) file header. Only those files that have this bit set will ever be verified for valid checksum during a reinstall (see the REINSTALLMODE property for more information). 
</dd>
<dt>
Sequence</dt>
<dd>
Sequence position of this file on the media images. This order must correspond to the order of the files in the cabinet if the files are compressed.
<p>
The sequence numbers in the Sequence column are used to specify both the order of installation for files and the source media upon which the file is located (in conjunction with the <a href="tref_4mlh.htm">Media table</a>). For example, suppose a file has a sequence number of 92. To determine the source disk this file resides on, look in the Media table for the entry with the smallest Last Sequence value that is larger than 92.

<p>
Although compressed files are assigned internal sequence numbers within cabinets, those absolute numbers do not need to match the sequence numbers within the File table. It is, however, important that the sequence of files in the File table be identical to the sequence of the files within the cabinets.

<p>
For files that aren't compressed, the sequence numbers need not be unique. For instance, if all your files are uncompressed, and all reside on one disk, you could give all the files the same sequence number.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The table is initially generated from the file list, but if cabinet compression is used, the table is regenerated from the output of the compression engine.</p>
<p>
For uncompressed files, the File column is ignored, and the FileName column is used for both the source and destination file name. You must set the Uncompressed bit of the Attributes column for any file that is not compressed in a cabinet.</p>
<p>
This table is referred to when the <a href="aref_3hym.htm">InstallFiles action</a>, <a href="aref_4fxq.htm">ProcessComponents action</a>, <a href="aref_2f8u.htm">FileCost action</a>, <a href="aref_9xny.htm">RemoveFiles action</a>, <a href="aref_2er2.htm">UpdateResources action</a>, <a href="aref_2tv2.htm">RegisterFonts action</a>, or <a href="aref_6wmm.htm">UnregisterFonts action</a> is executed.</p>
<p>
<b>Companion Files</b></p>
<p>
If the Version column contains the primary key of another record in the File table, a Companion File reference is produced with the referencing record termed the companion and the record being referred to termed the companion parent. In this situation, the installation state of the companion file is dependent not on its own file versioning information, but on that of its companion parent. For example, if a companion parent file is going to be installed over an existing, older version of the file, the companion file is also installed regardless of the version of an existing file (if any).</p>
<p>
Only certain combinations of values in the Version column and the Language column are valid. The following table summarizes the possibilities.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=16%>Version</th>
<th align=left width=27%>Language</th>
<th align=left width=57%>Comment</th>
</tr>
<tr valign=top>
<td width=16%>1.2.3.4</td>
<td width=27%>1033</td>
<td width=57%>Valid   version and language.</td>
</tr>
<tr valign=top>
<td width=16%>1.2.3.4</td>
<td width=27%>(Null)</td>
<td width=57%>Invalid   version but no language.</td>
</tr>
<tr valign=top>
<td width=16%>1.2.3.4</td>
<td width=27%>0</td>
<td width=57%>Valid   version and language are neutral.</td>
</tr>
<tr valign=top>
<td width=16%>Testdb</td>
<td width=27%>(Null) </td>
<td width=57%>Valid   companioned file but no language associated with it.</td>
</tr>
<tr valign=top>
<td width=16%>Testdb</td>
<td width=27%>1033    </td>
<td width=57%>Valid   companioned file and language.</td>
</tr>
<tr valign=top>
<td width=16%>(Null)</td>
<td width=27%>1033  </td>
<td width=57%>Valid   no version, but has a language associated with it (that is, typelib, helpfile).</td>
</tr>
<tr valign=top>
<td width=16%>Testdb</td>
<td width=27%>1033</td>
<td width=57%>Valid.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_font_table"></a>Font Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Font table contains the information for registering font files with the system. </p>
<p>
The Font table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%>File_</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>FontTitle</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File_</dt>
<dd>
External key into the <a href="tref_4n6t.htm">File table</a> entry for the font file.</dd>
<dt>
FontTitle</dt>
<dd>
Font name.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_2tv2.htm">RegisterFonts action</a> or the <a href="aref_6wmm.htm">UnregisterFonts action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_icon_table"></a>Icon Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This table contains the icon files. Each icon from the table is copied to a file as a part of product advertisement to be used for advertised shortcuts and OLE servers.</p>
<p>
The Icon table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%>Name</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Data</td>
<td width=39%><a href="tref_6b77.htm#_msi_binary">Binary</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Name</dt>
<dd>
Name of the icon file.</dd>
<dt>
Data</dt>
<dd>
The binary icon data in PE (.dll or .exe) or icon (.ico) format.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_10dq.htm">PublishProduct action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_inifile_table"></a>IniFile Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The IniFile table contains the .ini information that the application needs to set in an .ini file. </p>
<p>
The IniFile table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%>IniFile</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>FileName</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Directory_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Section</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Key</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Value</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Action</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Component_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
IniFile</dt>
<dd>
The key for this table.</dd>
<dt>
FileName</dt>
<dd>
The name of the .ini file in which to write the information.</dd>
<dt>
Directory_</dt>
<dd>
External key into the <a href="tref_6an9.htm">Directory table</a> indicating the directory in which the .ini file is located.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Section</dt>
<dd>
The .ini file section.</dd>
<dt>
Key</dt>
<dd>
The .ini file key within the section.</dd>
<dt>
Value</dt>
<dd>
The value to be written.</dd>
<dt>
Action</dt>
<dd>
The type of modification to be made. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>This value</th>
<th align=left width=52%>Indicates this action</th>
</tr>
<tr valign=top>
<td width=48%>0</td>
<td width=52%>Creates or updates a .ini entry.</td>
</tr>
<tr valign=top>
<td width=48%>1</td>
<td width=52%>Creates a .ini entry only if the entry does not already exist.</td>
</tr>
<tr valign=top>
<td width=48%>3</td>
<td width=52%>Creates a new entry or appends a new comma-separated value to an existing entry.</td>
</tr>
</table><br>

</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> referencing the component that controls the installation of the .ini value.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The .ini file information is written out when the corresponding component has been selected to be installed, either locally or run from source.</p>
<p>
This table is referred to when the <a href="aref_8432.htm">WriteIniValues action</a> or the <a href="aref_4tv2.htm">RemoveIniValues action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_inilocator_table"></a>IniLocator Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The IniLocator table holds the information needed to find a file or directory using a .ini file. The .ini file must be present in the default Microsoft  Windows  directory.</p>
<p>
The IniLocator table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=41%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=26%>Signature_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>FileName</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Section</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Key</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Field</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Type</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Signature_</dt>
<dd>
The Signature_ represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>. If the key is absent from the Signature table, the search is assumed to be for the presence of a directory pointed to by the IniLocator table.
<p>
External key to column one of the Signature table.
</dd>
<dt>
FileName</dt>
<dd>
The .ini file name.</dd>
<dt>
Section</dt>
<dd>
Section name within the .ini file.</dd>
<dt>
Key</dt>
<dd>
Key value within the section.</dd>
<dt>
Field</dt>
<dd>
The field in the .ini line. If Field is Null or 0, the entire line is read.
<p>
Non-negative numbers only.
</dd>
<dt>
Type</dt>
<dd>
A Boolean value that determines if the .ini value read is a file name or a directory location.
<p>
If absent, Type is assumed to be 1, denoting a file name search.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=22%>Value</th>
<th align=left width=78%>Meaning</th>
</tr>
<tr valign=top>
<td width=22%>0</td>
<td width=78%>Directory</td>
</tr>
<tr valign=top>
<td width=22%>1</td>
<td width=78%>File name</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table's columns are generally not localized. If an author decides to search for products in multiple languages, then there can be a separate entry included in the table for each language.</p>
<p>
Associated localized text for progress display or logging is specified in the <a href="tref_7het.htm">ActionText table</a>.</p>
<p>
For an example of a sequence table, see <a href="novr_3mqt.htm">Using a Sequence Table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installexecutesequence_table"></a>InstallExecuteSequence Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallExecuteSequence table lists actions that are executed when the top-level <a href="aref_986m.htm">INSTALL action</a> is executed. </p>
<p>
Actions in the install sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and any exit dialogs, are located in the <a href="tref_1git.htm">InstallUISequence table</a>. All actions from the InstallValidate through the end of the install sequence are in the InstallExecuteSequence table. Because the InstallExecuteSequence table needs to stand alone, it has any necessary initialization actions such as LaunchConditions, CostInitialize, FileCost, and CostFinalize.</p>
<p>
The InstallExecuteSequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Action</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Condition</td>
<td width=37%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>Sequence</td>
<td width=37%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a built-in action, a custom action, or a user interface wizard.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to expFalse, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the expression syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the Action Sequencer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=19%>This value</th>
<th align=left width=81%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=19%>-1</td>
<td width=81%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=19%>-2</td>
<td width=81%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=19%>-3</td>
<td width=81%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=19%>-4</td>
<td width=81%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<h4>Remarks</h4>
<p>
Associated localized text for progress display or logging is specified in the <a href="tref_7het.htm">ActionText table</a>.</p>
<p>
For an example of a sequence table, see <a href="novr_3mqt.htm">Using a Sequence Table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installuisequence_table"></a>InstallUISequence Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallUISequence table lists actions that are executed when the top-level <a href="aref_986m.htm">INSTALL action</a> is executed. </p>
<p>
Actions in the install sequence up to the <a href="aref_9fzi.htm">InstallValidate action</a>, and the exit dialogs, are located in the InstallUISequence table. All actions from the InstallValidate through the end of the install sequence are in the <a href="tref_5pid.htm">InstallExecuteSequence table</a>. Because the InstallExecuteSequence table needs to stand alone, it has any necessary initialization actions such as <a href="aref_6jhq.htm">LaunchConditions</a>, <a href="aref_4bam.htm">CostInitialize</a>, <a href="aref_2f8u.htm">FileCost</a>, and the <a href="aref_22we.htm">CostFinalize</a>, and it has the <a href="aref_3b1q.htm">ExecuteAction action</a>.</p>
<p>
The InstallUISequence table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%>Action</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Condition</td>
<td width=37%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>Sequence</td>
<td width=37%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of the action to execute, either a built-in action, a custom action, or a user interface wizard.
<p>
Primary table key.
</dd>
<dt>
Condition</dt>
<dd>
Logical expression. If the expression evaluates to expFalse, the action is skipped. If the expression syntax is invalid, the sequence terminates, returning iesBadActionData. For information on the expression syntax, see <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</dd>
<dt>
Sequence</dt>
<dd>
Number that determines the sequence position in which this action is to be executed.
<p>
A positive value represents the sequence position. A Null value indicates that the action is never to be executed. The following negative values indicate that this action is to be executed if the Action Sequencer returns the associated return code.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=19%>This value</th>
<th align=left width=81%>Corresponds with this return code</th>
</tr>
<tr valign=top>
<td width=19%>-1</td>
<td width=81%>Successful completion (iesSuccess).</td>
</tr>
<tr valign=top>
<td width=19%>-2</td>
<td width=81%>User terminates install (iesUserExit).</td>
</tr>
<tr valign=top>
<td width=19%>-3</td>
<td width=81%>Fatal exit terminates (iesFailure).</td>
</tr>
<tr valign=top>
<td width=19%>-4</td>
<td width=81%>Install is suspended (iesSuspend).</td>
</tr>
</table><br>

</dd>
</dl>
<p>
Zero, all other negative numbers, or a Null value indicate that the action is never to be executed.</p>
<h4>Remarks</h4>
<p>
Associated localized text for progress display or logging is specified in the <a href="tref_7het.htm">ActionText table</a>.</p>
<p>
For an example of a sequence table, see <a href="novr_3mqt.htm">Using a Sequence Table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi__installvalidate_table"></a>_InstallValidate Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallValidate table is a system table used with the <a href="tref_2yjp.htm">_Sequence table</a> to ensure that the actions occur in the correct order, since some actions have pre- and post-conditional actions. This table is only used during the database validation process.</p>
<p>
The InstallValidate table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Action</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>SectionFlag</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Description</td>
<td width=40%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of action.</dd>
<dt>
SectionFlag</dt>
<dd>
Section flag for location in the sequence table.</dd>
<dt>
Description</dt>
<dd>
Description of sections to which the action belongs.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_launchcondition_table"></a>LaunchCondition Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The LaunchCondition table is used by the <a href="aref_6jhq.htm">LaunchConditions action</a>. It contains a list of conditions, all of which must be satisfied for the action to succeed.</p>
<p>
The LaunchCondition table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>Condition</td>
<td width=39%><a href="tref_6b77.htm#_msi_condition">Condition</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Description</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Condition</dt>
<dd>
Expression that must evaluate to True for installation to begin.</dd>
<dt>
Description</dt>
<dd>
Localizable text to display when the condition fails and the installation must be terminated.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_listbox_table"></a>ListBox Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The lines of a listbox are not treated as individual controls, but they are part of a listbox that functions as a control. The ListBox table defines the values for all listboxes.</p>
<p>
The ListBox table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=41%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=26%>Property</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Order</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Value</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Text</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
A named property to be tied to this item. All the items tied to the same property become part of the same listbox.</dd>
<dt>
Order</dt>
<dd>
A positive integer used to determine the ordering of the items that appear in a single listbox. If the listbox is defined as ordered, all items should have an Order value. The integers do not have to be consecutive. If the listbox is defined as unordered, this column is ignored.
<p>
Positive numbers only.
</dd>
<dt>
Value</dt>
<dd>
The value string associated with this item. Selecting the line sets the associated property to this value.</dd>
<dt>
Text</dt>
<dd>
The visible text to be assigned to the item. If this entry or the entire column is missing, the text defaults to the corresponding entry in Value.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Formatting</b></p>
<p>
The contents of the Value and Text fields are formatted by the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function when the control is created, so they can contain any expression that the <b>MsiFormatRecord</b> function can interpret. The formatting occurs only when the control is created, and it is not updated if a property involved in the expression is modified during the life of the control.</p>
<p>&nbsp;</p>

<h1><a name="_msi_listview_table"></a>ListView Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The lines of a listview are not treated as individual controls, but they are part of a listview that functions as a control. The ListView table defines the values for all listviews.</p>
<p>
The ListView table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Property</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Order</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Value</td>
<td width=44%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Text</td>
<td width=44%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>Binary_</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
A named property to be tied to this item. All the items tied to the same property become part of the same listview.</dd>
<dt>
Order</dt>
<dd>
A positive integer used to determine the ordering of the items that appear in a single listview list. The integers do not have to be consecutive. If a listview is defined as ordered, all the items should have an Ordering value. If the listview is defined as unordered, this column is ignored.
<p>
Positive numbers only.
</dd>
<dt>
Value</dt>
<dd>
The value string associated with this item. Selecting the line sets the associated property to this value.</dd>
<dt>
Text</dt>
<dd>
The visible text to be assigned to the item. If this entry or the entire column is missing, the text defaults to the corresponding entry in Value.</dd>
<dt>
Binary_</dt>
<dd>
The image data for the icon. This is a foreign key to the <a href="tref_04px.htm">Binary table</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Formatting</b></p>
<p>
The contents of the Value and Text fields are formatted by the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function when the control is created, so they can contain any expression that the MsiFormatRecord function can interpret. The formatting occurs only when the control is created, and it is not updated if a property involved in the expression is modified during the life of the control.</p>
<p>&nbsp;</p>

<h1><a name="_msi_media_table"></a>Media Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Media table describes the set of disks that make up the source media for the installation.</p>
<p>
The Media table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%>DiskId</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>LastSequence</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>DiskPrompt</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Cabinet</td>
<td width=39%><a href="tref_6b77.htm#_msi_cabinet">Cabinet</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>VolumeLabel</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Source</td>
<td width=39%><a href="tref_6b77.htm#_msi_property">Property</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
DiskId</dt>
<dd>
Determines the sort order for the table.
<p>
Non-negative numbers only. Minimum value is 1.
</dd>
<dt>
LastSequence</dt>
<dd>
File sequence number for the last file for this media.
<p>
Non-negative numbers only.
</dd>
<dt>
DiskPrompt</dt>
<dd>
Disk name, the visible text printed on the disk. This is used to prompt the user when this disk needs to be inserted.</dd>
<dt>
Cabinet</dt>
<dd>
The name of the cabinet if some or all of the files stored on the media are compressed in a cabinet. If cabinets are not being used, this column must be blank (or the entire column can be omitted).</dd>
<dt>
VolumeLabel</dt>
<dd>
The label attributed to the volume. This is the volume label returned by the GetVolumeInformation system API. If the <a href="pref_6uwp.htm">SOURCEDIR property</a> refers to a removable (floppy or CD-ROM) volume, this volume label is used to verify that the proper disk is in the drive before attempting to install files.</dd>
<dt>
Source</dt>
<dd>
The property defining the location of this cabinet file. If the Cabinet field is empty, this value is ignored. If this field is empty, the SOURCEDIR property is used.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Sequence Numbers</b></p>
<p>
The numbers in the LastSequence column specify which of the files in the <a href="tref_4n6t.htm">File table</a> are found on a particular source disk. Each source disk contains all the files whose sequence numbers (as shown in the Sequence column of the File table) are less than or equal to the value in the LastSequence column, and greater than the LastSequence value of the previous disk (or greater than 0, for the first entry in the Media table).</p>
<p>
<b>Cabinet Files</b></p>
<p>
If the Cabinet name is preceded by an at symbol (@), the files referencing this Media table record are packed in a cabinet that is stored within a resource of the launching executable file.</p>
<p>
<b>Determining the SourceMode</b></p>
<p>
The <a href="sref_8gzd.htm">MSI Source Type Summary property</a> determines the source mode for the current install. If this property is set to 2 or 3, a cabinet install is assumed. In this mode, the cabinet files are assumed to exist in the directory indicated by the SOURCEDIR property. If the Source Type value is 0 or 1, all source files are assumed to exist in the tree whose root is indicated by the SOURCEDIR property.</p>
<p>
Note that this only applies to files in the File table that do not have either the Compressed or Uncompressed bits set in the attributes column. These bits override the value of the <a href="sref_8gzd.htm">MSI Source Type Summary property</a> when determining if a particular file is compressed or uncompressed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_mime_table"></a>MIME Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MIME table contains the association between a MIME context type and the file extension and the CLSID. This is used to generate the MIME information as a part of product advertisement.</p>
<p>
The MIME table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%>ContentType</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Extension_</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>CLSID</td>
<td width=41%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ContentType</dt>
<dd>
Content identifier, typically type/format.</dd>
<dt>
Extension_</dt>
<dd>
Associated extension (without dot). Foreign key into the <a href="tref_219h.htm">Extension table</a>.</dd>
<dt>
CLSID</dt>
<dd>
Associated CLSID.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_9r8u.htm">RegisterMIMEInfo action</a> or the <a href="aref_30oe.htm">UnregisterMIMEInfo action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_movefile_table"></a>MoveFile Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This table contains a list of files to be moved or copied from a specified source directory to a specified destination directory. </p>
<p>
The MoveFile table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>FileKey</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>SourceName</td>
<td width=38%><a href="tref_6b77.htm#_msi_wildcardfilename">WildCardFilename</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Destname</td>
<td width=38%><a href="tref_6b77.htm#_msi_filename">Filename</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>SourceFolder</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>DestFolder</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Options</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
FileKey</dt>
<dd>
Primary key that uniquely identifies a particular MoveFile record.</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table.</a>. If the component referenced by this key is not selected for installation or removal, no action is taken on this MoveFile entry.</dd>
<dt>
SourceName</dt>
<dd>
Name of the source files to be moved or copied.
<p>
May be left blank (see the description of the SourceFolder column).
</dd>
<dt>
DestName</dt>
<dd>
Name to be given to the original file after it is moved or copied.
<p>
If blank, the destination file is given the same name as the source file.
</dd>
<dt>
SourceFolder</dt>
<dd>
Name of a property whose value is assumed to resolve to the full path to the source directory. If the SourceName column is left blank, the property named in the SourceFolder column is assumed to contain the full path to the source file itself (including the file name).</dd>
<dt>
DestFolder</dt>
<dd>
Name of a property whose value is assumed to resolve to the full path to the destination directory.
<p>
May contain wildcard characters (* and ?).
</dd>
<dt>
Options</dt>
<dd>
Integer value specifying the MoveFile operating mode.
<p>
One of imfoEnum as follows.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>0 (imfoCopy)</td>
<td width=52%>Copy the source file.</td>
</tr>
<tr valign=top>
<td width=48%>1 (imfoMove)</td>
<td width=52%>Move the source file.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is processed by the <a href="aref_15pq.htm">MoveFiles action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_odbcattribute_table"></a>ODBCAttribute Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCAttribute table contains information about the attributes of ODBC drivers and translators.</p>
<p>
The ODBCAttribute table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Driver_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Attribute</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Value</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Driver</dt>
<dd>
Internal token name for driver. A primary key for the table.</dd>
<dt>
Attribute</dt>
<dd>
Name of driver attribute. A primary key for the table.</dd>
<dt>
Value</dt>
<dd>
String value for attribute.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_odbcdatasource_table"></a>ODBCDataSource Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCDataSource table lists the data sources belonging to the installation.</p>
<p>
The ODBCDataSource table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>DataSource</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Description</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>DriverDescription</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Registration</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
DataSource</dt>
<dd>
Internal token name for data source. A primary key for the table.</dd>
<dt>
Component_</dt>
<dd>
External key into the Component table.</dd>
<dt>
Description</dt>
<dd>
The localized description registered for this data source.</dd>
<dt>
DriverDescription</dt>
<dd>
Associated driver which may be pre-existing.</dd>
<dt>
Registration</dt>
<dd>
A value of 0 in this column means that the data source is registered per machine. A value of 1 means the data source is registered per user.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_odbcdriver_table"></a>ODBCDriver Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCDriver table lists the ODBC drivers belonging to the installation.</p>
<p>
The ODBCDriver table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Driver</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Description</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>File_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>File_Setup</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Driver</dt>
<dd>
Internal token name for driver. A primary key for the table</dd>
<dt>
Component_</dt>
<dd>
External key into the Component table.</dd>
<dt>
Description</dt>
<dd>
The ODBC key for the driver. This key is localized.</dd>
<dt>
File_</dt>
<dd>
The DLL file for driver listed in the Driver column. This column is a key into the File table.</dd>
<dt>
File_Setup</dt>
<dd>
The setup DLL file for the driver if it is different than from Driver. This is a key into the File table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_odbcsourceattribute_table"></a>ODBCSourceAttribute Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCSourceAttribute table contains information about the attributes of data sources. </p>
<p>
The ODBCSourceAttribute table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Datasource_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Attribute</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Value</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Datasource_</dt>
<dd>
Internal token name for data source. A primary key for the table.</dd>
<dt>
Attribute</dt>
<dd>
Name of data source attribute. A primary key for the table.</dd>
<dt>
Value</dt>
<dd>
The string value for the attribute.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_odbctranslator_table"></a>ODBCTranslator Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCTranslator table lists the ODBC translators belonging to the installation.</p>
<p>
The ODBCTranslator table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Translator</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Description</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>File_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>File_Setup</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Translator</dt>
<dd>
Internal token name for translator. A primary key for the table.</dd>
<dt>
Component_</dt>
<dd>
External key into the Component table.</dd>
<dt>
Description</dt>
<dd>
The localized description registered for this data source.</dd>
<dt>
File_</dt>
<dd>
The DLL file for translator listed in the Translator column. This column is a key into the File table.</dd>
<dt>
File_Setup</dt>
<dd>
The setup DLL file for the translator if it is different than from Translator. This is a key into the File table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_patch_table"></a>Patch Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Patch table specifies the file that is to receive a particular patch and the physical location of the patch files on the media images.</p>
<p>
The Patch table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>File_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Sequence</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>PatchSize</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Attributes</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Header</td>
<td width=39%><a href="tref_6b77.htm#_msi_binary">Binary</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File_</dt>
<dd>
The patch is applied to the file specified by the identifier in this column. This is a primary key for the table and it is a foreign key to the <a href="tref_4n6t.htm">File table</a>.</dd>
<dt>
Sequence</dt>
<dd>
This is the position of the patch file in the sequence order of files on the media images. The sequence order must correspond to the order of the files in the patch package cabinet file. This is the primary key for this table.</dd>
<dt>
PatchSize</dt>
<dd>
This column gives the size of the patch in bytes written as a long integer.</dd>
<dt>
Attributes</dt>
<dd>
Integer containing bit flags representing patch attributes. Insert a value of 1 in this column to indicate that the failure to apply this patch is not a fatal error.</dd>
<dt>
Header</dt>
<dd>
This column is the binary stream patch header used for patch validation.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is processed by the <a href="aref_9cby.htm">PatchFiles action</a>. It is usually added to the install package by a transform from a patch package. It is usually not authored directly into an install package.</p>
<p>&nbsp;</p>

<h1><a name="_msi_patchpackage_table"></a>PatchPackage Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PatchPackage table describes all patch packages that have been applied to this product. For each patch package, the unique identifier for the patch is provided along with information about the media image the patch is located on.</p>
<p>
The PatchPackage table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>PatchId</td>
<td width=39%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Media_</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
PatchId</dt>
<dd>
This column contains a unique identifier for this particular patch.</dd>
<dt>
Media_</dt>
<dd>
This column is a foreign key to the DiskId column of the <a href="tref_4mlh.htm">Media Table</a> and indicates the disk containing the patch package.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is usually added to the install package by a transform from a patch package. It is usually not authored directly into an install package.</p>
<p>&nbsp;</p>

<h1><a name="_msi_progid_table"></a>ProgId Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ProgId table contains information for program IDs and version independent program IDs that must be generated as a part of the product advertisement.</p>
<p>
The ProgId table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>ProgId</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>ProgId_Parent</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Class_</td>
<td width=39%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Description</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Icon_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>IconIndex</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ProgId</dt>
<dd>
The program ID or version independent program ID.</dd>
<dt>
ProgId_Parent</dt>
<dd>
Defined only for version independent program IDs. To define a version independent program ID, place the corresponding ProgID in the Parent column.</dd>
<dt>
Class_</dt>
<dd>
Optional. A foreign key into the <a href="tref_5n8l.htm">Class table</a>. This column must be Null for a version independent ProgId.</dd>
<dt>
Description</dt>
<dd>
Optional, localized description of the associated program ID.</dd>
<dt>
Icon_</dt>
<dd>
Optional. A foreign key into the <a href="tref_7vmt.htm">Icon table</a> specifying the icon file associated with this ProgId. This is written under the DefaultIcon key associated with this ProgId. This column must be Null for a version independent ProgId.</dd>
<dt>
IconIndex</dt>
<dd>
The Icon index into the icon file. This column must be Null for a version independent ProgId.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_property_table"></a>Property Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Property table contains the property names and values for all defined properties in the installation. Properties with Null values are not present in the table.</p>
<p>
The Property table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%>Property</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Value</td>
<td width=40%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
Name of property, must be uppercase if it can be set from the Loader.</dd>
<dt>
Value</dt>
<dd>
String value for property, may never be Null or an empty string.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_publishcomponent_table"></a>PublishComponent Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PublishComponent table holds the information for cross-product advertisement of components and is used to generate component publishing information as a part of product advertisement. </p>
<p>
The PublishComponent table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%>ComponentID</td>
<td width=39%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Qualifier</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>AppData</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Feature_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Component_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ComponentID</dt>
<dd>
A string GUID that represents the component ID for the feature requested by an application. The component ID in the PublishComponent table is different than the component ID as described in the <a href="tref_09np.htm">Component table</a>. Here it refers to a server that provides the functionality of a component to external clients rather than the component, itself.</dd>
<dt>
Qualifier</dt>
<dd>
A text string that qualifies the value in the ComponentID column. A qualifier is used to distinguish multiple forms of the same component, such as a component that is implemented in multiple languages. This qualifier is referred to by the <a href="msi_3vn8.htm"><b>MsiProvideQualifiedComponent</b></a> function and the <a href="msi_2veb.htm"><b>MsiEnumComponentQualifiers</b></a> function.</dd>
<dt>
AppData</dt>
<dd>
An optional localizable text, owned and often parsed by the application. This can be retrieved with the <b>MsiEnumComponentQualifiers</b> function in the lpApplicationDataBuf buffer.</dd>
<dt>
Feature_</dt>
<dd>
External key into the <a href="tref_0a91.htm">Feature table</a>.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the Component table.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_2r3i.htm">PublishComponents action</a> or the <a href="aref_1ir2.htm">UnpublishComponents action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_radiobutton_table"></a>RadioButton Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Radio buttons are not treated as individual controls, but they are part of a radio button group that functions as a control. The RadioButton table lists the buttons for all the groups.</p>
<p>
The RadioButton table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Property</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Order</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Value</td>
<td width=40%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>X</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Y</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Width</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Height</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Text</td>
<td width=40%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=27%>Help</td>
<td width=40%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Property</dt>
<dd>
A named property to be tied to this radio button. All the buttons tied to the same property become part of the same group.</dd>
<dt>
Order</dt>
<dd>
A positive integer used to determine the ordering of the items within one list. The integers do not have to be consecutive.
<p>
Positive numbers only.
</dd>
<dt>
Value</dt>
<dd>
The value string associated with this button. Selecting the button sets the associated property to this value.</dd>
<dt>
X</dt>
<dd>
The horizontal coordinate within the group of the upper-left corner of the bounding rectangle of the radio button.
<p>
Non-negative numbers only.
</dd>
<dt>
Y</dt>
<dd>
The vertical coordinate within the group of the upper-left corner of the bounding rectangle of the radio button.
<p>
Non-negative numbers only.
</dd>
<dt>
Width</dt>
<dd>
The width of the button.
<p>
Non-negative numbers only.
</dd>
<dt>
Height</dt>
<dd>
The height of the button.
<p>
Non-negative numbers only.
</dd>
<dt>
Text</dt>
<dd>
The visible title to be assigned to the radio button. If the text is too long to be displayed on the control, it is truncated. If the button displays an icon or a bitmap, this entry contains the name of the picture (a key into the <a href="tref_04px.htm">Binary table</a>). There is no way to show both a picture and text on a button.</dd>
<dt>
Help</dt>
<dd>
The Help strings used with the button. The text is optional. The string is divided into two parts, divided by a separator character (|). The first part of the string is used as ToolTip text (this text is shown by screen readers for controls that contain a picture). The second part is used for context-sensitive Help. The separator character is required even if only one of the two kinds of text is present.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The integer values for x, y, width, and height are in the installer units, not dialog units. An installer unit is equal to one-twelfth the height of the system font. Coordinates for the controls are relative to the billboard.</p>
<p>
<b>Positioning</b></p>
<p>
The coordinates of the buttons are given relative to the group. If the coordinates of the group are changed, the buttons within the group remain in the same relative position to each other.</p>
<p>
<b>Formatting</b></p>
<p>
The contents of the Value and Text fields are formatted by the <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a> function when the control is created, so they can contain any expression that the <b>MsiFormatRecord</b> function can interpret. The formatting occurs only when the control is created, and it is not updated if a property involved in the expression is modified during the life of the control.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registry_table"></a>Registry Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Registry table holds the registry information that the application needs to set in the system registry. </p>
<p>
The Registry table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>Registry</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Root</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Key</td>
<td width=38%><a href="tref_6b77.htm#_msi_regpath">RegPath</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Name</td>
<td width=38%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Value</td>
<td width=38%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Registry</dt>
<dd>
The key for this table.</dd>
<dt>
Root</dt>
<dd>
The predefined root key for the registry value.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>0</td>
<td width=52%>HKEY_CLASSES_ROOT</td>
</tr>
<tr valign=top>
<td width=48%>1</td>
<td width=52%>HKEY_CURRENT_USER</td>
</tr>
<tr valign=top>
<td width=48%>2</td>
<td width=52%>HKEY_LOCAL_MACHINE</td>
</tr>
<tr valign=top>
<td width=48%>3</td>
<td width=52%>HKEY_USERS</td>
</tr>
</table><br>

</dd>
<dt>
Key</dt>
<dd>
The key for the registry value.</dd>
<dt>
Name</dt>
<dd>
The registry value name. If Null, the data entered into the Value column are written to the default registry key.
<p>
If the Value column is Null, the strings shown in the following table in the Name column have special significance.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=13%>String</th>
<th align=left width=87%>Meaning</th>
</tr>
<tr valign=top>
<td width=13%>+</td>
<td width=87%>The key is to be created, if absent, when the component is installed.</td>
</tr>
<tr valign=top>
<td width=13%>-</td>
<td width=87%>The key is to be deleted, if present, with all of its values and subkeys, when the component is uninstalled.</td>
</tr>
<tr valign=top>
<td width=13%>*</td>
<td width=87%>The key is to be created, if absent, when the component is installed. Additionally, the key is to be deleted, if present, with all of its values and subkeys, when the component is uninstalled.</td>
</tr>
</table><br>

</dd>
<dt>
Value</dt>
<dd>
The registry value.
<p>
KeyFormatted. If the Value is preceded by a pound symbol (#), the value is interpreted as follows.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=13%>String</th>
<th align=left width=87%>Meaning</th>
</tr>
<tr valign=top>
<td width=13%>#x</td>
<td width=87%>The value is interpreted and stored as a hexadecimal value (REG_BINARY).</td>
</tr>
<tr valign=top>
<td width=13%>#%</td>
<td width=87%>The value is interpreted and stored as an expandable string (REG_EXPAND_SZ).</td>
</tr>
<tr valign=top>
<td width=13%>#</td>
<td width=87%>The value is interpreted and stored as an integer (REG_INTEGER).</td>
</tr>
</table><br>

</dd>
</dl>
<ul>
<li>
If the value contains the sequence [~], then the value is interpreted as a Null-delimited list of strings (REG_MULTI_SZ). </li>
<li>
The sequence [~] within the value separates the individual strings and is interpreted and stored as a Null character.</li>
<li>
If a [~] precedes the string list, the strings are to be appended to any existing registry value strings. If an appending string already occurs in the registry value, the original occurrence of the string is removed.</li>
<li>
If a [~] follows the end of the string list, the strings are to be prepended to any existing registry value strings. If a prepending string already occurs in the registry value, the original occurrence of the string is removed.</li>
<li>
If a [~] is at both the beginning and the end or at neither the beginning nor the end of the string list, the strings are to replace any existing registry value strings. </li>
<li>
Otherwise, the value is interpreted and stored as a string (REG_SZ). </li>
<li>
If the value begins with two or more consecutive pound symbols (#), the value is interpreted and stored as a string, ignoring the first #.</li>
</ul>
<dl>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> referencing the component that controls the installation of the registry value.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The registry information is written out to the system registry when the corresponding component has been selected to be installed, either locally or run from source.</p>
<p>
This table is referred to when the <a href="aref_1cmm.htm">WriteRegistryValues action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reglocator_table"></a>RegLocator Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegLocator table holds the information needed to find a file or directory using the registry.</p>
<p>
The RegLocator table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%>Signature_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Root</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Key</td>
<td width=41%><a href="tref_6b77.htm#_msi_regpath">RegPath</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Name</td>
<td width=41%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Type</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Signature_</dt>
<dd>
The Signature_ represents a unique file signature and is also the external key into the <a href="tref_149x.htm">Signature table</a>. If the key is absent from the Signature table, the search is assumed to be for the presence of a directory pointed to by the RegLocator table.
<p>
External key to column one of the Signature table.
</dd>
<dt>
Root</dt>
<dd>
The predefined root key for the registry value.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Root Key</th>
</tr>
<tr valign=top>
<td width=44%>0</td>
<td width=56%>HKEY_CLASSES_ROOT</td>
</tr>
<tr valign=top>
<td width=44%>1</td>
<td width=56%>HKEY_CURRENT_USER</td>
</tr>
<tr valign=top>
<td width=44%>2</td>
<td width=56%>HKEY_LOCAL_MACHINE</td>
</tr>
<tr valign=top>
<td width=44%>3</td>
<td width=56%>HKEY_USERS</td>
</tr>
</table><br>

</dd>
<dt>
Key</dt>
<dd>
The key for the registry value.</dd>
<dt>
Name</dt>
<dd>
The registry value name.</dd>
<dt>
Type</dt>
<dd>
A Boolean value that determines if the registry value is a file name or a directory location.
<p>
If absent, Type is assumed to be 1, denoting a file name search.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Value</th>
<th align=left width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>0</td>
<td width=59%>Directory</td>
</tr>
<tr valign=top>
<td width=41%>1</td>
<td width=59%>File name</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table's columns are generally not localized. If an author decides to search for products in multiple languages, then there can be a separate entry included in the table for each language.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removefile_table"></a>RemoveFile Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveFile table contains a list of files to be removed by the <a href="aref_9xny.htm">RemoveFiles action</a>. Setting the FileName column of this table to Null supports the removal of empty folders. </p>
<p>
The RemoveFile table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%>FileKey</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>FileName</td>
<td width=38%><a href="tref_6b77.htm#_msi_wildcardfilename">WildCardFilename</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>DirProperty</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>InstallMode</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
FileKey</dt>
<dd>
Primary key used to identify a particular file entry.</dd>
<dt>
Component_</dt>
<dd>
External key referencing the component that controls the file to be removed.
<p>
External key to column one of the <a href="tref_09np.htm">Component table</a>.
</dd>
<dt>
FileName</dt>
<dd>
Name of the file to be removed. If this column is null, then the specified folder will be removed if it is empty.</dd>
<dt>
DirProperty</dt>
<dd>
Name of a property whose value is assumed to resolve to the full path to the folder of the file to be removed. The property can be the name of a directory in the <a href="tref_6an9.htm">Directory table</a>, a property set by the <a href="tref_0w9x.htm">AppSearch table</a>, or any other property that represents a full path.</dd>
<dt>
InstallMode</dt>
<dd>
Must be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=15%>Value</th>
<th align=left width=85%>Meaning</th>
</tr>
<tr valign=top>
<td width=15%>1</td>
<td width=85%>Remove only when the associated component is being installed (iisLocal or iisSource).</td>
</tr>
<tr valign=top>
<td width=15%>2</td>
<td width=85%>Remove only when the associated component is being removed (iisAbsent).</td>
</tr>
<tr valign=top>
<td width=15%>3</td>
<td width=85%>Remove in either of the above cases.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The file references in this table are processed by the <a href="aref_9xny.htm">RemoveFiles action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removeinifile_table"></a>RemoveIniFile Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveIniFile table contains the information an application needs to delete from a .ini file. </p>
<p>
The RemoveIniFile table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=38%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=30%>RemoveIniFile</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>FileName</td>
<td width=38%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Directory_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Section</td>
<td width=38%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Key</td>
<td width=38%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Value</td>
<td width=38%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Action</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
RemoveIniFile</dt>
<dd>
The key for this table.</dd>
<dt>
FileName</dt>
<dd>
The .ini file name in which to delete the information.</dd>
<dt>
Directory_</dt>
<dd>
External key into the <a href="tref_6an9.htm">Directory table</a> indicating the directory in which the .ini file resides.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Section</dt>
<dd>
The .ini file section.</dd>
<dt>
Key</dt>
<dd>
The .ini file key below the section.</dd>
<dt>
Value</dt>
<dd>
The value to be deleted. The value is required when Action is 4.</dd>
<dt>
Action</dt>
<dd>
The type of modification to be made.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>2</td>
<td width=52%>Deletes .ini entry.</td>
</tr>
<tr valign=top>
<td width=48%>4</td>
<td width=52%>Deletes a tag from a .ini entry.</td>
</tr>
</table><br>

</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> referencing the component that controls the deletion of the .ini value.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The .ini file information is deleted when the corresponding Component has been selected to be installed, either locally or run from source. </p>
<p>
This table is referred to when the <a href="aref_4tv2.htm">RemoveIniValues action</a> is executed.</p>
<p>
If the Directory_ column is specified as null, the ini file location is the standard Windows ini location which is the Windows directory by default.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removeregistry_table"></a>RemoveRegistry Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveRegistry table contains the registry information the application needs to delete from the system registry. </p>
<p>
The RemoveRegistry table has the following columns.</p>
<table cellspacing=4 cols=6>
<tr valign=top>
<th align=left width=9%>Column</th>
<th align=left width=12%>Type</th>
<th align=left width=4%>Key</th>
<th align=left width=8%>Nullable</th>
</tr>
<tr valign=top>
<td colspan=3 width=25%></td>
<td colspan=2 width=29%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=9%>RemoveRegistry</td>
<td width=12%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=4%>Y</td>
<td width=8%>N</td>
</tr>
<tr valign=top>
<td width=9%>Root</td>
<td width=12%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=4%></td>
<td width=8%>N</td>
</tr>
<tr valign=top>
<td width=9%>Key</td>
<td width=12%><a href="tref_6b77.htm#_msi_regpath">RegPath</a></td>
<td width=4%></td>
<td width=8%>N</td>
</tr>
<tr valign=top>
<td width=9%>Name</td>
<td width=12%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=4%></td>
<td width=8%>Y</td>
</tr>
<tr valign=top>
<td width=9%>Component_</td>
<td width=12%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=4%></td>
<td width=8%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
RemoveRegistry</dt>
<dd>
The key for this table.</dd>
<dt>
Root</dt>
<dd>
The predefined root key for the registry value.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>0</td>
<td width=52%>HKEY_CLASSES_ROOT</td>
</tr>
<tr valign=top>
<td width=48%>1</td>
<td width=52%>HKEY_CURRENT_USER</td>
</tr>
<tr valign=top>
<td width=48%>2</td>
<td width=52%>HKEY_LOCAL_MACHINE</td>
</tr>
<tr valign=top>
<td width=48%>3</td>
<td width=52%>HKEY_USERS</td>
</tr>
</table><br>

</dd>
<dt>
Key</dt>
<dd>
The key for the registry value.</dd>
<dt>
Name</dt>
<dd>
The registry value name. 
<p>
The following string in the Name column have special significance.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=13%>String</th>
<th align=left width=87%>Meaning</th>
</tr>
<tr valign=top>
<td width=13%>"-"</td>
<td width=87%>The key is to be deleted, if present, with all of its values and subkeys, when the component is installed.</td>
</tr>
</table><br>

</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> referencing the component that controls the deletion of the registry value.
<p>
External key to column one of the Component table.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The registry information is deleted from the system registry when the corresponding component has been selected to be installed, either locally or run from source. </p>
<p>
This table is referred to when the <a href="aref_5mem.htm">RemoveRegistryValues action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reservecost_table"></a>ReserveCost Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ReserveCost table is an optional table that allows the author to reserve a specified amount of disk space in any directory, depending on the installation state of a component.</p>
<p>
The ReserveCost table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=37%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=37%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=31%>ReserveKey</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>Component_</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=31%>ReserveFolder</td>
<td width=37%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>ReserveLocal</td>
<td width=37%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=31%>ReserveSource</td>
<td width=37%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ReserveKey</dt>
<dd>
Primary key that uniquely identifies a particular ReserveCost table entry.</dd>
<dt>
Component_</dt>
<dd>
Reserve a specified amount of space if this component is to be installed.
<p>
External key to column one of the <a href="tref_09np.htm">Component Table</a>.
</dd>
<dt>
ReserveFolder</dt>
<dd>
This column contains the name of a property that is the full path to the destination directory. This property name will typically be the name of a directory in the Directory table or the name of a property set obtained using the <a href="aref_16zy.htm">Appsearch action</a>. This will add the amount of disk space specified in ReserveLocal or ReserveSource to the volume cost of the device containing the directory.</dd>
<dt>
ReserveLocal</dt>
<dd>
Disk space to reserve if the linked component is installed locally.</dd>
<dt>
ReserveSource</dt>
<dd>
Disk space to reserve if the linked component is installed to run from the source location.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Reserving cost in this way could be useful for authors who want to ensure that a minimum amount of disk space will be available after the installation is completed. For example, this disk space might be reserved for user documents or for application files (such as index files) that are created only after the application is started following installation. The ReserveCost table also allows custom actions to specify an approximate cost for any files, registry entries, or other items that the custom action might install.</p>
<p>&nbsp;</p>

<h1><a name="_msi_resource_table"></a>Resource Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Resource table contains resource data to be written into executables or DLLs. </p>
<p>
The Resource table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=25%>Column</th>
<th align=left width=42%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=42%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=25%>File_</td>
<td width=42%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>ResType</td>
<td width=42%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>ResId</td>
<td width=42%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Data</td>
<td width=42%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File_</dt>
<dd>
File identifier, referencing the <a href="tref_4n6t.htm">File table</a> entry containing the file specification.
<p>
External key to column one of the File table.
</dd>
<dt>
ResType</dt>
<dd>
Resource type to update. 
<p>
Non-negative numbers only. Can be a user-defined resource type or one of the following predefined resource types.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=15%>Value</th>
<th align=left width=33%>Resource Type</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=15%>9</td>
<td width=33%>RT_ACCELERATOR</td>
<td width=52%>Accelerator table</td>
</tr>
<tr valign=top>
<td width=15%>21</td>
<td width=33%>RT_ANICURSOR</td>
<td width=52%>Animated cursor</td>
</tr>
<tr valign=top>
<td width=15%>22</td>
<td width=33%>RT_ANIICON</td>
<td width=52%>Animated icon</td>
</tr>
<tr valign=top>
<td width=15%>2</td>
<td width=33%>RT_BITMAP </td>
<td width=52%>Bitmap resource</td>
</tr>
<tr valign=top>
<td width=15%>1</td>
<td width=33%>RT_CURSOR </td>
<td width=52%>Hardware-dependent cursor resource</td>
</tr>
<tr valign=top>
<td width=15%>5</td>
<td width=33%>RT_DIALOG </td>
<td width=52%>Dialog box</td>
</tr>
<tr valign=top>
<td width=15%>8</td>
<td width=33%>RT_FONT </td>
<td width=52%>Font resource</td>
</tr>
<tr valign=top>
<td width=15%>7</td>
<td width=33%>RT_FONTDIR </td>
<td width=52%>Font directory resource</td>
</tr>
<tr valign=top>
<td width=15%>12</td>
<td width=33%>RT_GROUP_CURSOR </td>
<td width=52%>Hardware-independent cursor resource</td>
</tr>
<tr valign=top>
<td width=15%>14</td>
<td width=33%>RT_GROUP_ICON </td>
<td width=52%>Hardware-independent icon resource</td>
</tr>
<tr valign=top>
<td width=15%>3</td>
<td width=33%>RT_ICON </td>
<td width=52%>Hardware-dependent icon resource</td>
</tr>
<tr valign=top>
<td width=15%>4</td>
<td width=33%>RT_MENU </td>
<td width=52%>Menu resource</td>
</tr>
<tr valign=top>
<td width=15%>11</td>
<td width=33%>RT_MESSAGETABLE </td>
<td width=52%>Message-table entry</td>
</tr>
<tr valign=top>
<td width=15%>10</td>
<td width=33%>RT_RCDATA </td>
<td width=52%>Application-defined resource (raw data)</td>
</tr>
<tr valign=top>
<td width=15%>6</td>
<td width=33%>RT_STRING </td>
<td width=52%>String-table entry</td>
</tr>
<tr valign=top>
<td width=15%>16</td>
<td width=33%>RT_VERSION </td>
<td width=52%>Version resource</td>
</tr>
</table>
</dd>
<dt>
ResId</dt>
<dd>
Resource ID to update.
<p>
Non-negative numbers only. 
</dd>
<dt>
Data</dt>
<dd>
Data to write.
<p>
If the text string contains property parameters (a property name within square brackets), the current values for those properties are substituted into the string. If the resultant string begins with #x, the string is treated as a hexadecimal value, and the resource is updated with the binary value.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_2er2.htm">UpdateResources action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selfreg_table"></a>SelfReg Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelfReg table contains information about modules that need to be self-registered. The installer calls the DllRegisterServer() function at the time of installing the module and the DllUnregisterServer() function at the time of uninstalling the module.</p>
<p>
The SelfReg table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=38%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=38%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=30%>File_</td>
<td width=38%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=30%>Cost</td>
<td width=38%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
File_</dt>
<dd>
External key into the <a href="tref_4n6t.htm">File table</a> indicating the module that needs to be registered.
<p>
External key to column one of the File table.
</dd>
<dt>
Cost</dt>
<dd>
The cost of registering the module.
<p>
Non-negative numbers only.

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_servicecontrol_table"></a>ServiceControl Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ServiceControl table is used to control installed or uninstalled services. </p>
<p>
The ServiceControl table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=29%>Type</th>
<th align=left width=23%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=29%></td>
<td width=23%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=30%>ServiceControl</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>Name</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>Event</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>Arguments</td>
<td width=29%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Wait</td>
<td width=29%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ServiceControl</dt>
<dd>
This is the primary key of this table.</dd>
<dt>
Name</dt>
<dd>
This column is the string naming the service. This column can be used to control a service that is not installed.</dd>
<dt>
Event</dt>
<dd>
This column contains the operations to be performed on the name service. The values are bitfields that can be combined into a single value that represents several operations.
<p>
The following values are only used during an install.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=13%>Value</th>
<th align=left width=87%>Meaning</th>
</tr>
<tr valign=top>
<td width=13%>1</td>
<td width=87%>Starts the service during the StartServices action.</td>
</tr>
<tr valign=top>
<td width=13%>2</td>
<td width=87%>Stops the service during the StopServices action.</td>
</tr>
<tr valign=top>
<td width=13%>4</td>
<td width=87%>&lt;reserved&gt;</td>
</tr>
<tr valign=top>
<td width=13%>8</td>
<td width=87%>Deletes the service during the DeleteServices action.</td>
</tr>
</table><br>


<p>
The following values are only used during an uninstall

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=13%>Value</th>
<th align=left width=87%>Meaning</th>
</tr>
<tr valign=top>
<td width=13%>16</td>
<td width=87%>Starts the service during the StartServices action.</td>
</tr>
<tr valign=top>
<td width=13%>32</td>
<td width=87%>Stops the service during the StopServices action.</td>
</tr>
<tr valign=top>
<td width=13%>64</td>
<td width=87%>&lt;reserved&gt;</td>
</tr>
<tr valign=top>
<td width=13%>128</td>
<td width=87%>Deletes the service during the DeleteServices action.</td>
</tr>
</table><br>

</dd>
<dt>
Arguments</dt>
<dd>
A list of arguments for starting services. The arguments are separated by null characters [~]. For example, the list of arguments One, Two, and Three are listed as: One[~]Two[~]Three. </dd>
<dt>
Wait</dt>
<dd>
A value of 1 in this column means to wait until the service actually completes before proceeding. This implies that the event is critical to the install, and that if the event fails the resulting error cannot be ignored. A value of 0 in this column means to wait only until the service control manager (SCM) reports that this service is in a pending state.</dd>
<dt>
Component_</dt>
<dd>
External key to column one of the <a href="tref_09np.htm">Component Table</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_serviceinstall_table"></a>ServiceInstall Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ServiceInstall table is used to install a service.</p>
<p>
The ServiceInstall table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=30%>Column</th>
<th align=left width=29%>Type</th>
<th align=left width=23%>Key</th>
<th align=left width=18%>Nullable</th>
</tr>
<tr valign=top>
<td width=30%></td>
<td width=29%></td>
<td width=23%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=30%>ServiceInstall</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%>Y</td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>Name</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>DisplayName</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>ServiceType</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>StartType</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>ErrorControl</td>
<td width=29%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
<tr valign=top>
<td width=30%>LoadOrderGroup</td>
<td width=29%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Dependencies</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>StartName</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Password</td>
<td width=29%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=23%></td>
<td width=18%>Y</td>
</tr>
<tr valign=top>
<td width=30%>Component_</td>
<td width=29%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=23%></td>
<td width=18%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
ServiceInstall</dt>
<dd>
This is the primary key for the table.</dd>
<dt>
Name</dt>
<dd>
This column is the string that gives the service name to install. The string has a maximum length of 256 characters. The service control manager database preserves the case of the characters in the service name, but comparisons of service names are case insensitive. Forward-slash (/) and back-slash (\) are invalid service name characters.</dd>
<dt>
DisplayName</dt>
<dd>
This column is the string that user interface programs use to identify the service. The string has a maximum length of 256 characters. The service control manager preserves the case of the display name, but display name comparisons are case insensitive.</dd>
<dt>
ServiceType</dt>
<dd>
This column is a set of bit flags that specify the type of service. One of the following service types must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_WIN32_OWN_PROCESS</td>
<td width=22%>0x00000010</td>
<td width=40%>A Microsoft  Win32  service that runs its own process.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_WIN32_SHARE_PROCESS</td>
<td width=22%>0x00000020</td>
<td width=40%>A Win32 service that shares a process.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_INTERACTIVE_PROCESS</td>
<td width=22%>0x00000100</td>
<td width=40%>A Win32 service that interacts with the desktop. This value cannot be used alone and must be added to one of the two previous types.</td>
</tr>
</table><br>


<p>
The following types of service are unsupported.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_KERNEL_DRIVER</td>
<td width=22%>0x00000001</td>
<td width=40%>A driver service.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_FILE_SYSTEM_DRIVER</td>
<td width=22%>0x00000002</td>
<td width=40%>A file system driver service.</td>
</tr>
</table><br>

</dd>
<dt>
StartType</dt>
<dd>
This column is a set of bit flags that specify when to start the service. One of the following types of service start must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Service Start</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_AUTO_START </td>
<td width=22%>0x00000002</td>
<td width=40%>A service start during startup of the system.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_DEMAND_START </td>
<td width=22%>0x00000003</td>
<td width=40%>A service start when the service control manager calls the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_startservice">
</object><a href=JavaScript:alink_1.Click()><b>StartService</b></a> function.</td>
</tr>
</table><br>


<p>
The following types of service starts are valid only for driver services.

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Type of Driver Service Start</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Description</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_BOOT_START </td>
<td width=22%>0x00000000</td>
<td width=40%>A device driver started by the operating system loader.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_SYSTEM_START </td>
<td width=22%>0x00000001</td>
<td width=40%>A device driver started by calling the <b>IoInitSystem</b> function. Use this in the <a href="tref_1691.htm">ServiceControl Table</a>, with the StartServices action put after the InstallServices action, to start a driver service during an install.</td>
</tr>
</table><br>

</dd>
<dt>
ErrorControl</dt>
<dd>
This column specifies the action taken by the startup program if the service fails to start during startup. These values affect the ServiceControl StartService events for installed services. One of the following error control flags must be specified in this column.
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>Error Control Flag</th>
<th align=left width=22%>Value</th>
<th align=left width=40%>Startup Program's Action</th>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_IGNORE </td>
<td width=22%>0x00000000</td>
<td width=40%>Logs the error and continues with the startup operation.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_NORMAL </td>
<td width=22%>0x00000001</td>
<td width=40%>Logs the error, displays a message box and continues the startup operation.</td>
</tr>
<tr valign=top>
<td width=38%>SERVICE_ERROR_CRITICAL </td>
<td width=22%>0x00000003</td>
<td width=40%>Logs the error if it is possible and the system is restarted with the last configuration known to be good. If the last-known-good configuration is being started, the startup operation fails.</td>
</tr>
</table><br>

</dd>
<dt>
LoadOrderGroup</dt>
<dd>
This column contains the string that names the load ordering group of which this service is a member. Specify NULL or an empty string if the service does not belong to a group.</dd>
<dt>
Dependencies</dt>
<dd>
This column is a list of names of services or load ordering groups that the system must start before this service. Separate names in the list by Nulls. If the service has no dependencies, then specify NULL or an empty string. Dependency on a group means that the service can run if at least one member of the group is running after an attempt to start all members of the group. Because services and service groups share the same name space, group names must have the prefix: SC_GROUP_IDENTIFIER.</dd>
<dt>
StartName</dt>
<dd>
The service will be logged on as the name given by the string in this column. If the service type is SERVICE_WIN32_OWN_PROCESS use an account name in the form: DomainName\UserName. If the account belongs to the built-in domain it is permitted to specify .\UserName. The LocalSystem account must be used if the type of service is SERVICE_WIN32_SHARE_PROCESS. The <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createservice">
</object><a href=JavaScript:alink_2.Click()><b>CreateService</b></a> function uses the LocalSystem account if StartName is specified as NULL and most services will therefore leave this column blank.</dd>
<dt>
Password</dt>
<dd>
This string is the password to the account name in the <i>IpServiceStartName</i> parameter. The service has no password if the pointer in <i>IpServiceStartName</i> is NULL or if it points to an empty string. The Startname of LocalSystem is NULL, and therefore the password for <i>lpServiceStartName</i> in this instance is NULL, so most services will leave this column blank.

<p>
<b>Note</b>&nbsp;&nbsp;Services installed with a user name and password cannot be rolled back when deleted.

</dd>
<dt>
Component_</dt>
<dd>
External key to column one of the <a href="tref_09np.htm">Component Table</a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table has most of the parameters to the Win32 <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createservice">
</object><a href=JavaScript:alink_3.Click()><b>CreateService</b></a> function. </p>
<p>&nbsp;</p>

<h1><a name="_msi_shortcut_table"></a>Shortcut Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Shortcut table holds the information the application needs to create Shortcuts on the user's computer. </p>
<p>
The Shortcut table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=41%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=26%>Shortcut</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Directory_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Name</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Component_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Target</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Arguments</td>
<td width=41%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Description</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>HotKey</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Icon_</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>IconIndex</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>ShowCmd</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>WkDir</td>
<td width=41%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Shortcut</dt>
<dd>
The key value for this table.</dd>
<dt>
Directory_</dt>
<dd>
External key into the <a href="tref_6an9.htm">Directory table</a> specifying the directory into which the Shortcut file is created.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Name</dt>
<dd>
The name of the Shortcut to be created.</dd>
<dt>
Component_</dt>
<dd>
External key into the <a href="tref_09np.htm">Component table</a> specifying the component whose selection determines if the Shortcut is created (or deleted).
<p>
External key to column one of the Component table.
</dd>
<dt>
Target</dt>
<dd>
The Shortcut target. This is the key into the <a href="tref_0a91.htm">Feature table</a> in case of advertised Shortcuts. For non-advertised Shortcuts, it is a property that is expanded to a file or a folder that the Shortcut points to. For more information, see the <a href="aref_7uzy.htm">CreateShortcuts action</a>.
<p>
External key to column one of the Feature table or KeyFormatted.
</dd>
<dt>
Arguments</dt>
<dd>
The command-line arguments for the Shortcut.</dd>
<dt>
Description</dt>
<dd>
The description of the Shortcut.</dd>
<dt>
HotKey</dt>
<dd>
The hotkey for the Shortcut. 
<p>
Non-negative numbers only. The low-order byte contains the virtual-key code for the key, and the high-order byte contains modifier flags.
</dd>
<dt>
Icon_</dt>
<dd>
External key to column one of the <a href="tref_7vmt.htm">Icon table</a>.</dd>
<dt>
IconIndex</dt>
<dd>
The icon index for the Shortcut.
<p>
Non-negative numbers only. 
</dd>
<dt>
ShowCmd</dt>
<dd>
The Show command for the application window.
<p>
The following values may be used. The values are exactly as defined for the Windows API function ShowWindow.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=24%>Value</th>
<th align=left width=76%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=24%>0</td>
<td width=76%>SW_HIDE</td>
</tr>
<tr valign=top>
<td width=24%>1</td>
<td width=76%>SW_SHOWNORMAL</td>
</tr>
<tr valign=top>
<td width=24%>2</td>
<td width=76%>SW_SHOWMINIMIZED</td>
</tr>
<tr valign=top>
<td width=24%>3</td>
<td width=76%>SW_SHOWMAXIMIZED</td>
</tr>
<tr valign=top>
<td width=24%>4</td>
<td width=76%>SW_SHOWNOACTIVATE</td>
</tr>
<tr valign=top>
<td width=24%>5</td>
<td width=76%>SW_SHOW</td>
</tr>
<tr valign=top>
<td width=24%>6</td>
<td width=76%>SW_MINIMIZE</td>
</tr>
<tr valign=top>
<td width=24%>7</td>
<td width=76%>SW_SHOWMINNOACTIVE</td>
</tr>
<tr valign=top>
<td width=24%>8</td>
<td width=76%>SW_SHOWNA</td>
</tr>
<tr valign=top>
<td width=24%>9</td>
<td width=76%>SW_RESTORE</td>
</tr>
<tr valign=top>
<td width=24%>10</td>
<td width=76%>SW_SHOWDEFAULT</td>
</tr>
<tr valign=top>
<td width=24%>10</td>
<td width=76%>SW_MAX</td>
</tr>
</table><br>

</dd>
<dt>
WkDir</dt>
<dd>
The name of the property that has the path of the working directory for the Shortcut.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The Shortcuts are created only if the IShellLink interface is present on the system. An advertised shortcut is created when the corresponding feature has been enabled. A non-advertised shortcut is created when the  corresponding component has been selected to be installed, either locally or run from source.</p>
<p>
This table is referred to when the <a href="aref_7uzy.htm">CreateShortcuts action</a> and the <a href="aref_6t66.htm">RemoveShortcuts action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_signature_table"></a>Signature Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Signature table holds the information that uniquely identifies a file signature. </p>
<p>
The Signature table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>Signature</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>FileName</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>MinVersion</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>MaxVersion</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>MinSize</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>MaxSize</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>MinDate</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>MaxDate</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Languages</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Signature</dt>
<dd>
The Signature represents a unique file signature.</dd>
<dt>
FileName</dt>
<dd>
The name of the file.</dd>
<dt>
MinVersion</dt>
<dd>
The minimum version of the file. If specified, the file under inspection must have a version that is at least equal to MinVersion.</dd>
<dt>
MaxVersion</dt>
<dd>
The maximum version of the file. If specified, the file under inspection must have a version that is at most equal to MaxVersion.</dd>
<dt>
MinSize</dt>
<dd>
The minimum size of the file. If specified, the file under inspection must have a size that is at least equal to MinSize.
<p>
Non-negative numbers only.
</dd>
<dt>
MaxSize</dt>
<dd>
The maximum size of the file. If specified, the file under inspection must have a size that is at most equal to MaxSize.
<p>
Non-negative numbers only.
</dd>
<dt>
MinDate</dt>
<dd>
The minimum creation date of the file. If specified, the file under inspection must have a creation date that is at least equal to MinDate.
<p>
Non-negative numbers only.
</dd>
<dt>
MaxDate</dt>
<dd>
The maximum creation date of the file. If specified, the file under inspection must have a creation date that is at most equal to MaxDate.
<p>
Non-negative numbers only.
</dd>
<dt>
Languages</dt>
<dd>
The languages supported by the file.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The signature is searched for using the <a href="tref_91wl.htm">RegLocator table</a>, the <a href="tref_00o5.htm">IniLocator table</a>, the <a href="tref_771h.htm">CompLocator table</a>, and the <a href="tref_3azp.htm">DrLocator table</a>. This table's columns are generally not localized. If an author decides to search for products in multiple languages, then there can be a separate entry included in the table for each language.</p>
<p>&nbsp;</p>

<h1><a name="_msi_textstyle_table"></a>TextStyle Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The TextStyle table lists the different text styles used in the text controls.</p>
<p>
The TextStyle table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=22%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=44%></td>
<td width=14%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=22%>TextStyle</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=22%>FaceName</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=22%>Size</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=22%>Color</td>
<td width=44%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=14%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=22%>StyleBits</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
TextStyle</dt>
<dd>
Name of the style. This name is embedded in the texts to indicate a style change.</dd>
<dt>
FaceName</dt>
<dd>
A string indicating the name of the font used.
<p>
The string must be no more than 31 characters long.
</dd>
<dt>
Size</dt>
<dd>
The size of the font used. This is in the installer units. An installer unit is equal to one-twelfth of the height of the system font.
<p>
Non-negative numbers only.
</dd>
<dt>
Color</dt>
<dd>
A four-byte integer indicating the color of the string in the RGB format. 
<p>
The color value is specified in RGB format.

<p>
Red, green, and blue each have a range of 0-255. Blank signifies the default color.
</dd>
<dt>
StyleBits</dt>
<dd>
A combination of bits indicating the style of the string.
<p>
A combination of the following style bits.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Bit</th>
<th align=left width=67%>Style</th>
</tr>
<tr valign=top>
<td width=33%>0</td>
<td width=67%>Bold</td>
</tr>
<tr valign=top>
<td width=33%>1</td>
<td width=67%>Italic</td>
</tr>
<tr valign=top>
<td width=33%>2</td>
<td width=67%>Underline</td>
</tr>
<tr valign=top>
<td width=33%>3</td>
<td width=67%>Strike out</td>
</tr>
</table><br>

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_typelib_table"></a>TypeLib Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The TypeLib table contains the information that needs to be placed in the registry for the advertisement and registration of type libraries. </p>
<p>
The TypeLib table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=39%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=39%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=29%>LibID</td>
<td width=39%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Language</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Version</td>
<td width=39%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Description</td>
<td width=39%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Directory_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=29%>Feature_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Component_</td>
<td width=39%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=29%>Cost</td>
<td width=39%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
LibID</dt>
<dd>
The GUID that identifies the library.</dd>
<dt>
Language</dt>
<dd>
The language of the type library.
<p>
Non-negative numbers only.
</dd>
<dt>
Version</dt>
<dd>
The version of the library.
<p>
The major and minor versions are encoded in the two-byte integer with the minor version in the lower eight bits and the major version in the upper eight bits.
</dd>
<dt>
Description</dt>
<dd>
Description of the library.</dd>
<dt>
Directory_</dt>
<dd>
External key into the <a href="tref_6an9.htm">Directory table</a> that identifies the Help path for the type library. This column is ignored during advertising.
<p>
External key to column one of the Directory table.
</dd>
<dt>
Feature_</dt>
<dd>
External key into the Feature table specifying the feature to be advertised or installed for the type library to be operational.
<p>
External key to column one of the Feature table.
</dd>
<dt>
Component_</dt>
<dd>
External key into the Component table identifying the component belonging to Feature_ whose key file is the type library being advertised/ registered.
<p>
External key to column one of the Component table.
</dd>
<dt>
Cost</dt>
<dd>
The cost associated with the registration of the type library. This column is optional.
<p>
Non-negative numbers only.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_31ri.htm">RegisterTypeLibraries action</a> or the <a href="aref_8qb2.htm">UnregisterTypeLibraries action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_uitext_table"></a>UIText Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UIText table contains the localized versions of some of the strings used in the user interface. These strings are not part of any other table. The UIText table is for strings that have no logical place in any other table. </p>
<p>
The UIText table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Key</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Text</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Key</dt>
<dd>
A unique key that identifies the particular string. </dd>
<dt>
Text</dt>
<dd>
The localized version of the string.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Some controls use the UIText table as a source of strings. For information about which strings are required in this table for each particular control, see the individual controls in the <a href="href_2z6t.htm">User Interface Reference</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_upgrade_table"></a>Upgrade Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Upgrade table contains information on how the installer should perform an upgrade of a product and how to handle installations when related versions of the product are already installed.</p>
<p>
The Upgrade table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=25%>Column</th>
<th align=left width=42%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=42%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=25%>UpgradeCode</td>
<td width=42%><a href="tref_6b77.htm#_msi_guid">GUID</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>ProductVersion</td>
<td width=42%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Operator</td>
<td width=42%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Features</td>
<td width=42%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=25%>Property</td>
<td width=42%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
UpgradeCode</dt>
<dd>
This column contains a unique <a href="pref_7mux.htm">UpgradeCode property</a> representing a set of products that are related to the pending product upgrade. Products already installed and having this UpgradeCode may be removed and replaced by the pending upgrade or the current installation may be blocked.</dd>
<dt>
ProductVersion</dt>
<dd>
This is the version of the product that it to be compared to any related products that are already installed. Whether or not this version replaces an installed version of the product depends upon the evaluation of the Operator column.</dd>
<dt>
Operator</dt>
<dd>
This column contains an operator that changes the current installation dependent upon whether another version of the product is already installed. The following table lists the possible operations. To combine these operations, add their values and use the sum in the Operator column. For example, setting the Operator column to 3 specifies that the installation be blocked if a newer upgrade of the product is already installed. The type of the operator should be the same as the Type column of the CustomAction table.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%>Value</th>
<th align=left width=88%>Operation</th>
</tr>
<tr valign=top>
<td width=12%>0</td>
<td width=88%>If there is another version of the product already installed, then uninstall it.</td>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>If there is another version of the product already installed, then block the installation.</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>Check if the installed version of the product is greater than the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%>Check if the installed version of the product is less than the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>8</td>
<td width=88%>Check if the installed version of the product equals the ProductVersion column.</td>
</tr>
<tr valign=top>
<td width=12%>16</td>
<td width=88%>If there is another version of the product already installed, then migrate the product settings from it.</td>
</tr>
</table><br>

</dd>
<dt>
Features</dt>
<dd>
The features listed in this column are removed from the installed product when installing a newer version of the product.</dd>
<dt>
Property</dt>
<dd>
The property in this column is set to the product code if the <a href="aref_4rse.htm">FindRelatedProducts action</a> finds any related products already installed. If more than one product is found, this property is set to a semi-colon delimited list of product codes.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The Upgrade table is used by the <a href="aref_4rse.htm">FindRelatedProducts action</a>, <a href="aref_3u0e.htm">BlockInstall action</a>, <a href="aref_9a5q.htm">MigrateFeatureSettings action</a> and the <a href="aref_0omm.htm">RemoveOldProducts action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_verb_table"></a>Verb Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Verb table contains command-verb information associated with file extensions that must be generated as a part of the product advertisement. Each row generates a set of registry keys and values. </p>
<p>
The Verb table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=41%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=41%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=26%>Extension_</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Verb</td>
<td width=41%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=26%>Sequence</td>
<td width=41%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Command</td>
<td width=41%><a href="tref_6b77.htm#_msi_formatted">Formatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=26%>Argument</td>
<td width=41%><a href="tref_6b77.htm#_msi_keyformatted">KeyFormatted</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Extension_</dt>
<dd>
The extension associated with the table row.
<p>
External key to column one of the <a href="tref_219h.htm">Extension table</a>.
</dd>
<dt>
Verb</dt>
<dd>
The verb for the command.</dd>
<dt>
Sequence</dt>
<dd>
The sequence that the commands should appear in. Only verbs for which the Sequence column is non-Null are used to prepare an ordered list for the default value of the shell key.</dd>
<dt>
Command</dt>
<dd>
The command text.</dd>
<dt>
Argument</dt>
<dd>
Value for the command arguments.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This table is referred to when the <a href="aref_1epa.htm">RegisterExtensionInfo action</a> or the <a href="aref_738u.htm">UnregisterExtensionInfo action</a> is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi__columns_table"></a>_Columns Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The _Columns table is a read-only system table that contains the column catalog. All the columns for all tables are listed. You can query this table to find out if a given column exists.</p>
<p>
The _Columns table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Table</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Number</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Name</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Table</dt>
<dd>
The name of the table that contains the column.</dd>
<dt>
Number</dt>
<dd>
The order of the column within the table.</dd>
<dt>
Name</dt>
<dd>
The name of the column.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Because the _Columns table is a system table that cannot be modified through SQL queries, you cannot obtain the primary keys with the <a href="qref_0w8j.htm"><b>MsiDatabaseGetPrimaryKeys</b></a> function or the <a href="vref_1a1w.htm"><b>PrimaryKeys</b> method</a>.</p>
<p>
Only persistent columns are stored in the _Columns table. To determine if a temporary column exists one would need to create a view using a SELECT * statement against the table, then loop through all fields in a record returned by the <a href="qref_8vlb.htm"><b>MsiViewGetColumnInfo</b></a> function with the MSICOLINFO_NAMES option.</p>
<p>&nbsp;</p>

<h1><a name="_msi__required_table"></a>_Required Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The _Required table is a system table that contains the number of primary keys for all the tables in the database. It is only used during the database validation process.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Description</td>
<td width=40%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%></td>
<td width=19%>Y</td>
</tr>
<tr valign=top>
<td width=27%>KeyCount</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Table</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Value</td>
<td width=40%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Description</dt>
<dd>
Description of required value.</dd>
<dt>
KeyCount</dt>
<dd>
Number of primary keys (determines how to parse value string).</dd>
<dt>
Table</dt>
<dd>
Name of table.</dd>
<dt>
Value</dt>
<dd>
Required value.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi__sequence_table"></a>_Sequence Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The _Sequence table is a system table that lists the sequencing restrictions of all actions used in the installer database. Some actions in the installer have pre- and post-conditional actions. This table is used during the database validation process to ensure that all sequenced actions are in the correct order. Sequencing restrictions, if any, are listed in the individual action topics.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=40%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=19%>Nullable</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=40%></td>
<td width=14%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=27%>Action</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>After</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Dependent</td>
<td width=40%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=14%>Y</td>
<td width=19%>N</td>
</tr>
<tr valign=top>
<td width=27%>Optional</td>
<td width=40%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=14%></td>
<td width=19%>N</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Action</dt>
<dd>
Name of action.</dd>
<dt>
After</dt>
<dd>
Boolean for whether action comes after Dependent action.</dd>
<dt>
Dependent</dt>
<dd>
Dependent action.</dd>
<dt>
Optional</dt>
<dd>
Boolean for whether dependent action is optional.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi__tables_table"></a>_Tables Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The _Tables table is a read-only system table that lists all the tables in the database. Query this table to find out if a table exists.</p>
<p>
The _Tables Table has the following column.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=22%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=14%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=44%></td>
<td width=14%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=22%>Name</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=14%>Y</td>
<td width=20%>N</td>
</tr>
</table><br>
<h4>Column</h4>
<dl>
<dt>
Name</dt>
<dd>
Name of one of the tables.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Because the _Tables table is a system table that can not be modified through SQL queries, you cannot obtain the primary keys with the <a href="qref_0w8j.htm"><b>MsiDatabaseGetPrimaryKeys</b></a> function or the <a href="vref_1a1w.htm"><b>PrimaryKeys</b> method</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi__validation_table"></a>_Validation Table</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The _Validation table is a system table that contains the column names and the column values for all of the tables in the database. It is used during the database validation process to ensure that all columns are accounted for and have the correct values. This table is not shipped with the installer database.</p>
<p>
The _Validation table has the following columns.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%>Column</th>
<th align=left width=44%>Type</th>
<th align=left width=13%>Key</th>
<th align=left width=20%>Nullable</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=44%></td>
<td width=13%></td>
<td width=20%></td>
</tr>
<tr valign=top>
<td width=23%>Table</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Column</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%>Y</td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>Nullable</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>N</td>
</tr>
<tr valign=top>
<td width=23%>MinValue</td>
<td width=44%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>MaxValue</td>
<td width=44%><a href="tref_6b77.htm#_msi_doubleinteger">DoubleInteger</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>KeyTable</td>
<td width=44%><a href="tref_6b77.htm#_msi_identifier">Identifier</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>KeyColumn</td>
<td width=44%><a href="tref_6b77.htm#_msi_integer">Integer</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>Category</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>Set</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
<tr valign=top>
<td width=23%>Description</td>
<td width=44%><a href="tref_6b77.htm#_msi_text">Text</a></td>
<td width=13%></td>
<td width=20%>Y</td>
</tr>
</table><br>
<h4>Columns</h4>
<dl>
<dt>
Table</dt>
<dd>
Used to identify a particular table. This key and the Column key form the primary key of the _Validation table.</dd>
<dt>
Column</dt>
<dd>
Used to identify a particular column of the table. This key and the Table key form the primary key of the _Validation table.</dd>
<dt>
Nullable</dt>
<dd>
Identifies whether or not the column may contain a Null value.
<p>
This column may have one of the following values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=14%>String</th>
<th align=left width=86%>Meaning</th>
</tr>
<tr valign=top>
<td width=14%>Y</td>
<td width=86%>Yes, the column may have a Null value.</td>
</tr>
<tr valign=top>
<td width=14%>N</td>
<td width=86%>No, the column may not have a Null value.</td>
</tr>
<tr valign=top>
<td width=14%>@</td>
<td width=86%>The column is a key column for the table, but it may have a Null value.</td>
</tr>
</table><br>

</dd>
<dt>
MinValue</dt>
<dd>
The minimum value allowed. May be the minimum value for an integer or the minimum value for a date or version string.
<p>
Non-negative numbers only.
</dd>
<dt>
MaxValue</dt>
<dd>
The maximum value allowed. May be the maximum value for an integer or the maximum value for a date or version string.
<p>
Non-negative numbers only.
</dd>
<dt>
KeyTable</dt>
<dd>
For an external key column, name of the external table to which the data must link. May be a list of tables separated by semicolons.</dd>
<dt>
KeyColumn</dt>
<dd>
For an external key column, column number in the table specified by KeyTable to which the data must link.
<p>
Range 1-32.
</dd>
<dt>
Category</dt>
<dd>
A category of string or data that defines the type of data contained in the column.
<p>
This string must be one of the types described in <a href="tref_6b77.htm">Column Data Types</a>. The validation table is used to ensure that the table entries are the correct types as specified by the Category column.
</dd>
<dt>
Set</dt>
<dd>
The set of possible values allowed, separated by semicolons. Most often used when dealing with enums.</dd>
<dt>
Description</dt>
<dd>
The description of the data that is stored in the column.

</dd>
</dl>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_database_access"></a>Database Access</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Because the installation database contains all the information about the installation of a product, the Microsoft  Windows  installer provides many standard features that enable the user to access, retrieve, and manipulate the information in the database tables. Database access is required to create a custom installation package.</p>
<p>
The material in this section is primarily for developers who want to write tools that create new installer packages and who therefore need detailed information about the installer's relational database. Complete installer packages are adopted by application developers as an efficient means to manage the installation of their applications. Some knowledge of the installation database is also useful to application developers and administrators who want to modify existing installer packages and installation processes using custom actions. For general information on the installer and component management technology, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
The installer has many standard features for database access. The <a href="qovr_5mlv.htm">About Database Access</a> section gives a general description of installer features providing table querying and manipulation capabilities. For situations that are not addressed directly by these standard access features, additional database access functionality can be created by using <a href="cact_5t2r.htm">Custom Actions</a>.</p>
<p>
The <a href="qovr_4x4j.htm">Accessing Databases</a> section describes common procedures used to get, open, and change information in a database table.</p>
<p>
The <a href="qref_9okl.htm">Database Access Reference</a> describes in detail all of the access functions available to manipulate the installation database. </p>
<p>&nbsp;</p>

<h1><a name="_msi_about_database_access"></a>About Database Access</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The standard database access features provided by the Microsoft  Windows  installer enable the user to customize the installation process to his own requirements. Many customizations require similar kinds of database access, the most common being the retrieval of information from the database, changing or adding information, and finally saving the changes. The following are lists of standard database access features that retrieve, change, and save information in the installation database. These features are implemented using procedures described in the <a href="qovr_4x4j.htm">Accessing Databases</a> section. </p>
<p>
<a href="qovr_8x0l.htm">Access Features That Retrieve Information From The Database</a></p>
<p>
<a href="qovr_8w11.htm">Access Features That Change The Database</a></p>
<p>
<a href="qovr_4v51.htm">Access Features That Save Changes To The Database</a></p>
<p>&nbsp;</p>

<h2><a name="_msi_access_features_that_retrieve_information_from_the_database"></a>Access Features That Retrieve Information From The Database</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> 
<ul>
<li>
Query a table using Structured Query Language (SQL) by <a href="qovr_9cxf.htm">Working with Queries</a> .</li>
<li>
Extract information from tables as text archives by <a href="qovr_4msn.htm">Importing and Exporting</a>.</li>
<li>
Read a particular record field by <a href="qovr_6rg3.htm">Working with Records</a>.</li>
<li>
Check the state of an installer feature or component by <a href="qovr_1vub.htm">Working with Features and Components</a>.</li>
<li>
Locate the source or target of a particular folder by <a href="qovr_3k37.htm">Working with Folder Locations</a>.</li>
<li>
Examine how the user interface appears to the user by <a href="qovr_7uw5.htm">Previewing the User Interface</a>.</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_access_features_that_change_the_database"></a>Access Features That Change The Database</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> 
<ul>
<li>
Instigate a sequence of actions that change the database by <a href="qovr_6ws3.htm">Running Actions</a>.</li>
<li>
Modify a table using Structured Query Language (SQL) by <a href="qovr_9cxf.htm">Working with Queries</a> .</li>
<li>
Enter information into a table as a text archive by <a href="qovr_4msn.htm">Importing and Exporting</a>.</li>
<li>
Control the installation by <a href="qovr_6tdf.htm">working with Installer Properties</a>.</li>
<li>
Create and set new records by <a href="qovr_6rg3.htm">Working with Records</a>. </li>
<li>
Perform database operations by <a href="qovr_2bsj.htm">Working with Transforms</a>. </li>
<li>
Combine the information in two databases by <a href="qovr_6lyr.htm">Merging Databases</a>.</li>
<li>
Modify an installer feature or component by <a href="qovr_1vub.htm">Working with Features and Components</a>.</li>
<li>
Change the target of a folder by <a href="qovr_3k37.htm">Working with Folder Locations</a>.</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_access_features_that_save_changes_to_the_database"></a>Access Features That Save Changes To The Database</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> 
<ul>
<li>
Save the changes made to database tables by <a href="qovr_6fjn.htm">Committing Databases</a>.</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_accessing_databases"></a>Accessing Databases</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Utilizing the standard database access features involves using the following procedures for obtaining a handle and accessing the installation database.  The <a href="qovr_5mlv.htm">About Database Access</a> section provides lists of standard access features that are provided by the installer with links to the appropriate procedures. The following is a list of the most common to use to access the database. Note that before working with a database you must first obtain a handle to it and then to save any changes you must commit the database.
<ul>
<li>
<a href="qovr_0hgl.htm">Obtaining A Database Handle</a></li>
<li>
<a href="qovr_9cxf.htm">Working with Queries</a></li>
<li>
<a href="qovr_6ws3.htm">Running Actions</a></li>
<li>
<a href="qovr_4msn.htm">Importing and Exporting</a></li>
<li>
<a href="qovr_6lyr.htm">Merging Databases</a></li>
<li>
<a href="qovr_2bsj.htm">Working with Transforms</a></li>
<li>
<a href="qovr_6rg3.htm">Working with Records</a></li>
<li>
<a href="qovr_6tdf.htm">Working with Installer Properties</a></li>
<li>
<a href="qovr_3k37.htm">Working with Folder Locations</a></li>
<li>
<a href="qovr_1vub.htm">Working with Features and Components</a></li>
<li>
<a href="qovr_7uw5.htm">Previewing the User Interface</a></li>
<li>
<a href="qovr_6fjn.htm">Committing Databases</a></li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_obtaining_a_database_handle"></a>Obtaining A Database Handle</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Before working with a database you must first obtain a handle to it. </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To access information about an installer database</h5>
<ol>
<li>
You obtain a handle to the database in one of two ways:<ul>
<li>
If an installation is in progress, you get a handle to the active database by calling the <a href="qref_4e1x.htm"><b>MsiGetActiveDatabase</b></a> function. </li>
<li>
Otherwise, to open any specified database, call the <a href="qref_27tx.htm"><b>MsiOpenDatabase</b></a> function. </li>
</ul>
</li>
<li>
Once you have a database open, you can call a variety of functions to obtain information about the database or to manipulate the database. For example, you can:<ul>
<li>
Obtain a record that contains all primary keys of the specified database by calling the <a href="qref_0w8j.htm"><b>MsiDatabaseGetPrimaryKeys</b></a> function. </li>
<li>
Check the current state of a database by calling the <a href="qref_3iw5.htm"><b>MsiGetDatabaseState</b></a> function. With the <b>MsiGetDatabaseState</b> function, you can determine the read/write status for a database or if the handle is valid.</li>
</ul>
</li>
</ol>
<p>&nbsp;</p>

<h2><a name="_msi_committing_databases"></a>Committing Databases</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Changes made to the installation database are not written to the database until you call <a href="qref_3bxw.htm"><b>MsiDatabaseCommit</b></a>.</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To ensure changes made in a database are finalized</h5>
<ol>
<li>
You can check to see if a table will be written when you call <b>MsiDatabaseCommit</b> by calling <a href="qref_5244.htm"><b>MsiDatabaseIsTablePersistent</b></a>. </li>
<li>
Call the <a href="qref_3bxw.htm"><b>MsiDatabaseCommit</b></a> function to finalize changes to the database. </li>
</ol>
<p>
Changes made in a database are accumulated and are not reflected in the actual database until you call <b>MsiDatabaseCommit</b>. Temporary columns or rows are not committed to the database. When a database is closed, all changes made since the last <b>MsiDatabaseCommit</b> are automatically rolled back.</p>
<p>&nbsp;</p>

<h2><a name="_msi_importing_and_exporting"></a>Importing and Exporting</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use the installer to import a text archive into an active database and also to export a database file to a text archive. This can be useful for text-based source control systems.</p>
<p>
To import a text archive into an active database, call the <a href="qref_59pw.htm"><b>MsiDatabaseImport</b></a> function.</p>
<p>
To export a database file to a text archive, call the <a href="qref_4qyc.htm"><b>MsiDatabaseExport</b></a> function.</p>
<p>&nbsp;</p>

<h2><a name="_msi_merging_databases"></a>Merging Databases</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use the installer to add the information in one database into another database by performing a merge. <a href="over_2ysz.htm">Merges and Transforms</a> operate on an entire database, and a merge combines two databases into one. Merges are useful to development teams because they allow the installation database of large application to be divided into smaller parts and then recombined into the complete installation database later.</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To merge several component databases into a single complete database.</h5>
<ul>
<li>
Develop the partial component databases separately.</li>
<li>
Merge each component database into the main product database by calling the <a href="qref_5pd1.htm"><b>MsiDatabaseMerge</b></a> function.</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_transforms"></a>Working with Transforms</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Transforms greatly increase the flexibility of application installation by providing a way of recording changes to a database without altering the original database. Transforms are used extensively for upgrading and patching products. <a href="over_2ysz.htm">Merges and Transforms</a> can operate on entire databases.</p>
<p>
The following procedure describes a scenario in which a transform is used to localize a recent upgrade in the most efficient manner.</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To localize to French a recent upgrade of a product in English:</h5>
<ol>
<li>
Localize to French a snapshot of an English version 1.0 of an application. </li>
<li>
Develop the English version from version 1.0 to version 2.0. </li>
<li>
Create a transform from the English version 1.0 to the English version 2.0 by calling <a href="qref_29rh.htm">MsiDatabaseGenerateTransform</a>.</li>
<li>
Apply this transform to the French version 1.0 to obtain a French version 2.0 by calling <a href="qref_5tyl.htm">MsiDatabaseApplyTransform</a>. </li>
</ol>
<p>
Following the preceding procedure results in a French version that requires minimal work to bring it to French version 2.0. </p>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_queries"></a>Working with Queries</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Because the installer uses a relational database, there are functions for making Structured Query Language (SQL) queries to the database. The following procedure describes how to use SQL to query a database:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To query a database with SQL</h5>
<ol>
<li>
Open the view object, with the appropriate SQL statement, by calling the <a href="qref_5h9z.htm"><b>MsiDatabaseOpenView</b></a> function. <p>
A view object is the logical table created by applying a query to a set of tables. SQL queries must adhere to the <a href="qref_5j20.htm">SQL syntax</a> provided by the installer. This SQL statement can contain parameter markers that are not specified until the view object runs. 
</li>
<li>
Run the view object by calling the <a href="qref_8hgl.htm"><b>MsiViewExecute</b></a> function.</li>
<li>
Retrieve the next record from a view object by calling the <a href="qref_9b54.htm"><b>MsiViewFetch</b></a> function.</li>
<li>
Modify the view object by calling the <a href="qref_0gzd.htm"><b>MsiViewModify</b></a> function.<p>
You can also validate data with <b>MsiViewModify</b> by passing the appropriate flags. If <b>MsiViewModify</b> returns ERROR_INVALID_DATA from a validation request, the underlying data is corrupt. 
</li>
<li>
Obtain detailed error information on the view object by calling the <a href="qref_541e.htm"><b>MsiViewGetError</b></a> function.</li>
<li>
Close the view object by calling the <a href="qref_9fvp.htm"><b>MsiViewClose</b></a> function.</li>
</ol>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_records"></a>Working with Records</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer supplies functions that manipulate the records in an installation database. These functions can be used in conjunction with the functions described in <a href="qovr_9cxf.htm">Working with Queries</a> to make actual changes in a database. </p>
<p>
The following functions create or remove records.
<ul>
<li>
To create a new record for a database, call the <a href="qref_3v50.htm"><b>MsiCreateRecord</b></a> function.</li>
<li>
To clear data from a record, set each field to NULL by calling the <b>MsiRecordClearData</b> function.</li>
</ul>
<p>
The following functions fill specified fields of records:
<ul>
<li>
To set a record to an integer, call the <a href="qref_10vm.htm"><b>MsiRecordSetInteger</b></a> function. </li>
<li>
To set a record to a string, call the <a href="qref_5a07.htm"><b>MsiRecordSetString</b></a> function.</li>
<li>
To insert an entire file into a stream field, call the <a href="qref_4wq5.htm"><b>MsiRecordSetStream</b></a> function.</li>
</ul>
<p>
The following functions read values from specified fields of records:
<ul>
<li>
To read an integer value from a field, call the <a href="qref_1dma.htm"><b>MsiRecordGetInteger</b></a> function.</li>
<li>
To retrieve a string value, call the <a href="qref_202v.htm"><b>MsiRecordGetString</b></a> function.</li>
<li>
To obtain a stream, call the <b>MsiRecordReadStream</b> function.</li>
<li>
To determine if a particular field of a record is NULL, call the <a href="qref_1v58.htm"><b>MsiRecordIsNull</b></a> function.</li>
</ul>
<p>
The following functions are informational record functions:
<ul>
<li>
To get the number of fields a record contains, call the <a href="qref_8ulw.htm"><b>MsiRecordGetFieldCount</b></a> function.</li>
<li>
To get the size of a field, call the <a href="qref_6bj9.htm"><b>MsiRecordDataSize</b></a> function. The return value of <b>MsiRecordDataSize</b> is sensitive to the field type.</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_installer_properties"></a>Working with Installer Properties</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer uses a number of properties to control installation. A list of the properties can be found in the <a href="pref_3mp1.htm">Property Reference</a> topic.</p>
<p>
Functions that get installer properties:
<ul>
<li>
To obtain the current properties, call the <a href="qref_7u2h.htm"><b>MsiGetProperty</b></a> function.</li>
<li>
To obtain the current installation state, call the <a href="qref_8u05.htm"><b>MsiGetMode</b></a> function.</li>
<li>
To obtain the language for the current installation, call the <a href="qref_86xx.htm"><b>MsiGetLanguage</b></a> function.</li>
</ul>
<p>
Functions that set installer properties:
<ul>
<li>
To set properties, call the <a href="qref_56nt.htm"><b>MsiSetProperty</b></a> function.</li>
<li>
To set the installation state, call the <a href="qref_1d9h.htm"><b>MsiSetMode</b></a> function.</li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_running_actions"></a>Running Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use the installer functions to run specific actions or to instigate action sequences. These actions can be <a href="acts_4lmb.htm">standard actions</a>, which ship with the installer, or they can be <a href="cact_5t2r.htm">custom actions</a>. The following procedure describes how to run actions:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run an action sequence</h5>
<ol>
<li>
Run a sequence of actions defined in a table by calling the <a href="qref_6zad.htm"><b>MsiSequence</b></a> function. <p>
The installer queries the indicated table and runs each action if its conditional expression evaluates to TRUE. 
</li>
<li>
Check conditional expressions by calling the <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a> function.</li>
<li>
Run the action by calling the <a href="qref_9woe.htm"><b>MsiDoAction</b></a> function. The action can be a standard action, a custom action, or a user interface dialog box.</li>
<li>
If an error occurred during the execution of this action, call the <a href="qref_163p.htm"><b>MsiProcessMessage</b></a> function. The installer then processes the error.</li>
</ol>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_folder_locations"></a>Working with Folder Locations</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Use the following functions to find the source or target of a specified folder in the <a href="tref_6an9.htm">Directory table</a>:
<ul>
<li>
Obtain the path of the specified source folder by calling the <a href="qref_7g14.htm"><b>MsiGetSourcePath</b></a> function.</li>
<li>
Obtain the path of the specified target folder by calling the <a href="qref_05bc.htm"><b>MsiGetTargetPath</b></a> function. </li>
<li>
Change the target location for a folder with the <a href="qref_4wko.htm"><b>MsiSetTargetPath</b></a> function. </li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_working_with_features_and_components"></a>Working with Features and Components</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are several functions that change the installation of product <a href="over_8p83.htm">components and features</a>. The following procedure describes how to change the features and components.</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To change the installation of features and components</h5>
<ol>
<li>
Set the installation level for a component or feature by calling the <a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a> function. <p>
Each feature in a package is assigned an installation level in the <a href="tref_0a91.htm">Feature table</a>. If the installation level of a feature is lower than the level set by <b>MsiSetInstallLevel</b>, the feature is selected for installation. After <b>MsiSetInstallLevel</b> is called, you can explicitly change whether a feature will be installed. 
</li>
<li>
Determine which states are available for a specified feature by calling the <a href="qref_3k4z.htm"><b>MsiGetFeatureValidStates</b></a> function. </li>
<li>
Obtain the disk space requirements for a specified feature and its child features by calling the <a href="qref_5ub8.htm"><b>MsiGetFeatureCost</b></a> function.</li>
<li>
Obtain the current state of a feature or component by calling the <a href="qref_3wmd.htm"><b>MsiGetFeatureState</b></a> function or the <a href="qref_47l1.htm"><b>MsiGetComponentState</b></a> function. </li>
<li>
Change the state of the feature or component with the <a href="qref_9ejp.htm"><b>MsiSetFeatureState</b></a> function or the <a href="qref_3s6d.htm"><b>MsiSetComponentState</b></a> function. </li>
</ol>
<p>&nbsp;</p>

<h2><a name="_msi_previewing_the_user_interface"></a>Previewing the User Interface</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer stores all information about the <a href="hand_0alh.htm">user interface</a> in the tables of the installation database. To facilitate the design of the user interface the installer also provides a preview mode for viewing this information. The following procedure describes how to enable the user interface preview mode and display the current appearance of dialog boxes and billboards. </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To view the user interface in the preview mode:</h5>
<ol>
<li>
Enable the preview mode by calling the <a href="qref_4ek7.htm"><b>MsiEnableUIPreview</b></a> function. </li>
<li>
Display the particular dialog boxes by calling the <a href="qref_1tpj.htm"><b>MsiPreviewDialog</b></a> function.</li>
<li>
Display particular billboards by calling the <a href="qref_9s2s.htm"><b>MsiPreviewBillboard</b></a> function.</li>
</ol>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_database_access_reference"></a>Database Access Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and developers who want to learn more about the Microsoft  Windows  installer database tables. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
You can use the installer access functions to access the database and the installation process. These functions should only be used by custom installation actions and authoring tools. Some of the installer access functions require SQL query strings for querying the database. Queries must adhere to the installer <a href="qref_5j20.htm">SQL syntax</a>.</p>
<p>
This topic lists the installer database access functions by category.</p>

<h4><a name="_msi_general_database_access_functions"></a>General Database Access Functions</h4>
<p>
You can use the following general access functions in your application:</p>
<p>
<a href="qref_3bxw.htm"><b>MsiDatabaseCommit</b></a></p>
<p>
<a href="qref_0w8j.htm"><b>MsiDatabaseGetPrimaryKeys</b></a></p>
<p>
<a href="qref_5244.htm"><b>MsiDatabaseIsTablePersistent</b></a></p>
<p>
<a href="qref_5h9z.htm"><b>MsiDatabaseOpenView</b></a></p>
<p>
<a href="qref_4e1x.htm"><b>MsiGetActiveDatabase</b></a></p>
<p>
<a href="qref_27tx.htm"><b>MsiOpenDatabase</b></a></p>
<p>
<a href="qref_9fvp.htm"><b>MsiViewClose</b></a></p>
<p>
<a href="qref_8hgl.htm"><b>MsiViewExecute</b></a></p>
<p>
<a href="qref_9b54.htm"><b>MsiViewFetch</b></a></p>
<p>
<a href="qref_541e.htm"><b>MsiViewGetError</b></a></p>
<p>
<a href="qref_0gzd.htm"><b>MsiViewModify</b></a></p>

<h4><a name="_msi_database_management_functions"></a>Database Management Functions</h4>
<p>
You can use the following access functions to manage the database:</p>
<p>
<a href="qref_5zlb.htm"><b>MsiCreateTransformSummaryInfo</b></a></p>
<p>
<a href="qref_5tyl.htm"><b>MsiDatabaseApplyTransform</b></a></p>
<p>
<a href="qref_4qyc.htm"><b>MsiDatabaseExport</b></a></p>
<p>
<a href="qref_29rh.htm"><b>MsiDatabaseGenerateTransform</b></a></p>
<p>
<a href="qref_59pw.htm"><b>MsiDatabaseImport</b></a></p>
<p>
<a href="qref_5pd1.htm"><b>MsiDatabaseMerge</b></a></p>
<p>
<a href="qref_3iw5.htm"><b>MsiGetDatabaseState</b></a></p>

<h4><a name="_msi_record_processing_functions"></a>Record Processing Functions</h4>
<p>
You can use the following functions to process database records:</p>
<p>
<a href="qref_3v50.htm"><b>MsiCreateRecord</b></a></p>
<p>
<a href="qref_1l9d.htm"><b>MsiRecordClearData</b></a></p>
<p>
<a href="qref_6bj9.htm"><b>MsiRecordDataSize</b></a></p>
<p>
<a href="qref_8ulw.htm"><b>MsiRecordGetFieldCount</b></a></p>
<p>
<a href="qref_1dma.htm"><b>MsiRecordGetInteger</b></a></p>
<p>
<a href="qref_202v.htm"><b>MsiRecordGetString</b></a></p>
<p>
<a href="qref_1v58.htm"><b>MsiRecordIsNull</b></a></p>
<p>
<a href="qref_1vsd.htm"><b>MsiRecordReadStream</b></a></p>
<p>
<a href="qref_10vm.htm"><b>MsiRecordSetInteger</b></a></p>
<p>
<a href="qref_4wq5.htm"><b>MsiRecordSetStream</b></a></p>
<p>
<a href="qref_5a07.htm"><b>MsiRecordSetString</b></a></p>

<h4><a name="_msi_summary_information_property_functions"></a>Summary Information Property Functions</h4>
<p>
You can use the following functions with the summary information properties:</p>
<p>
<a href="qref_5dpq.htm"><b>MsiGetSummaryInformation</b></a></p>
<p>
<a href="qref_1ypl.htm"><b>MsiSummaryInfoGetProperty</b></a></p>
<p>
<a href="qref_4z5g.htm"><b>MsiSummaryInfoGetPropertyCount</b></a></p>
<p>
<a href="qref_65ys.htm"><b>MsiSummaryInfoPersist</b></a></p>
<p>
<a href="qref_9bax.htm"><b>MsiSummaryInfoSetProperty</b></a></p>

<h4><a name="_msi_installer_state_access_functions"></a>Installer State Access Functions</h4>
<p>
You can use the following functions to change or monitor the installer state:</p>
<p>
<a href="qref_86xx.htm"><b>MsiGetLanguage</b></a></p>
<p>
<a href="qref_7jhg.htm"><b>MsiGetLastErrorRecord</b></a></p>
<p>
<a href="qref_8u05.htm"><b>MsiGetMode</b></a></p>
<p>
<a href="qref_7u2h.htm"><b>MsiGetProperty</b></a></p>
<p>
<a href="qref_56nt.htm"><b>MsiSetProperty</b></a></p>
<p>
<a href="qref_1d9h.htm"><b>MsiSetMode</b></a></p>

<h4><a name="_msi_installer_action_functions"></a>Installer Action Functions</h4>
<p>
You can use the following functions to access the installer actions:</p>
<p>
<a href="qref_9woe.htm"><b>MsiDoAction</b></a></p>
<p>
<a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a></p>
<p>
<a href="qref_163p.htm"><b>MsiProcessMessage</b></a></p>
<p>
<a href="qref_6zad.htm"><b>MsiSequence</b></a></p>

<h4><a name="_msi_installer_location_functions"></a>Installer Location Functions</h4>
<p>
You can use the following functions to access the installer folder location:</p>
<p>
<a href="qref_7g14.htm"><b>MsiGetSourcePath</b></a></p>
<p>
<a href="qref_05bc.htm"><b>MsiGetTargetPath</b></a></p>
<p>
<a href="qref_4wko.htm"><b>MsiSetTargetPath</b></a></p>

<h4><a name="_msi_installer_selection_functions"></a>Installer Selection Functions</h4>
<p>
You can use the following functions to access the installer selection state:</p>
<p>
<a href="qref_47l1.htm"><b>MsiGetComponentState</b></a></p>
<p>
<a href="qref_5ub8.htm"><b>MsiGetFeatureCost</b></a></p>
<p>
<a href="qref_3wmd.htm"><b>MsiGetFeatureState</b></a></p>
<p>
<a href="qref_3k4z.htm"><b>MsiGetFeatureValidStates</b></a></p>
<p>
<a href="qref_3s6d.htm"><b>MsiSetComponentState</b></a></p>
<p>
<a href="qref_9ejp.htm"><b>MsiSetFeatureState</b></a></p>
<p>
<a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a></p>
<p>
<a href="qref_6ucl.htm"><b>MsiVerifyDiskSpace</b></a></p>

<h4><a name="_msi_user_interface_functions"></a>User Interface Functions</h4>
<p>
You can use the following functions to preview user interface dialog boxes:</p>
<p>
<a href="qref_4ek7.htm"><b>MsiEnableUIPreview</b></a></p>
<p>
<a href="qref_9s2s.htm"><b>MsiPreviewBillboard</b></a></p>
<p>
<a href="qref_1tpj.htm"><b>MsiPreviewDialog</b></a></p>
<p>
All functions support both ANSI and Unicode calls. To use these functions, include MsiQuery.h and link with Msi.lib.</p>
<h4>Installation Functions</h4>
<p>
In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the <a href="msi_8vqd.htm">Installer Function Reference</a> section.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sql_syntax"></a>SQL Syntax</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SQL query strings are restricted to the following format.
<ul>
<li>
To select a group of records.<p>
<b>SELECT</b> [DISTINCT]{column-list} <b>FROM</b> {table-list} [<b>WHERE</b> {operation-list}] [<b>ORDER BY </b>{column-list}] 
</li>
<li>
To delete records from a table.<p>
<b>DELETE FROM</b> {table} [<b>WHERE</b> {operation-list}]
</li>
<li>
To modify existing records in a table.<p>
<b>UPDATE</b> {table-list} <b>SET</b> {column}= {constant} [, {column}= {constant}][, ...] [<b>WHERE</b> {operation-list}]
</li>
<li>
To add records to a table.<p>
<b>INSERT INTO</b> {table} ({column-list}) <b>VALUES</b> ({constant-list}) [<b>TEMPORARY</b>]
</li>
<li>
To add a table.<p>
<b>CREATE TABLE </b>{table} ( {column} [<b>CHAR</b> [( {size} )] | <b>CHARACTER</b> [( {size} )] | <b>LONGCHAR </b> | <b>SHORT</b> | <b>INT</b> | <b>INTEGER</b> | <b>LONG</b> | <b>OBJECT</b> ] [<b>NOT NULL</b>] [<b>TEMPORARY</b>][<b>LOCALIZABLE</b>] [, column...][, ...] <b>PRIMARY KEY </b>column [, column][, ...] )[<b>HOLD</b>]
</li>
<li>
To remove a table.<p>
<b>DROP TABLE</b> {table}
</li>
<li>
To add a column.<p>
<b>ALTER TABLE</b> {table} <b>ADD </b> {column} [<b>CHAR</b> [( {size} )] | <b>CHARACTER</b> [( {size} )] | <b>LONGCHAR</b>  | <b>SHORT</b> | <b>INT</b> | <b>INTEGER</b> | <b>LONG</b> | <b>OBJECT</b> ] [<b>NOT</b> <b>NULL</b>] [<b>TEMPORARY</b>][<b>LOCALIZABLE</b>][<b>HOLD</b>]
</li>
<li>
To hold and free temporary tables.<p>
<b>ALTER TABLE</b> {table name} <b>HOLD</b>
<p>
<b>ALTER TABLE</b> {table name} <b>FREE</b>
<p>
The user can use the commands <b>HOLD</b> and <b>FREE</b> to control the life period of a temporary table or a temporary column. The hold count on a table is incremented for every SQL <b>HOLD</b> operation on that table and decremented for every SQL <b>FREE</b> operation on the table. When the last hold count is released on a table, all temporary columns become inaccessible. If all columns are temporary, the table becomes inaccessible.
</li>
</ul>
<p>
Optional parameters are shown enclosed in brackets [ ]. When several choices are listed, the optional parameters are separated by a vertical bar.</p>
<p>
A {constant} is either a string or an integer. A string must be enclosed in single quote marks 'example'. A {constant-list} is a comma-delimited list of one or more constants.</p>
<p>
The <b>LOCALIZABLE</b> option sets a column attribute that indicates the column needs to be localized.</p>
<p>
A {column} is a columnar reference to a value in a field of a table. </p>
<p>
A {marker} is a parameter reference to a value supplied by a record submitted with the query. It is represented in the SQL statement by a question mark ?. For information regarding the use of parameters, see either the <a href="qref_8hgl.htm"><b>MsiViewExecute</b></a> function or the <a href="vref_2k6c.htm">Execute method</a>.</p>
<p>
A <b>WHERE </b>{operation-list} clause is optional and is a grouping of operations to be used to filter the selection. The operations must be of the following types:
<ul>
<li>
{column} = {column}</li>
<li>
{column} = | &lt;&gt; | &gt; | &lt; | &gt;= | &lt;=  {constant} </li>
<li>
{column} = | &lt;&gt; | &gt; | &lt; | &gt;= | &lt;=  {marker} </li>
<li>
{column} is null</li>
<li>
{column} is not null</li>
</ul>
<p>
For string values, only the = or &lt;&gt; operations are possible. Object value comparisons are limited to IS NULL and IS NOT NULL.</p>
<p>
Individual operations can be grouped by <b>AND</b> or <b>OR</b> operators. Ordering can be imposed by use of parentheses ( ).</p>
<p>
The <b>ORDER BY </b>clause is optional and causes an initial delay during sorting. Ordering by strings will group identical strings together, but it will not alphabetize the strings.</p>
<p>
The <b>DISTINCT</b> clause is optional and does not repeat identical records in the returned result set.</p>
<p>
A {table-list} is a comma-delimited list of one or more table names referred to as {table} in the join. Table names that clash with SQL keywords must be enclosed in two grave accent marks `` (ASCII value 96). Table names are limited to 31 characters and cannot include a period.</p>
<p>
A {column-list} is a comma-delimited list of one or more table columns referred to as {column} selected. Ambiguous columns may be further qualified as {tablename.column}. Column names that clash with SQL keywords must be enclosed in quotation marks " ". If the column is qualified as {tablename.column} and if there is a need to escape the identifier, the table name and the column must be individually escaped as {`tablename`.`column`}. Column names cannot include a period.</p>
<p>
The table and column names are case-sensitive, even if ODBC databases are used. However, SQL keywords are not case-sensitive. Only inner joins are supported, specified by a comparison of columns from different tables.</p>
<p>
Tables may contain from 1 to 32 columns. Table and column names are not constrained except that they are limited to 31 characters. Columns that are part of the primary key(s) for a table must be defined first in priority order, followed by any non-primary key columns. Persistent columns must be defined before temporary columns. The sort sequence of a text column is undefined, however, identical text values will always group together.</p>
<p>
Tables may not contain more than one column of type 'object'.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msicreaterecord"></a>MsiCreateRecord</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiCreateRecord</b> function creates a new record object with the specified number of fields.</p>
<pre><code><b>MSIHANDLE MsiCreateRecord(
</b>  <b>unsigned int</b> <i>cParams</i>  // the number of data fields
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>cParams</i></dt>
<dd>
Specifies the number of fields the record will have. This value is limited by memory.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is handle to a new record object.</p>
<p>
If the function fails, the return value is NULL.</p>
<h4>Remarks</h4>
<p>
Field 0 of the record object created by the <b>MsiCreateRecord</b> function is used for format strings and operation codes and is not included in the count specified by <i>cParams</i>. All fields are initialized to NULL.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msicreatetransformsummaryinfo"></a>MsiCreateTransformSummaryInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiCreateTransformSummaryInfo function creates summary information of an existing transform to include validation and error conditions. Execution of this function sets the error record, accessible via <a href="qref_7jhg.htm">MsiGetLastErrorRecord</a></p>
<pre><code><b>UINT MsiCreateTransformSummaryInfo(
</b>  <b>MSIHANDLE</b> <i>hDatabase,         </i> // database handle
  <b>MSIHANDLE</b> <i>hDatabaseReference</i><b>,</b> // reference database without changes
  <b>LPCTSTR</b> <i>szTransformFile</i><b>,      </b>// name of generated transform file
  <b>int</b> <i>iErrorConditions</i><b>,</b>         // conditions treated as errors when 
                                // transform applied
  <b>int</b> <i>iValidation               </i>//<i> </i>properties to be validated when
                                // transform applied
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database that contains the new database Summary Information.</dd>
<dt>
<i>hDatabaseReference</i></dt>
<dd>
Handle to the database that contains the original Summary Information.</dd>
<dt>
<i>SzTransformFile</i></dt>
<dd>
The name of the transform that the Summary Information is being added to.</dd>
<dt>
<i>iErrorConditions</i></dt>
<dd>
The error conditions that should be suppressed when the transform is applied. Choose either:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=51%>0x0000</td>
<td width=49%>None of the following conditions.</td>
</tr>
</table><br>


<p>
or one or more of the following values:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0x0001</td>
<td width=79%>Adding a row that already exists.</td>
</tr>
<tr valign=top>
<td width=21%>0x0002</td>
<td width=79%>Deleting a row that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=21%>0x0004</td>
<td width=79%>Adding a table that already exists.</td>
</tr>
<tr valign=top>
<td width=21%>0x0008</td>
<td width=79%>Deleting a table that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=21%>0x0010</td>
<td width=79%>Updating a row that doesn't exist.</td>
</tr>
</table><br>

</dd>
<dt>
<i>iValidation</i></dt>
<dd>
Specifies those properties to be validated to verify the transform can be applied to the database. This parameter can be one or more of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0x0000 - </td>
<td width=79%>Validate no properties.</td>
</tr>
<tr valign=top>
<td width=21%>0x0001 - </td>
<td width=79%>Default language must match base database.</td>
</tr>
<tr valign=top>
<td width=21%>0x0002 - </td>
<td width=79%>Product must match base database.</td>
</tr>
<tr valign=top>
<td width=21%>0x0004 - </td>
<td width=79%>Platform must match base database.</td>
</tr>
</table><br>


<p>
Validate product version flags.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0x0008 - </td>
<td width=79%>Check major version only.</td>
</tr>
<tr valign=top>
<td width=21%>0x0010 - </td>
<td width=79%>Check major and minor versions only.</td>
</tr>
<tr valign=top>
<td width=21%>0x0020 - </td>
<td width=79%>Check major, minor, and update versions.</td>
</tr>
</table><br>


<p>
Product version relationship flags.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0x0040 - </td>
<td width=79%>Applied database version &lt;  base database version.</td>
</tr>
<tr valign=top>
<td width=21%>0x0080 - </td>
<td width=79%>Applied database version &lt;= base database version.</td>
</tr>
<tr valign=top>
<td width=21%>0x0100 - </td>
<td width=79%>Applied database version =  base database version.</td>
</tr>
<tr valign=top>
<td width=21%>0x0200 - </td>
<td width=79%>Applied database version &gt;= base database version.</td>
</tr>
<tr valign=top>
<td width=21%>0x0400 - </td>
<td width=79%>Applied database version &gt;  base database version.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_OPEN_FAILED</dt>
<dd>
The transform storage file could not be opened.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabaseapplytransform"></a>MsiDatabaseApplyTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseApplyTransform</b> function applies a transform to a database.</p>
<pre><code><b>UINT MsiDatabaseApplyTransform(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>     // database handle
  <b>LPCTSTR</b> <i>szTransformFile</i><b>,</b> // name of transform file
  <b>int</b> <i>iErrorConditions</i>     // error conditions to be suppressed
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to database to transform.</dd>
<dt>
<i>szTransformFile</i></dt>
<dd>
Specifies the name of the transform file to apply.</dd>
<dt>
<i>iErrorConditions</i></dt>
<dd>
Error conditions that should be suppressed. This parameter (can or must) be (one, any, one or more) of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Value</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%>0x0001</td>
<td width=84%>Adding a row that already exists.</td>
</tr>
<tr valign=top>
<td width=16%>0x0002</td>
<td width=84%>Deleting a row that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=16%>0x0004</td>
<td width=84%>Adding a table that already exists.</td>
</tr>
<tr valign=top>
<td width=16%>0x0008</td>
<td width=84%>Deleting a table that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=16%>0x0010</td>
<td width=84%>Updating a row that doesn't exist.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INSTALL_TRANSFORM_FAILURE</dt>
<dd>
The transform could not be applied.</dd>
<dt>
ERROR_OPEN_FAILED</dt>
<dd>
The transform storage file could not be opened.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseApplyTransform</b> function delays transforming tables until it is necessary. Any tables to be added or dropped are processed immediately. However, changes to the existing table are delayed until the table is loaded or the database is committed.</p>
<p>
An error occurs if <b>MsiDatabaseApplyTransform</b> is called when tables have already been loaded and saved to storage.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for filenames or paths.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabasecommit"></a>MsiDatabaseCommit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseCommit</b> function commits changes to a database.</p>
<pre><code><b>UINT MsiDatabaseCommit(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i>    // database handle
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle is in an invalid state.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseCommit</b> function finalizes the persistent form of the database. All persistent data is then written to the writable database. No temporary columns or rows are written. The <b>MsiDatabaseCommit</b> function has no effect on a database that is opened as read-only. You can call this function multiple times to save the current state of tables loaded into memory. When the database is finally closed, any changes made after the database is committed are rolled back. This function is normally called prior to shutdown when all database changes have been finalized.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabaseexport"></a>MsiDatabaseExport</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseExport</b> function exports an installer table from an open database to a text archive file.</p>
<pre><code><b>UINT MsiDatabaseExport(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>    // database handle
  <b>LPCTSTR</b> <i>szTableName</i><b>,</b>    // name of table to export
  <b>LPCTSTR</b> <i>szFolderPath</i><b>,</b>   // folder containing archive files
  <b>LPCTSTR</b> <i>szFileName</i>      // name of exported table archive file
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the table to export.</dd>
<dt>
<i>szFolderPath</i></dt>
<dd>
Specifies the name of the folder that contains archive files.</dd>
<dt>
<i>szFileName</i></dt>
<dd>
Specifies the name of the exported table archive file.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_PATHNAME</dt>
<dd>
An invalid path was passed to the function.</dd>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If a table contains streams, <b>MsiDatabaseExport</b> exports each stream to a separate file.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabasegeneratetransform"></a>MsiDatabaseGenerateTransform</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseGenerateTransform</b> function generates a transform file of differences between two databases. A transform is a way of recording changes to a database without altering the original database.</p>
<pre><code><b>UINT MsiDatabaseGenerateTransform(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>          // database handle
  <b>MSIHANDLE</b> <i>hDatabaseReference</i><b>,</b> // base database to reference changes
  <b>LPCTSTR</b> <i>szTransformFile</i><b>,</b>      // name of generated transform file
  <b>int</b> <i>iReserved1</i><b>,</b><i>      </i>         // reserved argument, not used
  <b>int</b> <i>iReserved2 </i>               // reserved argument, not used
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database that includes the changes.</dd>
<dt>
<i>hDatabaseReference</i></dt>
<dd>
Handle to the database that does not include the changes.</dd>
<dt>
<i>szTransformFile</i></dt>
<dd>
The name of the generated transform file. This is optional.</dd>
<dt>
<i>iReserved1</i></dt>
<dd>
This is a reserved argument and is not used.</dd>
<dt>
<i>iReserved2</i></dt>
<dd>
This is a reserved argument and is not used.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_NO_DATA</dt>
<dd>
The two databases are identical.</dd>
<dt>
ERROR_CREATE_FAILED</dt>
<dd>
The storage for the transform file could not be created.</dd>
<dt>
ERROR_INSTALL_TRANSFORM_FAILURE</dt>
<dd>
The transform could not be generated.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
NOERROR</dt>
<dd>
If szTransformFile is NULL, then this is returned if differences are found.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To generate a difference file between two databases, use the <b>MsiDatabaseGenerateTransform</b> function. A transform contains information regarding insertion and deletion of columns and rows. The validation flags are stored in the summary information stream of the transform file.</p>
<p>
For tables that exist in both databases, the only difference between the two schemas that is allowed is the addition of columns to the end of the reference table. You cannot add primary key columns to a table or change the order or names or column definitions of the existing columns as defined in the base table. In other words, if neither table contains data and columns are removed from the reference table, the resulting table is identical to the base table.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for these filenames or paths.</p>
<p>
This function does not generate a Summary Information stream. Use MsiCreateTransformSummaryInfo to create the stream for an existing transform.</p>
<p>
If <i>szTransformFile </i>is NULL, you can test whether two databases are identical without creating a transform. If the databases are identical, ERROR_NO_DATA is returned, NOERROR is returned if differences are found.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabasegetprimarykeys"></a>MsiDatabaseGetPrimaryKeys</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseGetPrimaryKeys</b> function returns a record containing the names of all the primary key columns.</p>
<pre><code><b>UINT MsiDatabaseGetPrimaryKeys(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>   // database handle
  <b>LPCTSTR</b> <i>szTableName</i><b>,</b>   // name of table
  <b>MSIHANDLE</b> <i>*phRecord</i>    // handle for record
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the table from which to obtain primary key names.</dd>
<dt>
<i>phRecord</i></dt>
<dd>
Pointer to the handle of the record that holds the primary key names.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_INVALID_TABLE</dt>
<dd>
An invalid table was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The field count of the returned record is the count of primary key columns returned by the <b>MsiDatabaseGetPrimaryKeys</b> function. The returned record contains the table name in Field (0) and the column names that make up the primary key names in succeeding fields. These primary key names correspond to the column numbers for the fields.</p>
<p>
This function cannot be used with the <a href="tref_2fl1.htm">_Tables table</a> or the <a href="tref_4rj9.htm">_Columns table</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabaseimport"></a>MsiDatabaseImport</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseImport</b> function imports an installer text archive table into an open database.</p>
<pre><code><b>UINT MsiDatabaseImport(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>    // database handle
  <b>LPCTSTR</b> <i>szFolderPath</i><b>,</b>   // folder containing archive files
  <b>LPCTSTR</b> <i>szFileName</i>      // table archive file to import
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>szFolderPath</i></dt>
<dd>
Specifies the path to the folder containing archive files.</dd>
<dt>
<i>szFileName</i></dt>
<dd>
Specifies the name of the file to import.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_PATHNAME</dt>
<dd>
An invalid path was passed to the function.</dd>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When you use the <b>MsiDatabaseImport</b> function to import a text archive table named _SummaryInformation into an installer database, the "05SummaryInformation" stream is written. This stream contains standard properties that are defined by COM and browseable by Windows  Explorer. The table rows consisting of pairs of property ID numbers with corresponding data values are written to the property stream. </p>
<p>
When you use the <b>MsiDatabaseImport</b> function to import a text archive table named _SummaryInformation into an ODBC database, a normal table is created. If the data is a valid integer, the database interprets this integer as an integer property. If the data can be parsed as a date or date/time value (consisting of digits separated by slashes), the database interprets this value as a data/time value. Otherwise, the database interprets the data as a string value. Date values can have two formats: yyyy/mm/dd (time is entered as 0) or yyyy/mm/dd/hh/mm/ss (24-hour time). The summary information is customarily generated for new files by the release build process.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabaseistablepersistent"></a>MsiDatabaseIsTablePersistent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseIsTablePersistent</b> function returns an enumeration describing the state of a particular table.</p>
<pre><code><b>UINT MsiDatabaseIsTablePersistent(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>   // database handle
  <b>LPCTSTR</b> <i>szTableName   </i> // name of relevant table
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database to which the relevant table belongs.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the relevant table.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MSICONDITION_ERROR </dt>
<dd>
An invalid handle or invalid parameter was passed to the function.</dd>
<dt>
MSICONDITION_FALSE </dt>
<dd>
The table is temporary.</dd>
<dt>
MSICONDITION_NONE  </dt>
<dd>
The table is unknown.</dd>
<dt>
MSICONDITION_TRUE</dt>
<dd>
The table is persistent.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabasemerge"></a>MsiDatabaseMerge</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseMerge</b> function merges two databases together, allowing duplicate rows.</p>
<pre><code><b>UINT MsiDatabaseMerge(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>      // database handle
  <b>MSIHANDLE</b> <i>hDatabaseMerge</i><b>,</b> // database to be merged into <i>hDatabase</i>
  <b>LPCTSTR</b> <i>szTableName</i>       // name of persistent table to receive rows
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the base database.</dd>
<dt>
<i>hDatabaseMerge</i></dt>
<dd>
Handle to the database to merge into the base database.</dd>
<dt>
<i>szTableName</i></dt>
<dd>
Specifies the name of the table to receive merge conflict information.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
Merge conflicts were reported.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_TABLE</dt>
<dd>
An invalid table was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseMerge</b> function merges two databases. The data in the base database dominates in any merge conflicts. If tables of the same name in both databases do not match in the number of primary keys, column types, number of columns, or column names, or if the tables share the same primary key names but the data in the other columns differs, the <b>MsiDatabaseMerge</b> function fails. If merge conflicts are reported, the <a href="tref_5dk5.htm">Error table</a> that is created contains two columns. The first column specifies the name of the table that has merge conflicts. The second column contains the number of rows in the table that has merge conflicts.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabaseopenview"></a>MsiDatabaseOpenView</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDatabaseOpenView</b> function prepares a database query and creates a view object.</p>
<pre><code><b>UINT MsiDatabaseOpenView(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>   // database handle
  <b>LPCTSTR</b> <i>szQuery</i><b>,</b>       // SQL query to be prepared
  <b>MSIHANDLE</b> *<i>phView</i>      // returned view if TRUE
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database to which you want to open a view object.</dd>
<dt>
<i>szQuery</i></dt>
<dd>
Specifies a SQL query string for querying the database. For correct syntax, see <a href="qref_5j20.htm">SQL Syntax</a>.</dd>
<dt>
<i>phView</i></dt>
<dd>
Pointer to a handle for the returned view.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_QUERY_SYNTAX</dt>
<dd>
An invalid SQL query string was passed to the function.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded, and the handle is to a view object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDatabaseOpenView</b> function opens a view object for a database. You must open a view object for a database before performing any execution or fetching.</p>
<p>
If an error occurs, you can call <a href="qref_7jhg.htm"><b>MsiGetLastErrorRecord</b></a> for more information.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msidoaction"></a>MsiDoAction</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiDoAction</b> function executes a built-in action, custom action, or user-interface wizard action.</p>
<pre><code><b>UINT MsiDoAction(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>    // installer handle
  <b>LPCTSTR</b> <i>szAction</i>       // action
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szAction</i></dt>
<dd>
Specifies the action to execute.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_FUNCTION_NOT_CALLED</dt>
<dd>
The action was not found.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
The action failed.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The user suspended the installation.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user canceled the action.</dd>
<dt>
ERROR_INVALID_DATA</dt>
<dd>
A failure occurred while calling the custom action.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle state was invalid.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
The action indicates that the remaining actions should be skipped.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiDoAction</b> function executes the action that corresponds to the name supplied. If the name is not recognized by the engine as a built-in action or as a custom action in the <a href="tref_71b9.htm">CustomAction table</a>, the name is passed to the user-interface handler object, which can invoke a function or a dialog box. If a NULL action name is supplied, the engine uses the upper-case value of the ACTION property as the action to perform. If no property value is defined, the default action is performed, defined as "INSTALL".</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_action_functions">Installer Action Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msienableuipreview"></a>MsiEnableUIPreview</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEnableUIPreview</b> function enables preview mode of the user interface to facilitate authoring of user-interface dialog boxes.</p>
<pre><code><b>UINT MsiEnableUIPreview(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>  // database handle
  <b>MSIHANDLE</b> <i>*phPreview</i>  // returned handle for UI preview capability
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>phPreview</i></dt>
<dd>
Pointer to a returned handle for user-interface preview capability.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
Bad parameter.</dd>
<dt>
ERROR_OUTOFMEMORY</dt>
<dd>
Out of memory.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_user_interface_functions">User Interface Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msievaluatecondition"></a>MsiEvaluateCondition</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiEvaluateCondition</b> function evaluates a conditional expression containing property names and values.</p>
<pre><code><b>MSICONDITION MsiEvaluateCondition(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>    // installer handle
  <b>LPCTSTR</b> <i>szCondition</i>    // conditional expression
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szCondition</i></dt>
<dd>
Specifies the conditional expression.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MSICONDITION_ERROR</dt>
<dd>
An invalid handle was passed to the function, or the conditional expression has a syntax error.</dd>
<dt>
MSICONDITION_FALSE</dt>
<dd>
An expression that evaluates to FALSE was passed to the function.</dd>
<dt>
MSICONDITION_NONE</dt>
<dd>
No expression was passed to the function.</dd>
<dt>
MSICONDITION_TRUE</dt>
<dd>
An expression that evaluates to TRUE was passed to the function.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiEvaluateCondition</b> function uses the following conditional statement syntax.</p>
<p>
value ::= symbol | literal | integer</p>
<p>
comparison-operator ::= <b>&lt;</b> | <b>&gt;</b> | <b>&lt;=</b> | <b>&gt;=</b> | <b>=</b> | <b>&lt;&gt;</b></p>
<p>
term ::= value | value comparison-operator value | <b>(</b> expression <b>)</b>|</p>
<p>
Boolean-factor ::= term | <b>NOT</b> term</p>
<p>
Boolean-term ::= Boolean-factor | Boolean-factor <b>AND</b> term</p>
<p>
expression ::= Boolean-term | Boolean-term <b>OR</b> expression</p>
<p>
symbol ::= property | %environment-variable | $component-action | ?component-state | &amp;feature-action | !feature-state</p>
<p>
All symbol names and values are case-sensitive, except environment variable names, which are not case-sensitive.</p>
<p>
Operators are not case-sensitive.</p>
<p>
Literal text must be enclosed in double quotes.</p>
<p>
Floating point numeric values are not supported.</p>
<p>
Operators and precedence: same as BASIC and SQL languages.</p>
<p>
Arithmetic operators are not supported.</p>
<p>
Supported operators: OR AND NOT Xor Eqv Imp &lt; &lt;= = &lt;&gt; &gt;= &gt; ().</p>
<p>
Non-existent property values are treated as empty strings.</p>
<p>
Comparison of an integer with a string or property value that cannot be converted to an integer is always iecFalse, except for the comparison operator '&lt;&gt;', which returns iecTrue.</p>
<p>
Parentheses can be used to override operator precedence.</p>
<p>
For string comparisons, a tilde '<b><code>~</code></b>' prefixed to the operator performs a comparison that is not case-sensitive.</p>
<p>
The following table shows the prefixes to use to access various system and installer information for use in conditional expressions.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Symbol type</th>
<th align=left width=16%>Prefix</th>
<th align=left width=53%>Value</th>
</tr>
<tr valign=top>
<td width=31%>Installer property</td>
<td width=16%>(none)</td>
<td width=53%>Value of property (<a href="tref_21d1.htm">Property table</a>).</td>
</tr>
<tr valign=top>
<td width=31%>Environment variable</td>
<td width=16%><b><code>%</code></b></td>
<td width=53%>Value of environment variable.</td>
</tr>
<tr valign=top>
<td width=31%>Component table key</td>
<td width=16%><b><code>$</code></b></td>
<td width=53%>Action state of the component.</td>
</tr>
<tr valign=top>
<td width=31%>Component table key</td>
<td width=16%><b><code>?</code></b></td>
<td width=53%>Installed state of the component.</td>
</tr>
<tr valign=top>
<td width=31%>Feature table key</td>
<td width=16%><b><code>&amp;</code></b></td>
<td width=53%>Action state of the feature.</td>
</tr>
<tr valign=top>
<td width=31%>Feature table key</td>
<td width=16%><b><code>!</code></b></td>
<td width=53%>Installed state of the feature.</td>
</tr>
</table><br>
<p>
The following table shows the logical operators used by the <b>MsiEvaluateCondition</b> function, in high to low order.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Operator</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%><b>Not</b> -</td>
<td width=84%>Prefix unary operator; inverts state of following term.</td>
</tr>
<tr valign=top>
<td width=16%><b>And</b> - </td>
<td width=84%>TRUE if both terms are TRUE.</td>
</tr>
<tr valign=top>
<td width=16%><b>Or</b> - </td>
<td width=84%>TRUE if either or both terms are TRUE.</td>
</tr>
<tr valign=top>
<td width=16%><b>Xor</b> - </td>
<td width=84%>TRUE if either but not both terms are TRUE.</td>
</tr>
<tr valign=top>
<td width=16%><b>Eqv</b> - </td>
<td width=84%>TRUE if both terms are TRUE or both terms are FALSE.</td>
</tr>
<tr valign=top>
<td width=16%><b>Imp</b> - </td>
<td width=84%>TRUE if left term is FALSE or right term is TRUE.</td>
</tr>
</table><br>
<p>
The following table shows the comparison operators used by the <b>MsiEvaluateCondition</b> function. These comparison operators can only occur between two values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Operator</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%><b>=</b> - </td>
<td width=84%>TRUE if left value is equal to right value.</td>
</tr>
<tr valign=top>
<td width=16%><b>&lt;&gt;</b> - </td>
<td width=84%>TRUE if left value is not equal to right value.</td>
</tr>
<tr valign=top>
<td width=16%><b>&gt;</b> - </td>
<td width=84%>TRUE if left value is greater than right value.</td>
</tr>
<tr valign=top>
<td width=16%><b>&gt;=</b> - </td>
<td width=84%>TRUE if left value is greater than or equal to right value.</td>
</tr>
<tr valign=top>
<td width=16%><b>&lt;</b> - </td>
<td width=84%>TRUE if left value is less than right value.</td>
</tr>
<tr valign=top>
<td width=16%><b>&lt;=</b> - </td>
<td width=84%>TRUE if left value is less than or equal to right value.</td>
</tr>
</table><br>
<p>
The following table shows the substring operators used by the <b>MsiEvaluateCondition</b> function. These substring operators can occur between two string values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Operator</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%><b>&gt;&lt;</b> - </td>
<td width=84%>TRUE if left string contains the right string.</td>
</tr>
<tr valign=top>
<td width=16%><b>&lt;&lt;</b> - </td>
<td width=84%>TRUE if left string starts with the right string.</td>
</tr>
<tr valign=top>
<td width=16%><b>&gt;&gt;</b> - </td>
<td width=84%>TRUE if left string ends with the right string.</td>
</tr>
</table><br>
<p>
The following table shows the bitwise numeric operators used by the <b>MsiEvaluateCondition</b> function. These operators can occur between two integer values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Operator</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td width=16%><b>&gt;&lt;</b> - </td>
<td width=84%>Bitwise AND, TRUE if the left and right integers have any bits in common.</td>
</tr>
<tr valign=top>
<td width=16%><b>&lt;&lt;</b> - </td>
<td width=84%>True if the high 16-bits of the left integer are equal to the right integer.</td>
</tr>
<tr valign=top>
<td width=16%><b>&gt;&gt;</b> - </td>
<td width=84%>True if the low 16-bits of the left integer are equal to the right integer.</td>
</tr>
</table><br>
<p>
The following table shows the feature and component state values used by the <b>MsiEvaluateCondition</b> function.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=42%>Value</th>
<th align=left width=58%>Meaning</th>
</tr>
<tr valign=top>
<td width=42%>INSTALLSTATE_ABSENT - </td>
<td width=58%>Feature or component not present.</td>
</tr>
<tr valign=top>
<td width=42%>INSTALLSTATE_LOCAL - </td>
<td width=58%>Feature or component on local computer.</td>
</tr>
<tr valign=top>
<td width=42%>INSTALLSTATE_SOURCE - </td>
<td width=58%>Feature or component run from source.</td>
</tr>
<tr valign=top>
<td width=42%>(NULL value) - </td>
<td width=58%>No action to be taken on feature or component.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;These states are not set until <a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a> is called, either directly or by the <a href="aref_22we.htm">CostFinalize action</a>. Therefore, state checking is generally only useful for conditional expressions in an action sequence table.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_action_functions">Installer Action Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiformatrecord"></a>MsiFormatRecord</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiFormatRecord</b> function formats record field data and properties using a format string.</p>
<pre><code><b>UINT MsiFormatRecord(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>    // installer handle
<b>  MSIHANDLE</b> <i>hRecord</i><b>,</b><i>     </i>// record to execute
<b>  LPTSTR </b><i>szResultBuf</i><b>,</b>    // buffer to return formatted string
<b>  DWORD </b><i>*pcchResultBuf   </i>// in/out buffer character count
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation. This may be omitted, in which case only the record field parameters are processed and properties are not available for substitution.</dd>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record to format. The template string must be stored in record field 0 followed by referenced data parameters.</dd>
<dt>
<i>szResultBuf</i></dt>
<dd>
Specifies the buffer to return the formatted string to.</dd>
<dt>
<i>pcchResultBuf</i></dt>
<dd>
Specifies the in/out character count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiFormatRecord</b> function uses the following format process.</p>
<p>
Parameters that are to be formatted are enclosed in square brackets [...]. The square brackets can be iterated because the substitutions are resolved from the inside out.</p>
<p>
If a part of the string is enclosed in curly braces { } and contains no square brackets, it is left unchanged, including the curly braces.</p>
<p>
If a part of the string is enclosed in curly braces { } and contains one or more property names, and if all the properties are found, the text (with the resolved substitutions) is displayed without the curly braces. If any of the properties is not found, all the text in the braces and the braces themselves are removed.</p>
<p>
The following steps describe how to format strings using the MsiFormatRecord function:</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To format strings using the MsiFormatRecord function</h5>
<ol>
<li>
The numeric parameters are substituted by replacing the marker with the value of the corresponding record field, with missing or null values producing no text.</li>
<li>
The resultant string is processed by replacing the non-record parameters with the corresponding values, described next.<ul>
<li>
If a substring of the form [propertyname] is encountered, it is replaced by the value of the property.</li>
<li>
If a substring of the form [%environmentvariable] is found, the value of the environment variable is substituted. </li>
<li>
If a substring of the form [#filekey] is found, it is replaced by the full path of the file, with the value <i>filekey</i> used as a key into the <a href="tref_4n6t.htm">File table</a>. </li>
<li>
If a substring of the form [$componentkey] is found, it is replaced by the installation directory of the component, with the value <i>componentkey</i> used as a key into the <a href="tref_09np.htm">Component table</a>, taking into account the Component.Action column state. If the component is selected to be installed locally, it is replaced by the target directory. If the component is selected to run from source, it is replaced by the source directory. If the component is not selected or if the component is missing, it is replaced by a null string.</li>
<li>
If a substring of the form [\c] is found, it is replaced by the character without any further processing. Only the first character after the backslash is kept; everything else is removed. </li>
</ul>
</li>
</ol>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetactivedatabase"></a>MsiGetActiveDatabase</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetActiveDatabase</b> function returns the active database for the installation.</p>
<pre><code><b>MSIHANDLE MsiGetActiveDatabase(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>    // installer handle
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation passed to the custom action.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, it returns a handle to the database currently in use by the installer.</p>
<p>
If the function fails, the return value can be the following:
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiGetActiveDatabase</b> function is used to access the database in use by the running the installation.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetcomponentstate"></a>MsiGetComponentState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetComponentState</b> function obtains the state of a component.</p>
<pre><code><b>UINT MsiGetComponentState(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>         // installer handle
  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>        // component name within product
  <b>INSTALLSTATE</b> <i>*piInstalled</i><b>,</b>  // returned current install state
  <b>INSTALLSTATE</b> <i>*piAction</i>      // action taken during install session
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the component name within the product.</dd>
<dt>
<i>piInstalled</i></dt>
<dd>
Specifies the returned current installed state. This parameter can be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Value</th>
<th align=left width=48%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_ABSENT</td>
<td width=48%>The component is not installed.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_BADCONFIG</td>
<td width=48%>The configuration data is corrupt.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_DEFAULT</td>
<td width=48%>The component will be installed in the default location: local or source.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_FREECACHE</td>
<td width=48%>The source files must be released from the client cache.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_INCOMPLETE</td>
<td width=48%>The installation is suspended or in progress.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_INVALIDARG</td>
<td width=48%>An invalid parameter was passed to the function.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_LOCAL</td>
<td width=48%>The component is installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_LOCKCACHE</td>
<td width=48%>The source files in the client cache are locked.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_MOREDATA</td>
<td width=48%>The buffer overflow is returned.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_SOURCE</td>
<td width=48%>The component will run from the source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_SOURCEABSENT</td>
<td width=48%>The component cannot run from the source because the source is unavailable.</td>
</tr>
<tr valign=top>
<td width=52%>INSTALLSTATE_UNKNOWN</td>
<td width=48%>An unrecognized product or feature name was passed to the function.</td>
</tr>
</table><br>

</dd>
<dt>
<i>piAction</i></dt>
<dd>
Specifies the action taken during the installation. For return values, see <i>piInstalled</i>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS </dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetdatabasestate"></a>MsiGetDatabaseState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetDatabaseState</b> function returns the state of the database.</p>
<pre><code><b>MSIDBSTATE MsiGetDatabaseState(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i>    // database handle
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to a database.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
MSIDBSTATE_READ</dt>
<dd>
The database is opened as read-only; there can be no persistent changes.</dd>
<dt>
MSIDBSTATE_ERROR</dt>
<dd>
An invalid database handle was passed to the function.</dd>
<dt>
MSIDBSTATE_WRITE</dt>
<dd>
The database is readable and writable. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiGetDatabaseState</b> function returns the update state of the database.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_database_management_functions">Database Management Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetfeaturecost"></a>MsiGetFeatureCost</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureCost</b> function returns the disk space required by a feature and its selected children and parent features.</p>
<pre><code><b>UINT MsiGetFeatureCost(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>     // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>      // name of feature
  <b>MSICOSTTREE</b> <i>iCostTree</i><b>,</b>  // portion of tree to cost
  <b>INSTALLSTATE</b> <i>iState</i><b>,</b>    // requested state
  <b>INT</b> <i>*piCost</i>             // returned cost
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the name of the feature.</dd>
<dt>
<i>iCostTree</i></dt>
<dd>
Specifies the value the function uses to determine disk space requirements. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_CHILDREN</td>
<td width=52%>The children of the indicated feature are included in the cost.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_PARENTS</td>
<td width=52%>The parent features of the indicated feature are included in the cost.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_PRODUCT</td>
<td width=52%>Unsupported.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOSTTREE_SELFONLY</td>
<td width=52%>The feature only is included in the cost.</td>
</tr>
</table><br>

</dd>
<dt>
<i>iState</i></dt>
<dd>
Specifies the installation state. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_UNKNOWN</td>
<td width=52%>The product or feature is unrecognized.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_ABSENT</td>
<td width=52%>The product or feature is uninstalled.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_LOCAL</td>
<td width=52%>The product or feature is installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_SOURCE</td>
<td width=52%>The product or feature is installed to run from source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_DEFAULT</td>
<td width=52%>The product or feature will be installed to use the default location: local or source.</td>
</tr>
</table><br>

</dd>
<dt>
<i>piCost</i></dt>
<dd>
Specifies the returned disk space requirements in units of 512 bytes.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
With the <b>MsiGetFeatureCost</b> function, the MSICOSTTREE_SELFONLY value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature only. This returned value does not include the children or the parent features of the specified feature. This total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<p>
The MSICOSTTREE_CHILDREN value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature and its children. For each feature, the total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<p>
The MSICOSTTREE_PARENTS value indicates the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the <a href="tref_0a91.htm">Feature table</a>). For each feature, the total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetfeaturestate"></a>MsiGetFeatureState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureState</b> function gets the requested state of a feature.</p>
<pre><code><b>UINT MsiGetFeatureState(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>         // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>          // feature name within product
  <b>INSTALLSTATE</b> <i>*piInstalled</i><b>,</b>  // returned current install state
  <b>INSTALLSTATE</b> <i>*piAction</i>      // action taken during install session
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature name within the product.</dd>
<dt>
<i>piInstalled</i></dt>
<dd>
Specifies the returned current installed state. This parameter can be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Value</th>
<th align=left width=51%>Meaning</th>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_BADCONFIG</td>
<td width=51%>The configuration data is corrupt.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_INCOMPLETE</td>
<td width=51%>The installation is suspended or in progress.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_SOURCEABSENT</td>
<td width=51%>The feature must run from source, and the source is unavailable.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_MOREDATA</td>
<td width=51%>The return buffer is full.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_INVALIDARG</td>
<td width=51%>An invalid parameter was passed to the function.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_UNKNOWN</td>
<td width=51%>An unrecognized product or feature was specified.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_ABSENT</td>
<td width=51%>The feature was uninstalled.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_LOCAL</td>
<td width=51%>The feature was installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_SOURCE</td>
<td width=51%>The feature must run from source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_DEFAULT</td>
<td width=51%>The feature will be installed in the default location: local or source.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_LOCKCACHE</td>
<td width=51%>The source files are locked in the client cache.</td>
</tr>
<tr valign=top>
<td width=49%>INSTALLSTATE_FREECACHE</td>
<td width=51%>The source files are released from the client cache.</td>
</tr>
</table><br>

</dd>
<dt>
<i>piAction</i></dt>
<dd>
Specifies the action taken during the installation session. For return values, see <i>piInstalled</i>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetfeaturevalidstates"></a>MsiGetFeatureValidStates</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetFeatureValidStates</b> function returns a valid installation state.</p>
<pre><code><b>UINT MsiGetFeatureValidStates(
</b>  <b>MSIHANDLE</b> <i>hInstall<b>,</b></i>            // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>             // feature name
  <b>DWORD</b> <i>*dwInstallState</i>          // install state
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the feature name.</dd>
<dt>
<i>dwInstallState</i></dt>
<dd>
Specifies the location to hold the valid installation states. This parameter will be a combination of the following values. For each valid install state, a bit is set of value: (1 &lt;&lt; INSTALLSTATE).
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=54%>Value</th>
<th align=left width=46%>Meaning</th>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_ABSENT</td>
<td width=46%>The feature can be uninstalled.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_ADVERTISED</td>
<td width=46%>The feature can be advertised.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_LOCAL</td>
<td width=46%>The feature can be installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_SOURCE</td>
<td width=46%>The feature can be configured to run from source, CD, or network.</td>
</tr>
<tr valign=top>
<td width=54%>1 &lt;&lt; INSTALLSTATE_DEFAULT</td>
<td width=46%>The feature can be configured to use the default location: local or source.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiGetFeatureValidStates</b> function determines state validity by querying all components that are linked to the specified feature without taking into account the current installed state of any component. If any of these components have a value of IRSOPTIONAL in the RunFromSource column, or if at least one component is marked IRSTLOCALONLY and at least one other component is marked IRSSOURCEONLY, then both INSTALLSTATE_LOCAL and INSTALLSTATE_SOURCE are valid states for the feature. If all components are set to IRSLOCALONLY, INSTALLSTATE_LOCAL is the only valid state. If all components are set to IRSSOURCEONLY, INSTALLSTATE_SOURCE is the only valid state.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetlanguage"></a>MsiGetLanguage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetLanguage</b> function returns the numeric language of the installation that is currently running.</p>
<pre><code><b>LANGID MsiGetLanguage(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>   // installer handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the numeric LANGID for the install.</p>
<p>
If the function fails, the return value can be the following value.
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiGetLanguage</b> function returns 0 if an installation is not running.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetlasterrorrecord"></a>MsiGetLastErrorRecord</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetLastErrorRecord</b> function returns the error record that was last returned for the calling process.</p>
<pre><b><code>MSIHANDLE MsiGetLastErrorRecord();
 </code></b></pre>
<h4>Parameters</h4>
<p>
None</p>
<h4>Return Values</h4>
<p>
A handle to the error record. If the last function was successful, <b>MsiGetLastErrorRecord</b> returns a null <b>MSIHANDLE</b>.</p>
<h4>Remarks</h4>
<p>
With the <b>MsiGetLastErrorRecord</b> function, field 1 of the record contains the MSI error code. Other fields contain data specific to the particular error. The error record is released internally after this function is run.</p>
<p>
If the record is passed to <a href="qref_163p.htm"><b>MsiProcessMessage</b></a>, it is formatted by looking up the string in the current database. If there is no install session but a product database is open, the format string may be obtained by a query on the <a href="tref_5dk5.htm">Error table</a> using the error code, followed by a call to <a href="qref_3t2c.htm"><b>MsiFormatRecord</b></a>. If the error code is known, the parameters may be individually interpreted.</p>
<p>
The following functions set the per-process error record or reset it to null if no error occurred (<b>MsiGetLastErrorRecord</b> also clears the error record after returning it). 
<ul>
<li>
<a href="qref_27tx.htm"><b>MsiOpenDatabase</b></a></li>
<li>
<a href="qref_3bxw.htm"><b>MsiDatabaseCommit</b></a></li>
<li>
<a href="qref_5h9z.htm"><b>MsiDatabaseOpenView</b></a></li>
<li>
<a href="qref_59pw.htm"><b>MsiDatabaseImport</b></a></li>
<li>
<a href="qref_4qyc.htm"><b>MsiDatabaseExport</b></a></li>
<li>
<a href="qref_5pd1.htm"><b>MsiDatabaseMerge</b></a></li>
<li>
<a href="qref_29rh.htm"><b>MsiDatabaseGenerateTransform</b></a></li>
<li>
<a href="qref_5tyl.htm"><b>MsiDatabaseApplyTransform</b></a></li>
<li>
<a href="qref_8hgl.htm"><b>MsiViewExecute</b></a></li>
<li>
<a href="qref_0gzd.htm"><b>MsiViewModify</b></a></li>
<li>
<a href="qref_4wq5.htm"><b>MsiRecordSetStream</b></a></li>
<li>
<a href="qref_5dpq.htm"><b>MsiGetSummaryInformation</b></a></li>
<li>
<a href="qref_7g14.htm"><b>MsiGetSourcePath</b></a></li>
<li>
<a href="qref_05bc.htm"><b>MsiGetTargetPath</b></a></li>
<li>
<a href="qref_4wko.htm"><b>MsiSetTargetPath</b></a></li>
<li>
<a href="qref_47l1.htm"><b>MsiGetComponentState</b></a></li>
<li>
<a href="qref_3s6d.htm"><b>MsiSetComponentState</b></a></li>
<li>
<a href="qref_3wmd.htm"><b>MsiGetFeatureState</b></a></li>
<li>
<a href="qref_9ejp.htm"><b>MsiSetFeatureState</b></a></li>
<li>
<a href="qref_5ub8.htm"><b>MsiGetFeatureCost</b></a></li>
<li>
<a href="qref_3k4z.htm"><b>MsiGetFeatureValidStates</b></a></li>
<li>
<a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a></li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetmode"></a>MsiGetMode</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetMode</b> function returns one of the Boolean internal installation states.</p>
<pre><code><b>BOOL MsiGetMode(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>,    // installer handle
  <b>MSIRUNMODE</b> <i>iRunMode</i>    // run mode
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>iRunMode</i></dt>
<dd>
Specifies the run mode. This parameter must be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=64%>Value</th>
<th align=left width=36%>Meaning</th>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_ADMIN</td>
<td width=36%>The administrative mode is installing, or the product is installing.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_ADVERTISE</td>
<td width=36%>The advertisements are installing, or the product is installing or updating. </td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_MAINTENANCE</td>
<td width=36%>An existing installation is being modified, or there is a new installation.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_ROLLBACKENABLED</td>
<td width=36%>Rollback is enabled.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_LOGENABLED</td>
<td width=36%>The log file is active. It was enabled prior to the installation session.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_OPERATIONS</td>
<td width=36%>Execute operations are spooling, or they are in the determination phase.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_REBOOTATEND</td>
<td width=36%>A reboot is necessary after a successful installation (settable).</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_REBOOTNOW</td>
<td width=36%>A reboot is necessary to continue the installation (settable).</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_CABINET</td>
<td width=36%>Files from cabinets and <a href="tref_4mlh.htm">Media table</a> files are installing.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_SOURCESHORTNAMES</td>
<td width=36%>The source LongFileNames is suppressed through the PID_MSISOURCE summary property.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_TARGETSHORTNAMES</td>
<td width=36%>The target LongFileNames is suppressed through the SHORTFILENAMES property.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_RESERVED11</td>
<td width=36%>Reserved for future use.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_WINDOWS9X</td>
<td width=36%>The operating system is Windows 95 or Windows 98.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_ZAWENABLED</td>
<td width=36%>The operating system supports demand installation.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_RESERVED14</td>
<td width=36%>Reserved for future use.</td>
</tr>
<tr valign=top>
<td width=64%>MSIRUNMODE_RESERVED15</td>
<td width=36%>Reserved for future use.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the BOOL internal installer state.</p>
<p>
If the function fails, the return value is FALSE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetproperty"></a>MsiGetProperty</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetProperty</b> function gets the value for an installer property.</p>
<pre><code><b>UINT MsiGetProperty(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>    // installer handle
  <b>LPCTSTR</b> <i>szName</i><b>,</b>        // property identifier, case-sensitive
  <b>LPTSTR</b> <i>szValueBuf</i><b>,</b>     // buffer for returned property value
  <b>DWORD</b> <i>*pchValueBuf</i>     // in/out buffer character count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installer.</dd>
<dt>
<i>szName</i></dt>
<dd>
Specifies the name of the property.</dd>
<dt>
<i>szValueBuf</i></dt>
<dd>
Specifies the buffer for the value of the property.</dd>
<dt>
<i>pchValueBuf</i></dt>
<dd>
Specifies the in-buffer character count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the value for the property retrieved by the <b>MsiGetProperty </b>function is not defined, it is equivalent to a 0-length value. It is not an error.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetsourcepath"></a>MsiGetSourcePath</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetSourcePath</b> function returns the full source path for a folder in the <a href="tref_6an9.htm">Directory table</a>.</p>
<pre><code><b>UINT MsiGetSourcePath(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>   // installer handle
  <b>LPCTSTR</b> <i>szFolder</i><b>,</b>     // folder identifier
  <b>LPTSTR</b> <i>szPathBuf</i><b>,</b>     // buffer to return full path
  <b>DWORD</b> <i>*pcchPathBuf</i>    // in/out buffer character count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFolder</i></dt>
<dd>
Indicates a record of the Directory table. If the directory is a root directory, this can be a value from the DefaultDir column. Otherwise it must be a value from the Directory column.</dd>
<dt>
<i>szPathBuf</i></dt>
<dd>
Specifies a buffer to return the full path.</dd>
<dt>
<i>pcchPathBuf</i></dt>
<dd>
Specifies the in/out character count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_PATHNAME</dt>
<dd>
An invalid path was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_location_functions">Installer Location Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigetsummaryinformation"></a>MsiGetSummaryInformation</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetSummaryInformation</b> function obtains a handle to the _SummaryInformation stream for an installer database.</p>
<pre><code><b>UINT MsiGetSummaryInformation(
</b>  <b>MSIHANDLE</b> <i>hDatabase</i><b>,</b>       // database handle
  <b>LPCTSTR</b> <i>szDatabasePath</i><b>,</b>    // path to database
  <b>UINT</b> <i>uiUpdateCount</i><b>,</b>        // maximum number of updated values, 0
                             // to open read-only
  <b>MSIHANDLE</b> <i>*phSummaryInf</i>o   // location to return summary information
                             // handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDatabase</i></dt>
<dd>
Handle to the database.</dd>
<dt>
<i>szDatabasePath</i></dt>
<dd>
Specifies the path to the database.</dd>
<dt>
<i>uiUpdateCount</i></dt>
<dd>
Specifies the maximum number of updated values.</dd>
<dt>
<i>phSummaryInfo</i></dt>
<dd>
Pointer to the location from which to receive the summary information handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INSTALL_PACKAGE_INVALID</dt>
<dd>
The installation package is invalid.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the database specified by the <b>MsiGetSummaryInformation</b> function is not open, you must specify 0 for <i>hDatabase</i> and specify the path to the database in <i>szDatabasePath</i>. If the database is open, you must set <i>szDatabasePath</i> to 0. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_summary_information_property_functions">Summary Information Property Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msigettargetpath"></a>MsiGetTargetPath</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiGetTargetPath</b> function returns the full target path for a folder in the <a href="tref_6an9.htm">Directory table</a>.</p>
<pre><code><b>UINT MsiGetTargetPath(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>   // installer handle
  <b>LPCTSTR</b> <i>szFolder</i><b>,</b>     // folder identifier
  <b>LPTSTR</b> <i>szPathBuf</i><b>,</b>     // buffer to return full path
  <b>DWORD</b> <i>*pcchPathBuf</i>    // in/out buffer character count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFolder</i></dt>
<dd>
Specifies the folder identifier. This is a primary key in the Directory table.</dd>
<dt>
<i>szPathBuf</i></dt>
<dd>
Specifies a buffer to return the full path.</dd>
<dt>
<i>pcchPathBuf</i></dt>
<dd>
Specifies the in/out buffer character count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_PATHNAME</dt>
<dd>
An invalid path was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was supplied.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_location_functions">Installer Location Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiopendatabase"></a>MsiOpenDatabase</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiOpenDatabase</b> function opens a database file for data access.</p>
<pre><code><b>UINT MsiOpenDatabase(
</b>  <b>LPCTSTR</b> <i>szDatabasePath</i><b>,</b>  // path to database
  <b>LPCTSTR</b> <i>szPersist</i><b>,</b>       // output database or predefined
                           // persist mode
  <b>MSIHANDLE</b> <i>*phDatabase</i>    // location to return database handle
<b>); </b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>szDatabasePath</i></dt>
<dd>
Specifies the full path or relative path to the database file.</dd>
<dt>
<i>szPersist</i></dt>
<dd>
Specifies the full path to the file or the persistence mode. You can use the <i>szPersist</i> parameter to direct the persistent output to a new file or to specify one of the following predefined persistence modes.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_CREATEDIRECT</td>
<td width=52%>Create a new database, direct mode read/write.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_CREATE</td>
<td width=52%>Create a new database, transact mode read/write.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_DIRECT</td>
<td width=52%>Open a database direct read/write without transaction.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_READONLY</td>
<td width=52%>Open a database read-only, no persistent changes.</td>
</tr>
<tr valign=top>
<td width=48%>MSIDBOPEN_TRANSACT</td>
<td width=52%>Open a database read/write in transaction mode.</td>
</tr>
</table><br>

</dd>
<dt>
<i>phDatabase</i></dt>
<dd>
Pointer to the location of the returned database handle.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_CREATE_FAILED</dt>
<dd>
The database could not be created.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters was invalid.</dd>
<dt>
ERROR_OPEN_FAILED</dt>
<dd>
The database could not be opened as requested.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiOpenDatabase</b> function initiates database access. This function cannot be used for a running installation. The database must be opened in transaction, create, or direct mode for changes to be retained. Create mode creates a new installer database</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database, and, thus, cannot be changed. Additionally, it is not persisted with the database. To create or modify the summary information for the output database, it must be closed and reopened.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msipreviewbillboard"></a>MsiPreviewBillboard</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiPreviewBillboard</b> function displays a billboard with the host control in the displayed dialog box.</p>
<pre><code><b>UINT MsiPreviewBillboard(
</b>  <b>MSIHANDLE</b> <i>hPreview</i><b>,</b>     // preview handle (UI handle)
  <b>LPCTSTR</b> <i>szControlName</i><b>,</b>  // name of control that accepts billboard
  <b>LPCTSTR</b> <i>szBillboard</i>     // name of billboard to display
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPreview</i></dt>
<dd>
Handle to the preview.</dd>
<dt>
<i>szControlName</i></dt>
<dd>
Specifies the name of the host control.</dd>
<dt>
<i>szBillboard</i></dt>
<dd>
Specifies the name of the billboard to display.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Supplying a NULL billboard name in the <b>MsiPreviewBillboard</b> function removes any billboard displayed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_user_interface_functions">User Interface Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msipreviewdialog"></a>MsiPreviewDialog</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiPreviewDialog</b> function displays a dialog box as modeless and inactive.</p>
<pre><code><b>UINT MsiPreviewDialog(
</b>  <b>MSIHANDLE</b> <i>hPreview</i><b>,</b>     // preview handle (UI handle)
  <b>LPCTSTR</b> <i>szDialogName</i>    // name of dialog
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPreview</i></dt>
<dd>
Handle to the preview.</dd>
<dt>
<i>szDialogName</i></dt>
<dd>
Specifies the name of the dialog box to preview.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_FUNCTION_NOT_CALLED</dt>
<dd>
The function was not called.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
An installation failure occurred.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The installation was suspended.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user exited the installation.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Supplying a NULL name in the <b>MsiPreviewDialog</b> function removes any current dialog box.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_user_interface_functions">User Interface Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiprocessmessage"></a>MsiProcessMessage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiProcessMessage</b> function sends an error record to the installer for processing.</p>
<pre><code><b>int MsiProcessMessage(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>       // installer handle
  <b>MSIMESSAGE</b> <i>eMessageType</i><b>,</b>  // type of message
  <b>MISHANDLE</b> <i>hRecord</i>         // record handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>eMessageType</i></dt>
<dd>
Specifies the message type. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_OutOfMemory</td>
<td width=52%>The process is out of memory, may call recursively.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Error</td>
<td width=52%>Error message,<br>
[1] is message number in <a href="tref_5dk5.htm">Error table</a>.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Warning</td>
<td width=52%>Warning message,<br>
[1] is message number in Error table.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_User</td>
<td width=52%>User request,<br>
[1] is message number in Error table.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Info</td>
<td width=52%>Informative message for log, <br>
not to be displayed.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Diagnostic</td>
<td width=52%>Debug notification, <br>
displayed only if no log.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_CommonData</td>
<td width=52%>Info for UI: <br>
[1]=language ID, <br>
[2]=dialog caption.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Reserved</td>
<td width=52%>Reserved for future use.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_ActionStar</td>
<td width=52%>Progress: start of action, <br>
[1] action name,<br>
[2] description.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_ActionData</td>
<td width=52%>Progress: data associated with individual action item.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_Progress</td>
<td width=52%>Progress: gauge info,<br>
[1] units so far,<br>
[2] total.</td>
</tr>
<tr valign=top>
<td width=48%>MSIMESSAGE_ActionData</td>
<td width=52%>Progress:<br>
end of action sequence,<br>
exit modeless dialog.</td>
</tr>
</table><br>

</dd>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to a record containing message format and data.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
-1</dt>
<dd>
An invalid parameter or handle was supplied.</dd>
<dt>
0</dt>
<dd>
No action was taken.</dd>
<dt>
IDABORT</dt>
<dd>
The process was stopped.</dd>
<dt>
IDCANCEL</dt>
<dd>
The process was canceled.</dd>
<dt>
IDIGNORE</dt>
<dd>
The process was ignored.</dd>
<dt>
IDOK</dt>
<dd>
The function succeeded.</dd>
<dt>
IDNO</dt>
<dd>
No.</dd>
<dt>
IDRETRY</dt>
<dd>
Retry.</dd>
<dt>
IDYES</dt>
<dd>
Yes.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiProcessMessage</b> function performs any enabled logging operations and defers execution. You can selectively enable logging for various message types.</p>
<p>
If field 0 is not set, field 1 must be set to the error code corresponding to the error message in the <a href="tref_5dk5.htm">Error table</a>. Then, the message is formatted using the template from the Error table before passing it to the user-interface handler for display. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_action_functions">Installer Action Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordcleardata"></a>MsiRecordClearData</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordClearData</b> function sets all fields in a record to NULL.</p>
<pre><code><b>unsigned int MsiRecordClearData(
</b>  <b>MSIHANDLE</b> <i>hRecord   </i>// record handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
The handle is inactive or does not represent a record.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecorddatasize"></a>MsiRecordDataSize</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordDataSize</b> function returns the length of a record field.</p>
<pre><code><b>unsigned int MsiRecordDataSize(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>    // record handle
  <b>unsigned int</b> <i>iField</i>   // record field
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies a field of the record.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The <b>MsiRecordDataSize</b> function returns 0 if the field is NULL, non-existent, or an internal object pointer. The function also returns 0 if the handle is not a valid record handle.</p>
<p>
If the data is in integer format, the function returns sizeof(int).</p>
<p>
If the data is in string format, the function returns the character count (not including the NULL terminator).</p>
<p>
If the data is in stream format, the function returns the byte count.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordgetfieldcount"></a>MsiRecordGetFieldCount</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordGetFieldCount</b> function returns the number of fields in a record.</p>
<pre><code><b>unsigned int MsiRecordGetFieldCount(
</b>  <b>MSIHANDLE</b> <i>hRecord</i>    // record handle
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to a record.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the number of fields in the record.</p>
<p>
If the function fails, the return value can be the following.
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The count returned by the <b>MsiRecordGetFieldCount</b> parameter does not include field 0. Read access to fields beyond this count returns NULL values. Write access fails.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordgetinteger"></a>MsiRecordGetInteger</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordGetInteger</b> function returns the integer value from a record field.</p>
<pre><code><b>int MsiRecordGetInteger(
</b>  <b>MSIHANDLE</b> <i>hRecord</i>,    // record handle
  <b>unsigned int</b> <i>iField</i>   // field of record
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to a record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field of the record from which to obtain the value.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the integer value of the field.</p>
<h4>Remarks</h4>
<p>
The <b>MsiRecordGetInteger</b> function returns MSI_NULL_INTEGER if the field is NULL or if the field is a string that cannot be converted to an integer.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordgetstring"></a>MsiRecordGetString</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordGetString</b> function returns the string value of a record field.</p>
<pre><code><b>UINT MsiRecordGetString(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>     // record handle
  <b>unsigned int</b> <i>iField</i><b>,</b>   // field requested
  <b>LPTSTR</b> <i>szValueBuf</i><b>,</b>     // buffer to hold string
  <b>DWORD</b> <i>*pcchValueBuf</i>    // pointer to size of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field requested.</dd>
<dt>
<i>szValueBuf</i></dt>
<dd>
Specifies a buffer to hold the returned string.</dd>
<dt>
<i>pcchValueBuf</i></dt>
<dd>
Pointer to the size of the buffer.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was supplied.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If ERROR_MORE_DATA is returned from the <b>MsiRecordGetString</b> function, the <i>pcchValueBuf</i> parameter contains the size of the buffer required to hold the string. If ERROR_SUCCESS is returned, <i>pcchValueBuf</i> contains the number of characters written to the string buffer.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordisnull"></a>MsiRecordIsNull</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordIsNull</b> function reports whether a record field is NULL.</p>
<pre><code><b>BOOL MsiRecordIsNull(
</b>  <b>MSIHANDLE</b> <i>hRecord</i>,    // record handle
  <b>unsigned int</b> <i>iField</i>   // field of record
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field to check.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
FALSE</dt>
<dd>
The function succeeded and the field is not null.</dd>
<dt>
TRUE</dt>
<dd>
The function succeeded and the field is null.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For the <b>MsiRecordIsNull</b> function, an integer value specifying a non-existent field of the record returns TRUE. </p>
<p>
The <i>iField</i> parameter is based on 1.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordreadstream"></a>MsiRecordReadStream</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordReadStream</b> function reads bytes from a record stream field into a buffer.</p>
<pre><code><b>UINT MsiRecordReadStream(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>    // record handle
  <b>unsigned int</b> <i>iField</i><b>,</b>  // field of record
  <b>char</b> <i>*szDataBuf</i><b>,</b>      // buffer to receive bytes from stream
  <b>DWORD</b> <i>*pchDataBuf</i>     // in/out buffer count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field of the record.</dd>
<dt>
<i>szDataBuf</i></dt>
<dd>
Specifies the buffer to hold data.</dd>
<dt>
<i>pchDataBuf</i></dt>
<dd>
Specifies the in/out buffer count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_DATATYPE</dt>
<dd>
The field is not a stream column.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When using the <b>MsiRecordReadStream</b> function, you must set the <i>pchDataBuf</i> parameter to the requested byte count to read. The number of bytes transferred is returned through the <i>pchDataBuf</i> parameter. If no more bytes are available, ERROR_SUCCESS is still returned.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordsetinteger"></a>MsiRecordSetInteger</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordSetInteger</b> function sets a record field to an integer field.</p>
<pre><code><b>UINT MsiRecordSetInteger(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>   // record handle
  <b>unsigned int</b> <i>iField</i><b>,</b> // field of record
  <b>int</b> <i>iValue</i>           // value to set
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field of the record to set.</dd>
<dt>
<i>iValue</i></dt>
<dd>
Specifies the value to which to set the field.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_FIELD</dt>
<dd>
An invalid field of the record was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
In the <b>MsiRecordSetInteger</b> function, attempting to store a value in a non-existent field causes an error.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordsetstream"></a>MsiRecordSetStream</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordSetStream</b> function sets a record stream field from a file.</p>
<pre><code><b>UINT MsiRecordSetStream(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>      // record handle
  <b>unsigned int</b> <i>iField</i><b>,</b>    // field of record
  <b>LPCTSTR</b> <i>szFilePath</i>      // path to file containing stream
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field of the record to set.</dd>
<dt>
<i>szFilePath</i></dt>
<dd>
Specifies the path to the file containing the stream.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_BAD_PATHNAME</dt>
<dd>
An invalid path was supplied.</dd>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The contents of the file specified in the <b>MsiRecordSetStream</b> function is read into a stream object. The stream persists if the record is inserted into the database and the database is committed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msirecordsetstring"></a>MsiRecordSetString</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiRecordSetString</b> function copies a string into the designated field.</p>
<pre><code><b>UINT MsiRecordSetString(
</b>  <b>MSIHANDLE</b> <i>hRecord</i><b>,</b>     // record handle
  <b>unsigned int</b> <i>iField</i><b>,</b>   // field to set
  <b>LPCTSTR</b> <i>szValue</i>        // string value
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record.</dd>
<dt>
<i>iField</i></dt>
<dd>
Specifies the field of the record to set.</dd>
<dt>
<i>szValue</i></dt>
<dd>
Specifies the string value of the field.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
In the <b>MsiRecordSetString</b> function, a NULL string pointer and an empty string both set the field to NULL. Attempting to store a value in a non-existent field causes an error.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_record_processing_functions">Record Processing Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisequence"></a>MsiSequence</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSequence</b> function executes another action sequence, as described in the specified table.</p>
<pre><code><b>UINT MsiSequence(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>,    // installer handle
  <b>LPCTSTR</b> <i>szTable</i>,       // table name
  <b>INT</b> <i>iSequenceMode</i>      // processing option
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szTable</i></dt>
<dd>
Specifies the name of the table containing the action sequence.</dd>
<dt>
<i>iSequenceMode</i></dt>
<dd>
Specifies the sequence mode.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_FUNCTION_NOT_CALLED</dt>
<dd>
The function was not called.</dd>
<dt>
ERROR_INSTALL_FAILURE</dt>
<dd>
An installation failure occurred.</dd>
<dt>
ERROR_INSTALL_SUSPEND</dt>
<dd>
The installation was suspended.</dd>
<dt>
ERROR_INSTALL_USEREXIT</dt>
<dd>
The user exited the installation.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
An invalid handle state occurred.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSequence</b> function queries the specified table, ordering the actions by the numbers in the Sequence column. For each row retrieved, an action is executed, provided that any supplied condition expression does not evaluate to FALSE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_action_functions">Installer Action Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetcomponentstate"></a>MsiSetComponentState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetComponentState</b> function sets a component to the requested state.</p>
<pre><code><b>UINT MsiSetComponentState(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>,     // installer handle
  <b>LPCTSTR</b> <i>szComponent</i><b>,</b>    // name of component within product
  <b>INSTALLSTATE</b> <i>iState</i>     // install state
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szComponent</i></dt>
<dd>
Specifies the name of the component.</dd>
<dt>
<i>iState</i></dt>
<dd>
Specifies the state to set. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_ABSENT</td>
<td width=52%>The component was uninstalled.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_LOCAL</td>
<td width=52%>The component was installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_SOURCE</td>
<td width=52%>The component will run from source, CD, or network.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSetComponentState</b> function requests a change in the Action state of a record in the <a href="tref_09np.htm">Component table</a>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetfeaturestate"></a>MsiSetFeatureState</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetFeatureState</b> function sets a feature to a specified state.</p>
<pre><code><b>UINT MsiSetFeatureState(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>     // installer handle
  <b>LPCTSTR</b> <i>szFeature</i><b>,</b>      // name of feature
  <b>INSTALLSTATE</b> <i>iState</i>     // install state
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFeature</i></dt>
<dd>
Specifies the name of the feature.</dd>
<dt>
<i>iState</i></dt>
<dd>
Specifies the state to set. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_ABSENT</td>
<td width=52%>The feature was uninstalled.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_LOCAL</td>
<td width=52%>The feature was installed on the local drive.</td>
</tr>
<tr valign=top>
<td width=48%>INSTALLSTATE_SOURCE</td>
<td width=52%>The feature will run from source, CD, or network.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
One of the parameters was invalid.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_FEATURE</dt>
<dd>
An unknown feature was requested.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSetFeatureState</b> function requests a change in the select state of a feature in the <a href="tref_0a91.htm">Feature table</a> and its children. In turn, the Action state of all the components linked to the changed Feature records are also updated appropriately, based on the new feature Select state.</p>
<p>
The <a href="qref_7yr0.htm"><b>MsiSetInstallLevel</b></a> function must be called before calling <b>MsiSetFeatureState</b>.</p>
<p>
When <b>MsiSetFeatureState</b> is called, the installer attempts to set the Action state of each component tied to the specified feature to the specified state. However, there are common situations when the request cannot be fully implemented. For example, suppose a feature is tied to two components, component A and component B, through the <a href="tref_52hx.htm">FeatureComponents table</a>. Also suppose that component A is authored with a RunFromSource option of IRSLOCALONLY and component B is authored with a RunFromSource option of IRSSOURCEONLY. In this case, if <b>MsiSetFeatureState</b> is called with a requested state of either INSTALLSTATE_LOCAL or INSTALLSTATE_SOURCE, the request cannot be fully implemented for both components. However, both components are turned ON, with component A set to Local and component B set to Source.</p>
<p>
If more than one feature is linked to a single component (a common scenario), the final Action state of that component is determined as follows.
<ul>
<li>
If at least one feature requires the component to be installed locally, the feature is installed with a state of Local.</li>
<li>
If at least one feature requires the component to be run from source , the feature is installed with a state of Source.</li>
<li>
If at least one feature requires the removal of the component, the action state is Absent.</li>
</ul>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetinstalllevel"></a>MsiSetInstallLevel</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetInstallLevel</b> function sets the installation level for a full product installation.</p>
<pre><code><b>UINT MsiSetInstallLevel(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>   // installer handle
  <b>int</b> <i>iInstallLevel</i>     // install level
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>iInstallLevel</i></dt>
<dd>
Specifies the installation level.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSetInstallLevel</b> function sets the following.
<ul>
<li>
The installation level for the current installation to a specified value.</li>
<li>
The Select and Installed states for all features in the <a href="tref_0a91.htm">Feature table</a>.</li>
<li>
The Action state of each component in the <a href="tref_09np.htm">Component table</a>, based on the new level.</li>
</ul>
<p>
If 0 is passed in the <i>ilnstallLevel</i> parameter, the current installation level does not change, but all features are still updated based on the current installation level.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetmode"></a>MsiSetMode</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetMode</b> function sets an internal engine Boolean state.</p>
<pre><code><b>UINT MsiSetMode(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>     // installer handle
  <b>unsigned int</b> <i>iRunMode</i><b>,</b>  // run mode
  <b>BOOL</b> <i>fState</i>             // state to set
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installer.</dd>
<dt>
<i>iRunMode</i></dt>
<dd>
Specifies the run mode.</dd>
<dt>
<i>fState</i></dt>
<dd>
Specifies the state to set. This parameter must be one of the following values. While there are many values for this parameter, as described in <a href="qref_8u05.htm"><b>MsiGetMode</b></a>, only one of the following values can be set.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Value</th>
<th align=left width=45%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>MSIRUNMODE_REBOOTATEND</td>
<td width=45%>A reboot is necessary after a successful installation.</td>
</tr>
<tr valign=top>
<td width=55%>MSIRUNMODE_REBOOTNOW</td>
<td width=45%>A reboot is necessary to continue installation.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ACCESS_DENIED</dt>
<dd>
Access was denied.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisetproperty"></a>MsiSetProperty</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetProperty</b> function sets the value for an installation property.</p>
<pre><code><b>UINT MsiSetProperty(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>,</b>   // installer handle
  <b>LPCTSTR</b> <i>szName</i><b>,</b>       // property identifier, case-sensitive
  <b>LPCTSTR</b> <i>szValue</i>       // property value, NULL to undefine property
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installer.</dd>
<dt>
<i>szName</i></dt>
<dd>
Specifies the name of the property.</dd>
<dt>
<i>szValue</i></dt>
<dd>
Specifies the value of the property.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the property is not defined, it is created by the <b>MsiSetProperty</b> function. If the value is NULL or an empty string, the property is removed.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_state_access_functions">Installer State Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisettargetpath"></a>MsiSetTargetPath</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSetTargetPath</b> function sets the full target path for a folder in the <a href="tref_6an9.htm">Directory table</a>.</p>
<pre><code><b>UINT MsiSetTargetPath(
</b>  <b>MSIHANDLE</b> <i>hInstall</i><b>, </b>  // installer handle
  <b>LPCTSTR</b> <i>szFolder</i><b>,</b>     // folder identifier
  <b>LPCTSTR</b> <i>szFolderPath</i>  // full path for folder, ending in
                        // directory separator
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.</dd>
<dt>
<i>szFolder</i></dt>
<dd>
Specifies the folder identifier. This is a primary key in the Directory table.</dd>
<dt>
<i>szFolderPath</i></dt>
<dd>
Specifies the full path for the folder, ending in a directory separator.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_DIRECTORY</dt>
<dd>
The target path could not be set.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiSetTargetPath</b> function changes the path specification for the target directory named in the in-memory <a href="tref_6an9.htm">Directory table</a>. Also, the path specifications of all other path objects in the table that are either subordinate or equivalent to the changed path are updated to reflect the change. The properties for each affected path are also updated.</p>
<p>
If an error occurs in this function, all updated paths and properties revert to their previous values. Therefore, it is safe to treat errors returned by this function as non-fatal.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_location_functions">Installer Location Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisummaryinfogetproperty"></a>MsiSummaryInfoGetProperty</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSummaryInfoGetProperty</b> function gets a single property from the summary information.</p>
<pre><code><b>UINT MsiSummaryInfoGetProperty(
</b>  <b>MSIHANDLE</b> <i>hSummaryInfo</i><b>,</b>   // summary info handle
  <b>UINT</b> <i>uiProperty</i><b>,</b>          // property
  <b>UINT</b> <i>*puiDataType</i><b>,</b>        // property type
  <b>INT</b> <i>*piValue</i><b>,</b>             // value
  <b>FILETIME</b> <i>*pftValue</i><b>,</b>       // file time
  <b>LPCTSTR</b> <i>szValueBuf</i><b>,</b>       // value buffer
  <b>DWORD</b> <i>*pcchValueBuf</i>       // buffer size
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSummaryInfo</i></dt>
<dd>
Handle to summary information.</dd>
<dt>
<i>uiProperty</i></dt>
<dd>
Specifies the property ID.</dd>
<dt>
<i>puiDataType</i></dt>
<dd>
Specifies the returned property type. This type can be VT_I2, VT_I4, VT_LPSTR, VT_FILETIME, or VT_EMPTY. For more information on these types, see <a href="sovr_43w4.htm">Summary Information Stream Property Set</a>.</dd>
<dt>
<i>piValue</i></dt>
<dd>
Specifies the returned integer property data.</dd>
<dt>
<i>pftValue</i></dt>
<dd>
Pointer to a file value.</dd>
<dt>
<i>szValueBuf</i></dt>
<dd>
Specifies the returned string property data.</dd>
<dt>
<i>pcchValueBuf</i></dt>
<dd>
Specifies the size of the string buffer.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_MORE_DATA</dt>
<dd>
A buffer was too small to hold the entire value.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_summary_information_property_functions">Summary Information Property Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisummaryinfogetpropertycount"></a>MsiSummaryInfoGetPropertyCount</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSummaryInfoGetPropertyCount</b> function returns the number of existing properties in the summary information stream.</p>
<pre><code><b>UINT MsiSummaryInfoGetPropertyCount(
</b>  <b>MSIHANDLE</b> <i>hSummaryInfo</i><b>,</b> // summary information handle
  <b>UINT</b> <i>*puiPropertyCount</i>  // location to return total property count
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSummaryInfo</i></dt>
<dd>
Handle to summary information.</dd>
<dt>
<i>puiPropertyCount</i></dt>
<dd>
Specifies the location to which to return the total property count.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_summary_information_property_functions">Summary Information Property Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisummaryinfopersist"></a>MsiSummaryInfoPersist</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSummaryInfoPersist</b> function writes changed summary information back to the summary information stream.</p>
<pre><code><b>UINT MsiSummaryInfoPersist(
</b>  <b>MSIHANDLE</b> <i>hSummaryInfo</i>    // summary info handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSummaryInfo</i></dt>
<dd>
Handle to summary information.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_summary_information_property_functions">Summary Information Property Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msisummaryinfosetproperty"></a>MsiSummaryInfoSetProperty</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiSummaryInfoSetProperty</b> function sets a single summary information property.</p>
<pre><code><b>UINT MsiSummaryInfoSetProperty(
</b>  <b>MSIHANDLE</b> <i>hSummaryInfo</i><b>,</b> // summary information handle
  <b>UINT</b> <i>uiProperty</i><b>,</b>        // property ID, one of allowed values
                          // for summary information
  <b>UINT</b> <i>uiDataType</i><b>,</b>        // VT_I4, VT_LPTSTR, VT_FILETIME,
                          // or VT_EMPTY
  <b>INT</b> <i>iValue</i><b>,</b>             // integer value, used only if integer
                          // property
  <b>FILETIME</b> <i>*pftValue</i><b>,</b>     // pointer to file-time value, used only
                          // if date/time property
  <b>LPCTSTR</b> <i>szValue</i>         // text value, used only if string property
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hSummaryInfo</i></dt>
<dd>
Handle to summary information.</dd>
<dt>
<i>uiProperty</i></dt>
<dd>
Specifies the property to set.</dd>
<dt>
<i>uiDataType</i></dt>
<dd>
Specifies the type of property to set.</dd>
<dt>
<i>iValue</i></dt>
<dd>
Specifies the integer value.</dd>
<dt>
<i>pftValue</i></dt>
<dd>
Specifies the file-time value.</dd>
<dt>
<i>szValue</i></dt>
<dd>
Specifies the text value.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_DATATYPE_MISMATCH</dt>
<dd>
The data types were mismatched.</dd>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.</dd>
<dt>
ERROR_UNKNOWN_PROPERTY</dt>
<dd>
The summary information property is unknown.</dd>
<dt>
ERROR_UNSUPPORTED_TYPE</dt>
<dd>
The type is unsupported.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_summary_information_property_functions">Summary Information Property Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiverifydiskspace"></a>MsiVerifyDiskSpace</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiVerifyDiskSpace</b> function checks to see if sufficient disk space is present for the current installation.</p>
<pre><code><b>UINT MsiVerifyDiskSpace(
</b>  <b>MSIHANDLE</b> <i>hInstall</i>    // installer handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInstall</i></dt>
<dd>
Handle to the installation.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_DISK_FULL</dt>
<dd>
The disk is full.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle is in an invalid state.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_installer_selection_functions">Installer Selection Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewclose"></a>MsiViewClose</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewClose</b> function releases the result set for an executed view.</p>
<pre><code><b>UINT MsiViewClose(
</b>  <b>MSIHANDLE</b> <i>hView</i>    // view handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to a view that is set to release.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle is in an invalid state.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiViewClose</b> function must be called before the <a href="qref_8hgl.htm"><b>MsiViewExecute</b></a> function is called again on the view, unless all rows of the result set have been obtained with the <a href="qref_9b54.htm"><b>MsiViewFetch</b></a> function.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewexecute"></a>MsiViewExecute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewExecute</b> function executes the view query, supplying parameters as required.</p>
<pre><code><b>UINT MsiViewExecute(
</b>  <b>MSIHANDLE</b> <i>hView</i><b>,</b>    // view handle
  <b>MSIHANDLE</b> <i>hRecord</i>   // parameter record
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to the view upon which to execute the query.</dd>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to a record that supplies parameters as required. This parameter contains values to replace parameter markers in the SQL query. It is optional, so <i>hRecord</i> can be zero. For a reference on syntax, see <a href="qref_5j20.htm">SQL Syntax</a>.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
A view could not be executed.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiViewExecute</b> function must be called before any calls to <a href="qref_9b54.htm"><b>MsiViewFetch</b></a>. If the SQL query specifies values in the predicate expression with parameter markers, a record with all replacement values in exact order and of compatible data types must be supplied.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewfetch"></a>MsiViewFetch</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewFetch</b> function fetches the next sequential record from the view.</p>
<pre><code><b>UINT MsiViewFetch(
</b>  <b>MSIHANDLE</b> <i>hView</i><b>,</b>      // view handle
  <b>MSIHANDLE</b> <i>*phRecord</i>   // handle for fetched record
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to the view to fetch from.</dd>
<dt>
<i>phRecord</i></dt>
<dd>
Pointer to the handle for the fetched record.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
An error occurred during fetching.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle was in an invalid state.</dd>
<dt>
ERROR_NO_MORE_ITEMS</dt>
<dd>
No records remain, and a NULL handle is returned.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded, and a handle to the record is returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the <b>MsiViewFetch</b> function returns ERROR_FUNCTION_FAILED, it is possible that the <a href="qref_8hgl.htm"><b>MsiViewExecute</b></a> function was not called first. If more rows are available in the result set, <b>MsiViewFetch</b> returns <i>phRecord</i> as a handle to a record containing the requested column data, or <i>phRecord</i> is 0. For maximum performance, the same record should be used for all retrievals, or the record should be released by going out of scope.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewgetcolumninfo"></a>MsiViewGetColumnInfo</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewGetColumnInfo</b> function returns a record containing column names or definitions.</p>
<pre><code><b>UINT MsiViewGetColumnInfo(
 MSIHANDLE </b><i>hView</i><b>,</b>       <b>  </b>// view handle
<b> MSICOLINFO</b> <i>eColumnInfo</i><b>,  </b>// type of information to return, names
                          // or definitions
<b> MSIHANDLE </b><i>*phRecord    </i>  // handle for returned record
<b>);</b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to the view from which to obtain column information.</dd>
<dt>
<i>eColumnInfo</i></dt>
<dd>
Specifies a flag indicating what type of information is needed. This parameter must be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>MSICOLINFO_NAMES </td>
<td width=52%>Column names are returned.</td>
</tr>
<tr valign=top>
<td width=48%>MSICOLINFO_TYPES </td>
<td width=52%>Definitions are returned.</td>
</tr>
</table><br>

</dd>
<dt>
<i>phRecord</i></dt>
<dd>
Pointer to a handle to receive the column information data record.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The view is not in an Active state.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid MSICOLINFO column information enumeration value was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded, and a handle to a record was returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>MsiViewGetColumnInfo</b> function uses the following column definition format.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Column descriptor</th>
<th align=left width=68%>Definition string</th>
</tr>
<tr valign=top>
<td width=32%>s?</td>
<td width=68%>String, variable length (?=1-255)</td>
</tr>
<tr valign=top>
<td width=32%>s0</td>
<td width=68%>String, variable length</td>
</tr>
<tr valign=top>
<td width=32%>i2</td>
<td width=68%>Short integer</td>
</tr>
<tr valign=top>
<td width=32%>i4</td>
<td width=68%>Long integer</td>
</tr>
<tr valign=top>
<td width=32%>v0</td>
<td width=68%>Binary Stream</td>
</tr>
<tr valign=top>
<td width=32%>g?</td>
<td width=68%>Temporary string (?=0-255)</td>
</tr>
<tr valign=top>
<td width=32%>j?</td>
<td width=68%>Temporary integer (?=0,1,2,4)</td>
</tr>
</table><br>
<p>
Each column is described by a string in the corresponding record field. The definition string consists of a single letter representing the data type followed by the width of the column (in characters when applicable, bytes otherwise). A width of zero designates an unbounded width (for example, long text fields and streams). An uppercase letter indicates that NULL values are allowed in the column.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewgeterror"></a>MsiViewGetError</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewGetError</b> function returns the error that occurred in the <a href="qref_0gzd.htm"><b>MsiViewModify</b></a> function. </p>
<pre><code><b>MSIDBERROR MsiViewGetError(
</b>  <b>MSIHANDLE</b> <i>hView</i><b>,</b>            // view handle
  <b>LPTSTR</b> <i>szColumnNameBuffer</i><b>,</b>  // buffer to hold column name string
  <b>DWORD </b><i>*pcchBuf</i>              // size of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to the view.</dd>
<dt>
<i>szColumnNameBuffer</i></dt>
<dd>
Specifies the buffer to hold the column name string. This parameter is NULL if there are no errors or if the size of the buffer is too small.</dd>
<dt>
<i>pcchBuf</i></dt>
<dd>
Specifies the size of the buffer. This parameter returns the size required for the buffer if an error occurs.
</dd>
</dl>
<h4>Return Values</h4>
<p>
This function returns one of the following values.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=55%>Error code</th>
<th align=left width=14%>Error number</th>
<th align=left width=31%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_INVALIDARG</td>
<td width=14%>-3</td>
<td width=31%>An argument was invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_MOREDATA</td>
<td width=14%>-2</td>
<td width=31%>The buffer was too small to receive data.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_FUNCTIONERROR</td>
<td width=14%>-1</td>
<td width=31%>The function failed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_NOERROR</td>
<td width=14%>0</td>
<td width=31%>The function completed successfully with no errors.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_DUPLICATEKEY</td>
<td width=14%>1</td>
<td width=31%>The new record duplicates primary keys of the existing record in a table.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_REQUIRED</td>
<td width=14%>2</td>
<td width=31%>There are no NULL values allowed, or the column is about to be deleted but is referenced by another row. </td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLINK</td>
<td width=14%>3</td>
<td width=31%>The corresponding record in a foreign table was not found.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_OVERFLOW</td>
<td width=14%>4</td>
<td width=31%>The data is greater than the maximum value allowed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_UNDERFLOW</td>
<td width=14%>5</td>
<td width=31%>The data is less than the minimum value allowed.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_NOTINSET</td>
<td width=14%>6</td>
<td width=31%>The data is not a member of the values permitted in the set.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADVERSION</td>
<td width=14%>7</td>
<td width=31%>An invalid version string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCASE</td>
<td width=14%>8</td>
<td width=31%>The case was invalid. The case must be all uppercase or all lowercase.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADGUID </td>
<td width=14%>9</td>
<td width=31%>An invalid GUID was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADWILDCARD </td>
<td width=14%>10</td>
<td width=31%>An invalid wildcard file name was supplied, or the use of wildcards was invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADIDENTIFIER </td>
<td width=14%>11</td>
<td width=31%>An invalid identifier was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLANGUAGE </td>
<td width=14%>12</td>
<td width=31%>Invalid language IDs were supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADFILENAME </td>
<td width=14%>13</td>
<td width=31%>An invalid file name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADPATH </td>
<td width=14%>14</td>
<td width=31%>An invalid path was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCONDITION </td>
<td width=14%>15</td>
<td width=31%>An invalid conditional statement was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADFORMATTED </td>
<td width=14%>16</td>
<td width=31%>An invalid format string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADTEMPLATE </td>
<td width=14%>17</td>
<td width=31%>An invalid template string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADDEFAULTDIR </td>
<td width=14%>18</td>
<td width=31%>An invalid string was supplied in the DefaultDir column of the <a href="tref_6an9.htm">Directory table</a>.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADREGPATH </td>
<td width=14%>19</td>
<td width=31%>An invalid registry path string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCUSTOMSOURCE</td>
<td width=14%>20</td>
<td width=31%>An invalid string was supplied in the CustomSource column of the <a href="tref_71b9.htm">CustomAction table</a>.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADPROPERTY </td>
<td width=14%>21</td>
<td width=31%>An invalid property string was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_MISSINGDATA </td>
<td width=14%>22</td>
<td width=31%>The <a href="tref_8fl1.htm">_Validation table</a> is missing a reference to a column.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCATEGORY </td>
<td width=14%>23</td>
<td width=31%>The category column of the _Validation table for the column is invalid.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADCABINET</td>
<td width=14%>24</td>
<td width=31%>An invalid cabinet name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADKEYTABLE </td>
<td width=14%>25</td>
<td width=31%>The table in the Keytable column of the _Validation table was not found or loaded.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADMAXMINVALUES </td>
<td width=14%>26</td>
<td width=31%>The value in the MaxValue column of the _Validation table is less than the value in the MinValue column.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADSHORTCUT</td>
<td width=14%>27</td>
<td width=31%>An invalid shortcut target name was supplied.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_STRINGOVERFLOW</td>
<td width=14%>28</td>
<td width=31%>The string is too long for the length specified by the column definition.</td>
</tr>
<tr valign=top>
<td width=55%>MSIDBERROR_BADLOCALIZEATTRIB</td>
<td width=14%>29</td>
<td width=31%>An invalid localization attribute was supplied. (Primary keys cannot be localized.)</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
You should only call the <b>MsiViewGetError</b> function when <b>MsiViewModify</b> returns ERROR_INVALID_DATA, indicating that the data is invalid. Errors are only recorded for MSIMODIFY_VALIDATE, MSIMODIFY_VALIDATE_NEW, and MSIMODIFY_VALIDATEFIELD.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_msiviewmodify"></a>MsiViewModify</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MsiViewModify</b> function updates a fetched record.</p>
<pre><code><b>UINT MsiViewModify(
</b>  <b>MSIHANDLE</b> <i>hView</i><b>,</b>        // view handle
  <b>MSIMODIFY</b> <i>eModifyMode</i><b>,</b>  // modify mode
  <b>MSIHANDLE</b> <i>hRecord</i>       // record handle
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hView</i></dt>
<dd>
Handle to a view.</dd>
<dt>
<i>eModifyMode</i></dt>
<dd>
Specifies the modify mode. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Value</th>
<th align=left width=45%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_REFRESH</td>
<td width=45%>Refetch current record data.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_INSERT</td>
<td width=45%>Insert a new record. The function fails if a matching key exists.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_UPDATE</td>
<td width=45%>Update the existing non-key data of the fetched record.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_ASSIGN</td>
<td width=45%>Insert a new record. If a matching key exists, the record is replaced.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_REPLACE</td>
<td width=45%>Update the record, delete the old if primary key edit.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_MERGE</td>
<td width=45%>The function fails if there is a record with a duplicate key that is not identical.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_DELETE</td>
<td width=45%>Remove a row referenced by this record from the table.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_INSERT_TEMPORARY</td>
<td width=45%>Insert a temporary record.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_VALIDATE</td>
<td width=45%>Validate a fetched record.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_VALIDATE_DELETE</td>
<td width=45%>Validate a record to be deleted.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_VALIDATE_NEW</td>
<td width=45%>Validate a new record.</td>
</tr>
<tr valign=top>
<td width=55%>MSIMODIFY_VALIDATE_FIELD</td>
<td width=45%>Validate field(s) of an incomplete record.</td>
</tr>
</table><br>

</dd>
<dt>
<i>hRecord</i></dt>
<dd>
Handle to the record to modify.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
ERROR_ACCESS_DENIED</dt>
<dd>
Access was not permitted.</dd>
<dt>
ERROR_FUNCTION_FAILED</dt>
<dd>
The function failed.</dd>
<dt>
ERROR_INVALID_DATA</dt>
<dd>
A validation was requested and the data did not pass. For more information, call <a href="qref_541e.htm"><b>MsiViewGetError</b></a>.</dd>
<dt>
ERROR_INVALID_HANDLE</dt>
<dd>
An invalid or inactive handle was supplied.</dd>
<dt>
ERROR_INVALID_HANDLE_STATE</dt>
<dd>
The handle is in an invalid state.</dd>
<dt>
ERROR_INVALID_PARAMETER</dt>
<dd>
An invalid parameter was passed to the function.</dd>
<dt>
ERROR_SUCCESS</dt>
<dd>
The function succeeded.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The MSIMODIFY_VALIDATE, MSIMODIFY_VALIDATE_NEW, and MSIMODIFY_VALIDATE_FIELD values of the <b>MsiViewModify</b> function do not perform actual updates; they ensure that the data in the record is valid.</p>
<p>
The <b>MsiViewModify</b> function uses the following action and modification mode descriptions.
<dl>
<dt>
MSIMODIFY_INSERT</dt>
<dd>
Inserts the information into the database table. You are not required to call the <a href="qref_9b54.htm"><b>MsiViewFetch</b></a> function before you call this operation. <b>MsiViewModify</b> fails if a row with the same primary keys exists in the table. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_UPDATE</dt>
<dd>
Updates the existing information in the database, allowing modification of non-primary keys only. Before you call this operation, you must call the <b>MsiViewFetch</b> function with the same record as that returned by the fetch. The function fails if the row has been deleted from the table. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_DELETE</dt>
<dd>
Deletes the information already existing in the database. Before you call this operation, you must call the <b>MsiViewFetch</b> function with the same record as that returned by the fetch. The function fails if the row has been deleted from the table. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_INSERT_TEMPORARY</dt>
<dd>
Temporarily inserts the information into the database table. The information is not persistent. You are not required to call the <b>MsiViewFetch</b> function before you call this operation. The function fails if a row with the same primary keys exists. For this operation, the database can be writable or read-only.</dd>
<dt>
MSIMODIFY_REFRESH</dt>
<dd>
Refreshes the information in the record from the database. Before you call this operation, you must call the <b>MsiViewFetch</b> function with the same record as that returned by the retrieval. The function fails if the row has been deleted from the table. For this operation, the database can be writable or read-only.</dd>
<dt>
MSIMODIFY_ASSIGN</dt>
<dd>
Inserts or updates the information into the database table. You are not required to call the <b>MsiViewFetch</b> function before you call this operation. An update operation takes place if primary keys match an existing row. An insert operation takes place if primary keys do not match any row. In either case, the current data in the cursor is written to a table row. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_MERGE</dt>
<dd>
Inserts or validates the information into the database table. You are not required to call the <a href="qref_9b54.htm"><b>MsiViewFetch</b></a> function before you call this operation. An insert operation takes place if primary keys do not match any row. A validation operation takes place if primary keys match an existing row. The operation fails if the record data does not match the data in the table. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_REPLACE</dt>
<dd>
Performs an update or a delete/insert operation on the information that is going into the database table. Before you call this operation, you must call the <b>MsiViewFetch</b> function with the same record as that returned by the fetch. If the primary keys have not been changed, an update of the table row occurs. If the primary keys have been changed, the old table row is deleted and a new row corresponding to the record is inserted. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_VALIDATE</dt>
<dd>
Validates a record. This operation does not validate across joins. Before calling the operation, you must call the <b>MsiViewFetch</b> function with the same record as that returned by the fetch. You can obtain validation errors by calling <a href="qref_541e.htm"><b>MsiViewGetError</b></a>. For this operation, the database can be read-only or writable.</dd>
<dt>
MSIMODIFY_VALIDATE_DELETE</dt>
<dd>
Validates a row of a retrieved record that will later be deleted. Before calling this operation, you must call the <a href="qref_9b54.htm"><b>MsiViewFetch</b></a> function. The function fails if another row of a table refers to the primary keys of this row. However, validation does not check for the existence of the primary keys of this row in properties or strings. This operation also does not check if a column might be a foreign key to possibly multiple tables of which the table for this row is listed. You can obtain validation errors by calling <b>MsiViewGetError</b>. </dd>
<dt>
MSIMODIFY_VALIDATE_NEW</dt>
<dd>
Validates a record as a new record. This operation does not validate across joins. This operation differs from MSIMODIFY_VALIDATE because it checks for duplicate keys. You can obtain validation errors by calling <b>MsiViewGetError</b>. For this operation, the database must be writable.</dd>
<dt>
MSIMODIFY_VALIDATE_FIELD</dt>
<dd>
Validates fields of a fetched or new record. This operation does not validate across joins. The validation depends upon the number of fields in the record. If only one field exists, the operation validates only that field. The operation can also validate more fields. It should be used when the fetched/new record does not represent every column of the table. You can obtain validation errors by calling <a href="qref_541e.htm"><b>MsiViewGetError</b></a>. For this operation, the database can be writable or read-only.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later. Available as a redistributable for Windows NT 4.0.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in msiquery.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use msi.lib.</p>
<h4>See Also</h4>
<p>
<a href="qref_9okl.htm">Database Access Reference</a>, <a href="qref_9okl.htm#_msi_general_database_access_functions">General Database Access Functions</a> </p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_user_interface"></a>User Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes the user interface portion of the Microsoft  Windows  installer. You can author a full graphical user interface by populating the appropriate tables or you can choose to bypass the internal UI functionality and use an external UI.</p>
<p>&nbsp;</p>

<h1><a name="_msi_about_the_user_interface"></a>About The User Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can author a full graphical user interface from within the Microsoft  Windows  installer. To use the interface you must populate the appropriate tables. For each dialog box that you want to use, you must enter its properties in the <a href="tref_51wl.htm">Dialog table</a>. Similarly, the <a href="tref_0c4l.htm">BillBoard table</a> is for the billboards you can display. You can fill dialog boxes and billboards with controls by populating the <a href="tref_6nad.htm">Control table</a> and <a href="tref_78it.htm">BBControl table</a>, respectively. You may need to present a different set of controls based on various conditions. There may be a control that should be presented if the operating system is Microsoft  Windows NT  but not if it is Microsoft  Windows  95. You can set whether a control is presented based on a conditional expression with the <a href="tref_4vhh.htm">ControlCondition table</a>.</p>
<p>
There are many events that controls on a dialog box can both broadcast and respond to. The logic of what happens is defined within the <a href="tref_6k11.htm">ControlEvent table</a> and the <a href="tref_6m3p.htm">EventMapping table</a>. The EventMapping table indicates the controls that should respond to events while the ControlEvent table describes the events that are broadcast by a control. For more information about control events see <a href="hand_5fhz.htm">ControlEvent overview</a>.</p>
<p>
Some controls have more information associated with them. You can use check boxes in your user interface by filling the <a href="tref_3fmt.htm">CheckBox table</a> with the appropriate values. Use a check box to allow the user to set a property to some value. The records in the check box table are linked to the control table by the property that the control sets. A similar method of setting properties can also be used with other controls such as combo boxes, list boxes, radio buttons, and list views. The information for these controls is contained in the <a href="tref_9wit.htm">ComboBox table</a>, the <a href="tref_5f1h.htm">ListBox table</a>, the <a href="tref_4t7p.htm">RadioButton table</a>, and the <a href="tref_0vs5.htm">ListView table</a>, respectively.</p>
<p>
There are several tables relating to the text you might need to use during an installation. You can make your dialog box present information to the user or write it to a log in response to installation actions by populating the <a href="tref_7het.htm">ActionText table</a>. The <a href="tref_0vz9.htm">UIText table</a> contains the text that is presented to the user. You can define a set of styles for text formatting by populating the <a href="tref_30px.htm">TextStyle table</a>. If this table is populated, you can refer to the styles to format strings in other tables.</p>
<p>&nbsp;</p>

<h2><a name="_msi_user_interface_schema"></a>User Interface Schema</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/images/gui.gif" border=0></p>
<p>
</p>
<p>&nbsp;</p>

<h2><a name="_msi_control_overview"></a>Control Overview</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The controls are divided into two major groups: active and inert. The <a href="href_2z6t.htm#_msi_controls_list">active controls</a> are linked to some property. These controls are authored with some property. When the control is created it shows the initial value of the property. The user can change the value of the property by interacting with the control. The <a href="href_2z6t.htm#_msi_controls_list">inert controls</a> are not linked to a property; they do not change a property value.</p>
<p>&nbsp;</p>

<h2><a name="_msi_controlevent_overview"></a>ControlEvent Overview</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Controls on the same dialog box can communicate with each other by means of ControlEvents. </p>
<p>
Each ControlEvent has one publisher (a control or the installer itself) and can have several subscribers. The kind of ControlEvents published by a control is determined by the type of the control. Theoretically any control can subscribe to any ControlEvent, although many combinations are not practical. </p>
<p>
A control can subscribe to a ControlEvent in the following ways:
<ul>
<li>
If a control is listed in the <a href="tref_6m3p.htm">EventMapping table</a> with a ControlEvent, it describes the <a href="hand_8mrb.htm">attribute</a> of the control that must be changed when the ControlEvent is published.</li>
<li>
If a control is listed in the <a href="tref_6k11.htm">ControlEvent table</a> with a ControlEvent, it means that activating the control (clicking the button) triggers a ControlEvent with the described parameter.</li>
</ul>
<p>
A custom control can publish its own ControlEvents and other controls (custom or regular) can subscribe to them.</p>
<p>
The publisher of a ControlEvent can hide/show or enable/disable its subscribers when its state requires it.</p>
<p>
It is perfectly reasonable to have a control on a dialog box that publishes some ControlEvent but to have no subscribers to the control. In contrast, if a control subscribes to a ControlEvent that is not published by the handler and a publishing control is not present on the same dialog box, it can result in an error (especially if the control attempts to trigger that event).</p>
<p>
For a more comprehensive explanation on a specific control, see the <a href="href_2z6t.htm#_msi_controlevents_list">ControlEvents list</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_progress_bar_overview"></a>Progress Bar Overview</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
During script execution time, you can display a progress bar representing the status (time elapsed relative to time remaining) of the installation. In addition, the approximate time remaining for the install can also be displayed (in minutes and seconds).</p>
<p>
Here is an overview on how progress bars work in installer.
<ul>
<li>
While generating an execution script, MsiEngine keeps track of the total progress ticks anticipated by each action (it does this by intercepting ixoProgressTotal script records, and tallying up the specified tick counts). At the end of  script generation, the grand tick total is stored as the last field of the ixoEnd record.</li>
<li>
Once the script starts executing, the ixoHeader execution action seeks to the end of the script, pulls out the progress tick total, and sends a "progress master reset" message via the standard Message function. When the active message handler (either MsiHandler, or the Basic UI message object if no MsiHandler is active) receives this message, it resets its internal progress state, and stores away the progress tick total.</li>
<li>
As each script record is executed, progress messages are sent to the active message handler, each detailing the elapsed number of progress ticks. On each progress message, the MsiHandler (if active) broadcasts a <a href="href_771w.htm">SetProgress ControlEvent</a> to the active dialog (assumed in our discussion to be a modeless dialog, with a ProgressBar control somewhere on it).</li>
<li>
The active dialog receiving the SetProgress event checks the <a href="tref_6m3p.htm">EventMapping table</a> for any controls subscribing to that event. In this case, the ProgressBar on the dialog should be a subscriber, with the "Progress" attribute specified in the Attributes column. If so, the "Progress" attribute of the ProgressBar will be set with the "ticksSoFar" and "totalTicks" values passed along with the SetProgress ControlEvent, and the progress bar advances (all other control types ignore the Progress attribute).</li>
<li>
In addition, on each progress message, the MsiHandler also broadcasts a <a href="href_1egk.htm">TimeRemaining ControlEvent</a>. The total time remaining for the install is determined by first determining the dynamic "execution rate", i.e. the total number of ticks elapsed divided by the total time since the "master reset" message. The total ticks remaining divided by the execution rate gives the approximate time remaining.</li>
<li>
When receiving the TimeRemaining ControlEvent, the active dialog again looks in the EventMapping table, this time for any TimeRemaining subscribers. In order to display the time remaining, a Text control should be a subscriber, with the "TimeRemaining" attribute specified in the Attributes column. If so, the "TimeRemaining" attribute of the Text control will be set with the time remaining, in seconds. When this attribute is set on a Text control, that control will automatically look in the <a href="tref_0vz9.htm">UIText table</a> for a parameterized template string named "TimeRemaining". This string should have two parameters, [1] for minutes, and [2] for seconds. A good example for this string would be:</li>
<li>
"Time remaining: {[1] min }[2] sec" (The curly braces specify that if the minutes parameter drops to zero, only the seconds portion will be displayed).</li>
<li>
The <a href="href_4s30.htm">Text control</a> then converts the total seconds value to minutes and seconds, inserts these values into the TimeRemaining template string, and displays it. (If the template string is not found in the UIText table, you'll only get "UIText string not found!" message).</li>
<li>
If the Basic UI message handler is active (for example, if "LIMITUI=1" is specified as a property on the command line), the progress bar and "Time Remaining" text field are built in to the basic dialog.</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_using_the_user_interface"></a>Using The User Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are many dialog boxes you can author for your installation. To author a dialog box, you must populate the various tables. For examples of common dialog boxes and how to author dialog boxes in the Microsoft  Windows  installer database, see <a href="hand_0alh.htm">User Interface</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_filesinuse_dialog"></a>FilesInUse Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This dialog box can be authored to inform the user of any processes that are using files that must be overwritten or deleted. This gives the user the opportunity to shut down the offending processes, thus avoiding the necessity of rebooting the computer to complete the replacement or deletion of the in-use files. This dialog box is created as required by the <a href="aref_9fzi.htm">InstallValidate action</a>. See that topic for complete details.</p>
<p>&nbsp;</p>

<h2><a name="_msi_firstrun_dialog"></a>FirstRun Dialog</h2>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The FirstRun Dialog opens a user interface wizard that collects the user name, company name, and product ID information. The installer will also verify the product ID during this dialog. The FirstRun Dialog is typically not a part of the action sequence and is instead called by the <a href="msi_9crz.htm"><b>MsiCollectUserInfo</b></a> function on the first run of the product.</p>
<p>
An author of an installer package may use the template dialog or create a different dialog sequence. The dialog sequence however needs to have the user set the <a href="pref_9shl.htm">USERNAME property</a>, <a href="pref_5oc9.htm">COMPANYNAME property</a>, and <a href="pref_1v21.htm">PIDKEY property</a>. The product ID will be validated during the dialog using the <a href="aref_0cdq.htm">ValidateProductID action</a> or the <a href="href_0jqs.htm">ValidateProductID ControlEvent</a>.</p>
<p>
If the product ID is set as a property on the command line, or by a transform, then the necessity of having the user reenter the product ID during the first-run dialog can be circumvented by controlling the display using the <a href="pref_6et5.htm">ProductID property</a>. Following the successful validation of the product ID the ProductID property is set to the full valid product ID.</p>
<p>&nbsp;</p>

<h2><a name="_msi_browse_dialog"></a>Browse Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use this dialog box to select a directory, though the directory does not have to exist. </p>
<p>
The dialog box typically contains the following controls:
<ul>
<li>
A <a href="href_4pik.htm">PathEdit control</a> to select the tail section of the path. This control cannot lose focus if the entered tail is not valid on the present volume.</li>
<li>
A <a href="href_5xkc.htm">DirectoryCombo control</a> to show the presently selected path that is displayed by the PathEdit control. This control does not show the last segment of the path.</li>
<li>
A <a href="href_09f0.htm">DirectoryList control</a> to show the folders below the directory currently displayed by the DirectoryCombo. This can also show a folder that is not yet created.</li>
</ul>
<p>
The preceding three controls are connected to the same property (possibly indirectly). The property is the path being selected.</p>
<p>
The DirectoryCombo control specifies, with its stylebits, the volume types that are displayed. On a typical Browse dialog box, probably all types should be turned on.</p>
<p>
The dialog box typically also contains three <a href="href_331o.htm">PushButton controls</a>, that serve as <b>Up One Level</b>, <b>New Folder</b>, and <b>Open</b> buttons. The buttons subscribe to the <a href="href_7fqs.htm">DirectoryListUp</a>, <a href="href_7e2c.htm">DirectoryListNew</a>, and <a href="href_7ab8.htm">DirectoryListOpen</a> control events respectively, using the <a href="tref_6k11.htm">ControlEvent Table</a>.</p>
<p>
If the dialog box is designed to search for existing folders only, the <b>New Folder</b> button can be omitted.</p>
<p>
When this dialog box is authored, the "NewFolder" string must be defined in the <a href="tref_0vz9.htm">UIText Table</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_cancel_dialog"></a>Cancel Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use this modal dialog box to confirm that the user wants to terminate the installation. This dialog box typically contains a <a href="href_4s30.htm">Text control</a> and two <a href="href_331o.htm">PushButtons</a>. The two buttons give the user the choice to return to the last dialog box or confirm the termination of the installation. The two buttons in the <a href="tref_6k11.htm">ControlEvent Table</a> are linked to the <a href="href_9a0k.htm">EndDialog</a> control event with the Return and Exit parameters. The Return parameter causes the Cancel dialog box to be terminated and the focus returns to the previous dialog box. The Exit parameter causes the user interface to return control to the installer with the appropriate code indicating that the user wants to exit. The installer then shuts down and displays the <a href="hand_2013.htm">UserExit Dialog</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_diskcost_dialog"></a>DiskCost Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This dialog box typically appears when the OutOfDiskSpace property is set indicating that there is not enough disk space for the currently selected installation.</p>
<p>
This dialog box or a variation of it can also be activated from the <a href="hand_9llz.htm">Selection Dialog</a>, to give the user an overview of the disk space needed on the different volumes.</p>
<p>
The dialog box is modal and normally contains a <a href="href_7ing.htm">VolumeCostList control</a> and a <a href="href_331o.htm">PushButton</a> that returns the user to the previous dialog box. It can contain other controls like static text or pictures.</p>
<p>&nbsp;</p>

<h2><a name="_msi_error_dialog"></a>Error Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can use this modal dialog box to display an error message. More than one error dialog box is possible in one installation. The ErrorDialog property specifies which dialog box is used as an error dialog box. If this property is not set or does not point to a valid error dialog box, the error messages are not displayed, only logged with a warning about the missing error dialog box.</p>
<p>
This dialog box must have the <a href="href_6fg4.htm">ErrorDialog</a> style bit set. The dialog box must have a <a href="href_4s30.htm">Text control</a> named ErrorText. This control displays the text of the error message.</p>
<p>
The dialog box is also authored with seven <a href="href_331o.htm">PushButtons</a>. These buttons must specify the <a href="href_9a0k.htm">EndDialog</a> control event in the <a href="tref_6k11.htm">ControlEvent Table</a> with the following parameters: ErrorAbort, ErrorCancel, ErrorIgnore, ErrorNo, ErrorOk, ErrorRetry, ErrorYes.</p>
<p>
You should author the buttons in approximately the same position. When the dialog box is created only a subset of these buttons is created, depending on the message, and the X coordinate of the buttons is modified so the displayed buttons are evenly spaced. The other three coordinates of the buttons are not changed. Since the buttons are rearranged, the author should make sure that no other control is placed in the same horizontal region of the dialog box as the buttons.</p>
<p>
The error message can consist of three portions. The first portion is the text of the error message, and it is required. </p>
<p>
The second portion is a list of letters, enclosed in curly braces, specifying the buttons to create. The letters are the first letters of the words abort, cancel, ignore, no, Ok, retry, yes. All the letters must be lowercase except the one that designates the default button. If this list of codes is missing or empty, it is assumed to be {O} and the <b>OK</b> button becomes default.</p>
<p>
The third portion of the error message is optional. If present, this string is used as the title for the dialog box, overwriting the title entered in the <a href="tref_51wl.htm">Dialog Table</a>. If this string is present the second portion must also be present to separate the part. (remember, the second part can be an empty list {}).</p>
<p>
For an error dialog box, the FirstControl, DefaultControl, and CancelControl entries in the Dialog Table are ignored, and the default button specified by the message plays all three roles.</p>
<p>&nbsp;</p>

<h2><a name="_msi_exit_dialog"></a>Exit Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This modal dialog box displays at the end of a successful installation. This dialog box typically contains only some text and an <b>OK</b> button. The name of this dialog box must appear in the <a href="tref_5lnp.htm">AdminUISequence table</a> and <a href="tref_1git.htm">InstallUISequence table</a> with -1 as the sequence number.</p>
<p>&nbsp;</p>

<h2><a name="_msi_fatalerror_dialog"></a>FatalError Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This modal dialog box displays at the end of an installation, if the installation is terminated because of a fatal error. This dialog box typically contains only some text and an <b>OK</b> button. The name of this dialog box must appear in the <a href="tref_5lnp.htm">AdminUISequence table</a> and <a href="tref_1git.htm">InstallUISequence table</a> with -3 as the sequence number.</p>
<p>&nbsp;</p>

<h2><a name="_msi_licenseagreement_dialog"></a>LicenseAgreement Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This modal dialog box displays the license agreement to the user. Typically the text of the agreement is displayed in a <a href="href_3i5o.htm">ScrollableText control</a>.</p>
<p>
The dialog box typically also contains a pair of option buttons that let the user accept or reject the agreement. For legal reasons it is advisable that neither of the buttons is selected initially, forcing the user to make an active choice. This can be achieved by not having an initial value for the property linked to the <a href="href_6iwc.htm">RadioButtonGroup</a>. The author can also disable/enable the next button on this dialog box, depending on the choice made. Another possible situation is when the next button takes the user to different dialog boxes depending on the choice he or she makes.</p>
<p>&nbsp;</p>

<h2><a name="_msi_selection_dialog"></a>Selection Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This modal dialog box enables the user to select individual items. The dialog box contains a <a href="href_3w30.htm">SelectionTree control</a> that displays the main information. This control publishes several events that change the display on other controls of the dialog box. Typically there are four <a href="href_4s30.htm">Text controls</a> subscribing to the <a href="href_66lw.htm">SelectionAction</a>, <a href="href_2qno.htm">SelectionDescription</a>, <a href="href_94z8.htm">SelectionSize</a>, and <a href="href_1d6c.htm">SelectionPath</a> events using the <a href="href_2kmd.htm">Text control attribute</a>. There is also a control that subscribes to the <a href="href_0778.htm">SelectionIcon</a> event through the <a href="href_3tut.htm">ImageHandle attribute</a>. The above controls use the <a href="tref_6m3p.htm">EventMapping Table</a> to specify these subscriptions. There is also a <a href="href_331o.htm">PushButton</a> that subscribes to the <a href="href_01dg.htm">SelectionBrowse</a> event using the <a href="tref_6k11.htm">ControlEvent Table</a> and giving the name of the <a href="hand_246f.htm">Browse dialog</a> as the parameter. When a SelectionTree control is authored, the AbsentPath, SelAbsentAbsent, SelAbsentLocal, SelAbsentCD, SelAbsentNetwork, SelLocalAbsent, SelLocalLocal, SelLocalCD, SelLocalNetwork, SelCDAbsent, SelNetworkAbsent, SelCDLocal, SelNetworkLocal, SelCDCD, SelNetworkNetwork, SelChildCostPos, SelChildCostNeg, SelParentCostPosPos, SelParentCostPosNeg, SelParentCostNegPos, SelParentCostNegNeg, MenuAbsent, MenuLocal, MenuCD, MenuNetwork strings must be specified in the <a href="tref_0vz9.htm">UIText table</a>. The selection tree gets populated only if the CostInitialize and CostFinalize actions were all previously called.</p>
<p>&nbsp;</p>

<h2><a name="_msi_userexit_dialog"></a>UserExit Dialog</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This modal dialog box displays at the end of an installation that was ended by the user. This dialog box typically contains only some text and an <b>OK</b> button. The name of this dialog box must appear in the <a href="tref_5lnp.htm">AdminUISequence table</a> and <a href="tref_1git.htm">InstallUISequence table</a> with -2 as the sequence number.</p>
<p>&nbsp;</p>

<h2><a name="_msi_authoring_disk_prompt_messages"></a>Authoring Disk Prompt Messages</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a message box prompting the user to insert a disk</h5>
<ol>
<li>
Use the authoring capabilities of the installer to set the <a href="pref_092x.htm">DiskPrompt property</a> string in the <a href="tref_21d1.htm">Property table</a>. This should include the name of the product being installed and a placeholder parameter within the string for the title printed on the disk. For example, for Microsoft  Publisher the DiskPrompt property could be "Microsoft Publisher: Disk [1]", where [1] is the placeholder for the disk title. </li>
<li>
Enter the titles of each of the disks being prompted for into separate rows of the DiskPrompt column of the <a href="tref_4mlh.htm">Media table</a>. For example, the first and only entry into the Media table could be "1 - Install."</li>
<li>
During the <a href="aref_3hym.htm">InstallFiles action</a> the value from the DiskPrompt column of the Media table is substituted for the placeholder in the string of the DiskPrompt property.</li>
<li>
The message displayed by the message box is created from a built-in template string in the <a href="tref_5dk5.htm">Error table</a>. This is Error 1329 and the template string is: "Please insert the disk: [2], and the [2] represents a placeholder for the DiskPrompt property.</li>
</ol>
<p>
The example displays the following message to the user: Please insert the disk: Microsoft Publisher: Disk 1 - Install.</p>
<p>&nbsp;</p>

<h2><a name="_msi_dialog_for_suspending_the_rollback_of_failed_installs"></a>Dialog for Suspending the Rollback of Failed Installs</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a dialog box presenting the option to suspend the automatic rollback of a failed or cancelled installation</h5>
<ol>
<li>
Use the authoring capabilities of the installer to set the <a href="pref_667t.htm">ALLOWSUSPEND property</a>.</li>
<li>
Following a failed or cancelled installation, and before the final exit dialog, the installer will display a error dialog box giving the option of suspending the automatic rollback of a failed or cancelled install.</li>
<li>
Selecting to suspend the rollback in this dialog allows the pending installation to be continued at a later time. Rejecting to suspend rollback results in a rollback of the pending installation.</li>
<li>
When continuing the suspended install at a later time, you must use a command line that is identical to the command line of the first install. </li>
</ol>
<p>
The default for not setting the ALLOWSUSPEND property is to not display the dialog box and to continue with an automatic rollback of a failed or cancelled installation.</p>
<p>&nbsp;</p>

<h2><a name="_msi_authoring_a_conditional_please_wait_._._._message_box"></a>Authoring a Conditional "Please Wait . . ." Message Box</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following example illustrates how to author a conditional message box that pops up and warns the user that a background task is still running whenever the user activates a displayed control prematurely. </p>
<p>
The example also illustrates how the <a href="href_95ro.htm">SpawnWaitDialog ControlEvent</a> can in general be used to protect a control that triggers an action dependent upon the completion of a background task. </p>
<p>
In this example, a <a href="hand_9llz.htm">Selection Dialog</a> containing three pushbutton controls labeled Install Now, Next, and Disk Cost is displayed to the user during the installation process. However, the installer also carries out a disk space costing task in the background while displaying this dialog box. The author wishes to protect these buttons from activation and wants a "Please wait" message box to pop up if the user pushes any of the buttons before the costing has completed. The author also wants this message box to contain a Cancel button and to disappear as soon as the background  task is finished .</p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a dialog box asking the user to wait while background disk costing is completed</h5>
<ol>
<li>
Use the authoring capabilities of the installer to add a new modal dialog box, named WaitForCosting, into the <a href="tref_51wl.htm">Dialog table</a>. The dialog box should display a text string that says "Please wait while disk space costing is completed." </li>
<li>
Add a single pushbutton control to this dialog, labeled Cancel, by authoring it into the <a href="tref_6nad.htm">Control table</a>.</li>
<li>
Link the Cancel pushbutton to a control event that closes the WaitForCosting dialog box by authoring an <a href="href_9a0k.htm">EndDialog ControlEvent</a> into the <a href="tref_6k11.htm">ControlEvent table</a>. Set the argument of the EndDialog Control event to be Exit.</li>
<li>
Link a <a href="href_95ro.htm">SpawnWaitDialog ControlEvent</a> to the existing Install Now, Next, and Disk Cost pushbutton controls displayed in the <a href="hand_9llz.htm">Selection Dialog</a> box. Set the argument of this control event in the ControlEvent table to be the WaitForCosting dialog and set the expression in the Condition column of the table to be: <a href="pref_7kah.htm">CostingComplete</a> =1.</li>
</ol>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_user_interface_reference"></a>User Interface Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and developers who want to learn more about the Microsoft  Windows  installer database tables. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>

<h4><a name="_msi_dialog_stylebits_list"></a>Dialog Stylebits List</h4>
<p>
The following list provides links to more information about dialog box stylebits:</p>
<p>
<a href="href_6fg4.htm">Error</a> = 65536 (0x00010000)<br>
<a href="href_7t4k.htm">KeepModeless</a> = 16 (0x00000010)<br>
<a href="href_052s.htm">Minimize</a> = 4 (0x00000004)<br>
<a href="href_79kk.htm">Modal</a> = 2 (0x00000002)<br>
<a href="href_9vlg.htm">TrackDiskSpace</a> = 32 (0x00000020)<br>
<a href="href_4184.htm">UseCustomPalette</a> = 64 (0x000040)<br>
<a href="href_5agk.htm">Visible</a> = 1 (0x00000001)</p>

<h4><a name="_msi_controls_list"></a>Controls List</h4>
<p>
The following list provides links to more information about inert controls:</p>
<p>
<a href="href_0gj0.htm">Billboard</a><br>
<a href="href_2ey4.htm">Bitmap</a><br>
<a href="href_63os.htm">GroupBox</a><br>
<a href="href_1tt8.htm">Icon</a><br>
<a href="href_6i7g.htm">Line</a><br>
<a href="href_0tkc.htm">ProgressBar Control</a><br>
<a href="href_331o.htm">PushButton</a><br>
<a href="href_3i5o.htm">ScrollableText</a><br>
<a href="href_4s30.htm">Text</a><br>
<a href="href_7ing.htm">VolumeCostList</a></p>
<p>
The following list provides links to more information about active controls:</p>
<p>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_4yp8.htm">ComboBox</a><br>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_09f0.htm">DirectoryList</a><br>
<a href="href_9yjw.htm">Edit</a><br>
<a href="href_1yjw.htm">ListBox</a><br>
<a href="href_6omk.htm">ListView</a><br>
<a href="href_8re4.htm">MaskedEdit</a><br>
<a href="href_4pik.htm">PathEdit</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a><br>
<a href="href_3w30.htm">SelectionTree</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>

<h4><a name="_msi_control_attributes_list"></a>Control Attributes List</h4>
<p>
The following list provides links to more information about control attributes:</p>
<p>
<a href="href_21np.htm">BillboardName</a><br>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_590l.htm">Image</a><br>
<a href="href_3tut.htm">ImageHandle</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_8hyd.htm">Progress</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_6yxx.htm">Transparent</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<p>
When a control is created several attributes can be selected by setting certain style bits.</p>

<h4><a name="_msi_control_stylebits_list"></a>Control Stylebits List</h4>
<p>
The following list provides links to more information about control stylebits:</p>
<p>
<a href="href_4xtg.htm">Bitmap</a> = 262144 (0x00040000)<br>
<a href="href_01x0.htm">CDROMVolume</a> = 524288 (0x00080000)<br>
<a href="href_8h10.htm">ComboList</a> = 131072 (0x00020000)<br>
<a href="href_6do4.htm">Enabled</a> = 2 (0x00000002)<br>
<a href="href_01f8.htm">FixedSize</a> = 1048576 (0x00100000)<br>
<a href="href_0lo4.htm">FixedVolume</a> = 131072 (0x00020000)<br>
<a href="href_0m9g.htm">FloppyVolume</a> = 2097152 (0x00200000)<br>
<a href="href_1d10.htm">HasBorder</a> = 16777216 (0x01000000)<br>
<a href="href_9gok.htm">Icon</a> = 524288 (0x00080000)<br>
<a href="href_6h6b.htm">IconSize</a> = 2097152 (0x00200000),  4194304 (0x00400000)<br>
<a href="href_9mcz.htm">ImageHandle</a> = 65536 (0x00010000)<br>
<a href="href_2984.htm">Indirect</a> = 8 (0x00000008)<br>
<a href="href_95mc.htm">Integer</a> = 16 (0x00000010)<br>
<a href="href_6qlw.htm">Progress95</a> = 65536 (0x00010000)<br>
<a href="href_69pw.htm">PushLike</a> = 131072 (0x00020000)<br>
<a href="href_2ypg.htm">RAMDiskVolume</a> = 1048576 (0x00100000)<br>
<a href="href_4egk.htm">RemoteVolume</a> = 262144 (0x00040000)<br>
<a href="href_1rqs.htm">RemovableVolume</a> = 65536 (0x00010000)<br>
<a href="href_56t0.htm">Sorted</a> = 65536 (0x00010000)<br>
<a href="href_1tmc.htm">Sunken</a> = 4 (0x00000004)<br>
<a href="href_4f1w.htm">Transparent</a> = 65536 (0x00010000)<br>
<a href="href_3i2c.htm">Visible</a> = 1 (0x00000001)</p>

<h4><a name="_msi_controlevents_list"></a>ControlEvents List</h4>
<p>
The following list provides links to more information about ControlEvents:</p>
<p>
<a href="href_33lg.htm">ActionData</a><br>
<a href="href_0dpw.htm">ActionText</a><br>
<a href="href_1jw4.htm">AddLocal</a><br>
<a href="href_25mc.htm">AddSource</a><br>
<a href="href_1w1g.htm">CheckExistingTargetPath</a><br>
<a href="href_171w.htm">CheckTargetPath</a><br>
<a href="href_7e2c.htm">DirectoryListNew</a><br>
<a href="href_7ab8.htm">DirectoryListOpen ControlEvent</a><br>
<a href="href_7fqs.htm">DirectoryListUp</a><br>
<a href="href_2zjo.htm">DoAction</a><br>
<a href="href_9a0k.htm">EndDialog</a><br>
<a href="href_18ms.htm">IgnoreChange</a><br>
<a href="href_9myc.htm">NewDialog</a><br>
<a href="href_8gdw.htm">Reinstall</a><br>
<a href="href_0x6c.htm">ReinstallMode</a><br>
<a href="href_0lx0.htm">Remove</a><br>
<a href="href_7d2s.htm">Reset</a><br>
<a href="href_66lw.htm">SelectionAction</a><br>
<a href="href_01dg.htm">SelectionBrowse</a><br>
<a href="href_2qno.htm">SelectionDescription</a><br>
<a href="href_0778.htm">SelectionIcon</a><br>
<a href="href_1d6c.htm">SelectionPath</a><br>
<a href="href_6tf8.htm">SelectionPathOn</a><br>
<a href="href_94z8.htm">SelectionSize</a><br>
<a href="href_3oms.htm">SetInstallLevel</a><br>
<a href="href_771w.htm">SetProgress</a><br>
<a href="href_7nuc.htm">SetProperty</a><br>
<a href="href_7khg.htm">SetTargetPath</a><br>
<a href="href_0qus.htm">SpawnDialog</a><br>
<a href="href_95ro.htm">SpawnWaitDialog</a><br>
<a href="href_1egk.htm">TimeRemaining</a><br>
<a href="href_0jqs.htm">ValidateProductID</a></p>
<p>&nbsp;</p>

<h2><a name="_msi_dialog_stylebits"></a>Dialog Stylebits</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes dialog stylebits.</p>
<p>&nbsp;</p>

<h1><a name="_msi_error_dialog_stylebit"></a>Error Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the dialog is an error dialog.</p>
<p>
There can be more than one dialog with this style. The ErrorDialog property determines which dialog is used as an error dialog. The selected dialog can be only one of those that have this style bit set. The error dialog must have a static text control named ErrorText. This control receives the text of the error message. The dialog should also have the seven push buttons corresponding to the possible return values. The error message determines which of these buttons are actually displayed. The displayed buttons are rearranged so they are evenly distributed on the dialog. This rearrangement changes the X coordinate of the buttons, but not the other three coordinates. Therefore it is advisable that no other control should be authored in the same horizontal region of the dialog as the buttons. If the error message specifies no button, the OK button is displayed. The Default button, First active control and Cancel button values are ignored for an error dialog. The default button defined in the error message will be assigned to all three values. The effect of pushing these buttons have to be defined in the <a href="tref_6k11.htm">ControlEvent Table</a> just like for all other buttons. The title of the dialog is authored in a way similar to other dialogs. It can get overwritten by the error message if it specifies a header text after the button list. </p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_keepmodeless_dialog_stylebit"></a>KeepModeless Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Normally, when this bit is not set and a dialog is created through DoAction, all other (typically modeless) dialogs are destroyed. If this bit is set, the other dialogs stay alive when this dialog is created.</p>
<h4>Numeric Value</h4>
<p>
0x00000010 = 16</p>
<p>&nbsp;</p>

<h1><a name="_msi_minimize_dialog_stylebit"></a>Minimize Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set, the dialog can be minimized. In Windows, the dialog's minimize button is enabled and the minimize item is enabled in the system menu. This bit is ignored for modeless dialogs that cannot be minimized.</p>
<h4>Numeric Value</h4>
<p>
0x00000004 = 4</p>
<p>&nbsp;</p>

<h1><a name="_msi_modal_dialog_stylebit"></a>Modal Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set, the dialog is modal, other dialogs of the same application cannot be put on top of it, and the dialog keeps the control while it is running. If this bit is not set, the dialog is modeless, other dialogs of the same application may be moved on top of it. After a modeless dialog is created and displayed, the user interface returns control to the installer. The installer then calls the user interface periodically to update the dialog and to give it a chance to process the messages. As soon as this is done, the control is returned to the installer. </p>
<p>
<b>Note</b>&nbsp;&nbsp;There should be no modeless dialogs in a wizard sequence, since this would return control to the installer, ending the wizard sequence prematurely.</p>
<h4>Numeric Value</h4>
<p>
0x00000002 = 2</p>
<p>&nbsp;</p>

<h1><a name="_msi_trackdiskspace_dialog_stylebit"></a>TrackDiskSpace Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set, the dialog periodically calls the installer. If the property changes, it notifies the controls on the dialog. This style can be used if there is a control on the dialog indicating whether you are out of disk space. If the user switches to another application and adds/removes files or otherwise modifies the available disk space, you can quickly catch the change using this style.</p>
<h4>Numeric Value</h4>
<p>
0x0000020 = 32</p>
<p>&nbsp;</p>

<h1><a name="_msi_usecustompalette_dialog_stylebit"></a>UseCustomPalette Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the pictures on the dialog will be created with the custom palette (one per dialog received from the first control created). If the bit is not set, the pictures are rendered using a default palette.</p>
<p>
Typically one would set this bit if the dialog contains a picture with a special palette, or several pictures sharing a custom palette. The bit should be unset if the dialog contains several pictures with different palettes. In this case the default will be most likely to give a satisfactory result for all pictures.</p>
<h4>Numeric Value</h4>
<p>
0x00000040 = 64</p>
<p>&nbsp;</p>

<h1><a name="_msi_visible_dialog_stylebit"></a>Visible Dialog Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the dialog is originally created as visible, otherwise it is hidden.</p>
<h4>Numeric Value</h4>
<p>
0x0000001 = 1</p>
<p>&nbsp;</p>

<h2><a name="_msi_controls"></a>Controls</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes controls.</p>
<p>&nbsp;</p>

<h1><a name="_msi_billboard_control"></a>Billboard Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control plays the billboards based on progress messages. The billboards are composed of individual controls that are added and later removed from the dialog.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control.</p>
<h4>Valid Style Bits</h4>
<p>
None.</p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_21np.htm">BillboardName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
This control has no window of its own.</p>
<p>&nbsp;</p>

<h1><a name="_msi_bitmap_control"></a>Bitmap Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control simply displays a static picture of a bitmap.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_590l.htm">Image</a><br>
<a href="href_3tut.htm">ImageHandle</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
This control is created as a "STATIC" with the SS_BITMAP, SS_CENTERIMAGE, WS_CHILD, and WS_GROUP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_groupbox_control"></a>GroupBox Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control displays a rectangle, possibly with some caption. It only serves as a visual element on the dialog to group other controls together.</p>
<p>
Because of the way Windows draws this control, there is a gap between the top of the control's window and the visible frame, even when there is no caption.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
The control is created as a "BUTTON" with the BS_GROUPBOX, WS_CHILD, WS_GROUP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_icon_control"></a>Icon Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control simply displays a static picture of an icon. The background of the image is transparent.</p>
<p>
An icon file can contain different size images of the same icon. If the <a href="href_9gok.htm">IconSize</a> bits are set, the first image of the specified size is loaded. If no size is specified, the first image is loaded.</p>
<p>
If the <a href="href_9gok.htm">IconSize</a> bits are not set the <a href="href_01f8.htm">FixedSize</a> bit is ignored and the image is stretched to fit the control rectangle.</p>
<p>
If both the IconSize bits and the FixedSize bit are set and the control is larger than the icon, the image is centered in the control. If the image is larger than the control it is not chopped (unlike in the <a href="href_2ey4.htm">Bitmap</a> control) but shrunk to fit the control.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_6h6b.htm">IconSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_590l.htm">Image</a><br>
<a href="href_3tut.htm">ImageHandle</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<p>
No.</p>
<h4>Remarks</h4>
<p>
This control is created as a "STATIC" with the SS_ICON, SS_CENTERIMAGE, WS_CHILD, and WS_GROUP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_line_control"></a>Line Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a simple horizontal line.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
The Line control is implemented is using a STATIC control with the SS_ETCHEDHORZ and SS_SUNKEN styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_progressbar_control"></a>ProgressBar Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control displays a rectangle filling up as it receives progress messages. Typically should subscribe to the <a href="href_771w.htm">SetProgress</a> control event or a control event whose name matches the name of the action whose progress is gauged. </p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6qlw.htm">Progress95</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_8hyd.htm">Progress</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
The control is created as a PROGRESS_CLASS. It also has the WS_CHILD and WS_GROUP styles. </p>
<p>&nbsp;</p>

<h1><a name="_msi_pushbutton_control"></a>PushButton Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control displays a basic push button.</p>
<p>
If the <a href="href_4xtg.htm">Bitmap</a> or the <a href="href_9gok.htm">Icon</a> style bit is set, the corresponding text entry in the Control Table is taken as a foreign key to the Binary Table that specifies the binary data needed to create the picture.</p>
<p>
This means that the button cannot have both a picture and a text.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_4xtg.htm">Bitmap</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_9gok.htm">Icon</a><br>
<a href="href_6h6b.htm">IconSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "BUTTON" class.</p>
<p>
It has the BS_MULTILINE, WS_CHILD, WS_TABSTOP, WS_GROUP styles.</p>
<p>
If the <a href="href_4xtg.htm">Bitmap</a> style is set it has the BS_BITMAP style.</p>
<p>
If the Icon style is set it has the BS_ICON style.</p>
<p>&nbsp;</p>

<h1><a name="_msi_scrollabletext_control"></a>ScrollableText Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control displays a long text that cannot fit on a page normally. A typical application for this control is displaying the license agreement.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
The control is created using the "RICHEDIT" class with the ES_MULTILINE, WS_HSCROLL, WS_VSCROLL, ES_READONLY, WS_TABSTOP, ES_AUTOHSCROLL, ES_AUTOVSCROLL, WS_CHILD and WS_GROUP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_text_control"></a>Text Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control displays a static text. The text may use a predefined style. This is done by putting the name of the style in the form {\style} at the start of the string, where style is one of the keys in the <a href="tref_30px.htm">TextStyle Table</a>. A base text style can be assigned to the control by supplying {&amp;style} at the very beginning of a the text string. This style is used whenever no other style is defined by the string.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_4f1w.htm">Transparent</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_6yxx.htm">Transparent</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<h4>Remarks</h4>
<p>
The control is created with the "STATIC" class and with the SS_LEFT, WS_CHILD, WS_GROUP styles.</p>
<p>
If the <a href="href_4f1w.htm">Transparent</a> style is set the control also has the WS_EX_TRANSPARENT style.</p>
<p>&nbsp;</p>

<h1><a name="_msi_volumecostlist_control"></a>VolumeCostList Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This special control presents information to the user about the cost associated with the selection on the different volumes. The control shows all the volumes involved in the current installation plus all volumes that are of the types specified in the attribute bits. If the required disk space exceeds the available amount on some drive, the volume is highlighted in the table. Clicking on a column header sorts the volumes according to the chosen column.</p>
<h4>Property</h4>
<p>
There can be no property associated with this control. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
No.</p>
<p>
<b>Related Strings in the UIText</b> <a href="tref_0vz9.htm"><b>Table</b></a></p>
<p>
The strings for the column headings in the table:</p>
<p>
<b>VolumeCostAvailable</b><br>
<b>VolumeCostDifference</b><br>
<b>VolumeCostRequired</b><br>
<b>VolumeCostSize</b><br>
<b>VolumeCostVolume</b></p>
<p>
The following four localized strings are used in formatting the size of a file.</p>
<p>
<b>Bytes</b><br>
<b>KB</b><br>
<b>MB</b><br>
<b>GB</b></p>
<h4>Remarks</h4>
<p>
This control is created with the WC_LISTVIEW class and the LVS_REPORT, WS_VSCROLL, WS_HSCROLL, LVS_SHAREIMAGELISTS, LVS_AUTOARRANGE, LVS_SINGLESEL, WS_BORDER, WS_CHILD, WS_TABSTOP, WS_GROUP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_checkbox_control"></a>CheckBox Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control is a simple two-state check box. If the <a href="tref_3fmt.htm">CheckBox table</a> exists and specifies a value for the property associated with the checkbox, the property is set to this value when the checkbox is on, to null otherwise. If there is no such table, or it does not specify a value for this property, but the associated property has an initial value, the control remembers it and initially drawn as selected. When the control is unchecked, the property is set to NULL. If the check box is rechecked, it returns to its original value. If the property does not have an original value, it is set to "1" when the control is checked.</p>
<h4>Property</h4>
<p>
The property associated with this control can be integer or string valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_4xtg.htm">Bitmap</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_9gok.htm">Icon</a><br>
<a href="href_6h6b.htm">IconSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_69pw.htm">PushLike</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "BUTTON" class.</p>
<p>
It has the BS_CHECKBOX, WS_TABSTOP, WS_GROUP, WS_CHILD and BS_MULTILINE styles.</p>
<p>
If the <a href="href_69pw.htm">PushLike</a> style is set it has the BS_PUSHLIKE style.</p>
<p>
If the <a href="href_4xtg.htm">Bitmap</a> style is set it has the BS_BITMAP style.</p>
<p>
If the <a href="href_9gok.htm">Icon</a> style is set it has the BS_ICON style.</p>
<p>&nbsp;</p>

<h1><a name="_msi_combobox_control"></a>ComboBox Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control is a drop-down combo box with an edit field. It makes a predefined list of values and also allows for the user to enter some new value. It reads the possible values from the <a href="tref_9wit.htm">ComboBox Table</a>. If the sorted style is set, the items are displayed according the <b>Ordering</b> column of the table. If the style is not set, that column is ignored and the items are displayed in alphabetical order.</p>
<p>
The length of the text that can be entered can be limited by putting a number from 0 to 2147483646 in curly braces at the beginning of the Text field in the <a href="tref_6nad.htm">Control Table</a>. For example if the text field starts with {80}, the length of the string is limited at 80 characters. If no such limit is supplied in the table, or if 0 is specified,the length is set to the maximum possible (2147483646 characters). A negative or non-numeric value will generate an error.</p>
<h4>Property</h4>
<p>
The property associated with this control can be integer or string valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_8h10.htm">ComboList</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_56t0.htm">Sorted</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "COMBOBOX" class with the CBS_AUTOHSCROLL, WS_TABSTOP, WS_GROUP, WS_CHILD styles. If the <a href="href_8h10.htm">ComboList</a> style bit is on, it also has the CBS_DROPDOWNLIST style, otherwise it has the CBS_DROPDOWN style.</p>
<p>
If the <a href="href_56t0.htm">Sorted</a> style is set, it also has the CBS_SORT style.</p>
<p>
For compatibility with screenreaders, when authoring a dialog with an ComboBox control as the first active control, you must make the text field belonging to the edit field the first active control in the <a href="tref_51wl.htm">Dialog Table</a>. Since the static text cannot take focus, when the dialog is created the edit field will have the focus initially as intended, but doing this ensures that screenreaders show the correct information.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directorycombo_control"></a>DirectoryCombo Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a special control designed for use on a browse dialog. It is designed to be used with a <a href="href_4pik.htm">PathEdit control</a> and a <a href="href_09f0.htm">DirectoryList</a> control on the same dialog. It lets the user select the main part of a path (everything except the last segment). It displays the available volumes in an alphabetical order and the steps of the currently displayed path in a hierarchical way. If the main part of the currently selected path contains any folders that do not exist, those files are displayed with a different icon. The property associated with this control has to have an initial value, and this value has to contain at least two steps (a volume and at least one level below). The selection of the initial style bits determines what kind of volumes are listed.</p>
<h4>Property</h4>
<p>
The property associated with this control can be only string valued. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "COMBOBOX" class with the CBS_DROPDOWNLIST, CBS_OWNERDRAWFIXED, CBS_HASSTRINGS, WS_CHILD, WS_GROUP, WS_TABSTOP and WS_VSCROLL styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directorylist_control"></a>DirectoryList Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a special control designed for use on a browse dialog. It is designed to be used with a <a href="href_4pik.htm">PathEdit</a> and <a href="href_5xkc.htm">DirectoryCombo</a> control on the same dialog. It shows the user the folders below the main part of a path (everything except the last segment). It displays the folders below the main part of the currently selected path. If the list contains any folders that don't exist at present time, those are displayed with a different icon. The property associated with this control has to have an initial value, and this value has to contain at least two steps (a volume and at least one level below). The primary goal of this control is to let the user select a subfolder of the current selection. With some additional buttons it also lets the user select a new phantom folder in current selection or step up one step in the path. If the user chooses the create new folder button in a folder where there is a phantom folder already, this folder is selected for editing instead of creating a second phantom folder. </p>
<h4>Property</h4>
<p>
The property associated with this control can be only string valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
<a href="href_7e2c.htm">DirectoryListNew</a><br>
<a href="href_18ms.htm">IgnoreChange</a><br>
<a href="href_7fqs.htm">DirectoryListUp</a><br>
<a href="href_7ab8.htm">DirectoryListOpen</a></p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<p>
<b>Related Strings in the</b> <a href="tref_0vz9.htm"><b>UIText Table</b></a></p>
<p>
<b>NewFolder</b> The default name of a newly created folder.</p>
<h4>Remarks</h4>
<p>
The control is created with the WC_LISTVIEW class with the LVS_LIST, LVS_EDITLABELS, WS_VSCROLL, LVS_SHAREIMAGELISTS, LVS_AUTOARRANGE, LVS_SINGLESEL, WS_BORDER, LVS_SORTASCENDING, WS_CHILD, WS_GROUP, WS_TABSTOP styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_edit_control"></a>Edit Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a regular edit field. The user can enter any string or integer. If the associated property is integer-valued it accepts only integer entries (not yet implemented). The length of the text that can be entered can be limited by putting a number from 0 to 2147483646 in curly braces at the beginning of the Text field in the <a href="tref_6nad.htm">Control Table</a>. For example if the text field starts with {80}, the length of the string is limited at 80 characters. If no such limit is supplied in the table, or if 0 is specified,the length is set to the maximum possible (2147483646 characters). A negative or non-numeric value will generate an error.</p>
<h4>Property</h4>
<p>
The property associated with this control can be string or integer valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "EDIT" class with the WS_BORDER, WS_CHILD, WS_TABSTOP, WS_GROUP styles.</p>
<p>
For compatibility with screenreaders, when authoring a dialog with an Edit control as the first active control, you must make the text field belonging to the edit field the first active control in the <a href="tref_51wl.htm">Dialog Table</a>. Since the static text cannot take focus, when the dialog is created the edit field will have the focus initially as intended, but doing this ensures that screenreaders show the correct information.</p>
<p>&nbsp;</p>

<h1><a name="_msi_listbox_control"></a>ListBox Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a regular listbox control. It enables the user to select a value of a property from a pre-authored list of choices. This control supports only single select listboxes. The possible values are read from the <a href="tref_5f1h.htm">Listbox Table</a>. Note that the string displayed is not necessarily the same as the value that the user is choosing. If the control is created with the <a href="href_56t0.htm">Sorted</a>, the items are listed according to the <b>Ordering</b> column of the table. If the style bit is not set, the column is ignored.</p>
<h4>Property</h4>
<p>
The property associated with this control can be string or integer valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_56t0.htm">Sorted</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the "LISTBOX" class.</p>
<p>
If the <a href="href_56t0.htm">Sorted</a> style bit is on, the control is created with the LBS_NOTIFY, WS_VSCROLL, WS_BORDER styles, otherwise with the LBS_STANDARD style. It also has the WS_TABSTOP, WS_GROUP, WS_CHILD styles.</p>
<p>&nbsp;</p>

<h1><a name="_msi_listview_control"></a>ListView Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a listview control displaying a single column of values with an icon next to each item. It enables the user to select a value of a property from a pre-authored list of choices. This control supports single select listviews only. The possible values are read from the <a href="tref_0vs5.htm">ListView Table</a>. </p>
<p>
<b>Note</b>&nbsp;&nbsp;The string displayed is not necessarily the same as the value that the user is choosing. If the control is created with the <a href="href_56t0.htm">Sorted</a>, the items are listed according to the <b>Ordering</b> column of the table. If the style bit is not set, the column is ignored.</p>
<h4>Property</h4>
<p>
The property associated with this control can be string or integer valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_6h6b.htm">IconSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_56t0.htm">Sorted</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<h4>Remarks</h4>
<p>
The control is created with the WC_LISTVIEW class with the LVS_REPORT, LVS_NOCOLUMNHEADER, WS_VSCROLL, WS_HSCROLL, LVS_SHAREIMAGELISTS, LVS_SINGLESEL, LVS_SHOWSELALWAYS, WS_BORDER, WS_TABSTOP styles.</p>
<p>
If the <a href="href_56t0.htm">Sorted</a> style bit is not on, the control also has the LVS_SORTASCENDING style.</p>
<p>
For compatibility with screenreaders, when authoring a dialog with an ListView control as the first active control, you must make the text field belonging to the edit field the first active control in the <a href="tref_51wl.htm">Dialog Table</a>. Since the static text cannot take focus, when the dialog is created the edit field will have the focus initially as intended, but doing this ensures that screenreaders show the correct information.</p>
<p>&nbsp;</p>

<h1><a name="_msi_maskededit_control"></a>MaskedEdit Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is an edit field control with a mask contained in the text field of the control. The MaskedEdit Control can be used to create a template for user entry of information such as a phone number or Product ID code. For example, the <a href="pref_1v21.htm">PIDKEY property</a> can be entered by the user through a MaskedEdit Control that has been specified by setting the <a href="pref_0z21.htm">PIDTemplate property</a> to a string such as:</p>
<p>
12345&lt;### -%%%%%%%&gt;@@@@@</p>
<p>
This string defines the masking template for the entry of the <a href="pref_1v21.htm">PIDKEY property</a> by the user.</p>
<p>
The syntax of the mask is a described below. The visible segment of the string is enclosed by the pair of &lt;&gt; characters.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=8%><b>&lt;</b></td>
<td width=92%>This is the left end of the visible segment of the template. This character and everything to its left is hidden in the user interface. There should be no more than one instance of this character in the template.</td>
</tr>
<tr valign=top>
<td width=8%><b>&gt;</b></td>
<td width=92%>This is the right end of the visible segment of the template. This character and everything to its right is hidden in the user interface. This character is replaced by a dash during validation. If there is a visible segment started with &lt;, then it must be terminated with a matching &gt;.</td>
</tr>
<tr valign=top>
<td width=8%><b>#</b></td>
<td width=92%>This character is a digit.</td>
</tr>
<tr valign=top>
<td width=8%><b>%</b></td>
<td width=92%>An alternate digit, essentially the same as # , enabling a custom action to differentiate between fields in a way that can be controlled by the mask. </td>
</tr>
<tr valign=top>
<td width=8%>@</td>
<td width=92%>This character is a randomized digit. This character should not appear in the visible part of the template.</td>
</tr>
<tr valign=top>
<td width=8%>_</td>
<td width=92%>This character stands for an alpha-numeric character.</td>
</tr>
<tr valign=top>
<td width=8%>^</td>
<td width=92%>An alternate alpha-numeric character, enabling a custom action to differentiate between fields in a way that can be controlled by the mask..</td>
</tr>
<tr valign=top>
<td width=8%>?</td>
<td width=92%>An alternate alpha-numeric character.</td>
</tr>
<tr valign=top>
<td width=8%>'</td>
<td width=92%>An alternate alpha-numeric character.</td>
</tr>
<tr valign=top>
<td width=8%>=</td>
<td width=92%>This character is the field terminator. This must follow a #, %, ^, or '. This creates one more input position of the same type as the preceding positions and terminates the field with a '-' separator.</td>
</tr>
</table><br>
<p>
Any other character is treated as a literal constant.</p>
<p>
For the characters that can be edited the control creates separate edit windows with one window for each block of contiguous characters of the same kind. </p>
<h4>Property</h4>
<p>
The property associated with this control must be a string.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The control creates one parent window of the "BUTTON" class with the BS_OWNERDRAW and WS_EX_CONTROLPARENT styles. It creates several child windows to this window: for the constant text parts it creates "STATIC" windows with the SS_LEFT and WS_CHILD styles. For the editable fields it creates an "EDIT" window with the WS_CHILD, WS_BORDER and WS_TABSTOP styles. In case of a numeric field the window also has the ES_NUMBER style.</p>
<p>
The alternate digit, %, and alternate alpha-numeric characters, ^, ?, and ' fields are intended to allow custom actions differentiate between fields in a way that can be controlled by the mask. For example, ^ could be used for fields that should be upper-case.</p>
<p>&nbsp;</p>

<h1><a name="_msi_pathedit_control"></a>PathEdit Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a special control designed for use on a browse dialog. It is designed to be used with a <a href="href_5xkc.htm">DirectoryCombo</a> and <a href="href_09f0.htm">DirectoryList</a> control on the same dialog. It displays the currently selected folder name or the entire path in an edit field. The property associated with this control has to have an initial value. This control also supports entering a full path in both modes. It first checks if the string enters is a valid path. If it is, it interprets the string as such. One can also enter a UNC path to a drive that has no drive letter associated with it.This control does not let the focus leave if the selection is not valid.</p>
<h4>Property</h4>
<p>
The property associated with this control can be only string valued. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<h4>Remarks</h4>
<p>
The control is derived from the <a href="href_9yjw.htm">Edit</a> control.</p>
<p>
For compatibility with screenreaders, when authoring a dialog with an PathEdit control as the first active control, you must make the text field belonging to the edit field the first active control in the <a href="tref_51wl.htm">Dialog Table</a>. Since the static text cannot take focus, when the dialog is created the edit field will have the focus initially as intended, but doing this ensures that screenreaders show the correct information.</p>
<p>&nbsp;</p>

<h1><a name="_msi_radiobuttongroup_control"></a>RadioButtonGroup Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This control is a group of radio buttons. It enables the user to select a value of a property from a pre-authored list of choices. The possible values are read from the <a href="tref_4t7p.htm">RadioButton Table</a>. Note that the string displayed is not necessarily the same as the value that the user is choosing. The implementation treats the whole group as one control, therefore it is not possible to hide or disable individual buttons within the group. Similarly all the buttons have to be of the same style, that is, either all of them have text or all of them have bitmaps, or other similar features. The position of the buttons is authored relative to the group. This way the entire group can be moved by changing only the coordinates of the group without changing the individual buttons. At creation the control verifies that the individual buttons do not extend beyond the boundaries of the group.</p>
<p>
If the <a href="href_4xtg.htm">Bitmap</a> or the <a href="href_9gok.htm">Icon</a> style bit is set, the corresponding text entry in the RadioButton Table is taken as a foreign key to the <a href="tref_04px.htm">Binary table</a> that specifies the binary data needed to create the picture on the individual buttons.</p>
<p>
This means that the buttons cannot have both a picture and text.</p>
<p>
Because of the way Windows draws the frame, there is a gap between the top of the control's window and the visible frame, even when there is no caption.</p>
<h4>Property</h4>
<p>
The property associated with this control can be string or integer valued.</p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_4xtg.htm">Bitmap</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_01f8.htm">FixedSize</a><br>
<a href="href_1d10.htm">HasBorder</a><br>
<a href="href_9gok.htm">Icon</a><br>
<a href="href_6h6b.htm">IconSize</a><br>
<a href="href_9mcz.htm">ImageHandle</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_95mc.htm">Integer</a><br>
<a href="href_69pw.htm">PushLike</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<h4>Remarks</h4>
<p>
The group is created using the "BUTTON" class. If the <a href="href_1d10.htm">HasBorder</a> style is set, it has the BS_GROUPBOX style, otherwise it has the BS_OWNERDRAW style. </p>
<p>
The individual buttons are created with the "BUTTON" class.</p>
<p>
It has the BS_RADIOBUTTON, WS_CHILD, WS_GROUP, WS_TABSTOP, WS_EX_CONTROLPARENT and BS_MULTILINE styles.</p>
<p>
If the <a href="href_69pw.htm">PushLike</a> style is set they have the BS_PUSHLIKE style.</p>
<p>
If the <a href="href_4xtg.htm">Bitmap</a> style is set they have the BS_BITMAP style.</p>
<p>
If the <a href="href_9gok.htm">Icon</a> style is set they have the BS_ICON style.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectiontree_control"></a>SelectionTree Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This special control is designed to present some of the information in the <a href="tref_0a91.htm">Feature Table</a> to the user and allow the user to change the selection state of some items.</p>
<h4>Property</h4>
<p>
String valued, the name of the directory property that will be set by the browse dialog. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
<a href="href_66lw.htm">SelectionAction</a><br>
<a href="href_01dg.htm">SelectionBrowse</a><br>
<a href="href_2qno.htm">SelectionDescription</a><br>
<a href="href_0778.htm">SelectionIcon</a><br>
<a href="href_1d6c.htm">SelectionPath</a><br>
<a href="href_6tf8.htm">SelectionPathOn</a><br>
<a href="href_94z8.htm">SelectionSize</a></p>
<h4>Can Take Focus</h4>
<p>
Yes.</p>
<p>
<b>Related Strings in the <a href="tref_0vz9.htm">UIText Table</a></b></p>
<p>
<b>AbsentPath</b> The path displayed for an item in the absent state.</p>
<p>
The following six strings are used to display the number of children selected and the size associated with the highlighted item.</p>
<p>
<b>SelChildCostPos</b><br>
<b>SelChildCostNeg</b><br>
<b>SelParentCostPosPos</b><br>
<b>SelParentCostPosNeg</b><br>
<b>SelParentCostNegPos</b><br>
<b>SelParentCostNegNeg</b></p>
<p>
The following strings are used to display the available selection options for an item in a popup menu.</p>
<p>
<b>MenuAbsent</b><br>
<b>MenuLocal</b><br>
<b>MenuCD</b><br>
<b>MenuNetwork</b></p>
<p>
The following strings are used to explain the present selection in the <a href="href_2qno.htm">SelectionDescription</a> control event.</p>
<p>
<b>SelAbsentAbsent</b><br>
<b>SelAbsentLocal</b><br>
<b>SelAbsentCD</b><br>
<b>SelAbsentNetwork</b><br>
<b>SelLocalAbsent</b><br>
<b>SelLocalLocal</b><br>
<b>SelLocalCD</b><br>
<b>SelLocalNetwork</b><br>
<b>SelCDAbsent</b><br>
<b>SelNetworkAbsent</b><br>
<b>SelCDLocal</b><br>
<b>SelNetworkLocal</b><br>
<b>SelCDCD</b><br>
<b>SelNetworkNetwork</b></p>
<p>
The following four localized strings are used in formatting the size of a file.</p>
<p>
<b>Bytes</b><br>
<b>KB</b><br>
<b>MB</b><br>
<b>GB</b></p>
<h4>Remarks</h4>
<p>
This control is created with the WC_TREEVIEW class and the WS_BORDER, TVS_HASLINES, TVS_HASBUTTONS, TVS_LINESATROOT, TVS_DISABLEDRAGDROP, TVS_SHOWSELALWAYS, WS_CHILD, WS_TABSTOP, WS_GROUP styles.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The selection tree gets populated only if the CostInitialize and CostFinalize actions were all previously called.</p>
<p>&nbsp;</p>

<h1><a name="_msi_volumeselectcombo_control"></a>VolumeSelectCombo Control</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a special control designed to a volume from a list of volumes. It lists the volumes in alphabetical order. The types of controls displayed is determined by the style bits of the control. </p>
<h4>Property</h4>
<p>
The property associated with this control can be only string valued. </p>
<h4>Valid Style Bits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_6do4.htm">Enabled</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2984.htm">Indirect</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a><br>
<a href="href_1tmc.htm">Sunken</a><br>
<a href="href_3i2c.htm">Visible</a></p>
<h4>Valid Control Attributes</h4>
<p>
<a href="href_5uud.htm">Default</a><br>
<a href="href_2ig5.htm">Enabled</a><br>
<a href="href_8m05.htm">Indirect</a><br>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_2w6d.htm">Position</a><br>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a><br>
<a href="href_2kmd.htm">Text</a><br>
<a href="href_8bqd.htm">Visible</a><br>
<a href="href_6hnp.htm">WindowHandle</a></p>
<h4>Control Events Published</h4>
<p>
None.</p>
<h4>Can Take Focus</h4>
<p>
Windows: Yes.</p>
<h4>Remarks</h4>
<p>
The control is created as a"COMBOBOX" with the CBS_DROPDOWNLIST, CBS_OWNERDRAWFIXED, CBS_HASSTRINGS, WS_VSCROLL, WS_CHILD, WS_GROUP, WS_TABSTOP and CBS_SORT styles.</p>
<p>
For compatibility with screenreaders, when authoring a dialog with an VolumeSelectCombo control as the first active control, you must make the text field belonging to the edit field the first active control in the <a href="tref_51wl.htm">Dialog Table</a>. Since the static text cannot take focus, when the dialog is created the edit field will have the focus initially as intended, but doing this ensures that screenreaders show the correct information.</p>
<p>&nbsp;</p>

<h2><a name="_msi_control_attributes"></a>Control Attributes</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes control attributes.</p>
<p>&nbsp;</p>

<h1><a name="_msi_billboardname_control_attribute"></a>BillboardName Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute returns the name of the currently running billboard, or sets and displays a billboard by name. This attribute is used in preview mode.</p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least one field.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
<a href="href_0gj0.htm">Billboard</a></p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_default_control_attribute"></a>Default Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute describes if the given control is defined as the default control on the dialog. If it is the default, then pressing ENTER automatically activates this control.</p>
<h4>Type</h4>
<p>
Boolean.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least one field.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
All controls. </p>
<p>
Although this attribute is defined for every control, it is only practical for controls that have a button-like behavior.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_enabled_control_attribute"></a>Enabled Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute describes if the given control is enabled or disabled. Most controls have a gray disabled look. For some inert controls, changing this attribute results in no visible change.</p>
<h4>Type</h4>
<p>
Boolean.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least one field.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
All controls. </p>
<h4>Associated Control Stylebit</h4>
<p>
<a href="href_6do4.htm">Enabled</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_image_control_attribute"></a>Image Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute is the name of the image in the <a href="tref_04px.htm">Binary Table</a>. If the image is set by the <a href="href_3tut.htm">ImageHandle</a> attribute, this attribute does not reflect the correct name anymore.</p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
<a href="href_2ey4.htm">Bitmap</a><br>
<a href="href_1tt8.htm">Icon</a></p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attribute</h4>
<p>
<a href="href_3tut.htm">ImageHandle</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_imagehandle_control_attribute"></a>ImageHandle Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute is the handle to the bitmap or icon displayed in the control. If the image is set by this attribute, the name of the image is not correct anymore and the <a href="href_590l.htm">Image</a> attribute will return an incorrect value.</p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
<a href="href_2ey4.htm">Bitmap</a><br>
<a href="href_1tt8.htm">Icon</a></p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attribute</h4>
<p>
<a href="href_590l.htm">Image</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_indirect_control_attribute"></a>Indirect Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute determines for some active controls if the associated property is referenced indirectly.</p>
<h4>Type</h4>
<p>
Boolean.</p>
<h4>Access</h4>
<p>
Read only.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1 field.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
All active controls.</p>
<h4>Associated Control Stylebit</h4>
<p>
<a href="href_2984.htm">Indirect</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_indirectpropertyname_control_attribute"></a>IndirectPropertyName Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In case of an active control this attribute is the name of the associated indirect property. For inert controls this attribute returns Null. </p>
<p>
An indirect property names an other property, and the control displays/changes the value of this second property. </p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read only.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attributes</h4>
<p>
<a href="href_1nc5.htm">PropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_position_control_attribute"></a>Position Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute determines the position of the control on the dialog. The four fields are: left, top, width, and height. The coordinates are in pixels and relative to the upper left corner of the dialog.</p>
<h4>Type</h4>
<p>
Integer.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 4.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attributes</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_progress_control_attribute"></a>Progress Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute measures how far the progress bar is filled up. The record contains two integers and a string. The first number is the progress, the second number is the range (the maximal possible number for the progress).</p>
<p>
On setting, the integers can be entered as integer fields or strings containing the integers.</p>
<p>
If the second number is missing it is assumed to be the default (1024). If the progress is larger than the range then it is changed to be the range. The third field is a string, the name of the action whose progress is displayed.</p>
<h4>Type</h4>
<p>
Integer.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 3.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
<a href="href_0tkc.htm">ProgressBar</a></p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_propertyname_control_attribute"></a>PropertyName Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In case of an active control this attribute is the name of the associated property. For inert controls this attribute returns Null. </p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read only.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attributes</h4>
<p>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_4twl.htm">PropertyValue</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_propertyvalue_control_attribute"></a>PropertyValue Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute is the present value of the associated property. If this attribute is changed, the control updates to show the new state.</p>
<h4>Type</h4>
<p>
String or Integer depending on the <a href="href_95mc.htm">Integer</a> style of the control.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every active control.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<h4>Related Control Attributes</h4>
<p>
<a href="href_1i79.htm">IndirectPropertyName</a><br>
<a href="href_1nc5.htm">PropertyName</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_text_control_attribute"></a>Text Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute is the text string used displayed in the control. On setting, if the field 0 of the record is not null, the record is formatted using FormatText. If the field 0 is null, the first field of the record defines the text. On getting the value is always returned in the first field. For some controls this text may not be visible. In Windows the accelerator key for a control is defined by placing a "&amp;" in front of the desired character in this string.</p>
<h4>Type</h4>
<p>
String.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1 field.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control.</p>
<h4>Associated Control Stylebit</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_transparent_control_attribute"></a>Transparent Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this attribute is set on a text control, it is displayed transparently, the background shows through the control where there are no characters. Otherwise the background is opaque.</p>
<h4>Type</h4>
<p>
Boolean.</p>
<h4>Access</h4>
<p>
Read only.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
<a href="href_4s30.htm">Text</a></p>
<h4>Associated Control Stylebit</h4>
<p>
<a href="href_4f1w.htm">Transparent</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_visible_control_attribute"></a>Visible Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this attribute is set the control is visible, otherwise hidden.</p>
<h4>Type</h4>
<p>
Boolean.</p>
<h4>Access</h4>
<p>
Read and Write.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control.</p>
<h4>Associated Control Stylebit</h4>
<p>
<a href="href_3i2c.htm">Visible</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_windowhandle_control_attribute"></a>WindowHandle Control Attribute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This attribute returns the window handle to the control's window. Supported on Windows only.</p>
<h4>Type</h4>
<p>
Integer.</p>
<h4>Access</h4>
<p>
Read only.</p>
<h4>Minimum Size of the Record</h4>
<p>
At least 1.</p>
<h4>Control Types That Have This Attribute</h4>
<p>
Every control. Windows only!</p>
<h4>Associated Control Stylebit</h4>
<p>
<a href="href_3i2c.htm">Visible</a></p>
<p>&nbsp;</p>

<h2><a name="_msi_control_stylebits"></a>Control Stylebits</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes control stylebits.</p>
<p>&nbsp;</p>

<h1><a name="_msi_bitmap_control_stylebit"></a>Bitmap Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set, the control's text is replaced by a bitmap. The text entry in the database that normally would specify the text of the control is used as a foreign key to the <a href="tref_04px.htm">Binary table</a> to point to the binary data needed for the picture. Such a control has no text associated with it. This style bit should not be set at the same time as the Icon stylebit.</p>
<h4>Control Types that Can Have This Style</h4>
<p>
<a href="href_7dt8.htm">CheckBox</a></p>
<p>
<a href="href_331o.htm">PushButton</a></p>
<p>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<h4>Numeric Value</h4>
<p>
0x00040000 = 262144</p>
<p>&nbsp;</p>

<h1><a name="_msi_cdromvolume_control_stylebit"></a>CDROMVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists CDROM volumes in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00080000 = 524288</p>
<p>&nbsp;</p>

<h1><a name="_msi_combolist_control_stylebit"></a>ComboList Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a combobox, the edit field is replaced by a static text field, therefore the user cannot enter a new value, can choose only one of the predefined values. Otherwise the combobox is drawn with an edit field.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_4yp8.htm">ComboBox</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00020000 = 131072</p>
<p>&nbsp;</p>

<h1><a name="_msi_enabled_control_stylebit"></a>Enabled Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control control is created enabled, otherwise disabled. The enabled/disabled state of the control can be changed later through the associated attribute or by the publisher of some event that the given control subscribes to. </p>
<h4>Control Types That Can Have This Style</h4>
<p>
All controls. On some controls (like Bitmaps and Icons) this bit makes no visible difference.</p>
<h4>Associated Control Attribute</h4>
<p>
<a href="href_2ig5.htm">Enabled</a></p>
<h4>Numeric Value</h4>
<p>
0x00000002 = 2</p>
<p>&nbsp;</p>

<h1><a name="_msi_fixedsize_control_stylebit"></a>FixedSize Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the picture on the button or a bitmap or an icon control is displayed in its "natural size". If the picture is smaller than the control, it is centered, if the picture is larger, it is chopped in case of bitmaps but it is shrunk in case of icons. If the bit is not set, the picture is stretched to fit the button or control rectangle. </p>
<p>
On CheckBoxes, PushButtons, and RadioButtonGroups this bit has any effect only if the <a href="href_4xtg.htm">Bitmap</a> or the <a href="href_9gok.htm">Icon</a> is set.</p>
<p>
On Icon controls and buttons associated with icons this bit is ignored if the <a href="href_6h6b.htm">IconSize</a> bits are not set!</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_2ey4.htm">Bitmap</a><br>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_1tt8.htm">Icon</a><br>
<a href="href_331o.htm">PushButton</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00100000 = 1048576</p>
<p>&nbsp;</p>

<h1><a name="_msi_fixedvolume_control_stylebit"></a>FixedVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists fixed internal hard drives in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00020000 = 131072</p>
<p>&nbsp;</p>

<h1><a name="_msi_floppyvolume_control_stylebit"></a>FloppyVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists floppy drives in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00200000 = 2097152</p>
<p>&nbsp;</p>

<h1><a name="_msi_hasborder_control_stylebit"></a>HasBorder Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the <a href="href_6iwc.htm">RadioButtonGroup</a> has a border displayed around it. If the style bit is not set, the border is not displayed and no text is displayed on the group either!</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x01000000 = 16777216</p>
<p>&nbsp;</p>

<h1><a name="_msi_icon_control_stylebit"></a>Icon Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set, the control's text is replaced by an icon. The text entry in the database that normally would specify the text of the control is used as a foreign key to the <a href="tref_04px.htm">Binary table</a> to point to the binary data needed for the picture. Therefore, such a control has not text associated with it, only the picture. This stylebit should not be set at the same time as the Bitmap stylebit.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_7dt8.htm">CheckBox</a></p>
<p>
<a href="href_331o.htm">PushButton</a></p>
<p>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<h4>Numeric Value</h4>
<p>
0x00080000 = 5242288</p>
<p>&nbsp;</p>

<h1><a name="_msi_iconsize_control_stylebits"></a>IconSize Control Stylebits</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
An icon file can hold several different size images of the same icon. These two bits determine which size image of the icon is loaded. If neither bit is set, the first image is loaded. If only the lower bit is set, the first 16x16 image is loaded. If only the higher bit is set, the first 32x32 image is loaded. If both bits are set, the first 48x48 image is loaded.</p>
<p>
If the <a href="href_01f8.htm">FixedSize</a> bit is set, these bits determine the size of the image displayed.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_1tt8.htm">Icon</a><br>
<a href="href_331o.htm">PushButton</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00200000 = 2097152<br>
0x00400000 = 4194304</p>
<p>&nbsp;</p>

<h1><a name="_msi_imagehandle_control_stylebits"></a>ImageHandle Control Stylebits</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Controls that require an image normally specify the name of the binary information in the text field and the binary data is looked up from the Binary table using this key. If this style bit is set, it means that the binary information is NOT coming from the Binary table, but instead the text field represents the handle to a bitmap or icon (in a string format) and this already loaded icon or bitmap must be used by the control. Obviously these handles cannot be authored previously, the actual value of the handle in the table has to be set by some action that is performed prior to creating the control. A possible use is to have an action to find all the running applications and put their names and icons into the <a href="tref_0vs5.htm">ListView Table</a>, and the control can display these names and icons, Even if this bit is on, other stylebits governing the size and stretching of the image are still observed. As an example: if an action puts a handle of an image in the table, but other stylebits describe a different size, the image will be still stretched. </p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_2ey4.htm">Bitmap</a><br>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_1tt8.htm">Icon</a><br>
<a href="href_6omk.htm">ListView</a><br>
<a href="href_331o.htm">PushButton</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_indirect_control_stylebit"></a>Indirect Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on an active control, it means that the control changes the value of the property whose name is the value of the named property. Otherwise the named property is changed.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
All active controls.</p>
<h4>Associated Control Attribute</h4>
<p>
<a href="href_8m05.htm">Indirect</a>.</p>
<h4>Numeric Value</h4>
<p>
0x00000008 = 8</p>
<p>&nbsp;</p>

<h1><a name="_msi_integer_control_stylebit"></a>Integer Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on an active control, the associated property is integer valued. Otherwise the property is string valued.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_4yp8.htm">ComboBox</a><br>
<a href="href_9yjw.htm">Edit</a><br>
<a href="href_1yjw.htm">ListBox</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00000010 = 16</p>
<p>&nbsp;</p>

<h1><a name="_msi_progress95_control_stylebit"></a>Progress95 Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a progress bar, it is drawn with small disjoint rectangles in Windows 95 style. Otherwise the bar is drawn continuously.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_0tkc.htm">ProgressBar</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_pushlike_control_stylebit"></a>PushLike Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a checkbox or a radiobuttongroup the button is drawn with the visual appearance of a push button, but it's logic stays the same. If the bit is not set the controls are drawn in their usual visual style.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_7dt8.htm">CheckBox</a><br>
<a href="href_6iwc.htm">RadioButtonGroup</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00020000 = 131072</p>
<p>&nbsp;</p>

<h1><a name="_msi_ramdiskvolume_control_stylebit"></a>RAMDiskVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists RAM disks in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00100000 = 1048567</p>
<p>&nbsp;</p>

<h1><a name="_msi_remotevolume_control_stylebit"></a>RemoteVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists remote volumes in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_1rqs.htm">RemovableVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00040000 = 262144</p>
<p>&nbsp;</p>

<h1><a name="_msi_removablevolume_control_stylebit"></a>RemovableVolume Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set the control lists removable drives in its list of volumes.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_5xkc.htm">DirectoryCombo</a><br>
<a href="href_7ing.htm">VolumeCostList</a><br>
<a href="href_3uek.htm">VolumeSelectCombo</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Related Control Stylebits</h4>
<p>
<a href="href_01x0.htm">CDROMVolume</a><br>
<a href="href_0lo4.htm">FixedVolume</a><br>
<a href="href_0m9g.htm">FloppyVolume</a><br>
<a href="href_2ypg.htm">RAMDiskVolume</a><br>
<a href="href_4egk.htm">RemoteVolume</a></p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_sorted_control_stylebit"></a>Sorted Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a listbox or combobox, the items in the list are displayed in the order defined by the <b>Ordering</b> column of the corresponding table. If the bit is not set, the items are displayed in alphabetical order.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_4yp8.htm">ComboBox</a><br>
<a href="href_1yjw.htm">ListBox</a><br>
<a href="href_6omk.htm">ListView</a></p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_sunken_control_stylebit"></a>Sunken Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a control, it is displayed with a sunken, 3D look, if that is available on the system. Otherwise the control is displayed in its default visual style. The effect of this style bit is different on different versions of Windows. On most controls it has no visible effect.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
All controls.</p>
<h4>Associated Control Attribute</h4>
<p>
None.</p>
<h4>Numeric Value</h4>
<p>
0x00000004 = 4</p>
<p>&nbsp;</p>

<h1><a name="_msi_transparent_control_stylebit"></a>Transparent Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a text control, it is displayed transparently, the background shows through the control where there are no characters. Otherwise the background is opaque.</p>
<h4>Control Types That Can Have This Style</h4>
<p>
<a href="href_4s30.htm">Text</a></p>
<h4>Associated Control Attribute</h4>
<p>
<a href="href_6yxx.htm">Transparent</a></p>
<h4>Numeric Value</h4>
<p>
0x00010000 = 65536</p>
<p>&nbsp;</p>

<h1><a name="_msi_visible_control_stylebit"></a>Visible Control Stylebit</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this bit is set on a control, it is visible on the dialog. Otherwise it is hidden. The visible/hidden state of the control can be changed later through the associated attribute or by the publisher of some event that the given control subscribes to. </p>
<h4>Control Types That Can Have This Style</h4>
<p>
All controls.</p>
<h4>Associated Control Attribute</h4>
<p>
<a href="href_8bqd.htm">Visible</a></p>
<h4>Numeric Value</h4>
<p>
0x00000001 = 1</p>
<p>&nbsp;</p>

<h2><a name="_msi_control_events"></a>Control Events</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes control events.</p>
<p>&nbsp;</p>

<h1><a name="_msi_actiondata_controlevent"></a>ActionData ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler uses this event to broadcast the latest action data.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are hidden when a new action starts and they are shown when a new action data arrives from the engine.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on a modeless dialog subscribes to this event using the <a href="href_2kmd.htm">text</a> attribute to receive the latest data on the current action. (For example the names of the files copied during file copy). </p>
<p>&nbsp;</p>

<h1><a name="_msi_actiontext_controlevent"></a>ActionText ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler uses this event to broadcast the name of the present action.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are shown when a new progress data arrives from the engine.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on a modeless dialog subscribes to this event using the <a href="href_2kmd.htm">text</a> attribute to receive the name of the current action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_addlocal_controlevent"></a>AddLocal ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The this event notifies the installer when a feature or all features have to be selected as local.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, either the name of the feature or "ALL" (this second option is case insensitive).</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher</h4>
<h4>When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog running and notifies the installer.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_addsource_controlevent"></a>AddSource ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer is notified through this event when a feature or all features have to be selected as source.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, either the name of the feature or "ALL" (this second option is case insensitive).</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog running and notifies the installer.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_checkdiskspace_controlevent"></a>CheckDiskSpace ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To be written. </p>
<p>&nbsp;</p>

<h1><a name="_msi_checkexistingtargetpath_controlevent"></a>CheckExistingTargetPath ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when it has to be verified that the selected path is writable. If the path is not writable, it blocks further control events associated with the same control.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
The name of the property containing the path. If the property is indirected, the property name is enclosed in square brackets.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The path is checked.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a browse dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to check the selected path before returning to the selection dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_checktargetpath_controlevent"></a>CheckTargetPath ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when it has to be verified that the selected path is valid. If the path is not valid, it blocks further control events associated with the same control.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
The name of the property containing the path. If the property is indirected, the property name is enclosed in square brackets.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The path is checked.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a browse dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to check the selected path before returning to the selection dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_ignorechange_controlevent"></a>IgnoreChange ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The IgnoreChange control event is published by the <a href="href_09f0.htm">DirectoryList control</a> when a folder is highlighted but not opened in the current directory.</p>
<h4>Published By</h4>
<p>
<a href="href_09f0.htm">DirectoryList</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
Typically the <a href="href_5xkc.htm">DirectoryCombo control</a> subscribes to the IgnoreChange control event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directorylistnew_controlevent"></a>DirectoryListNew ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DirectoryList control is notified through this event when a new folder must be created.</p>
<h4>Published By</h4>
<p>
<a href="href_09f0.htm">DirectoryList</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
Creates a new (ghost) folder and selects its name field for editing. If a ghost folder already exists in the current folder, that that folder is selected and its name is opened for editing.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on the same modal dialog as the DirectoryList subscribes to this event to trigger the creation of a new folder.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directorylistopen_controlevent"></a>DirectoryListOpen ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DirectoryList control is notified through this event when the user wants to open the selected directory.</p>
<h4>Published By</h4>
<p>
<a href="href_09f0.htm">DirectoryList</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are disabled if there is no folder selected currently. Otherwise they are enabled.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
Changes the selection to the highlighted directory.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on the same modal dialog as the DirectoryList subscribes to this event to trigger stepping down in the path.</p>
<p>&nbsp;</p>

<h1><a name="_msi_directorylistup_controlevent"></a>DirectoryListUp ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DirectoryList control is notified through this event when the user wants to select the parent of the present directory.</p>
<h4>Published By</h4>
<p>
<a href="href_09f0.htm">DirectoryList</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are disabled if the current directory has no parent (it is a volume), otherwise they are enabled.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
Changes the selection to the parent of the current directory.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on the same modal dialog as the DirectoryList subscribes to this event to trigger stepping up in the path.</p>
<p>&nbsp;</p>

<h1><a name="_msi_doaction_controlevent"></a>DoAction ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A dialog box notifies the user interface handler when a custom action should be executed.</p>
<h4>Published By</h4>
<p>
User interface handler.</p>
<h4>Argument</h4>
<p>
A string, the name of the custom action to be executed.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The user interface handler runs the specified custom action.</p>
<h4>Typical Use</h4>
<p>
A PushButton control on a dialog is tied to this event in the ControlEvent table to invoke a custom action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_enddialog_controlevent"></a>EndDialog ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when a modal dialog has to be removed.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
On regular dialogs: "Return", "Exit", "Retry", or "Ignore".</p>
<p>
On error dialogs" "ErrorOk", "ErrorCancel", "ErrorAbort", "ErrorRetry", "ErrorIgnore", "ErrorYes", or "ErrorNo".</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
In all cases the Handler removes the present dialog.</p>
<p>
If the argument is "Exit", the wizard sequence is closed, the control returns to the Engine with the UserExit value.</p>
<p>
If the argument is "Retry", the wizard sequence is closed, the control returns to the Engine with the Suspend value.</p>
<p>
If the argument is "Ignore", the wizard sequence is closed, the control returns to the Engine with the Finished value.</p>
<p>
The above three arguments can be used only on dialogs that are not children of some other dialog.</p>
<p>
If the argument is "Return", the control returns to the parent of the present dialog, if there is a parent. If there is no parent, the control returns to the Engine with the Success value.</p>
<p>
For buttons on an error dialog, the possible values correspond to the return codes to the Engine.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to dismiss a dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_newdialog_controlevent"></a>NewDialog ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when a modal dialog transitions to an other one.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, the name of the new dialog.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler removes the present dialog and creates the new one with the name indicated in the argument.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to signal a transition to the next or previous dialog of the same wizard sequence.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reinstall_controlevent"></a>Reinstall ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This ControlEvent allows the author to initiate a reinstall of some or all features, typically with the push of a <a href="href_331o.htm">PushButton</a> control.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, either the name of the feature or "ALL" (this second option is case insensitive).</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog running and notifies the installer.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event. Typically the same button is also tied to a <a href="href_0x6c.htm">ReinstallMode</a> control event immediately preceeding this one.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reinstallmode_controlevent"></a>ReinstallMode ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This ControlEvent allows the author to specify the validation mode(s) to be used during a reinstall.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string. For the list of possible values, see the <a href="pref_7bll.htm">REINSTALLMODE Property</a>.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog running and notifies the installer.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event. Typically the same button is also tied to a <a href="href_8gdw.htm">Reinstall</a> control event immediately following this one.</p>
<p>&nbsp;</p>

<h1><a name="_msi_remove_controlevent"></a>Remove ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer is notified through this event when a feature or all features have to be selected for removal.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, either the name of the feature or "ALL" (this second option is case insensitive).</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog running and notifies the installer.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reset_controlevent"></a>Reset ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The dialog is reset. In other words all the controls on the dialog are called to undo the property changes they have performed. It should reset all the property values to what they were when the dialog was created. </p>
<p>
There is one case that is not handled properly. If there are at least two controls on the same dialog linked indirectly to the same property and at least one of them started with some other property originally, this property value is sometimes reset to its second value. Since this case is very esoteric, it is not worth the special code to handle it.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
All the controls on the dialog are called to restore the original values of their properties.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event to allow resetting all the values on the dialog, canceling all the changes performed on the page.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionaction_controlevent"></a>SelectionAction ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that contains a string describing the action selected for the highlighted item. The string is one of the "Sel*" strings from the <a href="tref_0vz9.htm">UIText Table</a>.</p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on the same modal dialog as the SelectionTree subscribes to this event to display the explanation of the currently selected action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionbrowse_controlevent"></a>SelectionBrowse ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that makes possible for another control (typically a button) to trigger the browse dialog for the currently highlighted item. </p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
The name of the dialog to be spawned.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are disabled or enabled depending on whether or not the path of the currently selected item can be modified by the user.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
Spawns a browse dialog to modify the path.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on the same modal dialog as the SelectionTree subscribes to this event to trigger the browse dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectiondescription_controlevent"></a>SelectionDescription ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that contains the description for the highlighted item. This string is the <b>Description</b> field of the <a href="tref_0a91.htm">Feature Table</a>.</p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on the same modal dialog as the SelectionTree subscribes to this event to display the description of the highlighted item.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionicon_controlevent"></a>SelectionIcon ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that contains the handle to the icon indicating the selected action on the highlighted item. </p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
An <a href="href_1tt8.htm">Icon</a> control on the same modal dialog as the SelectionTree subscribes to this event to display the icon corresponding to the highlighted item.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionpath_controlevent"></a>SelectionPath ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that contains the path for the highlighted item. If the item is selected to run from source, this is the path of the source. If the item is selected to be absent, the string is the <b>AbsentPath</b> string from the <a href="tref_0vz9.htm">UIText Table</a>.</p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on the same modal dialog as the SelectionTree subscribes to this event to display the path of the highlighted item.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionpathon_controlevent"></a>SelectionPathOn ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that is a Boolean value whether there is a selection path associated with the currently selected feature.</p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on the same modal dialog as the SelectionTree subscribes to this event as the caption of the selection path. This text control is turned visible or hidden depending on this event.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selectionsize_controlevent"></a>SelectionSize ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelectionTree control publishes this event that contains the size for the highlighted item. If it is a parent item, it also contains the number of children selected. The string is one of the <b>SelChildCostPos</b>, <b>SelChildCostNeg</b>, <b>SelParentCostPosPos</b>, <b>SelParentCostPosNeg</b>, <b>SelParentCostNegPos</b> or <b>SelParentCostNegNeg</b> strings from the <a href="tref_0vz9.htm">UIText Table</a>.</p>
<h4>Published By</h4>
<p>
<a href="href_3w30.htm">SelectionTree</a></p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_4s30.htm">Text</a> control on the same modal dialog as the SelectionTree subscribes to this event to display the size of the highlighted item.</p>
<p>&nbsp;</p>

<h1><a name="_msi_setinstalllevel_controlevent"></a>SetInstallLevel ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The handler calls the engine to set the installation level to the value specified in the argument</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
An integer. The new value of the installation level.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The handler calls the engine to change the installation level.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to change the installation level.</p>
<p>&nbsp;</p>

<h1><a name="_msi_setprogress_controlevent"></a>SetProgress ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler uses this event to broadcast install progress information to any subscribing controls. The name is the actual name of the action not SetProgress. In other words, the control has to subscribe to the event by naming the Action whose progress is being indicated. </p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
The subscribers are hidden when a new action starts or and they are shown when a new progress data arrives from the engine.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_0tkc.htm">ProgressBar</a> control on a modeless dialog subscribes to this event using the <a href="href_8hyd.htm">Progress</a> attribute to receive the progress information. </p>
<p>&nbsp;</p>

<h1><a name="_msi_setproperty_controlevent"></a>SetProperty ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The syntax for this event is different than for other controlevents! In place of the name of the event one puts the property in square brackets: [property_name]. The argument is the new value of the property. To unset the property, the argument must be {}. This is necessary, because the argument is a primary key in the table, so it cannot be null. The argument will be formatted using the FormatText method, therefore it can contain any expression that the method can handle. The property values are evaluated at the moment of the control event.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
The new value of the property. {} for null.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a dialog linked to this event so it changes a property when the button is pushed. </p>
<p>&nbsp;</p>

<h1><a name="_msi_settargetpath_controlevent"></a>SetTargetPath ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when it has to be verified that the selected path is valid and writable. It also calls the DirectoryManager to set the target path. If the path is not valid, it blocks further control events associated with the same control.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
The name of the property containing the path. If the property is indirected, the property name is enclosed in square brackets.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The path is checked and set.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a browse dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to check the selected path before returning to the selection dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_spawndialog_controlevent"></a>SpawnDialog ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Handler is notified through this event when a modal dialog wants to create a child.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A string, the name of the new dialog.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
The Handler keeps the present dialog and creates the new one with the name indicated in the argument, placing it on top of the old one.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event in the <a href="tref_6k11.htm">ControlEvent</a> table to create a child dialog, like a "Are you sure you want to cancel" dialog.</p>
<p>&nbsp;</p>

<h1><a name="_msi_spawnwaitdialog_controlevent"></a>SpawnWaitDialog ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This event pops up the dialog specified by the Argument column of the <a href="tref_6k11.htm">ControlEvent table</a> if the expression in the Condition column evaluates as FALSE. The dialog remains up for as long as the conditional expression remains FALSE and is removed as soon as the condition evaluates TRUE.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
A dialog in the <a href="tref_51wl.htm">Dialog table</a>.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
The SpawnWaitDialog ControlEvent can be used to wait for any background task the completion of which can tested using a conditional expression such as the state of a property. For an example of using the SpawnWaitDialog ControlEvent see the section <a href="hand_6at4.htm">Authoring a Conditional "Please wait . . ." Message Box</a>. </p>
<p>&nbsp;</p>

<h1><a name="_msi_timeremaining_controlevent"></a>TimeRemaining ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The handler uses this event to broadcast the approximate time remaining, in seconds, for the current progress sequence.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
None.</p>
<h4>Typical Use</h4>
<p>
A text control on  a modeless dialog subscribes to this event (via the EventMapping table), using the TimeRemaining attribute to display the time remaining.</p>
<p>&nbsp;</p>

<h1><a name="_msi_validateproductid_controlevent"></a>ValidateProductID ControlEvent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ValidateProductID ControlEvent sets the <a href="pref_6et5.htm">ProductID property</a> to the full Product ID. If the validation is unsuccessful, then this event puts up an error message and modal dialog for a user entry of the Product ID.</p>
<h4>Published By</h4>
<p>
Handler.</p>
<h4>Argument</h4>
<p>
None.</p>
<h4>Action on Subscribers</h4>
<p>
None.</p>
<h4>Action by Publisher When Subscriber Activated</h4>
<p>
Validates the Product ID.</p>
<h4>Typical Use</h4>
<p>
A <a href="href_331o.htm">PushButton</a> control on a modal dialog is tied to this event. This is used to check the user's entry of the Product ID. If the user's entry is valid, then the next dialog will open.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_standard_actions"></a>Standard Actions</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In the Microsoft  Windows  installer, actions serve the same purpose as functions in a programming language. An action encapsulates a typical function you can perform during installation or maintenance of your application. There is a very close relationship between actions and the installer database. In fact, many of the tables in the database can be viewed as serving the singular purpose of containing parameters used by a corresponding action. Almost all of the standard actions are linked to at least one of the tables.</p>
<p>
Examples of installer standard actions include:
<ul>
<li>
<a href="aref_7uzy.htm">CreateShortcuts action</a>: Manages the creation of shortcuts to files installed with the current application. This action uses the <a href="tref_2i91.htm">Shortcut table</a> for its data.</li>
<li>
<a href="aref_3hym.htm">InstallFiles action</a>: Copies selected files from the source directory to the destination directory. This action uses the <a href="tref_4n6t.htm">File table</a> for its data.</li>
<li>
<a href="aref_1cmm.htm">WriteRegistryValues action</a>: Sets up registry information that the application requires in the registry. This action uses the <a href="tref_3obp.htm">Registry table</a> for its data. <p>
<b>Note</b>&nbsp;&nbsp;The need to write registry values into the HKCU and HKLM hives of the registry at installation will diminish in the future as part of the ZAW effort.
</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_about_standard_actions"></a>About Standard Actions</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To increase the versatility of your setup program, use Microsoft  Windows  installer standard actions. The topics in this section cover the major areas of functionality that a standard action carries out, such as:
<ul>
<li>
<a href="acts_1m91.htm">Ordering actions in a sequence table</a></li>
<li>
<a href="acts_8dpv.htm">Publishing standard actions</a></li>
<li>
<a href="acts_9egj.htm">Searching standard actions</a></li>
<li>
<a href="acts_47sj.htm">Costing standard actions</a></li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_ordering_actions_in_a_sequence_table"></a>Ordering Actions in a Sequence Table</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are three top-level actions in the installer: <a href="aref_986m.htm">INSTALL</a>, <a href="aref_2o8e.htm">ADVERTISE</a>, and <a href="aref_4hbi.htm">ADMIN</a>. When one of these top-level actions is executed, the installer accesses the corresponding sequence tables. Sequence tables in the installer list actions in a logical order to perform an overall task. There are six sequence tables in the installer:
<ul>
<li>
The <a href="tref_1git.htm">InstallUISequence table</a> </li>
<li>
The <a href="tref_5pid.htm">InstallExecuteSequence table</a> </li>
<li>
The <a href="tref_5lnp.htm">AdminUISequence table</a> </li>
<li>
The <a href="tref_70f9.htm">AdminExecuteSequence table</a> </li>
<li>
The <a href="tref_3rvp.htm">AdvtUISequence table</a> </li>
<li>
The <a href="tref_5mn9.htm">AdvtExecuteSequence table</a> </li>
</ul>
<p>
All three sequence tables have the following columns.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Column</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%>Action</td>
<td width=80%>The primary key for the table; the action name must be unique.</td>
</tr>
<tr valign=top>
<td width=20%>Condition</td>
<td width=80%>A Boolean expression used to determine whether to perform the action.</td>
</tr>
<tr valign=top>
<td width=20%>Sequence</td>
<td width=80%>A relative sequence number used to determine the order in which to execute actions.</td>
</tr>
</table><br>
<p>
When a top-level action is invoked actions in the sequence table are done in the sequence order. If the condition evaluates to True, the action is executed. Sequence tables are the only place in a package where flow is specified, and the flow is always linear. No branching or looping is allowed. Conditions can be thought of as jumps so the linear flow may not execute every action. This simplicity makes following the sequence of events during an installation trivial.</p>
<p>&nbsp;</p>

<h2><a name="_msi_publishing_standard_actions"></a>Publishing Standard Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To <a href="over_5lgn.htm">publish</a> a product, component, or feature, you use one of the publishing actions. The <a href="aref_10dq.htm">PublishProduct action</a> registers the product information with the system. After executing the PublishProduct action, you publish components with the <a href="aref_2r3i.htm">PublishComponents action</a>, which uses the <a href="tref_7xt1.htm">PublishComponent table</a> to determine the components that are set to be advertised. To publish on a per-feature basis, the <a href="aref_8bou.htm">PublishFeatures action</a> is invoked. This action uses the <a href="tref_52hx.htm">FeatureComponents table</a> as data to resolve which features must be advertised.</p>
<p>
There are also two corresponding actions that unpublish a feature or a component: the <a href="aref_1ir2.htm">UnpublishComponents action</a> and the <a href="aref_6ywe.htm">UnpublishFeatures action</a>.</p>
<p>&nbsp;</p>

<h2><a name="_msi_searching_standard_actions"></a>Searching Standard Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
During installation, you often need to search for a file. The installer has four standard search actions that serve this purpose. The <a href="aref_16zy.htm">AppSearch action</a> uses the <a href="tref_0w9x.htm">AppSearch table</a> to determine if a file exists on a user's computer. The <a href="aref_77se.htm">CCPSearch action</a> and the <a href="aref_5pgu.htm">RMCCPSearch action</a> use corresponding tables to check for a previous version of a product for an upgrade installation.</p>
<p>&nbsp;</p>

<h2><a name="_msi_costing_standard_actions"></a>Costing Standard Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Costing is the process of determining the total disk space requirements for the current installation, including costs for files to be installed and/or removed, registry entries, shortcuts, and so forth. Costing takes into account the size of existing files to be overwritten (which reduces the overall costs). </p>
<p>
Total costs are accumulated on a per-component basis and consist of three separate parts: local costs, source costs, and removal cost corresponding to the disk cost that is incurred if the component is installed locally, installed to run from the source media, or removed.</p>
<p>
All calculations involving the cost of installing files depend in part on the volume to which the file is to be installed or removed. Each time the directory associated with a component changes, the costs of the installation files controlled by that component must be recalculated. For example, because a change in directory might also imply a volume change, the clustered file sizes must be recalculated. In addition, the new directory must be checked to determine whether any existing files that may be overwritten must be taken into account.</p>
<p>
After the <a href="aref_4bam.htm">CostInitialize action</a> is called, the <a href="aref_2f8u.htm">FileCost</a> action must be called. This action initializes all internal routines that dynamically calculate the disk costs involved with all standard installation actions. No other dynamic cost calculations are done at this point.</p>
<p>
Next, the <a href="aref_22we.htm">CostFinalize</a> action must be called. This action finalizes all the cost calculations and makes them available through the <a href="tref_09np.htm">Component table</a>.</p>
<p>
After the <a href="aref_22we.htm">CostFinalize</a> action finishes, the Component table is fully initialized, and a user interface dialog box sequence containing a <a href="href_3w30.htm">SelectionTree control</a> (if needed) can be initiated. The user interface dialog boxes typically give the user the option to change the selection state and/or destination directory of any feature in the <a href="tref_0a91.htm">Feature table</a> (which in turn is linked to one or more components). The process is similar when the selection state of a component changes, but, in this case, the dynamic cost of only the changed component is recalculated. </p>
<p>
After the Selection user interface wizard sequence, the <a href="aref_9fzi.htm">InstallValidate</a> action should be called before any other installation action. This action verifies that all volumes to which cost has been attributed have sufficient space for the installation.</p>
<p>&nbsp;</p>

<h1><a name="_msi_using_standard_actions"></a>Using Standard Actions</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You execute an action in the Microsoft  Windows  installer by calling the <a href="qref_9woe.htm"><b>MsiDoAction</b></a> function or by including the action in a sequence table. Since most actions encapsulate a single purpose, the most common way to use actions is to order a series of actions into a sequence to accomplish a larger task. The installer has three standard actions, called top-level actions, that call sequence tables. The three associated sequence tables can contain standard actions, custom actions, and user-interface elements. Each action in a sequence table has a condition and a sequence number. All actions in a sequence table are visited in order and are executed if the condition evaluates to True.</p>
<p>
Many of the installer standard actions have sequence restrictions. For example, before calling the <a href="aref_2f8u.htm">FileCost action</a>, you must first call the <a href="aref_4bam.htm">CostInitialize action</a>. Actions can be ordered in any manner in a sequence table as long as they follow all the sequencing restrictions. For more information on restrictions, see the individual action topic in <a href="aref_1wo5.htm">Standard Actions Reference</a>.</p>
<p>
The <a href="aref_986m.htm">INSTALL action</a> is a top-level action that uses the sequence tables.</p>
<h4>Example</h4>
<p>
When the INSTALL action is executed, a typical installation sequence would have the following execution flow:
<ol>
<li>
<a href="aref_6jhq.htm">LaunchConditions action</a> is executed. All of the launch conditions must be satisfied for the installation to proceed.</li>
<li>
<a href="aref_16zy.htm">AppSearch action</a> is executed. This action determines if an application specified in the <a href="tref_0w9x.htm">AppSearch table</a> is installed on the computer. This action can be used to determine the presence of a previous version of the application to be installed.</li>
<li>
<a href="aref_4bam.htm">CostInitialize action</a> is executed. This action loads the <a href="tref_09np.htm">Component table</a> and the <a href="tref_0a91.htm">Feature table</a> into memory to determine disk space requirements.</li>
<li>
<a href="aref_2f8u.htm">FileCost action</a> is executed. This action uses the loaded <a href="tref_0a91.htm">Feature table</a> and <a href="tref_09np.htm">Component table</a> to determine the size of all files to be installed.</li>
<li>
<a href="aref_22we.htm">CostFinalize action</a> is executed. This action finalizes the costing information, taking into account the installation levels and conditions for selected features.</li>
<li>
First installation dialog box displays. <p>
If the entry in the sequence is not a standard action, the installer queries the <a href="tref_71b9.htm">CustomAction table</a> to check whether the action is a registered custom action. If it is not a standard action or a custom action, the installer queries the user interface handler to check whether the action is a user interface element to be displayed.
</li>
<li>
Progress dialog box displays.</li>
<li>
<a href="aref_529a.htm">RegisterProduct action</a> is executed. The product information is registered with the configuration manager.</li>
<li>
<a href="aref_9fzi.htm">InstallValidate action</a> is executed. This action verifies that all volumes for which the cost has been determined have sufficient space for installation.</li>
<li>
<a href="aref_0g4u.htm">RegisterUser action</a> is executed. This action registers user information in the configuration manager.</li>
<li>
<a href="aref_6p0u.htm">CreateFolders action</a> is executed. This action creates empty folders for components set to be installed.</li>
<li>
<a href="aref_9xny.htm">RemoveFiles action</a> is executed. If there are files from a previous version, they are removed.</li>
<li>
<a href="aref_3hym.htm">InstallFiles action</a> is executed. All files from components set to be installed are copied to the appropriate directory.</li>
<li>
<a href="aref_15pq.htm">MoveFiles action</a> is executed. This action locates files that already exist on the user's computer and moves or copies those files to a new location.</li>
<li>
<a href="aref_1cmm.htm">WriteRegistryValues action</a> is executed. This action writes application registry information into the registry.</li>
<li>
<a href="aref_7uzy.htm">CreateShortcuts action</a> is executed. This action uses the <a href="tref_2i91.htm">Shortcut table</a> to determine the shortcuts that must be copied to the computer.</li>
<li>
<a href="aref_4fxq.htm">ProcessComponents action</a> is executed. This action registers the component information for the components set to be installed.</li>
<li>
<a href="aref_8l9q.htm">InstallFinalize action</a> is executed. This action runs a script containing all operations spooled since the start for the installation. </li>
</ol>
<p>
</p>
<p>&nbsp;</p>

<h2><a name="_msi_standard_actions_reference"></a>Standard Actions Reference</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Microsoft  Windows  installer contains the following standard actions.
<ul>
<li>
<a href="aref_4hbi.htm">ADMIN</a></li>
<li>
<a href="aref_2o8e.htm">ADVERTISE</a></li>
<li>
<a href="aref_16zy.htm">AppSearch</a></li>
<li>
<a href="aref_3ar2.htm">BindImage</a></li>
<li>
<a href="aref_3u0e.htm">BlockInstall</a></li>
<li>
<a href="aref_77se.htm">CCPSearch</a></li>
<li>
<a href="aref_4bam.htm">CostInitialize</a></li>
<li>
<a href="aref_22we.htm">CostFinalize</a></li>
<li>
<a href="aref_6p0u.htm">CreateFolders</a></li>
<li>
<a href="aref_7uzy.htm">CreateShortcuts</a></li>
<li>
<a href="aref_3b1q.htm">ExecuteAction</a></li>
<li>
<a href="aref_4rse.htm">FindRelatedProducts</a></li>
<li>
<a href="aref_69bi.htm">ForceReboot</a></li>
<li>
<a href="aref_986m.htm">INSTALL</a></li>
<li>
<a href="aref_9tpq.htm">InstallAdminPackage</a></li>
<li>
<a href="aref_3hym.htm">InstallFiles</a></li>
<li>
<a href="aref_2sku.htm">InstallExecute</a></li>
<li>
<a href="aref_8l9q.htm">InstallFinalize</a></li>
<li>
<a href="aref_0gby.htm">InstallInitialize</a></li>
<li>
<a href="aref_9fzi.htm">InstallValidate</a></li>
<li>
<a href="aref_6jhq.htm">LaunchConditions</a></li>
<li>
<a href="aref_9a5q.htm">MigrateFeatureSettings</a></li>
<li>
<a href="aref_15pq.htm">MoveFiles</a></li>
<li>
<a href="aref_6ffy.htm">ODBCInstall Action</a></li>
<li>
<a href="aref_935a.htm">ODBCRemove Action</a></li>
<li>
<a href="aref_9cby.htm">PatchFiles</a></li>
<li>
<a href="aref_4fxq.htm">ProcessComponents</a></li>
<li>
<a href="aref_2r3i.htm">PublishComponents</a></li>
<li>
<a href="aref_8bou.htm">PublishFeatures</a></li>
<li>
<a href="aref_10dq.htm">PublishProduct</a></li>
<li>
<a href="aref_2tv2.htm">RegisterFonts</a></li>
<li>
<a href="aref_529a.htm">RegisterProduct</a></li>
<li>
<a href="aref_08tq.htm">RegisterProgIdInfo</a></li>
<li>
<a href="aref_31ri.htm">RegisterTypeLibraries</a></li>
<li>
<a href="aref_0g4u.htm">RegisterUser</a></li>
<li>
<a href="aref_9xny.htm">RemoveFiles</a></li>
<li>
<a href="aref_0pf2.htm">RemoveFolders</a></li>
<li>
<a href="aref_4tv2.htm">RemoveIniValues</a></li>
<li>
<a href="aref_0omm.htm">RemoveOldProducts</a></li>
<li>
<a href="aref_5mem.htm">RemoveRegistryValues</a></li>
<li>
<a href="aref_6t66.htm">RemoveShortcuts</a></li>
<li>
<a href="aref_21im.htm">ResolveSource</a></li>
<li>
<a href="aref_5pgu.htm">RMCCPSearch</a></li>
<li>
<a href="aref_96su.htm">ScheduleReboot</a></li>
<li>
<a href="aref_1gku.htm">SelfRegModules</a></li>
<li>
<a href="aref_9jce.htm">SelfUnregModules</a></li>
<li>
<a href="aref_3xny.htm">SetODBCFolders Action</a></li>
<li>
<a href="aref_04oe.htm">RegisterClassInfo</a></li>
<li>
<a href="aref_1epa.htm">RegisterExtensionInfo</a></li>
<li>
<a href="aref_9r8u.htm">RegisterMIMEInfo</a></li>
<li>
<a href="aref_6ywe.htm">UnpublishFeatures</a></li>
<li>
<a href="aref_1ir2.htm">UnpublishComponents</a></li>
<li>
<a href="aref_8wby.htm">UnregisterClassInfo</a></li>
<li>
<a href="aref_738u.htm">UnregisterExtensionInfo</a></li>
<li>
<a href="aref_6wmm.htm">UnregisterFonts</a></li>
<li>
<a href="aref_30oe.htm">UnregisterMIMEInfo</a></li>
<li>
<a href="aref_1epb.htm">UnregisterProgIdInfo</a></li>
<li>
<a href="aref_8qb2.htm">UnregisterTypeLibraries</a></li>
<li>
<a href="aref_2er2.htm">UpdateResources</a></li>
<li>
<a href="aref_0cdq.htm">ValidateProductID</a></li>
<li>
<a href="aref_8432.htm">WriteIniValues</a></li>
<li>
<a href="aref_1cmm.htm">WriteRegistryValues</a> </li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_admin_action"></a>ADMIN Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Admin action is a top-level action that is used to install an Admin image for workgroup use. </p>
<h4>Database Tables Queried</h4>
<p>
The Admin action queries the following sequence tables for the action to execute, the condition for action execution, and the place of the action in the sequence. </p>
<p>
<a href="tref_1git.htm">InstallUISequence Table</a></p>
<p>
<a href="tref_5pid.htm">InstallExecuteSequence Table</a></p>
<p>
<a href="tref_5lnp.htm">AdminUISequence Table</a></p>
<p>
<a href="tref_70f9.htm">AdminExecuteSequence Table</a></p>
<p>
<a href="tref_3rvp.htm">AdvtUISequence Table</a></p>
<p>
<a href="tref_5mn9.htm">AdvtExecuteSequence Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The Admin action is not called from within the action table sequence.</p>
<h4>Remarks</h4>
<p>
The application of transforms during the creation of an Admin image has no valid effect. Therefore to make a customized version of a product available to a workgroup, the transform should be applied during the installation of the product from the Admin image.</p>
<p>&nbsp;</p>

<h1><a name="_msi_advertise_action"></a>ADVERTISE Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ADVERTISE action is a top-level action that is called to install or remove advertised components.</p>
<h4>Database Tables Queried</h4>
<p>
The ADVERTISE action queries the following sequence tables for the action to execute, the condition for action execution, and the place of the action in the sequence. </p>
<p>
<a href="tref_3rvp.htm">AdvtUISequence Table</a></p>
<p>
<a href="tref_5mn9.htm">AdvtExecuteSequence Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
Advertisement involves placing information with the system to allow either explicit or implicit Just-in-Time installation of features of a product when needed.</p>
<p>
When the installer is in install mode, advertise information for all enabled features.</p>
<p>&nbsp;</p>

<h1><a name="_msi_appsearch_action"></a>AppSearch Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AppSearch action uses file signatures to determine whether an application exists on a user's computer. The action works on the <a href="tref_0w9x.htm">AppSearch</a> table. The AppSearch action is used to search for previous versions of products to determine where to install an upgrade.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_0w9x.htm">AppSearch</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>AppSearch.Property</td>
<td width=65%>Property to be set on existence of a file signature.</td>
</tr>
<tr valign=top>
<td width=35%>AppSearch.Signature_</td>
<td width=65%>File signature.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
For each Property/Signature<b>_</b> pair in the table, the file signature, as specified in the <a href="tref_149x.htm">Signature</a> table, is searched for on the user's computer using the <a href="tref_771h.htm">CompLocator</a>, <a href="tref_91wl.htm">RegLocator</a>, <a href="tref_00o5.htm">IniLocator</a>, and <a href="tref_3azp.htm">DrLocator</a> tables (in that order). The absence of the signature from the Signature table denotes a directory. If the signature is determined to exist, the corresponding Property is set to the directory path for that signature. </p>
<p>&nbsp;</p>

<h1><a name="_msi_bindimage_action"></a>BindImage Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The BindImage action binds each executable that must be bound to the DLLs imported by it. This action does this by computing the virtual address of each function that is imported from all DLLs. The computed virtual address is then saved in the importing image Import Address Table (IAT). The action works on each file referred to in the <a href="tref_47l1.htm">BindImage</a> table installed locally.</p>
<h4>Database Tables Queried</h4>
<p>
This action queries the <a href="tref_47l1.htm">BindImage table</a> and the <a href="tref_09np.htm">Component table</a>.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The BindImage action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_blockinstall_action"></a>BlockInstall Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The BlockInstall action displays an error dialog and then blocks the current installation if the <a href="aref_4rse.htm">FindRelatedProducts action</a> finds a newer version of the product on the system.</p>
<h4>Database Tables Queried</h4>
<p>
This action queries the Operator and Property columns of the <a href="tref_4qxx.htm">Upgrade table</a>. The value of the operator specifies whether to block the installation of the pending upgrade of the product.</p>
<h4>Properties Used</h4>
<p>
The BlockInstall action terminates the installation if the properties set by the <a href="aref_4rse.htm">FindRelatedProducts action</a> are set when the action executes.</p>
<h4>Remarks</h4>
<p>
The BlockInstall action only stops the installation if the properties are still set when the action is executed. For example, a dialog may be authored that warns the user that a newer version of the application has been found. If the user chooses to perform the current install anyway, the dialog may unset the appropriate property to allow the installation to proceed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_ccpsearch_action"></a>CCPSearch Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CCPSearch action uses file signatures to ensure that a user who acquires an upgrade version of a product actually has installed one of the qualifying upgrade products. The action works on the <a href="tref_8nad.htm">CCPSearch table</a>. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_8nad.htm">CCPSearch</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>CCPSearch.Signature_ </td>
<td width=52%>File signature</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The CCPSearch action must be sequenced before the <a href="aref_5pgu.htm">RMCCPSearch</a> action.</p>
<h4>Remarks</h4>
<p>
Each file signature, Signature<b>_</b>, in the table is searched for on the user's computer as specified in the <a href="tref_149x.htm">Signature</a> table using the <a href="tref_771h.htm">CompLocator</a>, <a href="tref_91wl.htm">RegLocator</a>, <a href="tref_00o5.htm">IniLocator</a>, and <a href="tref_3azp.htm">DrLocator</a> tables (in that order). The absence of the signature from the Signature table denotes a directory. If any signature is determined to exist, the property <b>CCP_Success</b> is set to 1, and the CCPSearch action terminates.</p>
<p>&nbsp;</p>

<h1><a name="_msi_costfinalize_action"></a>CostFinalize Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CostFinalize action is used to finalize the costing information for each component in the <a href="tref_09np.htm">Component table</a>, making use of the authored InstallLevel for each Feature item in conjunction with the conditions specified in the <a href="tref_83qd.htm">Condition table</a>.</p>
<p>
CostFinalize also validates that all configurable target directories are writable before allowing the install to continue.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<p>
<a href="tref_83qd.htm">Condition Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_4bam.htm">CostInitialize action</a>, and any specific cost-calculation actions (such as <a href="aref_2f8u.htm">FileCost</a>), must be executed prior to executing CostFinalize. In turn, CostFinalize must be executed before starting any user interface dialog sequence that allows the user to view or modify <a href="tref_0a91.htm">Feature table</a> selections or directories.</p>
<p>&nbsp;</p>

<h1><a name="_msi_costinitialize_action"></a>CostInitialize Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CostInitialize action starts the internal installation costing process. The CostInitialize action is also responsible for loading the <a href="tref_09np.htm">Component</a> and <a href="tref_0a91.htm">Feature</a> tables into memory.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<p>
<a href="tref_0a91.htm">Feature Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
Typically, after the CostInitialize action is called, the <a href="aref_2f8u.htm">FileCost</a> action is called. Next, the <a href="aref_22we.htm">CostFinalize</a> action is called, which finalizes all the cost calculations and makes them available via the <a href="tref_09np.htm">Component table</a>.</p>
<h4>Remarks</h4>
<p>
Costing is the process in which the installer determines the disk space requirements for all the components comprising an installation, taking into account factors such as whether or not existing files need to be overwritten. For more information on the costing process in the installer, see <a href="acts_47sj.htm">Costing Standard Actions</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_createfolders_action"></a>CreateFolders Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CreateFolders action creates empty folders for components set to be installed locally. When a folder is created (and didn't already exist), it is registered with the appropriate component identifier.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_152d.htm">CreateFolder</a></p>
<p>
<a href="tref_09np.htm">Component</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=37%>CreateFolder.Directory_</td>
<td width=63%>Folder name. For each folder, a property is assumed to exist with this name that defines the folder location.</td>
</tr>
<tr valign=top>
<td width=37%>Component.ComponentId</td>
<td width=63%>Component ID for the component owning this folder.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
Each folder name in the CreateFolder table also is assumed to be a property defining the folder location.</p>
<h4>Sequencing Restrictions</h4>
<p>
The CreateFolders action must be executed before the <a href="aref_3hym.htm">InstallFiles</a> action or any action that may add files to folders.</p>
<h4>Remarks</h4>
<p>
The removal of these folders is handled by the <a href="aref_0pf2.htm">RemoveFolders</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_createshortcuts_action"></a>CreateShortcuts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CreateShortcuts action manages the creation of shortcuts. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_2i91.htm">Shortcut Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The CreateShortcuts action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action and the <a href="aref_6t66.htm">RemoveShortcuts</a> action.</p>
<h4>Remarks</h4>
<p>
In advertise mode, the action creates shortcuts to the key files of components of features that are enabled. Advertised shortcuts are those for which the Target column in the <a href="tref_2i91.htm">Shortcut table</a> is the feature of the component and the directory of the shortcut is one of the Shell folders or is below one. Advertised shortcuts are created with an installer descriptor as the target. Non-advertised shortcuts are those for which the Target column in the Shortcut table is a property or the directory of the shortcut is not one of the Shell folders or is below one. Advertised shortcuts are created with an installer descriptor as the target.</p>
<p>
In non-advertise mode (normal install), the action creates shortcuts to the key files of components of features that are selected for install as well as non-advertised shortcuts whose components are selected for install.</p>
<p>&nbsp;</p>

<h1><a name="_msi_duplicatefiles_action"></a>DuplicateFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The DuplicateFiles action allows the author to make one or more duplicate copies of files installed by the <a href="aref_3hym.htm">InstallFiles</a> action. The duplicate files can be copied to the same directory with a different name, or to a different directory with the original name.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_310l.htm">DuplicateFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=38%>DuplicateFile.FileKey</td>
<td width=62%>Primary key, uniquely identifying an entry in the <a href="tref_5un9.htm">MoveFile table</a>.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.Component_</td>
<td width=62%>Foreign key into the Component table.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.File_</td>
<td width=62%>Foreign key into the <a href="tref_4n6t.htm">File table</a>, representing the original file to be duplicated.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.DestName</td>
<td width=62%>Name to be given to the destination file.</td>
</tr>
<tr valign=top>
<td width=38%>DuplicateFile.DestFolder</td>
<td width=62%>Property name whose value identifies the destination folder.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The DuplicateFiles action must occur after the <a href="aref_3hym.htm">InstallFiles action</a>.</p>
<h4>Remarks</h4>
<p>
The DuplicateFiles action processes a <a href="tref_310l.htm">DuplicateFile table</a> entry only if the component linked to that entry is being installed locally.</p>
<p>
The string in the DestFolder field is a property name whose value is expected to resolve to a fully qualified path. This property could be any of the directory entries in the <a href="tref_6an9.htm">Directory</a> table, any pre-defined folder property (<a href="pref_4ge1.htm">CommonFilesFolder</a>, for example), or a property set by any entry in the <a href="tref_0w9x.htm">AppSearch</a> table.</p>
<p>
For a particular entry in the <a href="tref_310l.htm">DuplicateFile table</a>, if the DestFolder property does not evaluate to a valid path, DuplicateFiles does nothing for that entry.</p>
<p>
The name to be given to the destination file can be specified in the DestName field. If this field is left blank, the destination file name is the same as the original file name.</p>
<p>
Files installed by the DuplicateFiles action are uninstalled when appropriate by the <a href="aref_3tpq.htm">RemoveDuplicateFiles</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_executeaction_action"></a>ExecuteAction Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ExecuteAction action runs the top-level action defined by the <a href="pref_2dq1.htm">EXECUTEACTION property</a>. </p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
The ExecuteAction action checks the <a href="pref_2dq1.htm">EXECUTEACTION property</a> to determine with which top-level action to begin the execution sequence. </p>
<h4>Sequencing Restrictions</h4>
<p>
This action should be placed in the sequence after the collection all of the information necessary to begin the installation. Additional actions can be placed after ExecuteAction action in the <a href="tref_1git.htm">InstallUISequence table</a>, <a href="tref_5lnp.htm">AdminUISequence table</a>, and the <a href="tref_3rvp.htm">AdvtUISequence table</a>. A typical sequence will begin with costing actions, such as the <a href="aref_4bam.htm">CostInitialize action</a>, followed by the user interface actions, and then the ExecuteAction action.</p>
<h4>Remarks</h4>
<p>
This action is run with system privileges if the Installer service is enabled. The top-level actions, such as the <a href="aref_986m.htm">INSTALL action</a>, <a href="aref_2o8e.htm">ADVERTISE action</a>, and <a href="aref_4hbi.htm">Admin action</a>, include internal logic that determines whether calling to the ExecuteAction action means to run the execution or the user interface sequence. </p>
<p>&nbsp;</p>

<h1><a name="_msi_installexecute_action"></a>InstallExecute Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallExecute action runs a script containing all operations spooled since the start of the install or the last InstallFinalize action. It updates the system without ending the transaction. </p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
This action occurs in the sequence between the InstallInitialize action the InstallFinalize action.</p>
<h4>Remarks</h4>
<p>
The InstallExecute action is similar to the InstallFinalize action but InstallExecute does not end the transaction. This action will update the system with whatever operations have been determined to that point.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installfinalize_action"></a>InstallFinalize Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallFinalize action runs a script containing all operations spooled since the start of the install or the last InstallFinalize action. It marks the end of a transaction that begins with the <a href="aref_0gby.htm">InstallInitialize action</a>. If it is detected that the product is marked for complete removal, operations are added to the script to remove Add/Remove Control Panel information for the product, to unregister and unpublish the product, and to remove the cached local database from %WINDOWS%, if it exists.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The InstallInitialize action must be called before the InstallFinalize action.</p>
<h4>Remarks</h4>
<p>
When this action is executed, system changes made before it may not be restored. This action updates the system with whatever operations have been determined to that point, then ends the transaction.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installinitialize_action"></a>InstallInitialize Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallInitialize action and <a href="aref_8l9q.htm">InstallFinalize action</a> mark the beginning and end of a sequence of actions that change the system. </p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The InstallInitialize action must be called before any actions that change the system, such as the <a href="aref_3hym.htm">InstallFiles action</a>, <a href="aref_1cmm.htm">WriteRegistryValues action</a>, and <a href="aref_4fxq.htm">ProcessComponents action</a>. It must, therefore, be called before the <a href="aref_8l9q.htm">InstallFinalize action</a> and the <a href="aref_2sku.htm">InstallExecute action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_filecost_action"></a>FileCost Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The FileCost action enables dynamic costing of standard installation actions.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_4bam.htm">CostInitialize</a> action must be executed before executing the FileCost action. The installer is then responsible for determining the actual disk space cost of every file in the <a href="tref_4n6t.htm">File table</a>, on a per-component basis, taking into account volume clustering and the presence of existing files that may need to be overwritten. All actions that consume or release disk space are considered. In case an existing file is found, a file version check is performed to determine whether the new file actually needs to be installed. If the existing file is an equal or greater version, the existing file is not overwritten and no disk space cost is incurred. In any case, the installer uses the results of version checking to set the install state of each file.</p>
<p>
The FileCost action itself simply initializes cost calculation with the installer. Actual dynamic costing does not occur until the <a href="aref_22we.htm">CostFinalize</a> action is executed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_findrelatedproducts_action"></a>FindRelatedProducts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The FindRelatedProducts action uses the <a href="tref_4qxx.htm">Upgrade table</a> to search for related products on the system. If a related product is found to be installed, then the action sets the property in the Property column of the Upgrade table.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_forcereboot_action"></a>ForceReboot Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ForceReboot action is authored in the sequence if there is a need to reboot during the installation before it can continue. The action writes a registry key that causes the installer to start after reboot. It also runs all spooled operations before reboot.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The ForceReboot action must be preceeded by the <a href="aref_9fzi.htm">InstallValidate</a> action and placed at the point in the installation sequence where the reboot is required.</p>
<p>&nbsp;</p>

<h1><a name="_msi_install_action"></a>INSTALL Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The INSTALL action is a top-level action called to install or remove components.</p>
<h4>Database Tables Queried</h4>
<p>
The INSTALL action queries the following sequence tables for the action to execute, the condition for action execution, and the place of the action in the sequence. </p>
<p>
<a href="tref_1git.htm">InstallUISequence Table</a></p>
<p>
<a href="tref_5pid.htm">InstallExecuteSequence Table</a></p>
<p>
<a href="tref_5lnp.htm">AdminUISequence Table</a></p>
<p>
<a href="tref_70f9.htm">AdminExecuteSequence Table</a></p>
<p>
<a href="tref_3rvp.htm">AdvtUISequence Table</a></p>
<p>
<a href="tref_5mn9.htm">AdvtExecuteSequence Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<p>&nbsp;</p>

<h1><a name="_msi_installadminpackage_action"></a>InstallAdminPackage Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallAdminPackage action copies the product database to the admin install point, which is defined by the <a href="pref_73ax.htm"><b>TARGETDIR</b> property</a>. This action also updates the summary information of the database and removes any cabinets located in streams once the database is copied.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
<a href="pref_73ax.htm"><b>TARGETDIR</b></a></p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<p>&nbsp;</p>

<h1><a name="_msi_installfiles_action"></a>InstallFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallFiles action copies selected files from the source directory to the destination directory.</p>
<p>
The InstallFiles action operates on files specified in the <a href="tref_4n6t.htm">File table</a>. Each of these files is installed based on what is going to happen to its associated component in the <a href="tref_09np.htm">Component table</a>. Only those files whose components are resolved to the <i>iisLocal</i> Action state are eligible to be copied.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4mlh.htm">Media Table</a></p>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>Media.LastSequence</td>
<td width=65%>Last sequence number on this media record.</td>
</tr>
<tr valign=top>
<td width=35%>Media.DiskPrompt</td>
<td width=65%>Text identifier on media, for user prompting (localized text).</td>
</tr>
<tr valign=top>
<td width=35%>Media.VolumeLabel</td>
<td width=65%>Volume label, used for disk validation.</td>
</tr>
<tr valign=top>
<td width=35%>Media.Cabinet</td>
<td width=65%>For cabinet installs, the name of the cabinet file.</td>
</tr>
<tr valign=top>
<td width=35%>File.FileName</td>
<td width=65%>Target file name (localized text).</td>
</tr>
<tr valign=top>
<td width=35%>File.Version</td>
<td width=65%>File version (non-localized text).</td>
</tr>
<tr valign=top>
<td width=35%>File.State</td>
<td width=65%>Installation status for the file (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Attributes</td>
<td width=65%>File and installation attribute flag bits (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.File</td>
<td width=65%>Unique file token (non-localized text, primary key).</td>
</tr>
<tr valign=top>
<td width=35%>File.FileSize</td>
<td width=65%>Uncompressed file size in bytes (long integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Language</td>
<td width=65%>File language identifier (integer).</td>
</tr>
<tr valign=top>
<td width=35%>File.Sequence</td>
<td width=65%>Sequence number on media (integer, unique).</td>
</tr>
<tr valign=top>
<td width=35%>Component.Directory_</td>
<td width=65%>Reference to <a href="tref_6an9.htm">Directory table</a> item (non-localized text).</td>
</tr>
<tr valign=top>
<td width=35%>Component.Component</td>
<td width=65%>Unique name for the component item (text, primary key)</td>
</tr>
<tr valign=top>
<td width=35%>Component.Action</td>
<td width=65%>Enum indicating the action to be taken.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The InstallFiles action must occur after the <a href="aref_9fzi.htm">InstallValidate</a> action and before any file-dependent actions.</p>
<h4>Remarks</h4>
<p>
Action states determine what is going to happen to a file during the running of the installation script. However, even if the component is in the <i>iisLocal</i> state, the file is only copied if one of the following is true:
<ul>
<li>
The file is currently not on the local computer.</li>
<li>
The file is on the local computer but it has a lower version number than the file in the <a href="tref_4n6t.htm">File table</a>.</li>
<li>
The file is on the local computer, but there is no associated version number.</li>
</ul>
<p>
The value in the Action state is calculated during the file costing process. For more information, see the <a href="tref_0a91.htm">Feature table</a> and the <a href="vref_84xl.htm"><b>FeatureRequestState</b> property</a>.</p>
<p>
<b>Source Directory Determination</b></p>
<p>
The determination of the source directory for each file to be copied depends on the SourceMode, which is dependent on the value in the Media.Cabinet column. For a full discussion of the SourceMode determination, see the <a href="tref_4mlh.htm">Media table</a>.</p>
<p>
<b>Prompting for Disks</b></p>
<p>
If the source directory for a file to be copied resides on a removable disk (a floppy or CD-ROM), the InstallFiles action validates that the proper source disk is inserted before attempting to copy the file. To do this, InstallFiles searches for a disk of the same removable type that has a volume label that matches the value given in the Media.VolumeLabel field. If a matching mounted volume is found, the file copying process proceeds. However, if no match is found, a dialog appears requesting that the proper disk be inserted. In this case, the dialog uses the disk name found in the Media.DiskPrompt field as part of the prompt.</p>
<p>
<b>Possible Problems</b></p>
<p>
If a file is replacing an older file, an error occurs, and that error is ignored, it is possible that the original file is deleted and not replaced. This is because the installer deletes the old file before making sure the new file is copied correctly.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installvalidate_action"></a>InstallValidate Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The InstallValidate action verifies that all volumes to which cost has been attributed have sufficient space for the installation. If any volume is short of disk space, the InstallValidate action ends the installation with a fatal error.</p>
<p>
This action is also responsible for notifying the user if one or more files to be overwritten or removed are currently in use by an active process.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_22we.htm">CostFinalize</a> action and any user-interface dialog sequences that allow the user to modify selection states and/or directories should be executed prior to executing InstallValidate.</p>
<h4>Remarks</h4>
<p>
This is a fail-safe verification. Typically, an earlier user-interface dialog sequence should perform this same verification whenever the user attempts to initiate the actual installation of files and should present an Out-Of-Disk-Space dialog when required. Thus, the user-interface dialogs should be authored in such a way as to prevent the user from proceeding with the install if a disk-space problem exists. Of course, in the case of a quiet install, there is no user interface, so the fact that InstallValidate action simply terminates the install if a disk-space problem exists is the proper response. (If logging is enabled, the reason for the premature termination appears in the log.)</p>
<p>
<b>Handling Files in Use</b></p>
<p>
During the file costing process, for any file to be overwritten or removed that is also found to be in use (that is, opened for execution or modification by any process), an entry is added to an internal FilesInUse table. (This entry contains columns for the name and full path of the file.) When InstallValidate is executed, if there are any entries in the FilesInUse table, The installer determines the name of the process that is using the file. For each unique process identified in this manner, InstallValidate adds one record to the <a href="tref_5f1h.htm">ListBox</a> user-interface table, with the following values in each column:</p>
<p>
<b>Property</b>:   FileInUseProcess<br>
<b>Value</b>:       &lt;Name of process&gt;<br>
<b>Text</b>:         &lt;Text contained in the caption of main window of process&gt;</p>
<p>
Next, InstallValidate displays the FilesInUse dialog. This gives the user interface a chance to display a dialog informing the user of the processes that should be shut down to avoid the requirement of rebooting the system to replace files in use. To display an appropriate dialog, a dialog must be authored with the name FilesInUse. This dialog must contain a <a href="href_1yjw.htm">ListBox control</a> that is tied to a property named FileInUseProcess. By convention, this dialog would have three pushbuttons (for example, Exit, Retry, Ignore), but this is up to the user-interface author. In any case, each pushbutton should be tied to an <a href="href_9a0k.htm">EndDialog</a> controlevent via the <a href="tref_6k11.htm">ControlEvent</a> table, each with a different argument. InstallValidate responds as follows to the value returned by DoAction, as dictated by one of these <a href="href_9a0k.htm">EndDialog</a> arguments associated with the button pushed by the user:</p>
<p>
<b>Retry</b>: All values added to the <a href="tref_5f1h.htm">ListBox table</a> are cleared, and the entire file costing procedure is repeated (rechecking for files that are still in use). If one or more processes are still identified as using files to be overwritten or deleted, the process repeats; otherwise, InstallValidate returns control to The installer with a status of iesSuccess.</p>
<p>
<b>Exit</b>: InstallValidate immediately returns control to the installer with a status of iesUserExit. This terminates the installation.</p>
<p>
<b>Any other return value</b>: InstallValidate immediately returns control to the installer with a status of iesSuccess. In this case, since one or more files are still in use, the subsequent <a href="aref_3hym.htm">InstallFiles</a> and/or <a href="aref_9tpq.htm">InstallAdminPackage</a> actions must schedule the in-use file(s) to be replaced or deleted at reboot time.</p>
<p>
<b>Notes</b>&nbsp;&nbsp;If no dialog named FilesInUse is found, or if the database has no ListBox table, InstallValidate silently exits without an error.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used in these filenames or paths.</p>
<p>
Files marked read-only in a read-only location are never considered in use by the installer.</p>
<p>
If the UI level is basic, an "out of disk space" dialog is always presented to the user, when selecting the "Abort" and "Retry" buttons. To determine if sufficient disk space is available, see <a href="href_9njo.htm">CheckDiskSpace ControlEvent</a>.&nbsp; </p>
<p>&nbsp;</p>

<h1><a name="_msi_launchconditions_action"></a>LaunchConditions Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The LaunchConditions action evaluates the set of conditions that must be satisfied for the installation to proceed. If any of these conditions fail, then an error message is displayed to the user and the installation is terminated.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_90f9.htm">LaunchCondition Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>LaunchCondition.Condition</td>
<td width=52%>Expression, containing properties, to evaluate.</td>
</tr>
<tr valign=top>
<td width=48%>LaunchCondition.Description</td>
<td width=52%>Text to display if condition fails.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
Only properties contained within the condition expressions.</p>
<h4>Sequencing Restrictions</h4>
<p>
The LaunchConditions action is optional but, if present, should be the first action. If some of the conditions do not apply to all modes, the appropriate property should be included in the expression.</p>
<p>&nbsp;</p>

<h1><a name="_msi_migratefeaturesettings_action"></a>MigrateFeatureSettings Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MigrateFeatureSettings action sets the feature settings of the current installation equal to the feature settings of a product that is already installed. </p>
<h4>Database Tables Queried</h4>
<p>
The MigrateFeatureSettings action queries the Operator column of the <a href="tref_4qxx.htm">Upgrade table</a>. This action migrates the feature settings from a product found by the FindRelatedProducts action if the Operator column in the <a href="tref_4qxx.htm">Upgrade table</a> contains the bit: 16.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The MigrateFeatureSettings action should come after the <a href="aref_4bam.htm">CostInitialize action</a> but before the UI wizard begins. </p>
<p>&nbsp;</p>

<h1><a name="_msi_movefiles_action"></a>MoveFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MoveFiles action allows the author to locate files that already exist on the user's computer and move or copy those files to a new location. The MoveFiles action moves an entry in the <a href="tref_5un9.htm">MoveFile table</a> only if the component linked to that entry is being installed locally or is being run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_5un9.htm">MoveFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=34%>MoveFile.FileKey</td>
<td width=66%>Primary key, uniquely identifying an entry in the MoveFile table.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.Component_</td>
<td width=66%>Foreign key into the Component table.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.SourceName</td>
<td width=66%>Name of the source file to be moved or copied.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.DestName</td>
<td width=66%>Name to be given to the destination file.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.SourceFolder</td>
<td width=66%>Property name whose value identifies the source folder.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.DestFolder</td>
<td width=66%>Property name whose value identifies the destination folder.</td>
</tr>
<tr valign=top>
<td width=34%>MoveFile.Options</td>
<td width=66%>Option flags used to define the behavior of the move/copy operation.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The LaunchConditions action must occur after the <a href="aref_9fzi.htm">InstallValidate</a> action and before the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<h4>Remarks</h4>
<p>
The Options field allows you to specify whether the source file(s) should be moved or copied (that is, whether the source file is to be deleted after it has been copied to a new location). For the exact syntax, see the <a href="tref_5un9.htm">MoveFile table</a>.</p>
<p>
The strings in the SourceFolder and DestFolder fields are property names whose values are expected to resolve to fully qualified paths. These properties could be any of the directory entries in the <a href="tref_6an9.htm">Directory</a> table, any predefined folder property (<a href="pref_048p.htm">FavoritesFolder</a>, for example), or a property set by any entry in the <a href="tref_0w9x.htm">AppSearch</a> table.</p>
<p>
Some properties can contain a full path to a specific file (that is, a full path with the file name appended). For example, AppSearch can be authored to search for a particular file and to set a property to the full path to that file. In a case such as this, the SourceName field in the MoveFile table can be left blank indicating that the value in the SourceFolder property contains a full file path. Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used in these filenames or paths.</p>
<p>
For a particular entry in the MoveFile table, if either the SourceFolder or DestFolder property does not evaluate to a valid path, MoveFiles does nothing for that entry.</p>
<p>
The MoveFiles action attempts to move or copy all files in the source directory that match the name given in the SourceName column. This name can include wildcards (* and ?), which allow a group of files to be moved or copied. For example, you could specify *.xls for the SourceName, and MoveFiles moves or copies every Microsoft  Excel workbook from the source directory to the destination.</p>
<p>
When copying or moving files, the name to be given to the destination file can be specified in the DestName field. If this field is left blank, the destination file name is the same as the source file name.</p>
<p>
The DestName field should normally be left blank if a wildcard is specified in the SourceName field. If you do specify a DestName when using wildcards, the first source file that matches the wildcard criteria is given the specified destination name. (All other moved/copied files have the same name as the source file.)</p>
<p>
Files that are moved or copied by MoveFiles are not deleted when the product is uninstalled.</p>
<p>&nbsp;</p>

<h1><a name="_msi_odbcinstall_action"></a>ODBCInstall Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCInstall action installs the drivers, translators, and data sources in the <a href="tref_457p.htm">ODBCDriver table</a>, <a href="tref_6msl.htm">ODBCTranslator table</a>, and <a href="tref_359h.htm">ODBCDataSource table</a>. If a driver or translator already exists, the action will make SQL calls necessary to carry out their installation.</p>
<h4>Database Tables Queried</h4>
<p>
The ODBCInstall action queries the <a href="tref_359h.htm">ODBCDataSource table</a> and the <a href="tref_3yat.htm">ODBCSourceAttribute table</a> for each data source to be installed and the attributes of the data source. The action queries the <a href="tref_457p.htm">ODBCDriver table</a> and the <a href="tref_6msl.htm">ODBCTranslator table</a> for each driver and translator selected for installation. It queries the <a href="tref_0mat.htm">ODBCAttribute table</a> for the attributes of the drivers and translators. </p>
<h4>Sequencing Restrictions</h4>
<p>
This action does not copy or remove files and therefore must come after actions that copy or remove files.</p>
<h4>Remarks</h4>
<p>
The ODBC Driver Manager must be authored in the installer package and a component included named ODBCDriverManager. The manager will be installed if necessary. If this component must have another name, a property with the name ODBCDriverManager must contain the name of the component.</p>
<p>&nbsp;</p>

<h1><a name="_msi_odbcremove_action"></a>ODBCRemove Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ODBCRemove action removes the data sources, translators, and drivers that are listed for removal during the installation.</p>
<h4>Database Tables Queried</h4>
<p>
This action queries the <a href="tref_359h.htm">ODBCDataSource table</a>, the <a href="tref_6msl.htm">ODBCTranslator table</a>, or the <a href="tref_457p.htm">ODBCDriver table</a> for each data source, translator, or driver to be removed.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
If both the ODBC usage count and the file usage count become zero, the file is removed. Registration is dependent on ODBC usage counts and file removal based on SharedDLLs key ref counts.</p>
<p>&nbsp;</p>

<h1><a name="_msi_processcomponents_action"></a>ProcessComponents Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ProcessComponents action manages information regarding the product components. The action is responsible for the registration and unregistration of components and component clients.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The ProcessComponents action must be called after the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_patchfiles_action"></a>PatchFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PatchFiles action queries the <a href="tref_0h5x.htm">Patch table</a> to determine what patches are applied to which files and then performs the necessary byte-wise patching of the files receiving a patch.</p>
<h4>Database Tables Queried</h4>
<p>
The PatchFiles action queries the <a href="tref_0h5x.htm">Patch table</a> and <a href="tref_4n6t.htm">File table</a> and <a href="tref_09np.htm">Component table</a>.</p>
<h4>Sequencing Restrictions</h4>
<p>
A file must be installed to be patched. Therefore the PatchFiles action must come after the <a href="aref_3hym.htm">InstallFiles action</a> that installs the file or the file must have been already installed.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_publishcomponents_action"></a>PublishComponents Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PublishComponents action manages the advertisement of the components from the <a href="tref_7xt1.htm">PublishComponent</a>. </p>
<h4>Database Tables Queried</h4>
<p>
This action queries the <a href="tref_7xt1.htm">PublishComponent Table</a>, the <a href="tref_0a91.htm">Feature Table</a>, and the <a href="tref_09np.htm">Component Table</a>.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
This action publishes all of the components from the PublishComponents table that belong to features that have been selected for advertisement or installation.</p>
<p>&nbsp;</p>

<h1><a name="_msi_publishfeatures_action"></a>PublishFeatures Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PublishFeatures action manages the advertisement of the feature composition (feature-component mapping) within the system. </p>
<h4>Database Tables Queried</h4>
<p>
The PublishFeatures action queries the <a href="tref_52hx.htm">FeatureComponents table</a>, the <a href="tref_0a91.htm">Feature table</a>, and the <a href="tref_09np.htm">Component table</a>.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
The PublishFeatures action publishes the composition of all features that are selected to be advertised or installed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_publishproduct_action"></a>PublishProduct Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PublishProduct action manages the advertisement of the product information with the system. This action publishes the product if it is in advertise mode or if <a href="msi_8wa7.htm"><b>MsiGetProductInfo</b></a> returns ERROR_INSTALL_PRODUCT for the product.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_7vmt.htm">Icon Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The PublishProduct action is must come before the <a href="aref_8bou.htm">PublishFeatures</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registerclassinfo_action"></a>RegisterClassInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterClassInfo action manages the registration of COM class information with the system. In advertise mode, the action registers all COM classes from the Class table for which the corresponding feature is enabled. Else the action registers COM classes from the Class table for which the corresponding feature is currently selected to be installed.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_5n8l.htm">Class Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RegisterClassInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> and the <a href="aref_8wby.htm">UnregisterClassInfo</a> actions.</p>
<h4>Remarks</h4>
<p>
In advertise mode, the action registers all COM classes from the Class table for which the corresponding feature is enabled. Else the action registers COM classes from the Class table for which the corresponding feature is currently selected to be installed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registerextensioninfo_action"></a>RegisterExtensionInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterExtensionInfo action manages the registration of extension related information with the system. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_219h.htm">Extension Table</a></p>
<p>
<a href="tref_3kdh.htm">Verb Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RegisterExtensionInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> and the <a href="aref_738u.htm">UnregisterExtensionInfo</a> actions.</p>
<h4>Remarks</h4>
<p>
In advertise mode, the action registers all extension servers from the Extension table for which the corresponding feature is enabled. Else the action registers extension servers from the Extension table for which the corresponding feature is currently selected to be installed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registerfonts_action"></a>RegisterFonts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterFonts action registers installed fonts with the system. This action maps the Font.FontTitle to the path of the font file installed. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_9tnp.htm">Font Table</a></p>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_3hym.htm">InstallFiles</a> action must be called before calling RegisterFonts. </p>
<h4>Remarks</h4>
<p>
The RegisterFonts action is triggered when the component to which the Font.File_ belongs is selected for install. This implies that fonts can be made private, shared, or system by specifying the components to which they belong.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registermimeinfo_action"></a>RegisterMIMEInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterMIMEInfo action registers the MIME-related registry information with the system. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3sh1.htm">MIME Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RegisterMIMEInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> and the <a href="aref_30oe.htm">UnregisterMIMEInfo</a> actions.</p>
<h4>Remarks</h4>
<p>
In advertise mode, the action registers all MIME info for servers from the MIME table for which the corresponding feature is enabled. Else the action registers MIME info for servers from the MIME table for which the corresponding feature is currently selected to be installed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registerproduct_action"></a>RegisterProduct Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterProduct action registers the product information with the installer. Additionally, it stores the installer database on the local computer.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
The RegisterProduct action uses the <a href="pref_1g8p.htm">ARPNOMODIFY property</a> and the <a href="pref_46bd.htm">ARPNOREMOVE property</a>. If these properties are set, then the RegisterProduct action will disable Add/Remove Control Panel and Programs Wizard functionality that would modify or remove products.</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
The RegisterProduct action is not performed during the AdminInstall.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registerprogidinfo_action"></a>RegisterProgIdInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterProgIdInfo action manages the registration of OLE ProgId information with the system. This action registers all ProgId information from the <a href="tref_4x5x.htm">ProgId table</a> for features that are connected to the extension information (in the <a href="tref_219h.htm">Extension table</a>) or the Class information (in the <a href="tref_5n8l.htm">Class table</a>) that are enabled to be advertised or selected to be installed.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4x5x.htm">ProgId Table</a></p>
<p>
<a href="tref_5n8l.htm">Class Table</a></p>
<p>
<a href="tref_219h.htm">Extension Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RegisterProgIdInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles action</a> and the <a href="aref_1epb.htm">UnregisterProgIdInfo action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registertypelibraries_action"></a>RegisterTypeLibraries Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterTypeLibraries action registers type libraries with the system. This action works on each file referred to in the <a href="tref_3085.htm">TypeLib table</a> that is triggered to be installed.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3085.htm">TypeLib Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RegisterTypeLibraries action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_registeruser_action"></a>RegisterUser Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RegisterUser action registers the user information with the installer to identify the user of a product.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
The RegisterUser action uses the <a href="pref_9shl.htm">USERNAME</a>, the <a href="pref_5oc9.htm">COMPANYNAME</a>, and the <a href="pref_6et5.htm">ProductID</a>.</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
The RegisterUser action is not performed during an Admin install. If the Product ID entered by the user has not been validated by the <a href="aref_0cdq.htm">ValidateProductID action</a>, then the <a href="pref_6et5.htm">ProductID property</a> will not be set and this action does nothing.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removeduplicatefiles_action"></a>RemoveDuplicateFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveDuplicateFiles action deletes files installed by the <a href="aref_7yr2.htm">DuplicateFiles</a> action.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_310l.htm">DuplicateFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=40%>DuplicateFile.FileKey</td>
<td width=60%>Primary key, uniquely identifying an entry in the DuplicateFile table.</td>
</tr>
<tr valign=top>
<td width=40%>DuplicateFile.Component_</td>
<td width=60%>Foreign key into the Component table.</td>
</tr>
<tr valign=top>
<td width=40%>DuplicateFile.File_</td>
<td width=60%>Foreign key into the <a href="tref_4n6t.htm">File table</a>, referencing the file to be duplicated.</td>
</tr>
<tr valign=top>
<td width=40%>DuplicateFile.DestName</td>
<td width=60%>Name that was given to the duplicate file.</td>
</tr>
<tr valign=top>
<td width=40%>DuplicateFile.DestFolder</td>
<td width=60%>Property name whose value identifies the destination folder.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RemoveDuplicateFiles action must occur after the <a href="aref_9fzi.htm">InstallValidate</a> action and before the <a href="aref_3hym.htm">InstallFiles</a> action.</p>
<h4>Remarks</h4>
<p>
To delete a file duplicated with the <a href="aref_7yr2.htm">DuplicateFiles action</a> using the RemoveDuplicateFiles action, the component associated with the file's entry in the DuplicateFile table must be selected for removal.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removefiles_action"></a>RemoveFiles Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveFiles action uninstalls files previously installed by the <a href="aref_3hym.htm">InstallFiles</a> action. Each of these files is gated by a link to an entry in the <a href="tref_09np.htm">Component</a> table. Only those files whose components are resolved to the <i>iisAbsent</i> Action state (or the <i>iisSource</i> Action state if the component is currently installed locally) are removed. </p>
<p>
The RemoveFiles action can also remove specific author-specified files that are not installed by the InstallFiles action. These files are specified in the <a href="tref_7gth.htm">RemoveFile</a> table. Each of these files is gated by a link to an entry in the <a href="tref_09np.htm">Component</a> table. Those files whose components are resolved to any active Action state (that is, not in the Off or Null state) are removed (if the file exists in the specified directory). This implies that removal of files specified in the RemoveFile table is attempted when the gating component is first installed, during a reinstall, and again when the gating component is removed.</p>
<p>
The RemoveFiles action can also remove folders. You can indicate that a folder be removed if it is empty by leaving the FileName column of the RemoveFile table null.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_7gth.htm">RemoveFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<p>
While uninstalling previously installed files, the database table fields queried are identical to those queried by the <a href="aref_3hym.htm">InstallFiles</a> action (except that the <a href="tref_4mlh.htm">Media table</a> is not used at all by RemoveFiles). </p>
<p>
While removing files specified in the <a href="tref_7gth.htm">RemoveFile</a> table, the following fields are queried:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>RemoveFile.FileName</td>
<td width=52%>Target file name (localized text).</td>
</tr>
<tr valign=top>
<td width=48%>RemoveFile.DirProperty</td>
<td width=52%>Property name that should resolve to a valid full directory path.</td>
</tr>
<tr valign=top>
<td width=48%>Component.Component</td>
<td width=52%>Unique name for the component item (text, primary key).</td>
</tr>
<tr valign=top>
<td width=48%>Component.Action</td>
<td width=52%>Enum indicating the action to be taken.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must be called before calling RemoveFiles. If an <a href="aref_3hym.htm">InstallFiles</a> action is used, it must appear after RemoveFiles.</p>
<h4>Remarks</h4>
<p>
The <a href="tref_7gth.htm">RemoveFile</a> table can be omitted from the install database if there are no miscellaneous files to remove.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removefolders_action"></a>RemoveFolders Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveFolders action removes any folders linked to components set to be uninstalled or run from source. These folders are only removed if they are empty. If a folder is removed, it is unregistered with the appropriate component identifier.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_152d.htm">CreateFolder Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=38%>CreateFolder.Directory_</td>
<td width=62%>Folder name. For each folder, a property is assumed to exist with this name that defines the folder location.</td>
</tr>
<tr valign=top>
<td width=38%>Component.ComponentId</td>
<td width=62%>Component ID for the component owning this folder.</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
Each folder name in the CreateFolder table is assumed to be a property defining the folder location.</p>
<h4>Sequencing Restrictions</h4>
<p>
The RemoveFolders action must be executed after the <a href="aref_9xny.htm">RemoveFiles</a> action or any action that may remove files from folders.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removeinivalues_action"></a>RemoveIniValues Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveIniValues action deletes .ini file information that the application needs to delete from .ini files. The deletion of the information is gated by the Component table. A .ini value is deleted if the corresponding component has been set to be installed either locally or run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_9k6d.htm">RemoveIniFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=37%>RemoveIniFile.FileName</td>
<td width=63%>The .ini file name in which the value is to be deleted.</td>
</tr>
<tr valign=top>
<td width=37%>RemoveIniFile.Directory_</td>
<td width=63%>Directory for the .ini file. This is a foreign key into the <a href="tref_6an9.htm">Directory</a> table.</td>
</tr>
<tr valign=top>
<td width=37%>RemoveIniFile.Section</td>
<td width=63%>The .ini file section.</td>
</tr>
<tr valign=top>
<td width=37%>RemoveIniFile.Key</td>
<td width=63%>The .ini file key under the section.</td>
</tr>
<tr valign=top>
<td width=37%>RemoveIniFile.Value</td>
<td width=63%>Value to be deleted.</td>
</tr>
<tr valign=top>
<td width=37%>RemoveIniFile.Action</td>
<td width=63%>How the value is to be deleted. For more information, see the IniFile table.</td>
</tr>
<tr valign=top>
<td width=37%>Component.Action</td>
<td width=63%>Action field from the Component table for the component record corresponding to <b>RemoveIniFile.Component_</b>. Must be either:<p>
iisLocal = 1: Item is to be installed locally (item is currently uninstalled or installed from run from source).</p>
<p>
iisSource = 2: Item is to be installed from run from source (item is currently uninstalled or installed locally).</p>
</td>
</tr>
</table><br>
<p>
The RemoveIniValues action also removes the .ini information that the application writes to the system registry with the <a href="aref_8432.htm">WriteIniValues</a> action. A .ini value is deleted from the corresponding .ini file if the corresponding component has been set to be uninstalled.</p>
<p>
<a href="tref_56jp.htm">IniFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=30%>IniFile.FileName</td>
<td width=70%>The .ini file name in which the value is written.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Directory_</td>
<td width=70%>Directory for the .ini file. This is a foreign key into the <a href="tref_6an9.htm">Directory</a> table.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Section</td>
<td width=70%>The .ini file section.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Key</td>
<td width=70%>The .ini file key under the section.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Value</td>
<td width=70%>Value that is written.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Action</td>
<td width=70%>How the value is written. For more information, see the IniFile table. The RemoveIniValues action deletes the value that is written by reversing the IniFile.Action.</td>
</tr>
<tr valign=top>
<td width=30%>Component.Action</td>
<td width=70%>The Action field from the Component table for the component record corresponding to <b>IniFile.Component_</b>. Must be: <p>
iisAbsent  = 0: Item is not installed.</p>
</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must be called before calling RemoveIniValues. If a <a href="aref_8432.htm">WriteIniValues</a> action is used, it must appear after RemoveIniValues. </p>
<p>&nbsp;</p>

<h1><a name="_msi_removeregistryvalues_action"></a>RemoveRegistryValues Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveRegistryValues action removes an application's registry information from the registry. A registry value is deleted from the registry if the corresponding component has been set to be installed locally or to run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3obp.htm">Registry Table</a></p>
<p>
<a href="tref_3wmd.htm">RemoveRegistry Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>RemoveRegistry.Root</td>
<td width=65%>Root key under which the registry value is written.</td>
</tr>
<tr valign=top>
<td width=35%>RemoveRegistry.Key</td>
<td width=65%>Key under the root.</td>
</tr>
<tr valign=top>
<td width=35%>RemoveRegistry.Name</td>
<td width=65%>Name of the value.</td>
</tr>
<tr valign=top>
<td width=35%>Component.Action</td>
<td width=65%>Action field from the Component table for the component record corresponding to <b>Registry.Component_</b>. Must be either:<p>
iisLocal = 1: Item is to be installed locally (item is currently uninstalled or installed from run from source).</p>
<p>
iisSource = 2: Item is to be installed from run from source (item is currently uninstalled or installed locally).</p>
</td>
</tr>
</table><br>
<p>
The RemoveRegistryValues action also removes the registry information that the application writes to the registry with the <a href="aref_1cmm.htm">WriteRegistryValues</a> action. A registry value is deleted from the registry if the corresponding component has been set to be uninstalled.</p>
<p>
<a href="tref_3obp.htm">Registry Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=31%>Registry.Root</td>
<td width=69%>Root key under which the registry value is written.</td>
</tr>
<tr valign=top>
<td width=31%>Registry.Key</td>
<td width=69%>Key under the root.</td>
</tr>
<tr valign=top>
<td width=31%>Registry.Value</td>
<td width=69%>The registry value to be removed. If the WriteRegistryValues action had attached REG_MULTI_SZ strings to the value in the <a href="tref_3obp.htm">Registry table</a>, then the RemoveRegistryValues action removes only those strings from the registry value.</td>
</tr>
<tr valign=top>
<td width=31%>Registry.Name</td>
<td width=69%>Name of the value.</td>
</tr>
<tr valign=top>
<td width=31%>Component.Action</td>
<td width=69%>Action field from the Component table for the component record corresponding to <b>Registry.Component_</b>. Must be: <p>
iisAbsent = 0: item is not installed.</p>
</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must be called before calling RemoveRegistryValues. If a <a href="aref_1cmm.htm">WriteRegistryValues</a> action is used, it must appear after RemoveRegistryValues.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_removeoldproducts_action"></a>RemoveOldProducts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveOldProducts action removes old versions of a product that are already installed. The RemoveOldProducts action runs nested installs to remove old products.</p>
<h4>Database Tables Queried</h4>
<p>
The RemoveOldProductsl action queries the Operator and Property columns of the <a href="tref_4qxx.htm">Upgrade table</a>. The value of the operator specifies whether the installed product version is removed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_removeshortcuts_action"></a>RemoveShortcuts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RemoveShortcuts action manages the removal of advertised shortcuts whose feature is selected for uninstall and non-advertised shortcuts whose component is selected for uninstall.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_2i91.htm">Shortcut Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The RemoveShortcuts action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action and before the <a href="aref_7uzy.htm">CreateShortcuts</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_resolvesource_action"></a>ResolveSource Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ResolveSource action will determine the source location and set the <a href="pref_6uwp.htm">SOURCEDIR property</a> if the source has not been resolved yet.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
SOURCEDIR</p>
<h4>Sequencing Restrictions</h4>
<p>
This action must come after the <a href="aref_4bam.htm">CostInitialize action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_rmccpsearch_action"></a>RMCCPSearch Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The RMCCPSearch action uses file signatures to ensure that a user who acquires an upgrade version of a product has the installation for one of the qualifying upgrade products. The action requires the <b>CCP_DRIVE</b> property to be set to the root path on the removable volume that has the installation for any of the qualifying products. The action works on the CCPSearch table. </p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_8nad.htm">CCPSearch Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>CCPSearch.Signature_ </td>
<td width=65%>File signature</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
<b>CCP_DRIVE</b></p>
<p>
<b>CCP_Success</b></p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<h4>Remarks</h4>
<p>
Each file signature, Signature_, in the table is searched for under the path referred to by the <b>CCP_DRIVE</b> property using the <a href="tref_3azp.htm">DrLocator</a> table. The absence of the signature from the <a href="tref_149x.htm">Signature</a> table denotes a directory. If any signature is determined to exist, the property <b>CCP_Success</b> is set to <b>1</b>, and the RMCCPSearch action terminates.</p>
<p>&nbsp;</p>

<h1><a name="_msi_schedulereboot_action"></a>ScheduleReboot Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ScheduleReboot action is authored in the sequence if there is a need to reboot at the end of the installation.</p>
<h4>Database Tables Queried</h4>
<p>
None</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None. The ScheduleReboot action is typically placed at the end of the sequence, but it can be anywhere.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selfregmodules_action"></a>SelfRegModules Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelfRegModules action processes all the modules in the <a href="tref_0llx.htm">SelfReg</a> table to register the modules, if installed.</p>
<h4>Database Tables Queried</h4>
<p>
The <a href="#_msi_selfregmodules_action">SelfRegModules action</a> queries the File_ column of the <a href="tref_0llx.htm">SelfReg table</a> for the module that is to be registered.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must be called before calling SelfRegModules. If an <a href="aref_3hym.htm">InstallFiles</a> action is used, it must also appear before SelfRegModules.</p>
<h4>Remarks</h4>
<p>
The SelfRegModules action attempts to call the DllRegisterServer() function of the module that is to be registered. Unlike other actions, this action is not performed with elevated privileges but instead with the default user privileges.</p>
<p>&nbsp;</p>

<h1><a name="_msi_selfunregmodules_action"></a>SelfUnregModules Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SelfUnregModules action unregisters the modules in the <a href="tref_0llx.htm">SelfReg table</a> that are to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
The SelfUnregModules action queries the File_ column of the SelfReg table for the module that is to be unregistered.</p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate</a> action must come before the SelfUnregModules action. If a <a href="aref_1gku.htm">SelfRegModules</a> action is used it must appear after the SelfUnregModules action. If a <a href="aref_9xny.htm">RemoveFiles action</a> is used it must come after the SelfUnregModules action.</p>
<h4>Remarks</h4>
<p>
The SelfUnregModules action attempts to call the DllUnregisterServer() function of the module that is to be unregistered. Unlike other actions this action is not performed with elevated privileges but instead is performed with the default user privileges.</p>
<p>&nbsp;</p>

<h1><a name="_msi_setodbcfolders_action"></a>SetODBCFolders Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This action checks for ODBC drivers existing on the system and sets the target directory of each new driver to the location of an existing driver.</p>
<h4>Database Tables Queried</h4>
<p>
This action sets the locations of existing drivers that are to be replaced in the <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Properties Used</h4>
<p>
None.</p>
<h4>Sequencing Restrictions</h4>
<p>
The SetODBCFolders action must come after the <a href="aref_22we.htm">CostFinalize action</a> and before the <a href="aref_9fzi.htm">InstallValidate action</a>.</p>
<h4>Remarks</h4>
<p>
This action places a new driver into the same directory as the existing driver being replaced.</p>
<p>&nbsp;</p>

<h1><a name="_msi_unpublishcomponents_action"></a>UnpublishComponents Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnpublishComponents action manages the unadvertisement of the components from the PublishComponent table that may be faulted in by other products with the system. This action removes the information about published components from the PublishComponent table for which the corresponding feature is currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_7xt1.htm">PublishComponent Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<p>&nbsp;</p>

<h1><a name="_msi_unpublishfeatures_action"></a>UnpublishFeatures Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnpublishFeatures action manages the unadvertisement of the feature composition (feature-component mapping) with the system. This action removes the published composition of all features that are currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_52hx.htm">FeatureComponents Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
None</p>
<p>&nbsp;</p>

<h1><a name="_msi_unregisterclassinfo_action"></a>UnregisterClassInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterClassInfo action manages the unregistration of COM class information with the system. The action unregisters the COM classes from the Class table for which the corresponding feature is currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_5n8l.htm">Class Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The UnregisterClassInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action and before the <a href="aref_04oe.htm">RegisterClassInfo</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_unregisterextensioninfo_action"></a>UnregisterExtensionInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterExtensionInfo action manages the unregistration of extension-related information with the system. The action unregisters the extension servers from the Extension table for which the corresponding feature is currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_219h.htm">Extension Table</a></p>
<p>
<a href="tref_3kdh.htm">Verb Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The UnregisterExtensionInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action and before the <a href="aref_1epa.htm">RegisterExtensionInfo</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_unregisterfonts_action"></a>UnregisterFonts Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterFonts action unregisters installed fonts with the system. The RegisterFonts action is triggered when the component to which the Font.File belongs is selected for uninstall. This implies that fonts can be made private, shared, or available to the entire system by specifying such status for the components to which they belong.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_9tnp.htm">Font Table</a></p>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9xny.htm">RemoveFiles</a> action must be called after UnregisterFonts.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_unregistermimeinfo_action"></a>UnregisterMIMEInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterMIMEInfo action unregisters MIME-related registry information from the system. The action unregisters MIME info for servers from the MIME table for which the corresponding feature is currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3sh1.htm">MIME Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The UnregisterMIMEInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles</a> action and before the <a href="aref_9r8u.htm">RegisterMIMEInfo</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_unregisterprogidinfo_action"></a>UnregisterProgIdInfo Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterProgIdInfo action manages the unregistration of OLE ProgId information with the system. This action unregisters ProgId information for features that are connected to the extension information (in the Extension table) or the Class information (in the <a href="tref_5n8l.htm">Class table</a> and are currently selected to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4x5x.htm">ProgId Table</a></p>
<p>
<a href="tref_5n8l.htm">Class Table</a></p>
<p>
<a href="tref_219h.htm">Extension Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The UnregisterProgIdInfo action must be sequenced after the <a href="aref_3hym.htm">InstallFiles action</a> and before the <a href="aref_08tq.htm">RegisterProgIdInfo action</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_unregistertypelibraries_action"></a>UnregisterTypeLibraries Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UnregisterTypeLibraries action unregisters type libraries from the system. This action works on each file referred to in the <a href="tref_3085.htm">TypeLib</a> table that is triggered to be uninstalled.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3085.htm">TypeLib Table</a></p>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The UnregisterTypeLibraries action must be sequenced before the <a href="aref_9xny.htm">RemoveFiles</a> action.</p>
<p>&nbsp;</p>

<h1><a name="_msi_updateresources_action"></a>UpdateResources Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UpdateResources action copies text or binary data into file resources.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_4n6t.htm">File Table</a></p>
<p>
<a href="tref_6rxh.htm">Resource Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<h4>Properties Used</h4>
<p>
Only properties specified in the data string.</p>
<h4>Sequencing Restrictions</h4>
<p>
The UpdateResources action must be sequenced after the <a href="aref_3hym.htm">InstallFiles action</a>.</p>
<h4>Remarks</h4>
<p>
If the data string contains property parameters (that is, the property names within square brackets), the current values for those properties are substituted. If the resultant string begins with 0x, the string is treated as a hexadecimal value, and the resource is updated with the binary value.</p>
<p>&nbsp;</p>

<h1><a name="_msi_validateproductid_action"></a>ValidateProductID Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ValidateProductID action sets the <a href="pref_6et5.htm">ProductID property</a> to the full Product ID. If the Product ID has already been validated successfully, then this action does nothing.</p>
<h4>Properties Used</h4>
<p>
The ValidateProductID action performs Product ID validation by comparing the <a href="pref_1v21.htm">PIDKEY property</a> to the <a href="pref_0z21.htm">PIDTemplate property</a>.</p>
<h4>Sequencing Restrictions</h4>
<p>
This action must be included in the sequence tables. The action must come before the UI wizard in the <a href="tref_1git.htm">InstallUISequence table</a> and before the <a href="aref_0g4u.htm">RegisterUser action</a> in the <a href="tref_5pid.htm">InstallExecuteSequence table</a>.</p>
<h4>Remarks</h4>
<p>
The ValidateProductId action always returns a success, whether or not the Product ID is valid, so that the product ID can be entered the on the command line the first time the product is run.</p>
<p>
The Product ID can be validated without having the user reenter this information by setting the <a href="pref_1v21.htm">PIDKEY property</a> on the command line or by a transform. The display requesting the user to enter the Product ID can then be made conditional upon the presence of the <a href="pref_6et5.htm">ProductID property</a>, which is set when the PIDKEY property is validated.</p>
<p>&nbsp;</p>

<h1><a name="_msi_writeinivalues_action"></a>WriteIniValues Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The WriteIniValues action writes .ini file information that the application needs to write in .ini files. The writing of the information is gated by the <a href="tref_09np.htm">Component table</a>. A .ini value is written if the corresponding component has been set to be installed either locally or run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_56jp.htm">IniFile Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=30%>IniFile.FileName</td>
<td width=70%>The .ini file name in which the value is written.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Directory_</td>
<td width=70%>Directory for the .ini file. This is a foreign key into the <a href="tref_6an9.htm">Directory</a> table.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Section</td>
<td width=70%>The .ini file section.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Key</td>
<td width=70%>The .ini file key under the section.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Value</td>
<td width=70%>Value to be written.</td>
</tr>
<tr valign=top>
<td width=30%>IniFile.Action</td>
<td width=70%>How the value is to be written. For more information, see the IniFile table.</td>
</tr>
<tr valign=top>
<td width=30%>Component.Action</td>
<td width=70%>Action field from the Component table for the component record corresponding to <b>IniFile.Component_</b>. Must be either:<p>
iisLocal = 1: Item is to be installed locally (item is currently uninstalled or installed from run from source).</p>
<p>
iisSource = 2: Item is to be installed from run from source (item is currently uninstalled or installed locally).</p>
</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The InstallValidate action must come before the <a href="#_msi_writeinivalues_action">WriteIniValues action</a>. If there is a <a href="aref_4tv2.htm">RemoveIniValues action</a> in the sequence, then it must come before the WriteIniValues action. </p>
<p>&nbsp;</p>

<h1><a name="_msi_writeregistryvalues_action"></a>WriteRegistryValues Action</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The WriteRegistryValues action sets up registry information that the application needs in the registry. The registry information is gated by the <a href="tref_09np.htm">Component table</a>. A registry value is written to the registry if the corresponding component has been set to be installed either locally or run from source.</p>
<h4>Database Tables Queried</h4>
<p>
<a href="tref_3obp.htm">Registry Table</a></p>
<p>
<a href="tref_09np.htm">Component Table</a></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=28%>Registry.Root</td>
<td width=72%>Root key under which the registry value is written.</td>
</tr>
<tr valign=top>
<td width=28%>Registry.Key</td>
<td width=72%>Key under the root.</td>
</tr>
<tr valign=top>
<td width=28%>Registry.Name</td>
<td width=72%>Name of the value.</td>
</tr>
<tr valign=top>
<td width=28%>Registry.Value</td>
<td width=72%>The registry value.</td>
</tr>
<tr valign=top>
<td width=28%>Component.Action</td>
<td width=72%>Action field from the Component table for the component record corresponding to <b>Registry.Component_</b>. Must be either:<p>
iisLocal = 1: Item is to be installed locally (item is currently uninstalled or installed from run from source).</p>
<p>
iisSource = 2: Item is to be installed from run from source (item is currently uninstalled or installed locally).</p>
</td>
</tr>
</table><br>
<h4>Properties Used</h4>
<p>
None</p>
<h4>Sequencing Restrictions</h4>
<p>
The <a href="aref_9fzi.htm">InstallValidate action</a> must come before the WriteRegistryValues action. If there is a <a href="aref_5mem.htm">RemoveRegistryValues action</a>, then it must come before the WriteRegistryValues action.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_custom_actions"></a>Custom Actions</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Microsoft  Windows  installer provides a number of actions to be used during the install process. For a list of these actions see <a href="aref_1wo5.htm">Standard Actions Reference</a>. For most situations these actions are sufficient. However, there may be situations in which an installation needs to do something that is not possible using only standard actions. To provide the greatest degree of flexibility, the installer provides setup authors the ability to create their own custom actions.</p>
<p>
The material in this section is intended for developers who are writing their own Setup programs and for developers who want to learn more about the installer. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
The topics in this section describe how to incorporate custom actions into an installation package. The topics include
<ul>
<li>
<a href="cact_1zhv.htm">About Custom Actions</a></li>
<li>
<a href="cact_93lf.htm">Using Custom Actions</a></li>
<li>
<a href="cact_6a05.htm">Custom Action Reference</a></li>
</ul>
<p>&nbsp;</p>

<h2><a name="_msi_about_custom_actions"></a>About Custom Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following sections give general information about custom actions
<ul>
<li>
<a href="cact_73sj.htm">Invoking Custom Actions</a></li>
<li>
<a href="cact_4qyb.htm">Synchronous and Asynchronous Custom Actions</a></li>
<li>
<a href="cact_0b77.htm">Executable Files</a></li>
<li>
<a href="cact_15mb.htm">Dynamic Link Libraries</a></li>
<li>
<a href="cact_7asz.htm">Scripts</a></li>
<li>
<a href="cact_0sj8.htm">Formatted Text</a></li>
<li>
<a href="cact_8o3d.htm">Custom Action Security</a></li>
<li>
<a href="cact_9b77.htm">Deferred Execution of Custom Actions</a></li>
<li>
<a href="cact_2ho3.htm">Rollback of Custom Actions</a></li>
<li>
<a href="cact_101f.htm">Information for Custom Actions</a></li>
<li>
<a href="cact_57qr.htm">Debugging Custom Actions</a></li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_invoking_custom_actions"></a>Invoking Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
There are two processes for calling actions. The action can be either a custom action or a standard action.
<ul>
<li>
A top-level action calls the sequence table to which the specified action belongs.</li>
<li>
You call the specified action directly with the <a href="qref_9woe.htm"><b>MsiDoAction</b></a> function.</li>
</ul>
<p>
When the installer obtains an action name from the <b>MsiDoAction</b> function or from a sequence table, it searches for a standard action of that name. If it cannot find the standard action, the installer queries the <a href="tref_71b9.htm">CustomAction table</a> to check if the specified action is a custom action. If the specified action is not a custom action, the installer queries the <a href="tref_51wl.htm">Dialog table</a> for a dialog box to present. This dialog box typically starts a wizard sequence.</p>
<p>&nbsp;</p>

<h3><a name="_msi_synchronous_and_asynchronous_custom_actions"></a>Synchronous and Asynchronous Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions that are implemented as a DLL or an EXE can be invoked either synchronously or asynchronously. For a synchronous process, the installer waits for the action to complete before installation continues. For an asynchronous process, the custom action runs as a separate thread while installation continues.</p>
<p>&nbsp;</p>

<h3><a name="_msi_executable_files"></a>Executable Files</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer calls executables by creating a separate process at user privilege. Executable custom actions cannot return the full set of return values described in <a href="cact_8h0z.htm">Custom Action Return Values</a>. They can only indicate success or failure. Synchronous calls returning a non-zero status cause the installation to terminate.</p>
<p>
The following options can be specified for an executable custom action as described in <a href="cact_1dbn.htm">Custom Action Types</a>.</p>
<p>
The executable file can be:
<ul>
<li>
Known to exist on the system </li>
<li>
Installed during this session</li>
<li>
Stored in the <a href="tref_04px.htm">Binary table</a></li>
</ul>
<p>
The custom action author can also specify whether the action will be run <a href="cact_4qyb.htm">synchronously or asynchronously</a>. Custom actions can also be scheduled to run during install script processing or during rollback as described in <a href="cact_9b77.htm">Deferred Execution of Custom Actions</a>.</p>
<p>
Command line parameters can be passed in the Target column of the <a href="tref_71b9.htm">CustomAction table</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_dynamic_link_libraries"></a>Dynamic-Link Libraries</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer calls dynamic link libraries by creating a separate thread at user privilege. The installer calls the DLL with the handle to the current session as the only parameter. DLL custom actions return the full set of return values described in <a href="cact_8h0z.htm">Custom Action Return Values</a>.</p>
<p>
You can call DLLs through the entry point named in the Target column of the <a href="tref_71b9.htm">CustomAction table</a>. The entry point name specified in the table must exactly match the entry point exported from the DLL.</p>
<p>
The following options can be specified for a DLL custom action as described in <a href="cact_1dbn.htm">Custom Action Types</a>.</p>
<p>
The DLL can be:
<ul>
<li>
Installed during this session</li>
<li>
Stored in the <a href="tref_04px.htm">Binary table</a></li>
</ul>
<p>
The custom action author can specify whether the action will be run <a href="cact_4qyb.htm">synchronously or asynchronously</a>. Custom actions can also be scheduled to run during install script processing or during rollback as described in <a href="cact_9b77.htm">Deferred Execution of Custom Actions</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_scripts"></a>Scripts</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer calls scripts by creating a separate process at user privilege. Script custom actions return the full set of return values described in <a href="cact_8h0z.htm">Custom Action Return Values</a>. The installer does not provide the script engine but can use it if it is installed. Authors wishing to make use of a scripting language during installation should be certain that the appropriate scripting engine is available.</p>
<p>
The following options can be specified for a script custom action as described in <a href="cact_1dbn.htm">Custom Action Types</a>.</p>
<p>
The script file can be:
<ul>
<li>
Installed during this session</li>
<li>
Stored in the <a href="tref_04px.htm">Binary table</a></li>
<li>
Stored in a property value</li>
<li>
Stored in Target column of the <a href="tref_71b9.htm">CustomAction table</a>.</li>
</ul>
<p>
Script custom actions can only be executed synchronously. Custom actions can be scheduled to run during rollback as described in <a href="cact_9b77.htm">Deferred Execution of Custom Actions</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_formatted_text"></a>Formatted Text</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions can be used to set properties and directories with formatted text. This can be useful for passing information to other custom actions. For information on how to specify set properties and directories with formatted text, see <a href="cact_1dbn.htm">Custom Action Types</a>. For information on how to format text, see the <a href="tref_6b77.htm#_msi_formatted">Formatted</a> data type.</p>
<p>&nbsp;</p>

<h3><a name="_msi_custom_action_security"></a>Custom Action Security</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions run at user privileges and have limited access to the system. Custom actions can access the system for queries, but all updates are passed through a security boundary for subsequent execution, as described in <a href="over_9jjh.htm">Installation Mechanism</a>.</p>
<p>
The only way a custom action can cause a change at elevated privileges is by manipulating tables used by built-in actions.</p>
<p>&nbsp;</p>

<h3><a name="_msi_deferred_execution_of_custom_actions"></a>Deferred Execution of Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions can be scheduled to run during any of the various phases of the install process. For more information about the phases of an installation, see <a href="over_9jjh.htm">Installation Mechanism</a>.</p>
<p>
If a custom action only sets properties, sets directories, or manipulates the installation database, then it should be scheduled to run during the acquisition phase when the database is processed. However, if a custom action performs any system changes directly, it should be scheduled to run during the execution stage when the install script is processed.</p>
<p>
The installer does not provide the script engine but can use it if it is installed. Authors wishing to make use of a scripting language during installation should be certain that the appropriate scripting engine is available.</p>
<p>
There are special restrictions that apply to deferred custom actions. See <a href="cact_101f.htm">Information for Custom Actions</a> for more information.</p>
<p>
You can also schedule custom actions to run during rollback. This is described in more detail in <a href="cact_2ho3.htm">Rollback of Custom Actions</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_rollback_of_custom_actions"></a>Rollback of Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions that schedule system operations by inserting rows into the appropriate tables are automatically rolled back if the installation is unsuccessful. However, if a custom action performs operations on its own or issues commands to other services, these operations or commands cannot be automatically rolled back. You must provide a custom action that performs the necessary operations during rollback processing.</p>
<p>
A rollback custom action is designated as described in <a href="cact_1dbn.htm">Custom Action Types</a>. When this action is invoked during the installation sequence, its execution is deferred until rollback as described in <a href="cact_9b77.htm">Deferred Execution of Custom Actions</a>.</p>
<p>&nbsp;</p>

<h3><a name="_msi_information_for_custom_actions"></a>Information for Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Custom actions obtain information about the current install by using the <a href="qref_9okl.htm">database access functions</a>. A custom action can obtain a handle to the active database. This handle allows the custom action to query and update the data in the various tables. Some data might be marked as read-only and cannot be updated by actions. </p>
<p>
Arguments cannot be passed to custom actions. They must obtain information by querying properties, tables, and session state flags. To effect argument passing, custom actions can set properties used by subsequent custom actions. Using a custom action that sets a property with formatted text is an efficient method to accomplish this.</p>
<p>
If a custom action is scheduled to run during script processing as described in <a href="cact_9b77.htm">Deferred Execution of Custom Actions</a>, the action may be run outside of an install session. Very little information is available to such custom actions. Therefore, the context information must be set beforehand. The command line for an EXE custom action is stored in the install script, so any information the custom action needs should be indicated in the command line.</p>
<p>
A DLL custom action receives an install session handle. During script execution, the session may not exist. However, the following functions that require a handle are supported during script processing.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Function</th>
<th align=left width=69%>Functionality during script processing</th>
</tr>
<tr valign=top>
<td width=31%><a href="qref_7u2h.htm"><b>MsiGetProperty</b></a></td>
<td width=69%>Supports only ProductCode and CustomActionData. Others return NULL.</td>
</tr>
<tr valign=top>
<td width=31%><a href="qref_8u05.htm"><b>MsiGetMode</b></a></td>
<td width=69%>Indicates the installation mode.</td>
</tr>
<tr valign=top>
<td width=31%><a href="qref_86xx.htm"><b>MsiGetLanguage</b></a></td>
<td width=69%>Returns the numeric language ID for the current product.</td>
</tr>
<tr valign=top>
<td width=31%><a href="qref_163p.htm"><b>MsiProcessMessage</b></a></td>
<td width=69%>Processes messages from the custom action.</td>
</tr>
</table><br>
<p>
In addition, any function that does not require a session handle is supported.</p>
<p>
Except for the properties mentioned in the table above, properties are not available to deferred custom actions. To provide further context information to your custom action, use the CustomActionData property. Put any information you want to pass to the custom action in a property with the same name as the custom action. For example, if the primary key for a custom action entry is named MyAction, set the MyAction property with any needed contextual information. You can then gain access to this information from within the custom action by calling <a href="qref_7u2h.htm"><b>MsiGetProperty</b></a> with CustomActionData as the property identifier.</p>
<p>
One way to set the CustomActionData is with a <a href="cact_0sj8.htm">Formatted Text</a> custom action.</p>
<p>
A script custom action receives the install session object, but has the same restrictions that a DLL custom action has. For example, the install session object may not exist if the action is deferred. A few methods are supported to allow the custom action to retrieve its context. The <a href="vref_53i1.htm">Mode property</a> returns TRUE for only <code>imfOperations.</code> The <a href="vref_98m7.htm">Property Property (MsiEngine Object)</a> returns properties as described above. The <a href="vref_2qqn.htm">Language Property (MsiEngine Object)</a> is available. And the <a href="vref_3mlg.htm">Message method</a> can be called to handle errors.</p>
<p>&nbsp;</p>

<h3><a name="_msi_debugging_custom_actions"></a>Debugging Custom Actions</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To enable the debugging of a custom action, set the environment variable <b>MsiBreak</b> to the name of the designated action. For DLL custom actions, a user breakpoint is called just prior to the entry point call. If the current session is not running under a debugger, the standard exception dialog box is invoked with an option to debug. This brings up the debugger that is registered for Just In Time debugging.</p>
<p>
To enable source-level debugging, the program database (PDB) file must be available, either at the original build location for the DLL or in the directory where the DLL is now running. Custom actions stored in the <a href="tref_04px.htm">Binary table</a> are executed from the system Temp directory. The mechanism is similar with EXE custom actions except that the debug break occurs just prior to the CreateProcess call. You cannot step into the EXE code, and you cannot attach the debugger to the process until it is running.</p>
<p>&nbsp;</p>

<h2><a name="_msi_using_custom_actions"></a>Using Custom Actions</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To be written</p>
<p>&nbsp;</p>

<h2><a name="_msi_custom_action_reference"></a>Custom Action Reference</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following reference sections pertain to custom actions.
<ul>
<li>
For information about what values your custom actions are expected to return, see <a href="cact_8h0z.htm">Custom Action Return Values</a></li>
<li>
For information about how to indicate the type of custom action see <a href="cact_1dbn.htm">Custom Action Types</a></li>
<li>
Custom actions typically access the installation database. See the <a href="qref_9okl.htm">Database Access Reference</a> topic for a list of functions that work with the database.</li>
</ul>
<p>&nbsp;</p>

<h3><a name="_msi_custom_action_return_values"></a>Custom Action Return Values</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Your custom actions must return the following values. These return values determine the course for further execution. DLL and script actions return the full set of return values. EXE processes and the setting of directories from formatted text can only indicate success or failure return values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Return value</th>
<th align=left width=41%>Description</th>
</tr>
<tr valign=top>
<td width=59%>ERROR_FUNCTION_NOT_CALLED</td>
<td width=41%>Action is not found.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_SUCCESS</td>
<td width=41%>Action is completed successfully.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INSTALL_USEREXIT</td>
<td width=41%>User terminates the action during the action execution.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INSTALL_FAILURE</td>
<td width=41%>Action fails.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INSTALL_SUSPEND</td>
<td width=41%>User suspends the installation.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_MORE_DATA</td>
<td width=41%>Action skips remaining actions; not an error.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INVALID_HANDLE_STATE</td>
<td width=41%>Installation session is not active.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INVALID_DATA</td>
<td width=41%>Call to custom action fails.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INVALID_HANDLE</td>
<td width=41%>Arguments are invalid.</td>
</tr>
<tr valign=top>
<td width=59%>ERROR_INVALID_PARAMETER</td>
<td width=41%>Arguments are invalid.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h3><a name="_msi_custom_action_types"></a>Custom Action Types</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The custom action type is specified by a numeric value in the Type column of the <a href="tref_71b9.htm">CustomAction table</a>. The following tables describe how to indicate the type.</p>
<h4>Formatted Text</h4>
<p>
The following table describes the values as well as the meaning of the Source and Target columns of the CustomAction table for these types of custom actions. A custom action that sets a property or directory with formatted text cannot use the options described in subsequent tables.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=19%>Numeric Value</th>
<th align=left width=29%>Description</th>
<th align=left width=26%>Source</th>
<th align=left width=26%>Target</th>
</tr>
<tr valign=top>
<td width=19%>51</td>
<td width=29%>Property set with formatted text</td>
<td width=26%>Property name</td>
<td width=26%>String to be formatted</td>
</tr>
<tr valign=top>
<td width=19%>35</td>
<td width=29%>Directory set with formatted text</td>
<td width=26%>Key into the <a href="tref_6an9.htm">Directory table</a></td>
<td width=26%>String to be formatted</td>
</tr>
</table><br>
<h4>Executable, DLL, or Script</h4>
<p>
A custom action can also be an executable file, a dynamic-link library, or a script. These custom actions are composed of a source type, an executable type, and option flags. To indicate these types, select one number from each of the following tables, add the values together, and enter the resulting number in the Type column of the CustomAction table. Note that the meanings of the other columns in the CustomAction table vary depending on the options. See the table describing the Location options for more information.</p>
<p>
The installer does not provide the script engine but can use it if it is installed. Authors wishing to make use of a scripting language during installation should be certain that the appropriate scripting engine is available.</p>
<h5>Source Type</h5>
<p>
The following table describes the action type options.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Numeric Value</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%>1</td>
<td width=80%>The action is a DLL.</td>
</tr>
<tr valign=top>
<td width=20%>2</td>
<td width=80%>The action is an .exe file.</td>
</tr>
<tr valign=top>
<td width=20%>5</td>
<td width=80%>The action is Microsoft  JScript , source.</td>
</tr>
<tr valign=top>
<td width=20%>6</td>
<td width=80%>The action is Microsoft  Visual Basic  Scripting Edition (VBScript) source.</td>
</tr>
</table><br>
<h5>Location</h5>
<p>
The following table shows the custom action source options along with the corresponding meanings of the Source and Target columns of the CustomAction table. If an entry in the table is blank, it is the same as the entry directly above it.</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=11%>Numeric Value</th>
<th align=left width=38%>Description</th>
<th align=left width=21%>Source</th>
<th align=left width=30%>Target</th>
</tr>
<tr valign=top>
<td width=11%>0</td>
<td width=38%>The data is stored in the <a href="tref_04px.htm">Binary table</a>.</td>
<td width=21%>Key into the <a href="tref_04px.htm">Binary table</a>.</td>
<td width=30%>For a DLL; the DLL entry point.</td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%></td>
<td width=21%></td>
<td width=30%>For an EXE; the command line options.</td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%></td>
<td width=21%></td>
<td width=30%>For a script; an optional function to call.</td>
</tr>
<tr valign=top>
<td width=11%>16</td>
<td width=38%>The file is copied during installation. The file is listed in the <a href="tref_4n6t.htm">File table</a>.</td>
<td width=21%>Key into the <a href="tref_4n6t.htm">File table</a>.</td>
<td width=30%>Same as for a source option of 0.</td>
</tr>
<tr valign=top>
<td width=11%>32</td>
<td width=38%>For an EXE file, the location of the folder containing the existing file is given in the <a href="tref_6an9.htm">Directory table</a>.</td>
<td width=21%>Key into the <a href="tref_6an9.htm">Directory table</a>.</td>
<td width=30%>The executable name and command line options.</td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%>For a script, the script itself is stored in the Target column of the CustomAction table.</td>
<td width=21%>Null</td>
<td width=30%>The script source.</td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%>Not allowed for a DLL.</td>
<td width=21%></td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=11%>48</td>
<td width=38%>For an EXE file, a property holds the full path to the executable.</td>
<td width=21%>Property name, key into the <a href="tref_21d1.htm">Property table</a>.</td>
<td width=30%>Same as for a source option of 0.</td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%>For a script, the property holds the source of the script itself.</td>
<td width=21%></td>
<td width=30%></td>
</tr>
<tr valign=top>
<td width=11%></td>
<td width=38%>Not allowed for a DLL.</td>
<td width=21%></td>
<td width=30%></td>
</tr>
</table><br>
<h4>Synchronous or Asynchronous Execution</h4>
<p>
The following table describes the custom action processing options.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%>Numeric Value</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%>0</td>
<td width=80%>Synchronous execution; must return exit code.</td>
</tr>
<tr valign=top>
<td width=20%>64</td>
<td width=80%>Synchronous execution; exit code is ignored.</td>
</tr>
<tr valign=top>
<td width=20%>128</td>
<td width=80%>Asynchronous execution; wait for exit code at sequence end.</td>
</tr>
<tr valign=top>
<td width=20%>192</td>
<td width=80%>Asynchronous execution; wait for exit code at install termination.</td>
</tr>
</table><br>
<h4>Scheduling Options</h4>
<p>
The following table describes the custom action scheduling options.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%>Numeric Value</th>
<th align=left width=73%>Description</th>
</tr>
<tr valign=top>
<td width=27%>0</td>
<td width=73%>Run action when the installer reaches it during database processing.</td>
</tr>
<tr valign=top>
<td width=27%>256</td>
<td width=73%>Run action at the appropriate stage during install script processing.</td>
</tr>
<tr valign=top>
<td width=27%>512</td>
<td width=73%>Run action only during install rollback.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_properties"></a>Properties</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following sections describe properties used in the Microsoft  Windows  installer.
<ul>
<li>
<a href="prop_0ylv.htm">About Properties</a> briefly describes what properties are and what they can be used for.</li>
<li>
<a href="prop_29tf.htm">Using Properties</a> shows a couple of simple examples of how properties can be used.</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_about_properties"></a>About Properties</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Properties are global variables used during an installation. All the properties are listed in the <a href="tref_21d1.htm">Property table</a> of the installation database. Any property can be specified in the property table and will then be set at the launch of the installation. In addition, some properties are public and can be overridden at the command line or set dynamically during the installation using <a href="acts_4lmb.htm">Standard actions</a> or <a href="cact_5t2r.htm">Custom actions</a>. The names of public properties are always in all uppercase letters. Private property names are specified in the Property table and cannot be overridden because they describe the local system or operating system. For example, it is possible to author a package in which the public <a href="pref_9bzt.htm">INSTALLLEVEL property</a> is specified at the command line or chosen in a user interface. The <a href="pref_88l5.htm">WindowsFolder property</a> however is set for the Windows platform. This property is specified in the Property table and cannot be overridden by an action or the command line. For more information on the individual properties see the <a href="pref_3mp1.htm">Property Reference</a> topic.</p>
<p>&nbsp;</p>

<h1><a name="_msi_using_properties"></a>Using Properties</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Typically properties are used in conditional expressions in the database to convey additional installation logic. For example, the <a href="tref_0a91.htm">Feature table</a> is linked to the <a href="tref_83qd.htm">Condition table</a>. This can be used to indicate if a feature should be installed depending upon the values of one or more properties.</p>
<p>
Similarly, in the six sequence tables, there is a column for a conditional expression. A dialog listed in a sequence table with <b>Installed AND NOT Resume AND NOT Preselected</b> in the condition column would only display if all of the following conditions were met.
<ul>
<li>
The product is already installed.</li>
<li>
The installation session is not resuming a partially completed install.</li>
<li>
The needed options were not already set on the command line when the installation was initiated.</li>
</ul>
<p>
This would be useful for a maintenance dialog.</p>
<p>
The full syntax for conditional expressions is described in <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a>.</p>
<p>
For more examples of using properties see <a href="novr_3mqt.htm">Using a Sequence Table</a>.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_property_reference"></a>Property Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following properties are defined by the Microsoft  Windows  installer. Additional properties can be specified by authored data or custom actions. Properties whose names are entirely uppercase can be specified on the command line.</p>
<p>
The following list provides links to more information about the component locations properties:</p>
<p class=indent1>
<a href="pref_6uwp.htm">SOURCEDIR Property</a><br>
<a href="pref_73ax.htm">TARGETDIR Property</a></p>
<p>
The following list provides links to more information about the feature installation options properties:</p>
<p class=indent1>
<a href="pref_3dvd.htm">ADDLOCAL Property</a><br>
<a href="pref_6k8p.htm">ADVERTISE Property</a><br>
<a href="pref_7yex.htm">ADDDEFAULT Property</a><br>
<a href="pref_7g1l.htm">ADDSOURCE Property</a><br>
<a href="pref_8ho9.htm">REMOVE Property</a><br>
<a href="pref_19x5.htm">REINSTALL Property</a><br>
<a href="pref_3htl.htm">COMPADDLOCAL Property</a><br>
<a href="pref_4gvt.htm">COMPADDSOURCE Property</a><br>
<a href="pref_89yx.htm">FILEADDLOCAL Property</a><br>
<a href="pref_0id5.htm">FILEADDSOURCE Property</a><br>
<a href="pref_3wc9.htm">PATCH Property</a></p>
<p>
The following list provides links to more information about other configurable properties:</p>
<p class=indent1>
<a href="pref_9njt.htm">ACTION Property</a><br>
<a href="pref_6tx5.htm">ALLUSERS Property</a><br>
<a href="pref_667t.htm">ALLOWSUSPEND Property</a><br>
<a href="pref_1g8p.htm">ARPNOMODIFY Property</a><br>
<a href="pref_46bd.htm">ARPNOREMOVE Property</a><br>
<a href="pref_1ou1.htm">CCP_DRIVE Property</a><br>
<a href="pref_2dq1.htm">EXECUTEACTION Property</a><br>
<a href="pref_2vw9.htm">EXECUTEMODE Property</a><br>
<a href="pref_9bzt.htm">INSTALLLEVEL Property</a><br>
<a href="pref_3lo9.htm">LOGACTION Property</a><br>
<a href="pref_27ll.htm">LOGFILE Property</a><br>
<a href="pref_6y2h.htm">LOGMODE Property</a><br>
<a href="pref_7qex.htm">REBOOT Property</a><br>
<a href="pref_3zll.htm">ROOTDRIVE Property</a><br>
<a href="pref_4xo9.htm">SCRIPTFILE Property</a><br>
<a href="pref_3d6h.htm">SHORTFILENAMES Property</a><br>
<a href="pref_8q2h.htm">TRANSFORMS Property</a><br>
<a href="pref_1ypl.htm">LIMITUI Property</a></p>
<p>
The following list provides links to more information about user-supplied information.</p>
<p class=indent1>
<a href="pref_3o55.htm">AdminProperties Property</a><br>
<a href="pref_5oc9.htm">COMPANYNAME Property</a><br>
<a href="pref_6et5.htm">ProductID Property</a><br>
<a href="pref_1v21.htm">PIDKEY Property</a><br>
<a href="pref_9shl.htm">USERNAME Property</a><br>
<a href="pref_7aex.htm">PRODUCTLANGUAGE Property</a></p>
<p>
The following list provides links to more information about product-specific properties specified in the property table:</p>
<p class=indent1>
<a href="pref_4tfd.htm">ProductCode Property</a><br>
<a href="pref_52m1.htm">ProductName Property</a><br>
<a href="pref_120p.htm">ProductVersion Property</a><br>
<a href="pref_9z09.htm">Manufacturer Property</a><br>
<a href="pref_0z21.htm">PIDTemplate Property</a><br>
<a href="pref_092x.htm">DiskPrompt Property</a><br>
<a href="pref_9qih.htm">DiskSerial Property</a><br>
<a href="pref_6n3t.htm">ComponentDownload Property</a><br>
<a href="pref_3hix.htm">SupportPhone Property</a><br>
<a href="pref_1jp5.htm">SupportURL Property</a><br>
<a href="pref_4fp5.htm">LeftUnit Property</a><br>
<a href="pref_7mux.htm">UpgradeCode Property</a></p>
<p>
The following list provides links to more information about system folders set by the installer at setup.</p>
<p class=indent1>
<a href="pref_7a7t.htm">AppDataFolder Property</a><br>
<a href="pref_4ge1.htm">CommonFilesFolder Property</a><br>
<a href="pref_4g6x.htm">DesktopFolder Property</a><br>
<a href="pref_048p.htm">FavoritesFolder Property</a><br>
<a href="pref_1115.htm">FontsFolder Property</a><br>
<a href="pref_4jqx.htm">NetHoodFolder Property</a><br>
<a href="pref_5xfd.htm">PersonalFolder Property</a><br>
<a href="pref_0v3t.htm">PrintHoodFolder Property</a><br>
<a href="pref_3xfd.htm">ProgramFilesFolder Property</a><br>
<a href="pref_5bw9.htm">ProgramMenuFolder Property</a><br>
<a href="pref_7vjt.htm">RecentFolder Property</a><br>
<a href="pref_5dh5.htm">SendToFolder Property</a><br>
<a href="pref_0mt5.htm">StartMenuFolder Property</a><br>
<a href="pref_3vnd.htm">StartupFolder Property</a><br>
<a href="pref_2hyx.htm">System16Folder Property</a><br>
<a href="pref_4sft.htm">SystemFolder Property</a><br>
<a href="pref_1nqx.htm">TempFolder Property</a><br>
<a href="pref_5at5.htm">TemplateFolder Property</a><br>
<a href="pref_88l5.htm">WindowsFolder Property</a><br>
<a href="pref_32ex.htm">WindowsVolume Property</a></p>
<p>
The following list provides links to more information about operating system properties set by the installer at startup.</p>
<p class=indent1>
<a href="pref_79mh.htm">AdminUser Property</a><a href="pref_2k1l.htm"><br>
ComputerName Property</a><br>
<a href="pref_8kxl.htm">LogonUser Property</a><br>
<a href="pref_6yux.htm">ServicePackLevel Property</a><br>
<a href="pref_73w9.htm">SharedWindows Property</a><br>
<a href="pref_6gs9.htm">Version9X Property</a><br>
<a href="pref_5jp5.htm">VersionDatabase Property</a><br>
<a href="pref_37nd.htm">VersionNT Property</a><br>
<a href="pref_4hh5.htm">WindowsBuild Property</a></p>
<p>
The following list provides links to more information about hardware properties set by the installer at startup.</p>
<p class=indent1>
<a href="pref_45mh.htm">Alpha Property</a><br>
<a href="pref_76k9.htm">BorderSide Property</a><br>
<a href="pref_9reh.htm">BorderTop Property</a><br>
<a href="pref_1y49.htm">CaptionHeight Property</a><br>
<a href="pref_8iyh.htm">ColorBits Property</a><br>
<a href="pref_2k1m.htm">Intel Property</a><br>
<a href="pref_4eih.htm">PhysicalMemory Property</a><br>
<a href="pref_3p4p.htm">ScreenX Property</a><br>
<a href="pref_7u2h.htm">ScreenY Property</a><br>
<a href="pref_9rw9.htm">TextHeight Property</a><br>
<a href="pref_49dl.htm">VirtualMemory Property</a></p>
<p>
The following list provides links to more information about status properties that are updated by the installer during installation.</p>
<p class=indent1>
<a href="pref_7kah.htm">CostingComplete Property</a><br>
<a href="pref_8ws9.htm">Installed Property</a><br>
<a href="pref_5m2h.htm">OutOfDiskSpace Property</a><br>
<a href="pref_84u1.htm">Preselected Property</a><br>
<a href="pref_31tl.htm">Resume Property</a><br>
<a href="pref_3hq1.htm">UpdateStarted Property</a></p>
<p>&nbsp;</p>

<h1><a name="_msi_action_property"></a>ACTION Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Specifies the initial action function that is called after the installer. in initialized.</p>
<h4>Set By</h4>
<p>
Set on the command line. Normally set to <b>INSTALL</b>, <b>ADVERTISE</b> or <b>ADMIN</b>. If not set, the <b>INSTALL</b> action will be called.</p>
<h4>Used By</h4>
<p>
After the installer is successfully initialized, Action uses this value to determine the type of action invoked . That action will most likely invoke other actions, commonly by querying the Action table. </p>
<h4>Default Value</h4>
<p>
None. If not set the <a href="aref_986m.htm">INSTALL Action</a> will be called.</p>
<p>&nbsp;</p>

<h1><a name="_msi_advertise_property"></a>ADVERTISE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be advertised. The features listed are to be found in the Feature column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All</b> to denote advertising all. Thus, if you wish to install all features locally you would provide the command line <b>ADVERTISE=All</b> to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine if a feature is advertised.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive.</p>
<p>&nbsp;</p>

<h1><a name="_msi_adddefault_property"></a>ADDDEFAULT Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be installed in their default configuration. The features listed are to be found in the <b>Feature</b> column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All</b>. Thus, if you wish to install all to their default configuration you would provide the command line <b>ADDDEFAULT=All</b> to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which features are advertised.  </p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive.</p>
<p>&nbsp;</p>

<h1><a name="_msi_addlocal_property"></a>ADDLOCAL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be installed locally. The features listed are to be found in the <b>Feature</b> column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All</b> to denote installing all features locally. Thus, if you wish to install all features locally you would provide the command line <b>ADDLOCAL=All</b> to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which features are to be installed locally.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive. Also note that if the <b><i>RunFromSource</i></b> column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsSourceOnly </b>then the component is installed as run from source.</p>
<p>&nbsp;</p>

<h1><a name="_msi_addsource_property"></a>ADDSOURCE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be installed to run from source. The features listed are to be found in the <b>Feature </b>column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All </b>to denote installing all features to run from source. Thus, if you wish to install all features as run from source you would provide the command line <b>ADDSOURCE=All </b>to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which features are to be installed as run from source.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive. Also note that if the <b><i>RunFromSource </i></b>column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsLocalOnly</b> then the component is installed locally.</p>
<p>&nbsp;</p>

<h1><a name="_msi_adminproperties_property"></a>AdminProperties Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The AdminProperties property is a semicolon delimited list of properties set at the time of an administration installation. During the post administration installation of the application these properties replace the current values in the installer database.</p>
<h4>Set By</h4>
<p>
The AdminProperties property list should be defined by the author and then set based upon information collected by the user interface during the network installation.</p>
<h4>Used By</h4>
<p>
The installer uses this value to set administration property values. </p>
<h4>Default Value</h4>
<p>
The values of properties already in the installer database. </p>
<h4>Remarks</h4>
<p>
The property names in the list can be internal or external (all uppercase) properties. For example, AdminProperties values could be <a href="pref_9bzt.htm">INSTALLLEVEL</a>, <a href="pref_1v21.htm">PIDKEY</a>, or the user's name and company.</p>
<p>&nbsp;</p>

<h1><a name="_msi_adminuser_property"></a>AdminUser Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>AdminUser</b> property is set on Windows NT whenever the user has administrator privileges. By convention, this property is always set on Windows 95 and Windows 98.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Typically, the user is asked if this will be a per-user or per-machine installation.  </p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_allowsuspend_property"></a>ALLOWSUSPEND Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Setting this property gives the user the option to continue at a later time a failed or cancelled installation or to do a rollback of the installation. This choice is presented to the user in the form of an error dialog box displayed before the final exit dialog box.</p>
<h4>Set By</h4>
<p>
Command line, or authored into the <a href="tref_21d1.htm">Property table</a>.</p>
<h4>Used By</h4>
<p>
</p>
<h4>Default Value</h4>
<p>
If ALLOWSUSPEND is not set, the default is to not display the dialog box following a failed or cancelled install and to do a rollback of the installation.</p>
<h4>Remarks</h4>
<p>
As with all error message dialogs, the suspend option dialog box will display even with a basic UI.</p>
<p>&nbsp;</p>

<h1><a name="_msi_allusers_property"></a>ALLUSERS Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this property is set, the folder properties representing folders in a profile are set to the folders in the "All Users" profile, if such a profile exists. Otherwise, those properties are set to folders in the user's personal profile.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
</p>
<h4>Default Value</h4>
<p>
None. May be undefined.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_alpha_property"></a>Alpha Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Defined only if running on an Alpha processor. The value is the numeric processor level.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_appdatafolder_property"></a>AppDataFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Application Data folder for the current user. Set for Windows NT but not for Windows 95 and Windows 98.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Winnt\Profiles\[LogonUser]\Application Data\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_arpnomodify_property"></a>ARPNOMODIFY Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ARPNOMODIFY property disables Add/Remove Control Panel and Programs Wizard functionality that would modify the product. If the property is set, <a href="aref_529a.htm">RegisterProduct action</a> writes the value for do not modify under the Uninstall key and prevents the UninstallString from being written to the registry.</p>
<h4>Set By</h4>
<p>
The ARPNOMODIFY property is set in the <a href="tref_21d1.htm">Property table</a> by authoring directly or through the use of a transform.</p>
<h4>Used By</h4>
<p>
<a href="aref_529a.htm">RegisterProduct</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
For example, this property can be set during a customization transform to prevent users from changing an administrator customization.</p>
<p>&nbsp;</p>

<h1><a name="_msi_arpnoremove_property"></a>ARPNOREMOVE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ARPNOREMOVE property disables the Add/Remove Control Panel and Programs Wizard functionality that would remove the product. If the property is set, <a href="aref_529a.htm">RegisterProduct action</a> writes the value for do not remove under the Uninstall key and prevents the UninstallString from being written to the registry.</p>
<h4>Set By</h4>
<p>
The ARPNOREMOVE property is set in the <a href="tref_21d1.htm">Property table</a> by authoring directly or through the use of a transform.</p>
<h4>Used By</h4>
<p>
<a href="aref_529a.htm">RegisterProduct</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
For example, this property can be set during a customization transform to prevent users from removing an administrator customization.</p>
<p>&nbsp;</p>

<h1><a name="_msi_borderside_property"></a>BorderSide Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The width, in pixels, of the window borders.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_bordertop_property"></a>BorderTop Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The height, in pixels, of the window borders.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_captionheight_property"></a>CaptionHeight Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Height, in pixels, of normal caption area.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_ccp_drive_property"></a>CCP_DRIVE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Property to be set to the root path on the removable volume that has the installation for any of the qualifying products for CCP.</p>
<h4>Set By</h4>
<p>
Property table, command line or through the UI.</p>
<h4>Used By</h4>
<p>
<a href="aref_5pgu.htm">RMCCPSearch</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_colorbits_property"></a>ColorBits Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Number of adjacent color bits for each pixel.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_commonfilesfolder_property"></a>CommonFilesFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Common Files folder for the current user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Program Files\Common Files\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_compaddlocal_property"></a>COMPADDLOCAL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of component ID's, delimited by commas, that are to be installed locally. Specifically, for each listed component ID, the installer examines all features linked (via the <a href="tref_52hx.htm">FeatureComponents</a> table) to that component, and installs the "cheapest" feature (i.e. the feature that would require the least amount of disk space to install). The components listed are to be found in the <b>Component</b> column of the <a href="tref_09np.htm">Component</a> table.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which feature(s) are set to be installed locally, based on the specified component(s).</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the component names are case-sensitive. Also note that if the <b><i>RunFromSource</i></b> column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsSourceOnly</b> then the component will be installed to run from source.</p>
<p>&nbsp;</p>

<h1><a name="_msi_compaddsource_property"></a>COMPADDSOURCE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of component ID's, delimited by commas, that are to be installed to run from the source media. Specifically, for each listed component ID, the installer examines all features linked (via the <a href="tref_52hx.htm">FeatureComponents</a> table) to that component, and installs the "cheapest" feature (i.e. the feature that would require the least amount of disk space to install). The components listed are to be found in the <b>Component</b> column of the <a href="tref_09np.htm">Component</a> table.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which feature(s) are set to be installed to run from source, based on the specified component(s).</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the component names are case-sensitive. Also note that if the <b><i>RunFromSource</i></b> column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsLocalOnly</b> then the component will be installed to run locally.</p>
<p>&nbsp;</p>

<h1><a name="_msi_companyname_property"></a>COMPANYNAME Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Organization for user performing the installation.</p>
<h4>Set By</h4>
<p>
Set by registry properties, can be overridden on command line.</p>
<h4>Used By</h4>
<p>
UI dialogs and ultimately, personalization actions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_componentdownload_property"></a>ComponentDownload Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
URL for downloading components by ID (string GUID).</p>
<h4>Set By</h4>
<p>
Authored into Property table. Optional.</p>
<h4>Used By</h4>
<p>
Installer uses this value to request a component when it is not possible to connect to any product source (server or CD).</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_computername_property"></a>ComputerName Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The computer name of the current system.</p>
<h4>Set By</h4>
<p>
Installer at initialization.  Set by system call GetComputerName().</p>
<h4>Used By</h4>
<p>
Actions and conditional expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_costingcomplete_property"></a>CostingComplete Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The CostingComplete property is used to indicate whether the installer has completed disk space costing. </p>
<h4>Set By</h4>
<p>
The CostingComplete property is set dynamically during disk space costing and is set to 1 as soon as the costing is complete. This property is initialized to 0 by the <a href="aref_22we.htm">CostFinalize action</a>. </p>
<h4>Used By</h4>
<p>
This property can be used to author a dialog box that pops up if costing has not been completed.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
For an example of how to author a "Please wait . . . " dialog box that pops up during disk space costing see the section <a href="hand_6at4.htm">Authoring a Conditional "Please wait . . ." Message Box</a>..</p>
<p>&nbsp;</p>

<h1><a name="_msi_versiondatabase_property"></a>VersionDatabase Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The value is the numeric database version of the current installation.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_desktopfolder_property"></a>DesktopFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Desktop folder. By default, this property is set to the folder for the current user. If an "All Users" profile exists and the <a href="pref_6tx5.htm">ALLUSERS</a> property is set, then this property is set to the folder in the "All Users" profile. </p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Desktop\ (Windows NT) and C:\Windows\Desktop\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_diskprompt_property"></a>DiskPrompt Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The string displayed by a message box prompting for a disk. This string should include the name of the product and a placeholder for the text printed on the CD surface. See <a href="hand_7po3.htm">Authoring Disk Prompt Messages</a>.</p>
<h4>Set By</h4>
<p>
Authored into the <a href="tref_21d1.htm">Property table</a>. </p>
<h4>Used By</h4>
<p>
Advertised as a product property. Used to display Diskprompt dialog when a disk is not detected in any drive.  </p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_diskserial_property"></a>DiskSerial Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The internal serial number for the CD for this particular product release.</p>
<h4>Set By</h4>
<p>
Authored into Property table. Required if a CD product.</p>
<h4>Used By</h4>
<p>
Advertised as a product property. Used to locate the CD in any drive.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_executeaction_property"></a>EXECUTEACTION Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The EXECUTEACTION Property is set to determine which top-level action the <a href="aref_3b1q.htm">ExecuteAction action</a> initiates.</p>
<h4>Set By</h4>
<p>
The top-level actions, such as the <a href="aref_986m.htm">INSTALL action</a>, <a href="aref_2o8e.htm">ADVERTISE action</a>, and <a href="aref_2o8e.htm">Advertise action</a>, set the EXECUTEACTION property to the name of the top-level action.</p>
<h4>Used By</h4>
<p>
<a href="aref_3b1q.htm">ExecuteAction</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_executemode_property"></a>EXECUTEMODE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property indicates the mode of execution performed by the installer. This property can have one of two values:
<dl>
<dt>
None</dt>
<dd>
No changes are made to the system. The installer does execute the user interface and the queries the database.</dd>
<dt>
Script</dt>
<dd>
All changes to the system are made through script execution. This is the default mode.</dd>
</dl>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
The installer uses this property to determine how system updates are executed.</p>
<h4>Default Value</h4>
<p>
If this property is not defined, then the execution mode defaults to Script.</p>
<h4>Remarks</h4>
<p>
The installer only examines the first letter of this property value and is case insensitive.</p>
<p>&nbsp;</p>

<h1><a name="_msi_favoritesfolder_property"></a>FavoritesFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Favorites folder for the current user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Favorites\ (Windows NT) and C:\Windows\Favorites\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_fileaddlocal_property"></a>FILEADDLOCAL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of file keys, delimited by commas, that are to be installed to run locally. Specifically, for each listed file key, the installer determines the component that controls that file, then examines all features linked (via the <a href="tref_52hx.htm">FeatureComponents</a> table) to that component, and installs the "cheapest" feature (i.e. the feature that would require the least amount of disk space to install). The file keys listed must be found in the <b>File</b> column of the <a href="tref_4n6t.htm">File</a> table.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which feature(s) will be installed locally, based on the specified file key(s).</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the file key names are case-sensitive. Also note that if the <b><i>RunFromSource</i></b> column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsSourceOnly</b> then the component will be installed to run from source.</p>
<p>&nbsp;</p>

<h1><a name="_msi_fileaddsource_property"></a>FILEADDSOURCE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of file keys, delimited by commas, that are to be installed to run from the source media. Specifically, for each listed file key, the installer determines the component that controls that file, then examines all features linked (via the <a href="tref_52hx.htm">FeatureComponents</a> table) to that component, and installs the "cheapest" feature (i.e. the feature that would require the least amount of disk space to install). The file keys listed must be found in the <b>File</b> column of the <a href="tref_4n6t.htm">File</a> table.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this property to determine which feature(s) will be installed to run from source, based on the specified file key(s).</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the file key names are case-sensitive. Also note that if the <b><i>RunFromSource</i></b> column of the <a href="tref_09np.htm">Component</a> table for a component has a value of <b>irsLocalOnly</b> then the component will be installed to run locally.</p>
<p>&nbsp;</p>

<h1><a name="_msi_fontsfolder_property"></a>FontsFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Fonts folder.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is [WindowsFolder]Fonts.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installed_property"></a>Installed Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Installed property indicates that a product is already installed.</p>
<h4>Set By</h4>
<p>
This property is set by the Installer at initialization if the product is already installed.</p>
<h4>Used By</h4>
<p>
The Installed property can be used in conditional expressions to determine if a product is already installed. For example, the property can be used in the conditional column of a sequence table or to differentiate between a first install and maintenance mode user interface.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_installlevel_property"></a>INSTALLLEVEL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The initial 'level' at which features will be selected 'ON' for installation by default. See the <a href="tref_0a91.htm">Feature</a> table for further discussion of install levels.</p>
<h4>Set By</h4>
<p>
Property table.</p>
<h4>Used By</h4>
<p>
Selection resolution actions.</p>
<h4>Default Value</h4>
<p>
If no value is specified, the install level defaults to 1.</p>
<p>&nbsp;</p>

<h1><a name="_msi_intel_property"></a>Intel Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Defined only if running on an Intel processor. The value is the numeric processor level, i.e. 4 for 486, 5 for P5, 6 for P6, etc..</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_leftunit_property"></a>LeftUnit Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this property is set, the unit is placed to the left of the number instead of the usual right hand side. This is needed to accommodate languages where this is the accepted format. </p>
<h4>Set By</h4>
<p>
The value is set in the <a href="tref_21d1.htm">Property Table</a>. </p>
<h4>Used By</h4>
<p>
The UI uses this property to display the size of files and the available space on different volumes.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
!!Additional notes!! </p>
<p>&nbsp;</p>

<h1><a name="_msi_logaction_property"></a>LOGACTION Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A list of action names, separated only by semicolons (no spaces), for which logging will occur.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine.Message uses this property to determine which actions will generate log information.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
The action names in this property are case-insensitive. The list may optionally end with a semicolon.</p>
<p>&nbsp;</p>

<h1><a name="_msi_logfile_property"></a>LOGFILE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Enables logging of messages by specifying a path to the file where the log information is to be written. The file will be created if not present, else any old log information from a previous installation will be overwritten unless the append option is set by the <a href="pref_6y2h.htm">LOGMODE</a> property. The logfile is flushed after each line is posted, and it is closed when the MsiServices object is destroyed.</p>
<h4>Set By</h4>
<p>
Set on the command line.</p>
<h4>Used By</h4>
<p>
The installer uses this property to specify which log file will be opened when the installer is initialized.  Initialization will fail if the log file cannot be opened.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
The first line of the log will be formatted according to the value of the imgLogHeader entry in the Error table. Log line formats are determined by the various message and action types, as well by code that directly writes directly to the log. The final line of the log will be formatted according to the value of the imsgLogTrailer entry in the Error table. For an example of using the LOGFILE property, see <a href="app_73eb.htm">Command Line Options</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_logmode_property"></a>LOGMODE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A string containing letters that specify which messages are to be written to the log file. Options are case-insensitive and order-independent.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to initialize logging for the various message types, but only if the <a href="pref_27ll.htm">LOGFILE</a> property is defined.</p>
<h4>Default Value</h4>
<p>
None. Internal default log options, "ewarim", are used if this property is undefined.</p>
<p>
<b>Log Option Codes</b> - for message types:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=7%>i</td>
<td width=30%>(imtInfo)</td>
<td width=63%>Informational-only messages</td>
</tr>
<tr valign=top>
<td width=7%>w</td>
<td width=30%>(imtWarning)</td>
<td width=63%>Warning messages, not fatal</td>
</tr>
<tr valign=top>
<td width=7%>e</td>
<td width=30%>(imtError)</td>
<td width=63%>Error messages, may be fatal</td>
</tr>
<tr valign=top>
<td width=7%>f</td>
<td width=30%>(imtFilesInUse)</td>
<td width=63%>List of files in use that need to be replaced</td>
</tr>
<tr valign=top>
<td width=7%>a</td>
<td width=30%>(imtActionStart)</td>
<td width=63%>Start of action notification</td>
</tr>
<tr valign=top>
<td width=7%>r</td>
<td width=30%>(imtActionData)</td>
<td width=63%>Action data record, contents action-specific</td>
</tr>
<tr valign=top>
<td width=7%>u</td>
<td width=30%>(imtUser)</td>
<td width=63%>User request messages</td>
</tr>
<tr valign=top>
<td width=7%>c</td>
<td width=30%>(imtCommonData)</td>
<td width=63%>Common Data messages</td>
</tr>
<tr valign=top>
<td width=7%>m</td>
<td width=30%>(imtOutOfMemory)</td>
<td width=63%>Out of memory messages</td>
</tr>
<tr valign=top>
<td width=7%>p</td>
<td width=30%></td>
<td width=63%>Dump property table, "property = value" at MsiEngine.Terminate </td>
</tr>
<tr valign=top>
<td width=7%>+</td>
<td width=30%></td>
<td width=63%>Append to existing logfile</td>
</tr>
</table><br>
<p>
For an example of using the LOGMODE property, see <a href="app_73eb.htm">Command Line Options</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_logonuser_property"></a>LogonUser Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The user name for the currently logged on user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.  Set by system call GetUserName().</p>
<h4>Used By</h4>
<p>
Actions and conditional expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_manufacturer_property"></a>Manufacturer Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The name of the manufacturer for the product.</p>
<h4>Set By</h4>
<p>
Authored into Property table. REQUIRED.</p>
<h4>Used By</h4>
<p>
Advertised as a product property.  </p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_nethoodfolder_property"></a>NetHoodFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the NetHood (Network Neighborhood) folder for the current user. Set for Windows NT but not for Windows 95 and Windows 98.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Winnt\Profiles\[LogonUser]\NetHood\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_limitui_property"></a>LIMITUI Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this property is set, the UI level used when installing this package is capped as Basic. This property can be used when a package has no authored UI to use the Installer's built in default UI.</p>
<h4>Set By</h4>
<p>
Property table or command line.</p>
<h4>Used By</h4>
<p>
Installer uses this value to determine which UI to display.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
On Windows NT 5.0, the LIMITUI property will not prevent an uninstall. If the LIMITUI property is set, a user can uninstall an application by the following methods: 
<ul>
<li>
msiexec /x &lt;path to MSI or ProductCode&gt;</li>
<li>
right-clicking on the MSI file, then clicking <b>Uninstall</b></li>
<li>
Calling the <a href="msi_75x0.htm">MsiInstallProduct</a> API</li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_outofdiskspace_property"></a>OutOfDiskSpace Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property is set to a value of TRUE by the installer if any volume that is a target of the current install has insufficient disk space to accommodate the proposed installation. If all volumes have sufficient space, the value is FALSE.</p>
<h4>Set By</h4>
<p>
This property is valid at any time after the <a href="aref_4bam.htm">CostInitialize</a> action has been executed. The OutOfDiskSpace property status is dynamically updated any time the total install cost is re-calculated (for example, any time the install state of any feature is changed via the <a href="hand_9llz.htm">Selection</a> dialog).</p>
<h4>Used By</h4>
<p>
Selection resolution actions use this value to cancel an installation and generate a dialog box.</p>
<p>&nbsp;</p>

<h1><a name="_msi_patch_property"></a>PATCH Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property is the full path of the current patch package. Setting this property causes the installer to apply the patch.</p>
<h4>Set By</h4>
<p>
The PATCH property is set by the command line or with <a href="msi_5fe0.htm">MsiApplyPatch</a>. The PATCH property is set only during the first application of the patch. The patch will continue to be applied for each subsequent configuration of the product, but the PATCH property will not be set.</p>
<h4>Used By</h4>
<p>
</p>
<h4>Remarks</h4>
<p>
The PATCH property can be used in conditional expressions to control an action or user interface that is performed only during the first application of the patch.</p>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for these filenames or paths.</p>
<p>&nbsp;</p>

<h1><a name="_msi_personalfolder_property"></a>PersonalFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Personal folder for the current user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Personal\ (Windows NT) and C:\My Documents\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_physicalmemory_property"></a>PhysicalMemory Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The PhysicalMemory property gives the size of the installed RAM in Megabytes.</p>
<h4>Set By</h4>
<p>
This property is set by the installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_pidtemplate_property"></a>PIDTemplate Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property contains the string used as a template for the <a href="pref_1v21.htm">PIDKEY property</a>. For the syntax used in the template, see the <a href="href_8re4.htm">MaskedEdit</a> control type.</p>
<h4>Set By</h4>
<p>
The value is initially set in the <a href="tref_21d1.htm">Property Table</a>. </p>
<h4>Used By</h4>
<p>
<a href="aref_0cdq.htm">ValidateProductID Action</a> uses this value to validate the Product ID.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_preselected_property"></a>Preselected Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Preselected Property indicates that features have already been selected and that the selection dialog need not be shown.</p>
<h4>Set By</h4>
<p>
This property is set by the Installer during the resumption of a suspended install or when properties such as <a href="pref_3dvd.htm">ADDLOCAL</a> or <a href="pref_8ho9.htm">REMOVE</a> are used to select features at the command line.</p>
<h4>Used By</h4>
<p>
Conditional expressions which depend on whether or not features are already installed use this value. For example, the property can be used to suppress any dialogs involving feature selections during the resumption of a suspended installation.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_printhoodfolder_property"></a>PrintHoodFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the PrintHood (Printer Neighborhood) folder for the current user. Not set for Win9x.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Winnt\Profiles\[LogonUser]\PrintHood\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_productcode_property"></a>ProductCode Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A unique identifier for the particular product release, represented as a string GUID, e.g. "{12345678-1234-1234-1234-123456789012}". This ID must differ for different versions and languages.</p>
<h4>Set By</h4>
<p>
Authored into Property table. REQUIRED.</p>
<h4>Used By</h4>
<p>
Advertised as a product property, as the primary method of specifying the product.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_productid_property"></a>ProductID Property</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ProductID property is set to the full Product ID after a successful validation.</p>
<h4>Set By</h4>
<p>
Following a successful validation, this property is set by the <a href="aref_0cdq.htm">ValidateProductID action</a> or the <a href="href_0jqs.htm">ValidateProductID ControlEvent</a>.</p>
<h4>Used By</h4>
<p>
This value is displayed by the UI and used by the <a href="aref_529a.htm">RegisterProduct action</a>. </p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_pidkey_property"></a>PIDKEY Property</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property contains the part of the Product ID entered by the user.</p>
<h4>Set By</h4>
<p>
The PIDKEY property can be set on the command line or through the user interface. This property contains only the part of the Product ID that is entered by the user.</p>
<h4>Used By</h4>
<p>
The <a href="aref_0cdq.htm">ValidateProductID action</a> validates the Product ID entered by the user by comparing the PIDKEY property to the <a href="pref_0z21.htm">PIDTemplate</a> property.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_productlanguage_property"></a>PRODUCTLANGUAGE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The numeric language ID. </p>
<h4>Set By</h4>
<p>
Set on the command line.</p>
<h4>Used By</h4>
<p>
Advertised as a product property, this value is used to apply the correct language transform in the case of a multi-language product. .</p>
<h4>Default Value</h4>
<p>
0.</p>
<h4>Remarks</h4>
<p>
The PRODUCTLANGUAGE property is applied only during the installation or advertisement of a product. Since the installer must use the same language for later maintenance of the product, the PRODUCTLANGUAGE property cannot be set in maintenance mode.</p>
<p>&nbsp;</p>

<h1><a name="_msi_productname_property"></a>ProductName Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The ProductName property contains the human-readable name of the application being installed (e.g. Microsoft Office 97). This is only used for display purposes.</p>
<h4>Set By</h4>
<p>
Authored into Property table. REQUIRED. May be changed by transform.</p>
<h4>Used By</h4>
<p>
Advertised as a product property and used for display purposes.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_productversion_property"></a>ProductVersion Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The string format of the product version, as a numeric value.</p>
<h4>Set By</h4>
<p>
Authored into Property table. REQUIRED.</p>
<h4>Used By</h4>
<p>
Advertised as a product property.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Only the major and minor versions are used for the advertised property.</p>
<p>&nbsp;</p>

<h1><a name="_msi_programfilesfolder_property"></a>ProgramFilesFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Program Files folder.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Program Files\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_programmenufolder_property"></a>ProgramMenuFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Program Menu folder. By default, this property is set to the folder for the current user. If an "All Users" profile exists and the <a href="pref_6tx5.htm">ALLUSERS</a> property is set, than this property is set to the folder in the "All Users" profile.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Start Menu\Programs\ (Windows NT) and C:\Windows\Start Menu\Programs\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_reboot_property"></a>REBOOT Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this property is set to "Force" the installation will reboot at the end, regardless of what the actions require.If the property is set to "Suppress" the installation will not reboot in case of reboots that happen at the end of the installation before the new program can be used. If the reboot is needed to continue the installation, the reboot will still take place.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value at termination to override the reboot decision made by the actions.  </p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
This property is typically used by an administrator who installs several products at the same time and wants to have only one reboot at the end of the series of installations.</p>
<p>&nbsp;</p>

<h1><a name="_msi_recentfolder_property"></a>RecentFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Recent folder for the current user. Not set for Win9x.</p>
<h4>Set By</h4>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Winnt\Profiles\[LogonUser]\Recent\.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reinstall_property"></a>REINSTALL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be reinstalled. The features listed are to be found in the <b>Feature</b> column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All</b> to denote reinstalling all features. Thus, if you wish to reinstall all features you would provide the command line <b>REINSTALL=All</b> to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which features are to be reinstalled.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive. </p>
<p>
If the REINSTALL property is set, the <a href="pref_7bll.htm">REINSTALLMODE</a> property should also be set, to indicate the type of reinstall to be performed. If the REINSTALLMODE property is not set, then by default all files that are currently installed will be reinstalled, IF the currently installed file is a lesser version (or is not present). By default, no registry entries will be rewritten.</p>
<p>
Note that even if REINSTALL is set to "ALL", only those features that were already installed previously will be reinstalled. Thus, if REINSTALL is set for a product that is yet to be installed, no installation action will take place at all.</p>
<p>&nbsp;</p>

<h1><a name="_msi_reinstallmode_property"></a>REINSTALLMODE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A string containing letters that specify the type of reinstall to perform. Options are case-insensitive and order-independent. This property should normally always be used in conjunction with the <a href="pref_19x5.htm">REINSTALL</a> property. </p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine the type of reinstall (if any) to perform.</p>
<h4>Default Value</h4>
<p>
By default the REINSTALLMODE is "romus".</p>
<p>
<b>Reinstall Option Codes</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=5%>r</td>
<td width=45%>(iefInstallEnable)</td>
<td width=50%>Enable <b>r</b>einstall of any files/registry found to be invalid.</td>
</tr>
<tr valign=top>
<td width=5%>p</td>
<td width=45%>(iefOverwriteNone)</td>
<td width=50%>Reinstall only if file is missing (i.e. verify that the file is <b>p</b>resent).</td>
</tr>
<tr valign=top>
<td width=5%>o</td>
<td width=45%>(iefOverwriteOlderVersions)</td>
<td width=50%>Reinstall if file is missing, or an <b>o</b>lder version is present.</td>
</tr>
<tr valign=top>
<td width=5%>e</td>
<td width=45%>(iefOverwriteEqualVersions)</td>
<td width=50%>Reinstall if file is missing, or an <b>e</b>qual or older version is present</td>
</tr>
<tr valign=top>
<td width=5%>d</td>
<td width=45%>(iefOverwriteDifferingVersions)</td>
<td width=50%>Reinstall if file is missing, or a <b>d</b>ifferent version is present</td>
</tr>
<tr valign=top>
<td width=5%>c</td>
<td width=45%>(iefOverwriteCorruptedFiles)</td>
<td width=50%>Reinstall if file is missing, or <b>c</b>orrupt (i.e. the stored checksum doesn't match the computed value).</td>
</tr>
<tr valign=top>
<td width=5%>a</td>
<td width=45%>(iefOverwriteAllFiles)</td>
<td width=50%>Force <b>a</b>ll files to be reinstalled, regardless of checksum or version</td>
</tr>
<tr valign=top>
<td width=5%>u</td>
<td width=45%>(iefInstallUserData)</td>
<td width=50%>Re-write all required <b>u</b>ser registry entries.</td>
</tr>
<tr valign=top>
<td width=5%>m</td>
<td width=45%>(iefInstallMachineData)</td>
<td width=50%>Re-write all required local <b>m</b>achine registry entries.</td>
</tr>
<tr valign=top>
<td width=5%>s</td>
<td width=45%>(iefInstallShortcuts)</td>
<td width=50%>Reinstall all <b>s</b>hortcuts, overwriting any existing shortcut.</td>
</tr>
</table><br>
<p>
All of the reinstall options shown above, except for iefInstallEnable, can actually be thought of as "detection" flags, which are used to detect that the feature or features specified by the REINSTALL property are installed properly. If any of the specified detection operations fail during the reinstall, this fact will be logged for informational purposes. However, the invalid installation will actually be repaired only if the iefInstallEnable option is also set. For example, if the iefOverwriteCorruptedFiles flag is set, corrupted files will be detected and logged on reinstall, but the corrupted files will actually be repaired (by reinstallation) only if the iefInstallEnable flag is also specified.</p>
<p>
If the REINSTALLMODE property is defined without the REINSTALL property defined, then the specified "detection" modes still apply; however, only those features that are selected normally for install will actually be "reinstalled". Thus, in this case, REINSTALLMODE actually specifies the "overwrite" mode for a normal install.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Only those files that are designated in the <a href="tref_4n6t.htm">File</a> table as containing checksum information will ever be verified for accurate checksum.</p>
<p>&nbsp;</p>

<h1><a name="_msi_remove_property"></a>REMOVE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The property value denotes a list of features, delimited by commas, that are to be removed, if installed. The features listed are to be found in the <b>Feature</b> column of the <a href="tref_0a91.htm">Feature</a> table. Optionally, the value could be <b>All</b> to denote removing all features. Thus, if you wish to remove all features (i.e. uninstall the entire product), you would provide the command line <b>REMOVE=All</b> to the installer.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine which features are to be removed.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Note that the feature names are case-sensitive.</p>
<p>&nbsp;</p>

<h1><a name="_msi_resume_property"></a>Resume Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Set when resuming a suspended install. This property can be used to determine what text to show the user in the UI. For example, when not in resume mode the user could be asked "Are you ready to install?" while in resume mode the user could be asked "Are you ready to complete your install?".</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
UI conditionalization uses this value to determine which install dialog to display.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_rootdrive_property"></a>ROOTDRIVE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Set to the default drive for the install. This property supplies the default paths for any undefined root directories in the Directory table. When in ADMIN mode, this is set to the first writable connected network drive found. When no network drives are found or when not in ADMIN mode, the location of the writable local drive with the most available free disk space is used.</p>
<p>
The value for this property must end with '\'.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
<a href="tref_6an9.htm">Directory Table</a> use this value to determine the drive used for an application installation. </p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_screenx_property"></a>ScreenX Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Width, in pixels, of the screen.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions use this value to establish screen width.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_screeny_property"></a>ScreenY Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Height, in pixels, of the screen.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions use this value to establish screen height.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_scriptfile_property"></a>SCRIPTFILE Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
If this property is set, a script file is created containing all operations executed during the install. This property defines the location of the script file. If a relative path is given, the path is assumed to be relative to the location of the installation package.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to determine if and where to create a script file.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
This property is completely unrelated to the <a href="pref_2vw9.htm">EXECUTEMODE</a> property. In other words, if this property is set, the script will be created regardless of the installer's execution mode.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sendtofolder_property"></a>SendToFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the SendTo folder for the current user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\SendTo\ (Windows NT) and C:\Windows\SendTo\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_servicepacklevel_property"></a>ServicePackLevel Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The numerical value of the operating system service pack, if one is installed.</p>
<h4>Set By</h4>
<p>
Installer at initialization</p>
<h4>Used By</h4>
<p>
Conditional expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sharedwindows_property"></a>SharedWindows Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Set when the system is operating as Shared Windows.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and conditional expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_shortfilenames_property"></a>SHORTFILENAMES Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Setting the SHORTFILENAMES property causes short file names to be used rather than long file names. This property may be set during an <a href="aref_4hbi.htm">ADMIN</a> install to create a source image having only short file names.</p>
<h4>Set By</h4>
<p>
This property can be set by the user at the command line to disable long file names.</p>
<h4>Used By</h4>
<p>
Actions use this property for directory resolution.</p>
<h4>Default Value</h4>
<p>
Long names will be used by the installer if the SHORTFILENAMES property is not set and the target volume supports long names. Short names will be used by the installer if the target volume does not support long names.</p>
<h4>Remarks</h4>
<p>
When the SHORTFILENAMES property is set, the installer will create folders and install files using short file names from any short|long pairs listed in the <a href="tref_4n6t.htm">File table</a> or <a href="tref_6an9.htm">Directory table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sourcedir_property"></a>SOURCEDIR Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Root directory containing the source files (either the source cabinet file, or the source file tree).</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
This value is used for directory resolution.</p>
<h4>Default Value</h4>
<p>
The directory containing the installation package.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sourcelist_property"></a>SOURCELIST Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The SOURCELIST property is a semicolon delimited list of network or URL source paths that are added to each user's source list for that product.</p>
<h4>Set By</h4>
<p>
The SOURCELIST property can be set at the command line or in the <a href="tref_21d1.htm">Property table</a>.</p>
<h4>Used By</h4>
<p>
During the installation of a feature or product, the installer searches the source list for a valid path to the installation package. The author of an installation package uses the SOURCELIST property to extend the list of potential source paths that are searched.</p>
<h4>Default Value</h4>
<p>
During every installation the installer will check to see if the property is set. If the SOURCELIST property is not set, then the installer will use the existing source list.</p>
<h4>Remarks</h4>
<p>
Sources added using the SOURCELIST property are added directly to the end of the list for each type of source and always come after the default source specified by the <a href="pref_6uwp.htm">SOURCEDIR property</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_startmenufolder_property"></a>StartMenuFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Start menu folder. By default, this property is set to the folder for the current user. If an "All Users" profile exists and the <a href="pref_6tx5.htm">ALLUSERS</a> property is set, than this property is set to the folder in the "All Users" profile.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and Directory table.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Start Menu\ (Windows NT) and C:\Windows\Start Menu\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_startupfolder_property"></a>StartupFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Startup folder. By default, this property is set to the folder for the current user. If an "All Users" profile exists and the <a href="pref_6tx5.htm">ALLUSERS</a> property is set, than this property is set to the folder in the "All Users" profile.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and Directory table.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\Start Menu\Programs\Startup\ (Windows NT) and C:\Windows\Start Menu\Programs\Startup\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_supportphone_property"></a>SupportPhone Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Technical support phone number(s).</p>
<h4>Set By</h4>
<p>
Authored into Property table. Optional.</p>
<h4>Used By</h4>
<p>
Product maintenance applets display this value.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_supporturl_property"></a>SupportURL Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Internet address for technical support.</p>
<h4>Set By</h4>
<p>
Authored into Property table. Optional.</p>
<h4>Used By</h4>
<p>
Product maintenance applets display this value.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_system16folder_property"></a>System16Folder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to folder for 16-bit system DLLs.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None. </p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\System\ (Windows NT) and C:\Windows\System\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_systemfolder_property"></a>SystemFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the System folder.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are: C:\Winnt\System32 (Windows NT) and C:\Windows\System\ (Windows 95 and Windows 98).</p>
<p>
This folder is normally a subfolder of the Windows folder. However, it will reside on a server when configured for Shared Windows.</p>
<p>&nbsp;</p>

<h1><a name="_msi_targetdir_property"></a>TARGETDIR Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
TARGETDIR must be the name of one root in the <a href="tref_6an9.htm">Directory</a> table. It is used as the location to copy the Installer installation package during an ADMIN install.</p>
<h4>Set By</h4>
<p>
Command line, user interface.</p>
<h4>Used By</h4>
<p>
Actions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_tempfolder_property"></a>TempFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Temp folder.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
A common value for this property is C:\Temp.</p>
<p>&nbsp;</p>

<h1><a name="_msi_templatefolder_property"></a>TemplateFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Template folder for the current user.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt\Profiles\[LogonUser]\ShellNew\ (Windows NT) and C:\Windows\ShellNew\ (Windows 95 and Windows 98).</p>
<p>&nbsp;</p>

<h1><a name="_msi_textheight_property"></a>TextHeight Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The height (ascent + descent) of characters, given in logical units. </p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_transforms_property"></a>TRANSFORMS Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A string containing a list of transforms to be applied to the database.</p>
<h4>Set By</h4>
<p>
Command line.</p>
<h4>Used By</h4>
<p>
MsiEngine uses this value to transform the database.</p>
<h4>Default Value</h4>
<p>
Undefined.</p>
<h4>Remarks</h4>
<p>
Transforms will be applied in the order they are listed in the string. To specify multiple transforms, separate each with a semi-colon (;).</p>
<p>
Transforms can reside in three locations. The format for specifying the transforms varies based on its location:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=38%>Location</th>
<th align=left width=62%>Format</th>
</tr>
<tr valign=top>
<td width=38%>file</td>
<td width=62%>filename</td>
</tr>
<tr valign=top>
<td width=38%>child storage in database</td>
<td width=62%>:transformname</td>
</tr>
</table><br>
<p>
Since the list delimiter for transforms, sources and patches is a semicolon, this character should not be used for these filenames or paths.</p>
<h4>Example</h4>
<p>
Suppose the following transforms need to be applied:
<ul>
<li>
trans1, located in a file in c:\transforms</li>
<li>
trans2, located in a child storage of the database</li>
</ul>
<p>
The string would be: c:\transforms\trans1;:trans2</p>
<p>
The TRANSFORMS property is applied only during the installation or advertisement of a product. Since the installer must use the same transform for later maintenance of the product, the TRANSFORMS property can't be set in maintenance mode.</p>
<p>&nbsp;</p>

<h1><a name="_msi_updatestarted_property"></a>UpdateStarted Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Set when changes to the system have begun for this install. This includes the case when a suspended install is resumed.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
UI conditionalization uses this value to select a dialog box. If this property is set, the user will be asked after an error and cancellation whether to restore or to continue later .</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_upgradecode_property"></a>UpgradeCode Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is a GUID representing a related set of products. The UpgradeCode is used in the <a href="tref_4qxx.htm">Upgrade Table</a> to search for related versions of the product that are already installed.</p>
<h4>Set By</h4>
<p>
The UpgradeCode of a product is set by the author of the upgrade package and registered in Darwin information.</p>
<h4>Used By</h4>
<p>
</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_username_property"></a>USERNAME Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
User performing installation.</p>
<h4>Set By</h4>
<p>
Set by registry properties, override on command line.</p>
<h4>Used By</h4>
<p>
UI dialogs use this value for personalization actions.</p>
<h4>Default Value</h4>
<p>
Default value may be put in database Property table.</p>
<p>&nbsp;</p>

<h1><a name="_msi_usersid_property"></a>UserSID Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The UserSID Property is set to the string form of the user's security identifier (SID). This property is only set on Windows NT.</p>
<h4>Set By</h4>
<p>
Set by installer at initialization.</p>
<h4>Used By</h4>
<p>
This property is used by <a href="cact_5t2r.htm">custom actions</a> that need to access registry keys under HKEY_CURRENT_USER.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
When a custom action is executed in the installation service, it cannot access HKEY_CURRENT_USER directly. Instead, it must open a key beneath HKEY_USERS. The value of this property is the name of the key under HKEY_USERS which may be used in place of HKEY_CURRENT_USER.</p>
<p>&nbsp;</p>

<h1><a name="_msi_version9x_property"></a>Version9X Property</h1>
<p>
[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property gives the version number for the Windows 95 or Windows 98 operating system.</p>
<h4>Set By</h4>
<p>
This property is set by the installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions dependent upon the Windows 95 or Windows 98 operating system use this value.</p>
<h4>Value</h4>
<p>
The value of this property is an integer: MajorVersion * 100 + MinorVersion. The property remains undefined if the operating system is not Windows 95 or Windows 98.</p>
<h4>Remarks</h4>
<p>
Condition expressions can test for the version of Windows 95 or Windows 98 by using the property name or may verify the version by using a comparison operator.</p>
<p>&nbsp;</p>

<h1><a name="_msi_versionnt_property"></a>VersionNT Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The version number for the Windows NT operating system, undefined if the operating system is not Windows NT. The value is an integer: MajorVersion * 100 + MinorVersion.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Windows NT operating system dependent actions and condition expressions use this value.</p>
<h4>Remarks</h4>
<p>
Condition expressions may test for Windows NT simply by using the property name, or may verify the version using a comparison operator.</p>
<p>&nbsp;</p>

<h1><a name="_msi_virtualmemory_property"></a>VirtualMemory Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Amount of available page file space in Megabytes.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and condition expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_windowsbuild_property"></a>WindowsBuild Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The build number of the operating system.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and conditional expressions.</p>
<h4>Default Value</h4>
<p>
None.</p>
<p>&nbsp;</p>

<h1><a name="_msi_windowsfolder_property"></a>WindowsFolder Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Full path to the Windows folder. </p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and <a href="tref_6an9.htm">Directory table</a>.</p>
<h4>Default Value</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Common values for this property are C:\Winnt (Windows NT) and C:\Windows (Windows 95 and Windows 98).</p>
<p>
This folder will be local, even when configured for shared Windows.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_windowsvolume_property"></a>WindowsVolume Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This property is set to the volume of the windows folder. The property always ends with a backslash.  This can be used to set the default location to the volume the windows folder is on, since the <a href="pref_3zll.htm">ROOTDRIVE Property</a> does not necessarily equal this drive.</p>
<h4>Set By</h4>
<p>
Installer at initialization.</p>
<h4>Used By</h4>
<p>
Actions and directory resolution use this value.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_summary_information_stream"></a>Summary Information Stream</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and developers who want to learn more about the Microsoft  Windows  installer database tables. For general information, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>
To conveniently store information in Microsoft  Windows  Explorer, you can use the summary information stream, which is accessible through the <b>IStream </b>interface. The following topics provide information about how to use the summary information stream with the installer:
<ul>
<li>
<a href="sovr_7q99.htm">About the Summary Information Stream</a></li>
<li>
<a href="sovr_09wt.htm">Using the Summary Information Stream</a></li>
<li>
<a href="sref_8yhx.htm">Summary Information Stream Reference</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_about_the_summary_information_stream"></a>About the Summary Information Stream</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The summary information stream is very convenient for storing information that can be viewed with Microsoft  Windows  Explorer. Microsoft  Windows  installer sets the summary information stream properties by default. The default value for each type of database is described in this section. The installer uses certain database and summary properties to populate the summary information stream for a database. </p>
<p>
The summary information stream uses COM to provide structured storage of databases. COM supports the concept of structured storage accessible through the <b>IStream</b> interface. Structured storage, in turn, supports the concept of property sets as a flexible method for serializing almost any information. The COM specification defines a single standard property set, summary information, which is used to populate property sheets viewable from the Windows Explorer. So, information stored in the summary information stream can be viewed by users when they right-click an installer database or transform and select <b>Properties</b>.</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database and thus cannot be changed. Additionally, it will not be persisted with the database. To create or modify the summary information for the output database it must be closed and re-opened.</p>
<p>&nbsp;</p>

<h2><a name="_msi_summary_information_stream_property_set"></a>Summary Information Stream Property Set</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following table shows the summary information stream property set, which includes the properties, their corresponding property IDs, PIDs, types, and also explains how the installer uses these properties.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=31%>Property Name</th>
<th align=left width=21%>Property ID</th>
<th align=left width=7%>PID</th>
<th align=left width=18%>Type</th>
<th align=left width=23%>Installer Usage</th>
</tr>
<tr valign=top>
<td width=31%><a href="sref_4r5l.htm">Codepage Property</a></td>
<td width=21%>PID_CODEPAGE</td>
<td width=7%>1</td>
<td width=18%>VT_12</td>
<td width=23%>Specifies the name of the code page. This property is static.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_82rd.htm">Title</a></td>
<td width=21%>PID_TITLE</td>
<td width=7%>2</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the database type.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_0b5l.htm">Subject</a></td>
<td width=21%>PID_SUBJECT</td>
<td width=7%>3</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the product name.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_76k9.htm">Author</a></td>
<td width=21%>PID_AUTHOR</td>
<td width=7%>4</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the vendor.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_7xfd.htm">Keywords</a></td>
<td width=21%>PID_KEYWORDS</td>
<td width=7%>5</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Includes Help for the user.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_4lfd.htm">Comments</a></td>
<td width=21%>PID_COMMENTS</td>
<td width=7%>6</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Includes Help for the user.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_80hl.htm">Template</a></td>
<td width=21%>PID_TEMPLATE</td>
<td width=7%>7</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the platform language IDs.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_7dyx.htm">Last Saved By</a></td>
<td width=21%>PID_LASTAUTHOR</td>
<td width=7%>8</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the user name of the person who last modified the database.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_1am1.htm">Revision Number</a></td>
<td width=21%>PID_REVNUMBER</td>
<td width=7%>9</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies the package code for a package.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_0395.htm">Last Printed</a></td>
<td width=21%>PID_LASTPRINTED</td>
<td width=7%>11</td>
<td width=18%>VT_FILETIME</td>
<td width=23%>Specifies the maintenance database when the installation occurred.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_2ut5.htm">Create Time/Date</a></td>
<td width=21%>PID_CREATE_DTM</td>
<td width=7%>12</td>
<td width=18%>VT_FILETIME</td>
<td width=23%>Specifies the product release date.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_0hkp.htm">Last Save Time/Date</a></td>
<td width=21%>PID_LASTSAVE_DTM</td>
<td width=7%>13</td>
<td width=18%>VT_FILETIME</td>
<td width=23%>Specifies the last database modification.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_8eex.htm">Page Count</a></td>
<td width=21%>PID_PAGECOUNT</td>
<td width=7%>14</td>
<td width=18%>VT_I4</td>
<td width=23%>Specifies the minimum installer version.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_8gzd.htm">MSI Source Type</a></td>
<td width=21%>PID_MSISOURCE</td>
<td width=7%>15</td>
<td width=18%>VT_I4</td>
<td width=23%>Specifies the installation source type.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_6r5l.htm">Character Count</a></td>
<td width=21%>PID_CHARCOUNT</td>
<td width=7%>16</td>
<td width=18%>VT_I4</td>
<td width=23%>Specifies the transform restrictions.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_4qrd.htm">Creating Application</a></td>
<td width=21%>PID_APPNAME</td>
<td width=7%>18</td>
<td width=18%>VT_LPSTR</td>
<td width=23%>Specifies which application created the installation database.</td>
</tr>
<tr valign=top>
<td width=31%><a href="sref_2mbd.htm">Security</a></td>
<td width=21%>PID_SECURITY</td>
<td width=7%>19</td>
<td width=18%>VT_I4</td>
<td width=23%>Specifies that the status is read-only. </td>
</tr>
</table><br>
<p>
The installer currently maintains two storage formats: a product-specific installation database, and a language- or version-specific transform. The CLSID for the storage is set to the appropriate format class for the particular format, independent of the summary information for the storage.</p>
<p>&nbsp;</p>

<h2><a name="_msi_summary_properties_for_installation_databases_and_transforms"></a>Summary Properties for Installation Databases and Transforms</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Summary properties for installation databases and transforms are described in the following table: </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=24%>Summary Property</th>
<th align=left width=38%>Installation Database</th>
<th align=left width=38%>Transform</th>
</tr>
<tr valign=top>
<td width=24%><a href="sref_82rd.htm">Title</a></td>
<td width=38%>[<a href="sref_82rd.htm">SummaryTitle</a>] (for example, the installation database for the property.)</td>
<td width=38%>[<a href="sref_82rd.htm">SummaryTitle</a>] (for example, the  transform for the property.)</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_0b5l.htm">Subject</a></td>
<td width=38%>[<a href="pref_52m1.htm">ProductName Property</a>]</td>
<td width=38%>[<a href="pref_52m1.htm">ProductName Property</a>]</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_76k9.htm">Author</a></td>
<td width=38%>Microsoft Corporation</td>
<td width=38%>Microsoft Corporation</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_7xfd.htm">Keywords</a></td>
<td width=38%>[<a href="sref_7xfd.htm">SummaryKeywords</a>]</td>
<td width=38%>[<a href="sref_7xfd.htm">SummaryKeywords</a>]</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_4lfd.htm">Comments</a></td>
<td width=38%>[<a href="sref_4lfd.htm">SummaryComments</a>] (For example, an installation database contains the logic and data required to install or modify the installation of a product on a user's computer.)</td>
<td width=38%>[<a href="sref_4lfd.htm">SummaryComments</a>] (For example, a transform is a set of changes to be applied to an installation database prior to processing the database. You can use transforms to create language versions, upgrades, and so on.)</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_80hl.htm">Template</a></td>
<td width=38%>Platform, default language ID, other language IDs.</td>
<td width=38%>Base platform, base language ID.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_7dyx.htm">Last Saved By</a></td>
<td width=38%>NULL</td>
<td width=38%>New platform, new language ID.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_1am1.htm">Revision Number</a></td>
<td width=38%>Product code and version</td>
<td width=38%>Package code for an installer package.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_0395.htm">Last Printed</a></td>
<td width=38%>Installation time.</td>
<td width=38%>NULL</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_2ut5.htm">Create Time/Date</a></td>
<td width=38%>Time and date stamped at Microsoft before shipment.</td>
<td width=38%>Time and date stamped at Microsoft before shipment.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_0hkp.htm">Last Saved Time/Date</a></td>
<td width=38%>NULL</td>
<td width=38%>NULL</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_8eex.htm">Page Count</a></td>
<td width=38%>The installer version.</td>
<td width=38%>The installer version.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_8gzd.htm">Source Type</a></td>
<td width=38%>Type code.</td>
<td width=38%>NULL</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_6r5l.htm">Character Count</a></td>
<td width=38%>NULL</td>
<td width=38%>Transform restrictions.</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_4qrd.htm">Creating Application</a></td>
<td width=38%>The installer</td>
<td width=38%>The installer</td>
</tr>
<tr valign=top>
<td width=24%><a href="sref_2mbd.htm">Security</a></td>
<td width=38%>2 (read-only recommended.)</td>
<td width=38%>4 (read-only enforced)</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_using_the_summary_information_stream"></a>Using the Summary Information Stream</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section describes which functions in the Microsoft  Windows  installer API can call the summary information stream properties. For more information on the summary information stream and how it works with databases, see <a href="sovr_7q99.htm">About the Summary Information Stream</a>. </p>
<p>
<b>Note</b>&nbsp;&nbsp;It is important to remember that the installer contains different types of databases, and some properties of the summary information stream have different meanings with different databases.</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database and thus cannot be changed. Additionally, it will not be persisted with the database. To create or modify the summary information for the output database it must be closed and re-opened.</p>
<p>
The following steps describe how to use the summary information stream functions: </p>
<h5><img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use the summary information stream properties</h5>
<ol>
<li>
Obtain a handle to the summary information stream database by calling the <a href="qref_5dpq.htm"><b>MsiGetSummaryInformation</b></a> function.</li>
<li>
Call the <a href="qref_4z5g.htm"><b>MsiSummaryInfoGetPropertyCount</b></a> function to obtain the number of existing properties.</li>
<li>
Call the <a href="qref_1ypl.htm"><b>MsiSummaryInfoGetProperty</b></a> function to view a single summary information property.</li>
<li>
Call the <a href="qref_9bax.htm"><b>MsiSummaryInfoSetProperty</b></a> function to set a single property</li>
<li>
Call the <a href="qref_65ys.htm"><b>MsiSummaryInfoPersist</b></a> function to save the summary information property. </li>
</ol>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_summary_information_stream_reference"></a>Summary Information Stream Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following list shows the summary information stream properties for the Microsoft  Windows  installer: 
<ul>
<li>
<a href="sref_76k9.htm">Author Summary Property</a></li>
<li>
<a href="sref_6r5l.htm">Character Count Summary Property</a></li>
<li>
<a href="sref_4r5l.htm">Codepage Summary Property</a></li>
<li>
<a href="sref_4lfd.htm">Comments Summary Property</a></li>
<li>
<a href="sref_2ut5.htm">Create Time Date Summary Property</a></li>
<li>
<a href="sref_4qrd.htm">Creating Application Summary Property</a></li>
<li>
<a href="sref_7xfd.htm">Keywords Summary Property</a></li>
<li>
<a href="sref_0395.htm">Last Printed Property</a></li>
<li>
<a href="sref_7dyx.htm">Last Saved By Summary Property</a></li>
<li>
<a href="sref_0hkp.htm">Last Saved Time Date Summary Property</a></li>
<li>
<a href="sref_8gzd.htm">Msi Source Type Summary Property</a></li>
<li>
<a href="sref_8eex.htm">Page Count Summary Property</a></li>
<li>
<a href="sref_1am1.htm">Revision Number Summary Property</a></li>
<li>
<a href="sref_2mbd.htm">Security Summary Property</a></li>
<li>
<a href="sref_0b5l.htm">Subject Summary Property</a></li>
<li>
<a href="sref_80hl.htm">Template Summary Property</a></li>
<li>
<a href="sref_82rd.htm">Title Summary Property</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_author_summary_property"></a>Author Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Author Summary Property is used to convey to a file browser who initially created an installer database. This value is typically set from the installer property <a href="pref_9z09.htm">Manufacturer</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_character_count_summary_property"></a>Character Count Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Character Count Summary property is only used in transforms. The upper word contains the transform validation flags. The lower word contains the transform error condition flags.  </p>
<p>&nbsp;</p>

<h1><a name="_msi_codepage_summary_property"></a>Codepage Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Codepage Summary property identifies the codepage used to display the Summary Information.</p>
<p>&nbsp;</p>

<h1><a name="_msi_comments_summary_property"></a>Comments Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Comments Summary Property is used to convey the general purpose of the installer database. By default the value for this summary property is set to the following:</p>
<p>
"This installer database contains the logic and data required to install &lt;<i>product name</i>&gt;."</p>
<p>
where &lt;<i>product name</i>&gt; is the name of the product being installed. In general the value for this summary property only changes in the product name, nothing else. But for localization reasons and to allow the modification of this summary property.</p>
<p>&nbsp;</p>

<h1><a name="_msi_create_time_date_summary_property"></a>Create Time/Date Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Create Time/Date Summary Property is used to convey when the installer database was created. This property is set at Microsoft as part of the authoring process and never changes.</p>
<p>&nbsp;</p>

<h1><a name="_msi_creating_application_summary_property"></a>Creating Application Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Creating Application Summary Property is used to convey what application created the installer database. In general the value for this summary property is "Microsoft installer". However, over time corporate customers and/or OEMs may use other tools, via COM, to create installer databases.</p>
<p>&nbsp;</p>

<h1><a name="_msi_keywords_summary_property"></a>Keywords Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This summary property is for use by file browsers to hold keywords that can permit the database file to be found in a keyword search. The set of keywords typically will include "Installer" as well as product-specific keywords, and may be localized.</p>
<p>&nbsp;</p>

<h1><a name="_msi_last_printed_property"></a>Last Printed Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The installer does not use this property, it is NULL in all databases.</p>
<p>&nbsp;</p>

<h1><a name="_msi_last_saved_by_summary_property"></a>Last Saved By Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
In an installer database the Last Saved By Summary Property is used to keep track of who made the last changes to the database. Initially the value for this summary property is set to NULL. However, should a user choose to make modifications to an installation the value for this summary property changes. The value is set to the value of the <a href="pref_9shl.htm">USERNAME</a> property defined by the installer.
<dl>
<dt>
<b>Transform</b></dt>
<dd>
In a transform this property is used for a different purpose. It contains the platform and language ID(s) that a database should have after it has been transformed. In other words, it specifies what the Template property should be set to in the new database. See the description of the <a href="sref_80hl.htm">Template</a> property for information about the form of this property.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_last_saved_time_date_summary_property"></a>Last Saved Time/Date Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Last Saved Time/Date Summary Property is used to convey when the last time the installer database was modified. Each time a user changes an installation the value for this summary property is updated to the current system time/date at the time the installer database was saved. Initially the value for this summary property is set to NULL to indicate that no changes have yet been made.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msi_source_type_summary_property"></a>MSI Source Type Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MSI Source Type Summary Property is used to indicate the type of source file image. If this property is not present, it defaults to 0. The location of the image is determined by the <code>SOURCEFILE</code> property, which defaults to the location of the installer package. Note that this property is stored in place of the standard Count property.
<ol>
<li>
Tree image matching the Directory table, long file names.</li>
<li value=1>
Tree image matching the Directory table, short file names.</li>
<li>
Cabinet and files matching the Media table, long file names.</li>
<li>
Cabinet and files matching the Media table, short file names.</li>
</ol>
<p>&nbsp;</p>

<h1><a name="_msi_page_count_summary_property"></a>Page Count Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Page Count Summary Property contains the minimum installer version required. It is stored as an integer in the form: Major * 100 + minor.</p>
<p>&nbsp;</p>

<h1><a name="_msi_revision_number_summary_property"></a>Revision Number Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Revision Number Summary Property contains the package code for an installer package.</p>
<p>&nbsp;</p>

<h1><a name="_msi_security_summary_property"></a>Security Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Security Summary Property is used to convey whether the file should be opened read-only or read-write. Possible values are:
<ol>
<li>
No restriction</li>
<li value=1>
Read-only recommended</li>
<li>
Read-only enforced</li>
</ol>
<p>&nbsp;</p>

<h1><a name="_msi_subject_summary_property"></a>Subject Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This summary property is used to convey to a file browser the product that can be installed using the logic and data in this installer database. For example, the value of the summary property for Microsoft  Office 97 would be; "Microsoft Office 97 Professional". This value is typically set from the installer property <a href="pref_52m1.htm">ProductName</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_template_summary_property"></a>Template Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Template summary indicates the platform and language versions supported by the database.</p>
<p>
The syntax of the Template summary info property is:</p>
<p>
[platform property][,platform property][,...];[language id][,language id][,...].</p>
<p>
For example, the following are all valid values for the Template Summary property:
<ul>
<li>
Alpha,Intel;1033</li>
<li>
Intel,Alpha;1033</li>
<li>
Alpha;1033</li>
<li>
Intel;1033</li>
<li>
;1033</li>
<li>
;</li>
<li>
Alpha;1033,2046</li>
<li>
Intel ;1033,2046</li>
<li>
Intel;0</li>
</ul>
<p>
If the current platform doesn't match one of the platforms specified then the installer will not process the package. Not specifying a platform implies that the package is platform-independent.</p>
<p>
Specifying a language ID of 0 indicates that a package is language-neutral.</p>
<p>
There are variations of this property depending on whether it is in a source installer database or a transform.
<dl>
<dt>
<b>Source Installer Database</b></dt>
<dd>
In a source installer database any number of languages may be specified. If more than one language is specified then a multi-language install will be done. Listing only one language specifies a single-language install.</dd>
<dt>
<b>Transform</b></dt>
<dd>
In a transform file only one language may be specified. The specified platform and language are used to determine whether a transform can be applied to a particular database. The platform property and the language property can be left blank if no transform restriction relies on them to validate the transform.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_title_summary_property"></a>Title Summary Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The Title Summary Property is used to convey what the *.msi file is, so the value for this summary property is either "Installation Database" or "Transform", and it never changes.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_automation_interface"></a>Automation Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The material in this section is intended for developers who are writing their own setup programs and for developers who want to learn more about the Microsoft  Windows  installer database tables. For general information on the installer, see <a href="over_2fjm.htm">About Windows Installer</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_about_the_automation_interface"></a>About the Automation Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To be written</p>
<p>&nbsp;</p>

<h1><a name="_msi_using_the_automation_interface"></a>Using the Automation Interface</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To be written</p>
<p>
</p>
<p>&nbsp;</p>

<h2><a name="_msi_access_to_c_libraries"></a>Access to C++ Libraries</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
An MsiInstall object must be created initially to load the automation support that is required to access the installer components through COM. This object provides wrappers to create the top-level objects and access their methods. These wrappers simply provide parameter translations to expose the installer functions in a manner consistent with Microsoft  Visual Basic  without changing the behavior of the methods. When possible, a pair of Get and Set C++ methods are exposed to Visual Basic as a single property. Where appropriate, C++ methods taking an index argument are exposed as an indexed property. Many C++ methods return the result through a parameter because the return value is used for the error return. However, in Visual Basic, errors are handled by a separate mechanism, and the result is always passed in the return value.</p>
<p>&nbsp;</p>

<h2><a name="_msi_creating_the_msiinstall_object"></a>Creating the MsiInstall Object</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
For OLE to access the automation, the DLL must be self-registered. The OLE ProgID used to create the MsiInstall object is <b>Msi.ApiAutomation</b>. If the DEBUG build automation is registered, the ProgID <b>Msi.ApiAutoDebug</b> is registered as well. If the SHIP build is registered last, both may be used.</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_automation_interface_reference"></a>Automation Interface Reference</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This section contains reference material for the Microsoft  Windows  installer objects.
<ul>
<li>
<a href="vref_2yes.htm">MsiDatabase Object</a></li>
<li>
<a href="vref_6c38.htm">MsiEngine Object</a></li>
<li>
<a href="vref_5s8k.htm">MsiInstall Object</a></li>
<li>
<a href="vref_6z78.htm">MsiRecord Object</a></li>
<li>
<a href="vref_4xmc.htm">MsiSummaryInfo Object</a></li>
<li>
<a href="vref_9lis.htm">MsiUIPreview Object</a></li>
<li>
<a href="vref_07qs.htm">MsiView Object</a></li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_msidatabase_object"></a><a name="helpid_msidatabase_object"></a>MsiDatabase Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiDatabase object accesses an installer database.</p>
<p>
Before the MsiDatabase object is released (by going out of scope or by setting the object variable to Nothing), the <a href="vref_6jdw.htm"><b>Commit</b> method</a> must be called to write out all persistent changes, else an implicit rollback is performed at object destruction.</p>
<p>
<b>Query API Sequencing</b></p>
<p>
The normal course of data access is summarized below:
<ol>
<li>
The client obtains a database object (MsiInstall.OpenDatabase).</li>
<li>
<b>Database.OpenView</b> is called, specifying a SQL query.</li>
<li>
<b>View.Execute</b> is called, supplying any parameters in an MsiRecord object.</li>
<li>
<b>View.Fetch</b> is called repeatedly and returns MsiRecord objects until exhausted.</li>
<li>
<b>View.Modify</b> may be called to update a fetched record.</li>
<li>
<b>View.Close</b> is called, which releases the query and unfetched records.</li>
<li>
<b>Database.Commit</b> is called to persist any database updates.</li>
</ol>
<h4>Properties</h4>
<p>
<a href="vref_40e1.htm"><b>DatabaseState</b></a></p>
<p>
<a href="vref_69nj.htm"><b>SummaryInformation</b></a></p>
<p>
<a href="vref_0sqh.htm"><b>TablePersistent</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_9h2c.htm"><b>ApplyTransform</b></a></p>
<p>
<a href="vref_6jdw.htm"><b>Commit</b></a></p>
<p>
<a href="vref_1mw4.htm"><b>CreateTransformSummaryInfo</b></a></p>
<p>
<a href="vref_45d0.htm"><b>EnableUIPreview</b></a></p>
<p>
<a href="vref_06uc.htm"><b>Export</b></a></p>
<p>
<a href="vref_2of8.htm"><b>GenerateTransform</b></a></p>
<p>
<a href="vref_795w.htm"><b>Import</b></a></p>
<p>
<a href="vref_21es.htm"><b>Merge</b></a></p>
<p>
<a href="vref_5tb8.htm"><b>OpenView</b></a></p>
<p>
<a href="vref_1a1w.htm"><b>PrimaryKeys</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_databasestate_property"></a><a name="helpid_msidatabase_databasestate"></a>DatabaseState Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>DatabaseState</b> property of the <a href="vref_2yes.htm">MsiDatabase object</a>. This property returns the persistence state of the database as one of enum idsEnum:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=18%>idsRead</td>
<td width=13%>= 0</td>
<td width=69%>Database opens read-only; changes are not saved.</td>
</tr>
<tr valign=top>
<td width=18%>IdsWrite</td>
<td width=13%>= 1</td>
<td width=69%>Database is fully operational for read and write.</td>
</tr>
</table><br>
<h4>Syntax</h4>
<p>
<i>object</i><b>.DatabaseState</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_summaryinformation_property_msidatabase_object_"></a><a name="helpid_msidatabase_summaryinformation"></a>SummaryInformation Property (MsiDatabase Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>SummaryInformation</b> property of the <a href="vref_2yes.htm">MsiDatabase object</a>. This property returns an <a href="vref_4xmc.htm">MsiSummaryInfo object</a> that can be used to examine, update, and add properties to the SummaryInformation stream.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.SummaryInformation(</b><i>maxProperties</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>maxProperties</i></dt>
<dd>
Required maximum number of properties to be added or modified, used solely to allocate sufficient working memory during the stream generation. It is not required to actually store this number of properties. A value of zero prevents the stream from being updated and must be used if the database is opened read-only.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_tablepersistent_property"></a><a name="helpid_msidatabase_tablepersistent"></a>TablePersistent Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>TablePersistent</b> property of the <a href="vref_2yes.htm">MsiDatabase object</a>. This property returns the persistence state of the table as one of enum iecEnum:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=20%>iecFalse</td>
<td width=13%>= 0</td>
<td width=67%>Table is temporary.</td>
</tr>
<tr valign=top>
<td width=20%>IecTrue</td>
<td width=13%>= 1</td>
<td width=67%>Table is persistent.</td>
</tr>
<tr valign=top>
<td width=20%>IecNone</td>
<td width=13%>= 2</td>
<td width=67%>Table is not present in the database.</td>
</tr>
<tr valign=top>
<td width=20%>IecError</td>
<td width=13%>= 3</td>
<td width=67%>Invalid or missing table name.</td>
</tr>
</table><br>
<h4>Syntax</h4>
<p>
<i>object</i><b>.TablePersistent </b><i>table</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>table</i></dt>
<dd>
Required name of the table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_applytransform_method"></a><a name="helpid_msidatabase_applytransform"></a>ApplyTransform Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ApplyTransform</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method applies the given transform to this database.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ApplyTransform </b><i>storage</i><b>, </b><i>errorConditions</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>storage</i></dt>
<dd>
Required MsiDatabase object containing the transform.</dd>
<dt>
<i>errorConditions</i></dt>
<dd>
The error conditions that should be suppressed, specified as an integer combination of the values below.
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=37%>iteAddExistingRow</td>
<td width=63%>Adding a row that already exists.</td>
</tr>
<tr valign=top>
<td width=37%>iteDelNonExistingRow</td>
<td width=63%>Deleting a row that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=37%>iteAddExistingTable</td>
<td width=63%>Adding a table that already exists.</td>
</tr>
<tr valign=top>
<td width=37%>iteDelNonExistingTable</td>
<td width=63%>Deleting a table that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=37%>iteUpdNonExistingRow</td>
<td width=63%>Updating a row that doesn't exist.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>ApplyTransform</b> method delays transforming tables until the last possible moment. The steps taken in <b>ApplyTransform</b> are to immediately transform the table and column catalogs for the database. The table and column catalogs are updated according to what table is added or deleted and what column is added (no deletion of columns is allowed). If a table is currently loaded in memory and needs to be transformed, it is transformed then. Else, the table state is set to that requiring a transform so that when the table is loaded, or when the database is committed, the transform is applied. Transform in this instance means that the actual (row) data of the table is added, deleted, or updated.</p>
<p>&nbsp;</p>

<h1><a name="_msi_commit_method"></a><a name="helpid_msidatabase_commit"></a>Commit Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Commit</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method finalizes the persistent form of the database. All persistent data is written to the writeable database. No temporary columns or rows are written. This method has no effect on a database opened read-only. This method can be called multiple times to save the current state of tables loaded into memory. When the database is finally closed, any changes made subsequent to the last Commit are rolled back. This method is normally called prior to shutdown when all database changes have been finalized.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Commit</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_createtransformsummaryinfo_method"></a>CreateTransformSummaryInfo Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the CreateTransformSummaryInfo method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method creates and populates the summary information stream of an existing transform file. This method fills in the properties with the base and reference ProductCode and ProductVersion properties.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.CreateTransformSummaryInfo </b><i>reference<b>, </b>storage<b>, </b>long errorConditions<b>, </b>long validation</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
Database that includes the changes.</dd>
<dt>
<i>reference</i></dt>
<dd>
Required database that does not include the changes.</dd>
<dt>
<i>storage</i></dt>
<dd>
Required MsiDatabase object where the transform is to be stored.</dd>
<dt>
<i>errorConditions</i></dt>
<dd>
Required error conditions that should be suppressed when the transform is applied. Choose either iteNone   none of the following conditions   or combine one or more of the following:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=36%>iteAddExistingRow</td>
<td width=64%>Adding a row that already exists.</td>
</tr>
<tr valign=top>
<td width=36%>IteDelNonExistingRow</td>
<td width=64%>Deleting a row that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=36%>IteAddExistingTable</td>
<td width=64%>Adding a table that already exists.</td>
</tr>
<tr valign=top>
<td width=36%>IteDelNonExistingTable</td>
<td width=64%>Deleting a table that doesn't exist.</td>
</tr>
<tr valign=top>
<td width=36%>IteUpdNonExistingRow</td>
<td width=64%>Updating a row that doesn't exist</td>
</tr>
</table><br>

</dd>
<dt>
<i>validation</i></dt>
<dd>
Required when the transform is applied to a database; shows which properties should be validated to verify that this transform can be applied to the database. The properties are all contained in the <a href="sovr_43w4.htm">Summary Information Stream Property Set</a>.
<p>
Choose either itvNone   validate no properties   or combine one or more of the following:

<table cellspacing=4 cols=2>
<tr valign=top>
<td width=28%>itvLanguage</td>
<td width=72%>Default language must match base database.</td>
</tr>
<tr valign=top>
<td width=28%>ItvProduct</td>
<td width=72%>Product must match base database.</td>
</tr>
<tr valign=top>
<td width=28%>ItvPlatform</td>
<td width=72%>Platform must match base database.</td>
</tr>
</table><br>


<p>
To validate product version, first choose one or more of these three flags to indicate how much of the version is to be verified.

<table cellspacing=4 cols=2>
<tr valign=top>
<td width=28%>itvMajVer</td>
<td width=72%>Check major version only.</td>
</tr>
<tr valign=top>
<td width=28%>ItvMinVer</td>
<td width=72%>Check major and minor version only.</td>
</tr>
<tr valign=top>
<td width=28%>ItvUpdVer</td>
<td width=72%>Check major, minor, and update versions.</td>
</tr>
</table><br>


<p>
Then choose one of the following to indicate the required relationship between the product version of the database the transform is being applied to and that of the base database.

<table cellspacing=4 cols=3>
<tr valign=top>
<td width=30%>itvLess</td>
<td width=35%>Applied db version </td>
<td width=35%>&lt;  base db version</td>
</tr>
<tr valign=top>
<td width=30%>itvLessOrEqual</td>
<td width=35%>Applied db version </td>
<td width=35%>&lt;= base db version</td>
</tr>
<tr valign=top>
<td width=30%>itvEqual</td>
<td width=35%>Applied db version</td>
<td width=35%>=  base db version</td>
</tr>
<tr valign=top>
<td width=30%>itvGreaterOrEqual</td>
<td width=35%>Applied db version </td>
<td width=35%>&gt;= base db version</td>
</tr>
<tr valign=top>
<td width=30%>itvGreater</td>
<td width=35%>Applied db version </td>
<td width=35%>&gt;  base db version</td>
</tr>
</table><br>


</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_enableuipreview_method"></a><a name="helpid_msidatabase_enableuipreview"></a>EnableUIPreview Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>EnableUIPreview</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method facilitates the authoring of dialog boxes and billboards by providing the support needed to view UI dialog boxes stored in the installer database. The method starts the preview mode by returning a preview object. The preview mode ends when the preview object is released.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.EnableUIPreview</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_export_method"></a><a name="helpid_msidatabase_export"></a>Export Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Export</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method copies the structure and data from a specified table to a text archive file.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Export </b><i>table<b>, </b>path<b>, </b>file</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>table</i></dt>
<dd>
Required name of the database table; case-sensitive if using the MSI database.</dd>
<dt>
<i>path</i></dt>
<dd>
Required MsiPath object set to the folder where the text file will be placed.</dd>
<dt>
<i>file</i></dt>
<dd>
Required name of the file to be created. This does not include the folder, as that must be set in the path object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_generatetransform_method"></a><a name="helpid_msidatabase_generatetransform"></a>GenerateTransform Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>GenerateTransform</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. A transform is a way of recording changes to a database without altering the original database. The <b>GenerateTransform</b> method creates a transform which, when applied to the <i>object</i> database, results in the <i>reference</i> database. The transform is stored in the <i>storage</i> object.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.GenerateTransform </b><i>reference<b>, </b>storage<b>, </b>long Reserved1<b>, </b>long Reserved2</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
Database that includes the changes.</dd>
<dt>
<i>reference</i></dt>
<dd>
Required database that does not include the changes.</dd>
<dt>
<i>storage</i></dt>
<dd>
Required MsiDatabase object where the transform is to be stored. This is optional.</dd>
<dt>
<i>Reserved1</i></dt>
<dd>
Reserved argument that is not used.</dd>
<dt>
<i>Reserved2</i></dt>
<dd>
Reserved argument that is not used.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For tables that exist in both databases, the only difference between the two schemas that is allowed is the addition of columns to the end of the reference table. You cannot add primary key columns to a table or change the order, names, or column definitions of the existing columns as defined in the base table. If neither table contained data, and columns were removed from the reference table, the resulting table would be identical to the base table.</p>
<p>
This method returns a boolean value; True if a transform was generated, False if a transform was not generated due to no differences. An error is generated if the method failed.</p>
<p>
If <i>storage </i>is NULL, you can test whether two databases are identical without creating a transform. If the databases are identical, ERROR_NO_DATA is returned, NOERROR is returned if differences are found.</p>
<p>&nbsp;</p>

<h1><a name="_msi_import_method"></a><a name="helpid_msidatabase_import"></a>Import Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Import</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method imports a database table from a text archive file, dropping any existing table.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Import</b>(<i>path<b>, </b>file</i>)</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>path</i></dt>
<dd>
Required folder where the text file is present.</dd>
<dt>
<i>file</i></dt>
<dd>
Required name of the file to be imported. This does not include the folder, as that must be set in the path object. The table name is specified within the file.
</dd>
</dl>
<h4>See Also</h4>
<p>
<a href="qref_59pw.htm"><b>MsiDatabaseImport</b></a> </p>
<p>&nbsp;</p>

<h1><a name="_msi_merge_method"></a><a name="helpid_msidatabase_merge"></a>Merge Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Merge</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method merges the reference database with the base database.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Merge </b><i>reference</i><b>, </b><i>errorTable</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>reference</i></dt>
<dd>
Required MsiDatabase object to be merged into the base.</dd>
<dt>
<i>errorTable</i></dt>
<dd>
Optional name of a table to contain the names of the tables containing merge conflicts, the number of conflicting rows within the table, and a reference to the table with the merge conflict.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If no table is provided, the general error message provides the number of tables containing merge conflicts. Any table can be passed in, but all other columns must be nullable since the operation to update the <a href="tref_5dk5.htm">Error table</a> fails if a column is not nullable. A newly created table can be passed in as well since the <b>Merge</b> method automatically creates the columns it uses if merge conflicts are found. Two columns are used for presenting merge conflicts. The first column is the table name and the primary key column. The second column is the number of rows of that table that have merge failures.</p>
<p>
If tables of the same name in both databases do not match in the number of primary keys, the column types, the number of columns, or the column names, the <b>Merge</b> method fails and posts an error message stating what occurred.</p>
<p>
For the Error table to remain, the error handler must commit the database to which the Error table belongs. However, this commit should be done after using the third column to obtain the references to those tables where merge conflicts occurred.</p>
<p>&nbsp;</p>

<h1><a name="_msi_openview_method"></a><a name="helpid_msidatabase_openview"></a>OpenView Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>OpenView</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method returns an <a href="vref_07qs.htm">MsiView object</a> representing the query specified by a SQL string.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.OpenView(</b><i>sql</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>sql</i></dt>
<dd>
Required SQL query string.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For information about SQL syntax implemented in the installer, see <a href="qref_5j20.htm">SQL Syntax</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_primarykeys_method"></a><a name="helpid_msidatabase_primarykeys"></a>PrimaryKeys Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>PrimaryKeys</b> method of the <a href="vref_2yes.htm">MsiDatabase object</a>. This method returns an <a href="vref_6z78.htm">MsiRecord object</a> containing the table name in field 0 and the column names (comprising the primary keys) in succeeding fields corresponding to their column numbers. The field count of the record is the count of primary key columns.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.PrimaryKeys(</b><i>table</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiDatabase object.</dd>
<dt>
<i>table</i></dt>
<dd>
Required name of an existing table. An error is generated if the table does not exist.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The PrimaryKeys method cannot be used with the <a href="tref_2fl1.htm">_Tables table</a> or the <a href="tref_4rj9.htm">_Columns table</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msiengine_object"></a><a name="helpid_msiengine_object"></a>MsiEngine Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiEngine object controls the installation process. It opens the install database, which contains the installation tables and data. The MsiEngine object is associated with a standard set of action functions, each performing particular operations on data from one or more tables. Additional custom actions may be added for particular product installations. The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action. Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</p>
<h4>Properties</h4>
<p>
<a href="vref_8hh5.htm"><b>Application</b></a></p>
<p>
<a href="vref_0b5l.htm"><b>ComponentCurrentState</b></a></p>
<p>
<a href="vref_8kc9.htm"><b>ComponentRequestState</b></a></p>
<p>
<a href="vref_22d5.htm"><b>Database</b></a></p>
<p>
<a href="vref_9s3d.htm"><b>FeatureCost</b></a></p>
<p>
<a href="vref_9vqx.htm"><b>FeatureCurrentState</b></a></p>
<p>
<a href="vref_84xl.htm"><b>FeatureRequestState</b></a></p>
<p>
<a href="vref_7b7d.htm"><b>FeatureValidStates</b></a></p>
<p>
<a href="vref_2qqn.htm"><b>Language</b></a></p>
<p>
<a href="vref_53i1.htm"><b>Mode</b></a></p>
<p>
<a href="vref_98m7.htm"><b>Property</b></a></p>
<p>
<a href="vref_95o9.htm"><b>SourcePath</b></a></p>
<p>
<a href="vref_42yh.htm"><b>TargetPath</b></a></p>
<p>
<a href="vref_8ozd.htm"><b>VerifyDiskSpace</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_0sdg.htm"><b>DoAction</b></a></p>
<p>
<a href="vref_44v8.htm"><b>EvaluateCondition</b></a></p>
<p>
<a href="vref_3tlw.htm"><b>FormatRecord</b></a></p>
<p>
<a href="vref_3mlg.htm"><b>Message</b></a></p>
<p>
<a href="vref_9wro.htm"><b>Sequence</b></a></p>
<p>
<a href="vref_7esk.htm"><b>SetInstallLevel</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_application_property"></a><a name="helpid_msiengine_application"></a>Application Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Application</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For a list of common properties, see Property Summary.</p>
<p>&nbsp;</p>

<h1><a name="_msi_componentcurrentstate_property"></a><a name="helpid_msiengine_componentcurrentstate"></a>ComponentCurrentState Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ComponentCurrentState</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-only property returns the current installed state of the designated component. See the <a href="vref_8kc9.htm"><b>ComponentRequestState</b> property</a> for state values.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ComponentCurrentState(</b><i>component</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>component</i></dt>
<dd>
Required string name of the requested component, primary key into the Component table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_componentrequeststate_property"></a><a name="helpid_msiengine_componentrequeststate"></a>ComponentRequestState Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ComponentRequestState</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This property is used to obtain or request a change in the Action state of a row in the Component table. </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ComponentRequestState(</b><i>component</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>component</i></dt>
<dd>
Required string name of the component item, primary key of the Component table.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Selection States</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=22%>Null (empty)</td>
<td width=12%>=</td>
<td width=66%>Requests that no action be taken for this item.</td>
</tr>
<tr valign=top>
<td width=22%>iisAbsent</td>
<td width=12%>= 2:</td>
<td width=66%>Item is to be removed.</td>
</tr>
<tr valign=top>
<td width=22%>iisLocal</td>
<td width=12%>= 3:</td>
<td width=66%>Item is to be installed locally.</td>
</tr>
<tr valign=top>
<td width=22%>iisSource</td>
<td width=12%>= 4:</td>
<td width=66%>Item is to be installed and run from the source media.</td>
</tr>
<tr valign=top>
<td width=22%>iisDefault</td>
<td width=12%>= 5:</td>
<td width=66%>If installed, the item is to be reinstalled in the same state.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_database_property"></a><a name="helpid_msiengine_database"></a>Database Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Database</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-only property returns the database for the current install session as an <a href="vref_2yes.htm">MsiDatabase object</a>.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Database</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_featurecost_property"></a><a name="helpid_msiengine_featurecost"></a>FeatureCost Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FeatureCost</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This property returns the total amount of disk space (in units of 512 bytes) required by the specified feature and that of all the feature's parent features (up to the root of the Feature table). For each feature, the total cost is made up of the disk costs attributed to every component linked to the feature.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FeatureCost(</b><i>feature<b>,</b> costTree<b>, </b>state</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>feature</i></dt>
<dd>
Required string name of the feature item whose cost is to be retrieved.</dd>
<dt>
<i>costTree</i></dt>
<dd>
Required portion of the feature tree branch to cost, one of the following:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=31%>ictSelfOnly</td>
<td width=69%>= 0</td>
</tr>
<tr valign=top>
<td width=31%>ictChildren</td>
<td width=69%>= 1 </td>
</tr>
<tr valign=top>
<td width=31%>ictParents</td>
<td width=69%>= 2 </td>
</tr>
<tr valign=top>
<td width=31%>ictProduct</td>
<td width=69%>= 3 (not supported at this time)</td>
</tr>
</table><br>

</dd>
<dt>
<i>state</i></dt>
<dd>
Required element that specifies the action state to use when determining the feature cost. For example, if Local is specified, <b>FeatureCost</b> returns the disk space required if the specified feature and all its parent features were to be installed locally.
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=31%>iisAbsent</td>
<td width=69%> = 2 </td>
</tr>
<tr valign=top>
<td width=31%>iisLocal</td>
<td width=69%> = 3 </td>
</tr>
<tr valign=top>
<td width=31%>iisSource</td>
<td width=69%> = 4</td>
</tr>
</table><br>

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_featurecurrentstate_property"></a><a name="helpid_msiengine_featurecurrentstate"></a>FeatureCurrentState Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FeatureCurrentState</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-only property returns the current installed state of the designated feature. See the <a href="vref_84xl.htm"><b>FeatureRequestState</b> property</a> for state values.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FeatureCurrentState(</b><i>feature</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>feature</i></dt>
<dd>
Required string name of the requested feature, and a primary key into the Feature table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_featurerequeststate_property"></a><a name="helpid_msiengine_featurerequeststate"></a>FeatureRequestState Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FeatureRequestState</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This property is used to obtain or request a change in the Select state of a feature's record (and of the feature's subrecords) in the Feature table. In turn, the Action state of all the components linked to the changed feature records are also updated appropriately, based on the new feature Select state. <b>FeatureRequestState</b> can also be used to configure all features at once by specifying the keyword ALL instead of a specific feature name.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FeatureRequestState(</b><i>strFeature</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>strFeature</i></dt>
<dd>
Required string specifying the name of the feature to be configured. Alternatively, the reserved word ALL (not case sensitive) can be used, indicating that all features should be configured to the state specified by the <i>iisState</i> parameter. For example, if iisAbsent is specified in the <i>iisState</i> parameter, and ALL is specified in the <i>strFeature</i> parameter, the entire product is removed.
</dd>
</dl>
<p>
<b>Selection States</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=21%>Null (empty)</td>
<td width=11%>= </td>
<td width=68%>Requests that no action be taken for this item.</td>
</tr>
<tr valign=top>
<td width=21%>iisAbsent</td>
<td width=11%>= 2:</td>
<td width=68%>Item is to be removed.</td>
</tr>
<tr valign=top>
<td width=21%>iisLocal</td>
<td width=11%>= 3:</td>
<td width=68%>Item is to be installed locally.</td>
</tr>
<tr valign=top>
<td width=21%>iisSource</td>
<td width=11%>= 4:</td>
<td width=68%>Item is to be installed and run from the source media.</td>
</tr>
<tr valign=top>
<td width=21%>iisDefault</td>
<td width=11%>= 5:</td>
<td width=68%>If the feature is installed, reinstall it in the same state.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <a href="vref_7esk.htm"><b>SetInstallLevel</b> method</a> must be called before calling <b>FeatureRequestState</b>.</p>
<p>
When <b>FeatureRequestState</b> is called, the Engine attempts to set the Action state of each component tied to the specified feature to the specified state, as best as possible. However, there are common situations when the request cannot be fully honored. For example, suppose a feature is tied to two components, Component A and Component B (via the FeatureComponents table). Also suppose that Component A is authored with a RunFromSource option of irsLocalOnly, and Component B is irsSourceOnly. In this case, if <b>FeatureRequestState</b> is called with a requested state of either iisLocal or iisSource, there is no way that the request can be fully honored for both components. However, both components can be turned ON with component A set to iisLocal and component B set to iisSource. </p>
<p>
If more than one feature is linked to a single component (a common scenario), the final Action state of that component is determined as follows: If at least one feature calls for the component to be installed locally, it is installed iisLocal. If at least one feature calls for the component to be run from the source media, it is installed iisSource'. If at least one feature calls for the removal of the component, the action state is iisAbsent. See the <a href="tref_0a91.htm">Feature table</a> for more information on how features are selected for installation.</p>
<p>&nbsp;</p>

<h1><a name="_msi_featurevalidstates_property"></a><a name="helpid_msiengine_featurevalidstates"></a>FeatureValidStates Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FeatureValidStates</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This property returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FeatureValidStates(</b><i>feature</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>feature</i></dt>
<dd>
Required string name of the feature item whose valid installation states are to be retrieved.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The return value is composed of bit flags as follows. Bit 0: if set, Local is a valid state. Bit 1: if set, Source is a valid state.</p>
<p>
The <b>GetFeatureValidStates</b> method determines state validity by querying all the components that are linked to the specified feature (without taking into account the current installed state of any component). If any of these components has a value of irsOptional in the RunFromSource column, or if at least one component is marked irstLocalOnly and at least one other component is marked irsSourceOnly, then both iisLocal and iisSource are valid states for the feature. If all components are set to irsLocalOnly, then iisLocal is the only valid state. If all components are set to irsSourceOnly, then iisSource is the only valid state.</p>
<p>&nbsp;</p>

<h1><a name="_msi_language_property_msiengine_object_"></a><a name="helpid_msiengine_language"></a>Language Property (MsiEngine Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Language</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-only property represents the numeric language ID used by the current install session.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Language</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_mode_property"></a><a name="helpid_msiengine_mode"></a>Mode Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Mode</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This property is a value representing the designated mode flag for the current install session. Most of the mode flags are read-only externally, but a few specified flags may be set as well.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Mode(</b><i>flag</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>flag</i></dt>
<dd>
</dd>
</dl>
<p>
Required integer value for the flag. Must be one of the following:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=39%>imfAdmin</td>
<td width=15%>=0</td>
<td width=46%>Admin mode install, else product install.</td>
</tr>
<tr valign=top>
<td width=39%>imfAdvertise</td>
<td width=15%>=1</td>
<td width=46%>Advertise mode of install.</td>
</tr>
<tr valign=top>
<td width=39%>imfMaintenance</td>
<td width=15%>=2</td>
<td width=46%>Maintenance mode database loaded.</td>
</tr>
<tr valign=top>
<td width=39%>imfRollbackEnabled</td>
<td width=15%>=3</td>
<td width=46%>Rollback is enabled.</td>
</tr>
<tr valign=top>
<td width=39%>imfLogEnabled</td>
<td width=15%>=4</td>
<td width=46%>Log file is active.</td>
</tr>
<tr valign=top>
<td width=39%>imfOperations</td>
<td width=15%>=5</td>
<td width=46%>Executing or spooling operations.</td>
</tr>
<tr valign=top>
<td width=39%>imfRebootAtEnd</td>
<td width=15%>=6</td>
<td width=46%>Reboot is needed (settable).</td>
</tr>
<tr valign=top>
<td width=39%>imfRebootNow</td>
<td width=15%>=7</td>
<td width=46%>Reboot is needed to continue installation (settable).</td>
</tr>
<tr valign=top>
<td width=39%>imfCabinet</td>
<td width=15%>=8</td>
<td width=46%>Installing files from cabinets and files using Media table.</td>
</tr>
<tr valign=top>
<td width=39%>imfSourceShortNames</td>
<td width=15%>=9</td>
<td width=46%>Source files use only short file names.</td>
</tr>
<tr valign=top>
<td width=39%>imfTargetShortNames</td>
<td width=15%>=10</td>
<td width=46%>Target files are to use only short file names line.</td>
</tr>
<tr valign=top>
<td width=39%>imfWindows9x</td>
<td width=15%>=12</td>
<td width=46%>Operating system is Windows 95 or Windows 98, but not Windows NT.</td>
</tr>
<tr valign=top>
<td width=39%>imfZawEnabled</td>
<td width=15%>=13</td>
<td width=46%>Operating system supports advertising of products.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_property_property_msiengine_object_"></a><a name="helpid_msiengine_property"></a>Property Property (MsiEngine Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Property</b> property of the <a href="vref_6c38.htm">MsiEngine object</a> This read-write property represents the string value of a named installer property, as maintained by the MsiEngine object in the in-memory Property table, or, if it is prefixed with a percent sign (<b><code>%</code></b>), the value of a system environment variable for the current process. Either string or integer values may be supplied. A non-existent property or environment variable is equivalent to its value being Null.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Property(</b><i>name</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>name</i></dt>
<dd>
Required case-sensitive name of a property, or a case-insensitive name of an environment variable prefixed by a percent sign (%).
</dd>
</dl>
<h4>Remarks</h4>
<p>
For a list of common properties, see Property Summary.</p>
<p>&nbsp;</p>

<h1><a name="_msi_sourcepath_property"></a><a name="helpid_msiengine_sourcepath"></a>SourcePath Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>SourcePath</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-only property provides the full path to the designated folder on the source media or server image.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.SourcePath(</b><i>folder</i>)</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>folder</i></dt>
<dd>
Required case-sensitive name of a folder property as specified by a primary key of the Directory database table. An error is generated if the folder does not exist.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_targetpath_property"></a><a name="helpid_msiengine_targetpath"></a>TargetPath Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>TargetPath</b> property of the <a href="vref_6c38.htm">MsiEngine object</a>. This read-write property provides the full path to the designated folder on the installation target drive.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.TargetPath(</b><i>folder</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>folder</i></dt>
<dd>
Required case-sensitive name of a folder property as specified by a primary key of the Directory database table. An error is generated if the folder does not exist.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_verifydiskspace_property"></a><a name="helpid_msiengine_verifydiskspace"></a>VerifyDiskSpace Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.VerifyDiskSpace</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For a list of common properties, see Property Summary.</p>
<p>&nbsp;</p>

<h1><a name="_msi_doaction_method"></a><a name="helpid_msiengine_doaction"></a>DoAction Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>DoAction</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method executes the action function corresponding to the name supplied. If the name is not recognized by the engine as a built-in action or as a custom action in the CustomAction table, the name is passed to the <b>DoAction</b> method of the MsiHandler object, which may either invoke a function or a dialog box. If a Null action name is supplied, the engine uses the uppercase value of the ACTION property as the action to perform. If no property value is defined, the default action is performed, currently defined as INSTALL. This method returns an integer enumeration.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.DoAction(</b><i>action</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>action</i></dt>
<dd>
Required string name of the action to execute. Case-sensitive.
</dd>
</dl>
<h4>Remarks</h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=27%>iesNoAction</td>
<td width=10%>= 0</td>
<td width=63%>Action not invoked, most likely does not exist.</td>
</tr>
<tr valign=top>
<td width=27%>iesSuccess</td>
<td width=10%>= 1</td>
<td width=63%>IDOK, completed actions successfully.</td>
</tr>
<tr valign=top>
<td width=27%>iesUserExit</td>
<td width=10%>= 2</td>
<td width=63%>IDCANCEL, user terminated prematurely.</td>
</tr>
<tr valign=top>
<td width=27%>iesFailure</td>
<td width=10%>= 3</td>
<td width=63%>IDABORT, unrecoverable error occurred.</td>
</tr>
<tr valign=top>
<td width=27%>iesSuspend</td>
<td width=10%>= 4</td>
<td width=63%>IDRETRY, sequence suspended, to be resumed later.</td>
</tr>
<tr valign=top>
<td width=27%>iesFinished</td>
<td width=10%>= 5</td>
<td width=63%>IDIGNORE, skip remaining actions, not an error.</td>
</tr>
<tr valign=top>
<td width=27%>iesWrongState</td>
<td width=10%>= 6</td>
<td width=63%>Calling sequence error, not in initialized state.</td>
</tr>
<tr valign=top>
<td width=27%>iesBadActionData</td>
<td width=10%>= 7</td>
<td width=63%>Invalid action table condition or missing custom action.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_evaluatecondition_method"></a><a name="helpid_msiengine_evaluatecondition"></a>EvaluateCondition Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>EvaluateCondition</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method evaluates a logical expression containing symbols and values and returns an integer of the enumeration iecEnum.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.EvaluateCondition(</b><i>condition</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>condition</i></dt>
<dd>
Required string containing the logical expression. See <a href="qref_6je6.htm"><b>MsiEvaluateCondition</b></a> for the expression syntax.
</dd>
</dl>
<h4>Remarks</h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=20%>iecFalse</td>
<td width=9%>= 0</td>
<td width=71%>Expression evaluates to False.</td>
</tr>
<tr valign=top>
<td width=20%>iecTrue</td>
<td width=9%>= 1</td>
<td width=71%>Expression evaluates to True.</td>
</tr>
<tr valign=top>
<td width=20%>iecNone</td>
<td width=9%>= 2</td>
<td width=71%>Expression is not present; caller decides interpretation.</td>
</tr>
<tr valign=top>
<td width=20%>iecError</td>
<td width=9%>= 3</td>
<td width=71%>Syntax error in expression; cannot be evaluated.</td>
</tr>
</table><br>
<p>
<b>Feature and Component State Values</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=28%>2 (iisAbsent)</td>
<td width=72%>Feature or component is not present.</td>
</tr>
<tr valign=top>
<td width=28%>3 (iisLocal) </td>
<td width=72%>Feature or component is on a local machine.</td>
</tr>
<tr valign=top>
<td width=28%>4 (iecSource </td>
<td width=72%>Feature or component runs from source.</td>
</tr>
<tr valign=top>
<td width=28%>(Null value) </td>
<td width=72%>No action to be taken on feature or component.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;These states are not set until the <a href="vref_7esk.htm"><b>SetInstallLevel</b> method</a> is called, either directly or by the CostFinalize action. Therefore, state checking is generally only useful in conditional expression in an action sequence table.</p>
<p>&nbsp;</p>

<h1><a name="_msi_formatrecord_method"></a><a name="helpid_msiengine_formatrecord"></a>FormatRecord Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FormatRecord</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method returns a formatted string from a template and record data.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FormatRecord(</b><i>record</i>)</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>record</i></dt>
<dd>
Required MsiRecord object containing a template and data to be formatted. The template string must be set in field 0 followed by any referenced data parameters.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>FormatRecord</b> method uses the following format process.</p>
<p class=indent1>
Parameters to be formatted are enclosed in square brackets [..]. The square brackets can be iterated because the substitutions are resolved from inside out.</p>
<p class=indent1>
If a part of the string is enclosed in curly braces { } and contains no square brackets, the part is left unchanged, including the curly braces.</p>
<p class=indent1>
If a part of the string is enclosed in curly braces and contains one or more property names, and if all the properties are found, the text (with the resolved substitutions) is displayed without the curly braces. If any of the properties are not found, all the text in the curly braces and the braces themselves are removed.</p>
<p>
<img src="mk:@MSITStore:C:/Program Files (x86)/Microsoft Visual Studio/MSDN98/98VSa/1033/MSI.chm::/devdoc/good/msi/../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To format strings using the FormatRecord method
<ol>
<li>
The numeric parameters are substituted by replacing the marker with the value of the corresponding record field, with missing or Null values producing no text.</li>
<li>
The string that results is processed by replacing the non-record parameters with the corresponding values, as noted in the following descriptions.<ul>
<li>
If a substring of the form "[propertyname]" is encountered, it is replaced by the value of the property.</li>
<li>
If a substring of the form "[%environmentvariable]" is found, the value of the environment variable is substituted. </li>
<li>
If a substring of the form "[#filekey]" is found, it is replaced by the full path of the file, with the value <i>filekey</i> used as a key into the File table. </li>
<li>
If a substring of the form "[$componentkey]" is found, it is replaced by the installation directory of the component, with the value <i>componentkey</i> used as a key into the Component table, taking into account the Component.Action column state. If the component is selected to be installed locally, it is replaced by the target directory. If the component is selected to run from source, it is replaced by the source directory. If the component is not selected, or if the component is missing, it is replaced by a Null string.</li>
<li>
If a substring of the form "[\c]" is found, it is replaced by the character without any further processing. Only the first character after the backslash is kept; everything else is removed. </li>
</ul>
</li>
</ol>
<p>&nbsp;</p>

<h1><a name="_msi_message_method"></a><a name="helpid_msiengine_message"></a>Message Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Message</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method performs any enabled logging operations and defers execution to the UI handler object associated with the engine. Logging may be selectively enabled for the various message types. See the <a href="vref_7mhw.htm"><b>EnableLog</b> method</a>. If record field 0 contains a formatting string, it is used to format the data in the other fields. Else if the message is an error, warning, or user message, an attempt is made to find a message template in the Error table for the current database using the error number found in field 1 of the record for message types and return values.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Message(</b><i>kind<b>, </b>record</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>kind</i></dt>
<dd>
Required message type; one of imtEnum.</dd>
<dt>
<i>record</i></dt>
<dd>
Required MsiRecord object containing a message-specific field.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Processing by Message Types</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=28%>imtOutOfMemory</td>
<td width=72%>Logged if 'm' in LOGMODE; passed to handler.</td>
</tr>
<tr valign=top>
<td width=28%>imtError</td>
<td width=72%>Logged if 'e' in LOGMODE; passed to handler.</td>
</tr>
<tr valign=top>
<td width=28%>imtWarning</td>
<td width=72%>Logged if 'w' in LOGMODE; passed to handler.</td>
</tr>
<tr valign=top>
<td width=28%>imtUser</td>
<td width=72%>Logged if 'u' in LOGMODE; passed to handler.</td>
</tr>
<tr valign=top>
<td width=28%>imtInfo</td>
<td width=72%>Logged if 'i' in LOGMODE; not passed to handler.</td>
</tr>
<tr valign=top>
<td width=28%>imtDiagnostic</td>
<td width=72%>Logged if 'd' in LOGMODE; not passed to handler if log enabled.</td>
</tr>
<tr valign=top>
<td width=28%>imtCommonData</td>
<td width=72%>Logged if 'c' in LOGMODE; passed to handler to cache.</td>
</tr>
<tr valign=top>
<td width=28%>imtActionStart</td>
<td width=72%>Logged if 'a' in LOGMODE; passed to handler for progress display.</td>
</tr>
<tr valign=top>
<td width=28%>imtActionData</td>
<td width=72%>Logged if 'r' in LOGMODE; passed to handler for progress display.</td>
</tr>
<tr valign=top>
<td width=28%>imtProgress</td>
<td width=72%>Never logged; passed to handler progress gauge.</td>
</tr>
<tr valign=top>
<td width=28%>imtActionDone</td>
<td width=72%>Never logged; passed to handler to remove progress dialog box.</td>
</tr>
</table><br>
<p>
<b>Message Record Fields</b></p>
<h4>Return Values</h4>
<p>&nbsp;</p>

<h1><a name="_msi_sequence_method"></a><a name="helpid_msiengine_sequence"></a>Sequence Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Sequence</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method opens a query on the specified table, ordering the actions by the numbers in the Sequence column. For each row fetched, the <a href="vref_0sdg.htm"><b>DoAction</b> method</a> is called, provided that any supplied condition expression does not evaluate to False. Returns an enumeration iesEnum, as described in the <a href="vref_0sdg.htm"><b>DoAction</b> method</a>.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Sequence(</b><i>table</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>table</i></dt>
<dd>
Required string name of the table to use for sequencing.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method is normally called internally by top-level actions.</p>
<p>&nbsp;</p>

<h1><a name="_msi_setinstalllevel_method"></a><a name="helpid_msiengine_setinstalllevel"></a>SetInstallLevel Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>SetInstallLevel</b> method of the <a href="vref_6c38.htm">MsiEngine object</a>. This method sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features in the Feature table. It also sets the Action state of each component in the Component table based on the new level.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.SetInstallLevel(</b><i>installLevel</i>)</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiEngine object.</dd>
<dt>
<i>installLevel</i></dt>
<dd>
Required requested new install level.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <a href="aref_4bam.htm">CostInitialize action</a> must be executed prior to calling <b>SetInstallLevel</b>.</p>
<p>
If 0 is passed for the <i>installLevel</i> parameter, the current install level is not changed, but all features are still updated based on the current install level. For example, this functionality could be used by the Handler module to reset all selections back to their initial default states at any point in the UI selection process.</p>
<p>&nbsp;</p>

<h1><a name="_msi_msiinstall_object"></a><a name="helpid_msiinstall_object"></a>MsiInstall Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
An MsiInstall object must be initially created to load the automation support that is required to access the installer API functions through OLE automation. This object provides wrappers to create the top-level objects and access their methods.</p>
<h4>Properties</h4>
<p>
<a href="vref_7bzt.htm"><b>Environment</b></a></p>
<p>
<a href="vref_2bjt.htm"><b>FileAttributes</b></a></p>
<p>
<a href="vref_69nj.htm"><b>SummaryInformation</b></a></p>
<p>
<a href="vref_6l15.htm"><b>UILevel</b></a></p>
<p>
<a href="vref_1o1l.htm"><b>Version</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_7mhw.htm"><b>EnableLog</b></a></p>
<p>
<a href="vref_5ack.htm"><b>CreateRecord</b></a></p>
<p>
<a href="vref_23z8.htm"><b>FileSize</b></a></p>
<p>
<a href="vref_83vo.htm"><b>FileVersion</b></a></p>
<p>
<a href="vref_010k.htm"><b>InstallProduct</b></a></p>
<p>
<a href="vref_6884.htm"><b>LastErrorRecord</b></a></p>
<p>
<a href="vref_5yn8.htm"><b>OpenDatabase</b></a></p>
<p>
<a href="vref_2isk.htm"><b>OpenPackage</b></a></p>
<p>
<a href="vref_8z6s.htm"><b>OpenProduct</b></a></p>
<p>
<a href="vref_5p2c.htm"><b>RegistryValue</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_environment_property"></a><a name="helpid_msiinstall_environment"></a>Environment Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the Environment property of the <a href="vref_5s8k.htm">MsiInstall object</a>. This read-write property is the string value for an environment variable or the current process.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Environment(</b><i>variable</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>variable</i></dt>
<dd>
The name of the environment variable to be read or written. This is case-insensitive.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_fileattributes_property"></a><a name="helpid_msiinstall_fileattributes"></a>FileAttributes Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the Fileattributes property of the <a href="vref_5s8k.htm">MsiInstall object</a>. It returns a number representing the combined file attributes for the designated path to a file or folder. </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FileAttributes(</b><i>filePath</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>filePath</i></dt>
<dd>
The required path to the file or folder. A partial path assumes the current directory (which may be set by the Installer).
</dd>
</dl>
<h4>Remarks</h4>
<p>
Returns -1 if the file or folder does not exist is not accessible.</p>
<p>&nbsp;</p>

<h1><a name="_msi_summaryinformation_property_msiinstall_object_"></a><a name="helpid_msiinstall_summaryinformation"></a>SummaryInformation Property (MsiInstall Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>SummaryInformation</b> property of the <a href="vref_5s8k.htm">MsiInstall object</a>. This property returns an MsiSummaryInfo object that can be used to examine, update, and add properties to the SummaryInformation stream of a package or transform.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.SummaryInformation(</b><i>packagePath<b>,</b> maxProperties</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>packagePath</i></dt>
<dd>
Required full path to the package (database) or transform.</dd>
<dt>
<i>maxProperties</i></dt>
<dd>
Required maximum number of properties to be added or modified. Used solely to allocate sufficient working memory during the stream generation. It is not required to actually store this number of properties. A value of zero prevents the stream from being updated and must be used if the database is opened as read-only.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_uilevel_property"></a><a name="helpid_msiinstall_uilevel"></a>UILevel Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>UILevel</b> property of the <a href="vref_5s8k.htm">MsiInstall object</a>. This read-write property indicates the type of UI to be used when opening and processing subsequent packages within the current process space. </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.UILevel</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>UI levels</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_NOCHANGE</td>
<td width=9%>= 0</td>
<td width=44%>UI level is unchanged.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_DEFAULT</td>
<td width=9%>= 1</td>
<td width=44%>Default UI level is used.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_NONE</td>
<td width=9%>= 2</td>
<td width=44%>Completely silent installation.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_BASIC</td>
<td width=9%>= 3</td>
<td width=44%>Simple progress and error handling.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_REDUCED</td>
<td width=9%>= 4</td>
<td width=44%>Authored UI, wizard dialogs suppressed.</td>
</tr>
<tr valign=top>
<td width=47%>INSTALLUILEVEL_FULL</td>
<td width=9%>= 5</td>
<td width=44%>Authored UI with wizards, progress, errors.</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_version_property"></a><a name="helpid_msiinstall_version"></a>Version Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the Version property of the <a href="vref_5s8k.htm">MsiInstall object</a>. This read-only property is the string representation of the installer version in the form "major.minor.0.build."</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Version</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_createrecord_method"></a><a name="helpid_msiinstall_createrecord"></a>CreateRecord Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>CreateRecord</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method returns a new <a href="vref_6z78.htm">MsiRecord object</a> with the requested number of fields.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.CreateRecord(</b><i>count</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>count</i></dt>
<dd>
Required number of fields, which may be 0. The upper limit is memory limited.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Field 0, not one of the fields in <i>count</i>, is normally used for record-oriented items such as format strings or execution op codes.</p>
<p>&nbsp;</p>

<h1><a name="_msi_enablelog_method"></a><a name="helpid_msiinstall_enablelog"></a>EnableLog Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>EnableLog</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method enables logging of the selected message type for all subsequent install sessions in the current process space.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.EnableLog </b>logMode<b><i>, </i></b>logFile</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>logMode</i></dt>
<dd>
Required string containing letters representing the message types to log.</dd>
<dt>
<i>logFile</i></dt>
<dd>
Required string containing the path to the log file to be created.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Log Message Types</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=7%>i</td>
<td width=30%>(imtInfo)</td>
<td width=63%>Information-only messages</td>
</tr>
<tr valign=top>
<td width=7%>w</td>
<td width=30%>(imtWarning)</td>
<td width=63%>Warning messages; not fatal</td>
</tr>
<tr valign=top>
<td width=7%>e</td>
<td width=30%>(imtError)</td>
<td width=63%>Error messages; may be fatal</td>
</tr>
<tr valign=top>
<td width=7%>f</td>
<td width=30%>(imtFilesInUse)</td>
<td width=63%>List of files in use that need to be replaced</td>
</tr>
<tr valign=top>
<td width=7%>a</td>
<td width=30%>(imtActionStart)</td>
<td width=63%>Start of action notification</td>
</tr>
<tr valign=top>
<td width=7%>r</td>
<td width=30%>(imtActionData)</td>
<td width=63%>Action data record; contents action-specific</td>
</tr>
<tr valign=top>
<td width=7%>u</td>
<td width=30%>(imtUser)</td>
<td width=63%>User request messages</td>
</tr>
<tr valign=top>
<td width=7%>c</td>
<td width=30%>(imtCommonData)</td>
<td width=63%>UI initialization parameters</td>
</tr>
<tr valign=top>
<td width=7%>m</td>
<td width=30%>(imtOutOfMemory)</td>
<td width=63%>Out-of-memory message</td>
</tr>
<tr valign=top>
<td width=7%>p</td>
<td width=30%></td>
<td width=63%>Dump property table; "property = value" at engine termination</td>
</tr>
<tr valign=top>
<td width=7%>+</td>
<td width=30%></td>
<td width=63%>Append if log file exists; overwrite if it exists</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_filesize_method"></a>FileSize Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the FileSize method of the MsiInstall object. This method uses the Win32 API calls to return the size of the file specified in szPath.</p>
<h4>Syntax</h4>
<p>
object<b>.FileSize(</b><i>szPath</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>szPath</i></dt>
<dd>
Required string containing the path to the file.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_fileversion_method"></a>FileVersion Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the FileVersion method of the MsiInstall object. This method uses the Win32 API calls to return the version of the path specified in szPath as a string in "#.#.#.#" format.</p>
<h4>Syntax</h4>
<p>
object<b>.FileVersion(</b><i>szPath</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>szPath</i></dt>
<dd>
Required string containing the path to the file.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_installproduct_method"></a><a name="helpid_msiinstall_installproduct"></a>InstallProduct Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>InstallProduct</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method opens an installer package and initializes an install session.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.InstallProduct </b><i>packagePath<b>, </b>propertyValues</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>packagePath</i></dt>
<dd>
Required string containing the path to the install package (which encompasses a database).</dd>
<dt>
<i>propertyValues</i></dt>
<dd>
Optional string containing property=value pairs separated by white space.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_lasterrorrecord_method"></a><a name="helpid_msiinstall_lasterrorrecord"></a>LastErrorRecord Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the LastErrorRecord method of the <a href="vref_5s8k.htm">MsiInstall object</a>. It returns a MsiRecord object containing error parameters for the most recent error from the function that produced the error record.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.LastErrorRecord</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Only designated functions will generate an error record. The record object will be reset after the execution of this function of any function that generates an error record.</p>
<p>&nbsp;</p>

<h1><a name="_msi_opendatabase_method"></a><a name="helpid_msiinstall_opendatabase"></a>OpenDatabase Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>OpenDatabase</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method opens an existing database or creates a new one, returning an MsiDatabase object. It generates an error if the database object cannot be successfully created and opened.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.OpenDatabase(</b><i>name</i><b>,</b><i> openMode</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>name</i></dt>
<dd>
Required string containing the path name of the database. If an empty string is supplied, a temporary database is created that is not persisted.</dd>
<dt>
<i>openMode</i></dt>
<dd>
Required enum from the following listed or a string containing the path name of the new output database file to be written to upon commit.
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=21%>idoReadOnly</td>
<td width=10%>= 0</td>
<td width=69%>Open database read-only; no persisted changes.</td>
</tr>
<tr valign=top>
<td width=21%>idoTransact</td>
<td width=10%>= 1</td>
<td width=69%>Open database; read-write in transaction mode.</td>
</tr>
<tr valign=top>
<td width=21%>idoDirect</td>
<td width=10%>= 2</td>
<td width=69%>Open database direct; read-write without transaction.</td>
</tr>
<tr valign=top>
<td width=21%>idoCreate</td>
<td width=10%>= 3</td>
<td width=69%>Create new database; read-write in transaction mode.</td>
</tr>
<tr valign=top>
<td width=21%>idoCreateDirect</td>
<td width=10%>= 4</td>
<td width=69%>Create new database; read-write without transaction mode.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Database Specifications</b></p>
<p>
The database type is determined by examining path and file content as specified below:</p>
<p>
An MSI package if a doc file with the correct CLSID, .msi extension is typical.</p>
<p>
<b>Note</b>&nbsp;&nbsp;When a database is opened as the output of another database, the summary information stream of the output database is actually a read-only mirror of the original database and thus cannot be changed. Additionally, it will not be persisted with the database. To create or modify the summary information for the output database it must be closed and re-opened.</p>
<p>&nbsp;</p>

<h1><a name="_msi_openpackage_method"></a><a name="helpid_msiinstall_openpackage"></a>OpenPackage Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>OpenPackage</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method opens an installer package for use with APIs that access the product database and install engine, returning an MsiEngine object.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.OpenPackage </b><i>packagePath</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>packagePath</i></dt>
<dd>
Required string containing the path name of the package.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The OpenPackage method can accept the database handle directly in lieu of the path string for the packagePath.</p>
<p>&nbsp;</p>

<h1><a name="_msi_openproduct_method"></a><a name="helpid_msiinstall_openproduct"></a>OpenProduct Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>OpenProduct</b> method of the <a href="vref_5s8k.htm">MsiInstall object</a>. This method opens an installer package for an installed product using the product code and returns an MsiEngine object.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.OpenProduct </b><i>productCode</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
<i>productCode</i></dt>
<dd>
Required string containing the unique product code (a GUID) or an activation descriptor written by the installer.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_registryvalue_method"></a><a name="helpid_msiinstall_registryvalue"></a>RegistryValue Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the RegistryValue method of the <a href="vref_5s8k.htm">MsiInstall object</a>. </p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.RegistryValue(</b><i>root, key, value</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiInstall object.</dd>
<dt>
root</dt>
<dd>
The registry root, which is either a numeric root key or a string machine name.</dd>
<dt>
key</dt>
<dd>
A string containing the complete key path from the root.</dd>
<dt>
value</dt>
<dd>
This optional parameter designates which associated value to return for the specified key. The value is one of the following:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>Missing or empty</td>
<td width=52%>Returns a boolean designating whether the key exists.</td>
</tr>
<tr valign=top>
<td width=48%>String</td>
<td width=52%>Returns the data associated with the named value, fails if the value name is non-existent.</td>
</tr>
<tr valign=top>
<td width=48%>Positive integer</td>
<td width=52%>Returns the 1-based enumerated value name, it is empty if non-existent.</td>
</tr>
<tr valign=top>
<td width=48%>Negative integer</td>
<td width=52%>Returns the 1-based enumerated subkey name, this is empty if non-existent.</td>
</tr>
<tr valign=top>
<td width=48%>Zero integer</td>
<td width=52%>Returns the string class name for the designated key.</td>
</tr>
</table><br>

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_msirecord_object"></a><a name="helpid_msirecord_object"></a>MsiRecord Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiRecord object is a container for holding and transferring a variable number of values. Fields within the record are numerically indexed and can contain strings, integers, objects, and Null values. Fields beyond the allocated record size are treated as having permanently Null values. Field number 0 is reserved.</p>
<h4>Properties</h4>
<p>
<a href="vref_46m1.htm"><b>DataSize</b></a></p>
<p>
<a href="vref_2j21.htm"><b>FieldCount</b></a></p>
<p>
<a href="vref_6nzt.htm"><b>IntegerData</b></a></p>
<p>
<a href="vref_1bw9.htm"><b>IsNull</b></a></p>
<p>
<a href="vref_2ol5.htm"><b>StringData</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_4azo.htm"><b>ClearData</b></a></p>
<p>
<a href="vref_59r8.htm"><b>FormatText</b></a></p>
<p>
<a href="vref_757o.htm"><b>ReadStream</b></a></p>
<p>
<a href="vref_8jhg.htm"><b>SetStream</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_datasize_property"></a><a name="helpid_msirecord_datasize"></a>DataSize Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>DataSize</b> property of the <a href="vref_6z78.htm">MsiRecord object</a>. This read-only property returns the size of the data for the designated field. If the data is a stream, the stream length in bytes is returned. If the data is a string, the string length without Null is returned. If the data is an integer, the value 4 is returned (indicating the size of the integer). If the data is Null, 0 is returned.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.DataSize(</b><i>field</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_fieldcount_property"></a><a name="helpid_msirecord_fieldcount"></a>FieldCount Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FieldCount</b> property of the <a href="vref_6z78.htm">MsiRecord object</a>. This read-only property returns the number of fields in the record. Read access to fields beyond this count returns Null values. Write access fails.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FieldCount</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_integerdata_property"></a><a name="helpid_msirecord_integerdata"></a>IntegerData Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>IntegerData</b> property of the <a href="vref_6z78.htm">MsiRecord object</a>. This read-write property transfers 32-bit integer data in to or out of a specified field within the record. If a field value cannot be converted to an integer, <b>iMsiNullInteger</b> is returned.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.IntegerData(</b><i>field</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The returned value of a non-existent field is <b>iMsiNullInteger</b>. Attempting to store a value in a non-existent field causes an error.</p>
<p>&nbsp;</p>

<h1><a name="_msi_isnull_property"></a><a name="helpid_msirecord_isnull"></a>IsNull Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>IsNull</b> property of the <a href="vref_6z78.htm">MsiRecord object</a>. This read-only property returns True if the indicated field is Null and False if the field contains data.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.IsNull(</b><i>field</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_stringdata_property"></a><a name="helpid_msirecord_stringdata"></a>StringData Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>StringData</b> property of the <a href="vref_6z78.htm">MsiRecord object</a>. This read-write property transfers string data in to or out of a specified field within the record. If an integer or object has been stored, its string value is returned.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.StringData(</b><i>field</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The returned value of a non-existent field is an empty string. An Empty variant value sets the record field to the Null state. Attempting to store a value in a non-existent field causes an error.</p>
<p>&nbsp;</p>

<h1><a name="_msi_cleardata_method"></a><a name="helpid_msirecord_cleardata"></a>ClearData Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ClearData</b> method of the <a href="vref_6z78.htm">MsiRecord object</a>. This method clears the data in all fields, setting them to Null. Any objects stored in the fields are released.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ClearData</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_formattext_method"></a><a name="helpid_msirecord_formattext"></a>FormatText Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>FormatText</b> method of the <a href="vref_6z78.htm">MsiRecord object</a>. This method formats fields according to the template in field 0.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.FormatText</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_readstream_method"></a><a name="helpid_msirecord_readstream"></a>ReadStream Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ReadStream</b> method of the <a href="vref_6z78.htm">MsiRecord object</a>. This method reads a specified number of bytes from a record field holding stream data.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ReadStream(</b>field<b><i>,</i> </b>length<b><i>, </i></b>format<b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.</dd>
<dt>
<i>length</i></dt>
<dd>
Required number of bytes to read from the stream.</dd>
<dt>
<i>format</i></dt>
<dd>
Required interpretation and return of the data bytes, one of the following:
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=19%>isfInteger</td>
<td width=15%>= 0</td>
<td width=66%>As a long integer, length must be 1 to 4.</td>
</tr>
<tr valign=top>
<td width=19%>isfBytes</td>
<td width=15%>= 1</td>
<td width=66%>Raw data as a BSTR; one byte per character. </td>
</tr>
<tr valign=top>
<td width=19%>isfAnsi</td>
<td width=15%>= 2</td>
<td width=66%>ANSI bytes translated to a Unicode BSTR. </td>
</tr>
<tr valign=top>
<td width=19%>isfDirect</td>
<td width=15%>= 3</td>
<td width=66%>Byte pairs returned directly as a BSTR.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The returned value of a non-existent field is an Empty value. If the stream has fewer bytes that the count requested, the returned string is shortened appropriately.</p>
<p>&nbsp;</p>

<h1><a name="_msi_setstream_method"></a><a name="helpid_msirecord_setstream"></a>SetStream Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>SetStream</b> method of the <a href="vref_6z78.htm">MsiRecord object</a>. This method copies the content of the specified file into the designated record field as stream data.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.SetStream(</b>field<b>,</b> filePath<b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiRecord object.</dd>
<dt>
<i>field</i></dt>
<dd>
Required field number of the value within the record, 1-based.</dd>
<dt>
<i>filePath</i></dt>
<dd>
The location of the file to copy. No translation of any type is performed.

</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_msisummaryinfo_object"></a><a name="helpid_msisummaryinfo_object"></a>MsiSummaryInfo Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiSummaryInfo object is used to read, create, and update document properties from the SummaryInformation stream of a storage object.</p>
<h4>Properties</h4>
<p>
<a href="vref_2h9b.htm"><b>Property</b></a></p>
<p>
<a href="vref_8ruh.htm"><b>PropertyCount</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_31r8.htm"><b>Persist</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_property_property_msisummaryinfo_object_"></a><a name="helpid_msisummaryinfo_property"></a>Property Property (MsiSummaryInfo Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Property</b> property of the <a href="vref_4xmc.htm">MsiSummaryInfo object</a>. This property sets or gets the value for the specified property in the summary information stream. The properties are read when the MsiSummaryInfo object is created, but they are not written until the <a href="vref_31r8.htm"><b>Persist</b> method</a> is called. Setting a property to Empty causes its removal; likewise, requesting a non-existent property returns an Empty value. Otherwise values may be transferred as strings, integers, or date (date time) types.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Property(</b><i>pid</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiSummaryInfo object.</dd>
<dt>
<i>pid</i></dt>
<dd>
Required property ID of one of the summary properties.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Standard Summary Property IDs</b> </p>
<p>
(not an enumeration)</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=34%>PID_DICTIONARY</td>
<td width=10%>0</td>
<td width=56%>Special format, not support by MsiSummaryInfo object</td>
</tr>
<tr valign=top>
<td width=34%>PID_CODEPAGE</td>
<td width=10%>1</td>
<td width=56%>VT_I2</td>
</tr>
<tr valign=top>
<td width=34%>PID_TITLE</td>
<td width=10%>2</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_SUBJECT</td>
<td width=10%>3</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_AUTHOR</td>
<td width=10%>4</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_KEYWORDS</td>
<td width=10%>5</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_COMMENTS</td>
<td width=10%>6</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_TEMPLATE</td>
<td width=10%>7</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_LASTAUTHOR</td>
<td width=10%>8</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_REVNUMBER</td>
<td width=10%>9</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_EDITTIME</td>
<td width=10%>10</td>
<td width=56%>VT_FILETIME</td>
</tr>
<tr valign=top>
<td width=34%>PID_LASTPRINTED</td>
<td width=10%>11</td>
<td width=56%>VT_FILETIME</td>
</tr>
<tr valign=top>
<td width=34%>PID_CREATE_DTM</td>
<td width=10%>12</td>
<td width=56%>VT_FILETIME</td>
</tr>
<tr valign=top>
<td width=34%>PID_LASTSAVE_DTM</td>
<td width=10%>13</td>
<td width=56%>VT_FILETIME</td>
</tr>
<tr valign=top>
<td width=34%>PID_PAGECOUNT</td>
<td width=10%>14</td>
<td width=56%>VT_I4</td>
</tr>
<tr valign=top>
<td width=34%>PID_WORDCOUNT</td>
<td width=10%>15</td>
<td width=56%>VT_I4</td>
</tr>
<tr valign=top>
<td width=34%>PID_CHARCOUNT</td>
<td width=10%>16</td>
<td width=56%>VT_I4</td>
</tr>
<tr valign=top>
<td width=34%>PID_THUMBNAIL</td>
<td width=10%>17</td>
<td width=56%>VT_CF (not supported)</td>
</tr>
<tr valign=top>
<td width=34%>PID_APPNAME</td>
<td width=10%>18</td>
<td width=56%>VT_LPSTR</td>
</tr>
<tr valign=top>
<td width=34%>PID_SECURITY</td>
<td width=10%>19</td>
<td width=56%>VT_I4</td>
</tr>
</table><br>
<p>
<b>Property Data Types</b> </p>
<p>
(not an enumeration)</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=34%>VT_I2</td>
<td width=10%>2</td>
<td width=56%>16-bit integer</td>
</tr>
<tr valign=top>
<td width=34%>VT_I4</td>
<td width=10%>3</td>
<td width=56%>32-bit integer</td>
</tr>
<tr valign=top>
<td width=34%>VT_LPSTR</td>
<td width=10%>30</td>
<td width=56%>String</td>
</tr>
<tr valign=top>
<td width=34%>VT_FILETIME</td>
<td width=10%>64</td>
<td width=56%>Date time (FILETIME, converted to Variant time)</td>
</tr>
<tr valign=top>
<td width=34%>VT_CF</td>
<td width=10%>71</td>
<td width=56%>Clipboard format + data, not handled by MsiSummaryInfo object</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_propertycount_property"></a><a name="helpid_msisummaryinfo_propertycount"></a>PropertyCount Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>PropertyCount</b> property of the <a href="vref_4xmc.htm">MsiSummaryInfo object</a>. This read-only property indicates the current number of property values in the summary information object. It takes into account properties that have been added, deleted, or replaced.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.PropertyCount</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiSummaryInfo object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_persist_method"></a><a name="helpid_msisummaryinfo_persist"></a>Persist Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Persist</b> method of the <a href="vref_4xmc.htm">MsiSummaryInfo object</a>. This method formats and writes the previously stored properties into the standard SummaryInformation stream. It generates an error if the stream cannot be successfully written. This method may only be called once after all the property values have been set. Properties may still be read after the stream is written.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Persist</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiSummaryInfo object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_msiuipreview_object"></a><a name="helpid_msiuipreview_object"></a>MsiUIPreview Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiUIPreview object is used to view UI dialog boxes and billboards during authoring. This object is created by the <a href="vref_45d0.htm"><b>EnableUIPreview </b>method</a> of the <a href="vref_2yes.htm">MsiDatabase object</a>.</p>
<h4>Properties</h4>
<p>
<a href="vref_8j04.htm"><b>Property</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_6ht0.htm"><b>ViewBillboard</b></a></p>
<p>
<a href="vref_34x0.htm"><b>ViewDialog</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_property_property_msiuipreview_object"></a>Property Property (MsiUIPreview Object)</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Property</b> property of the <a href="vref_9lis.htm">MsiUIPreview object</a>. This read-write property represents the string value of a named installer property, or, if it is prefixed with a percent sign (%), the value of a system environment variable for the current process. This is exposed to allow proper display of dialog boxes that are dependent upon property values. Either string or integer values may be supplied. A non-existent property or environment variable is equivalent to its value being Null.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Property(</b><i>name</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiUIPreview object.</dd>
<dt>
<i>name</i></dt>
<dd>
Required case-sensitive name of a property, or a case-insensitive name of an environment variable prefixed by a percent sign (%).
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_viewbillboard_method"></a><a name="helpid_msiuipreview_viewbillboard"></a>ViewBillboard Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ViewBillboard</b> method of the <a href="vref_9lis.htm">MsiUIPreview object</a>. This method displays an authored billboard using the host control in the currently displayed dialog box.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ViewBillboard </b>control<b>,<i> </i></b>billboard</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiUIPreview object.</dd>
<dt>
<i>control</i></dt>
<dd>
Required name of the control hosting the billboard, case-sensitive, along with the dialog box, and the primary keys of the Control database table.</dd>
<dt>
<i>billboard</i></dt>
<dd>
Required name of the billboard to display using the specified control and current dialog box, and the primary key of the Billboard database table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_viewdialog_method"></a><a name="helpid_msiuipreview_viewdialog"></a>ViewDialog Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ViewDialog</b> method of the <a href="vref_9lis.htm">MsiUIPreview object</a>. This method displays an authored UI dialog box stored in the current database.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ViewDialog </b><i>dialog</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiUIPreview object.</dd>
<dt>
<i>dialog</i></dt>
<dd>
Required name of the dialog box, case-sensitive, and the primary key of the Dialog database table.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_msiview_object"></a><a name="helpid_msiview_object"></a>MsiView Object</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The MsiView object represents a result set obtained when processing a query using the <a href="vref_5tb8.htm"><b>OpenView </b>method</a> of the MsiDatabase object. Before any data can be transferred, the query must be executed using the <a href="vref_2k6c.htm"><b>Execute</b> method</a>, passing to it all replaceable parameters designated within the SQL query string. The query may be executed again, with different parameters if needed, but only after freeing the result set either by fetching all the records or by calling the <a href="vref_7p9g.htm"><b>Close</b> method</a>.</p>
<h4>Properties</h4>
<p>
<a href="vref_1lh5.htm"><b>ColumnInfo</b></a></p>
<h4>Methods</h4>
<p>
<a href="vref_7p9g.htm"><b>Close</b></a></p>
<p>
<a href="vref_2k6c.htm"><b>Execute</b></a></p>
<p>
<a href="vref_2204.htm"><b>Fetch</b></a></p>
<p>
<a href="vref_14pw.htm"><b>GetError</b></a></p>
<p>
<a href="vref_6204.htm"><b>Modify</b></a></p>
<p>&nbsp;</p>

<h1><a name="_msi_columninfo_property"></a><a name="helpid_msiview_columninfo"></a>ColumnInfo Property</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>ColumnInfo</b> property of the <a href="vref_07qs.htm">MsiView object</a>. This property returns an MsiRecord object containing the requested information about each column in the result set. Either the column names or the column definitions may be requested. Constants supplied in the Select list do not have names.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.ColumnInfo(</b><i>info</i><b>)</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.</dd>
<dt>
<i>info</i></dt>
<dd>
Required information needed for each column:
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=18%>iciNames</td>
<td width=13%>= 0</td>
<td width=69%>Return names of all non-constant columns in result set.</td>
</tr>
<tr valign=top>
<td width=18%>iciTypes</td>
<td width=13%>= 1</td>
<td width=69%>Return definitions of all columns in result set.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Column Definition Format</b></p>
<p>
Each column is described by a string in the corresponding record field. The definition string consists of a single letter representing the data type followed by the width of the column (in characters when applicable, or else bytes). A width of zero designates an unbounded width (long text fields and streams). An uppercase letter indicates that Null values are allowed in the column.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Column descriptor</th>
<th align=left width=68%>Definition string</th>
</tr>
<tr valign=top>
<td width=32%>s?</td>
<td width=68%>String, variable length (?=1-255)</td>
</tr>
<tr valign=top>
<td width=32%>s0</td>
<td width=68%>String, variable length</td>
</tr>
<tr valign=top>
<td width=32%>i2</td>
<td width=68%>Short integer</td>
</tr>
<tr valign=top>
<td width=32%>i4</td>
<td width=68%>Long integer</td>
</tr>
<tr valign=top>
<td width=32%>v0</td>
<td width=68%>Binary Stream</td>
</tr>
<tr valign=top>
<td width=32%>g?</td>
<td width=68%>Temporary string (?=0-255)</td>
</tr>
<tr valign=top>
<td width=32%>j?</td>
<td width=68%>Temporary integer (?=0,1,2,4)</td>
</tr>
</table><br>
<p>&nbsp;</p>

<h1><a name="_msi_close_method"></a><a name="helpid_msiview_close"></a>Close Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Close</b> method of the <a href="vref_07qs.htm">MsiView object</a>. This method terminates query execution and releases database resources.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Close</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method must be called before the <b>Execute</b> method is called again on the MsiView object unless all rows of the result set have been obtained with the <b>Fetch</b> method. It is called internally when the view is destroyed.</p>
<p>&nbsp;</p>

<h1><a name="_msi_execute_method"></a><a name="helpid_msiview_execute"></a>Execute Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Execute</b> method of the <a href="vref_07qs.htm">MsiView object</a>. This method accepts replaceable query parameters and executes the database query, producing a result set that can be fetched or updated.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Execute </b><i>record</i></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.</dd>
<dt>
<i>record</i></dt>
<dd>
Optional MsiRecord objects containing values to replace parameter markers (?) in the SQL query.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method must be called before any calls to the <a href="vref_2204.htm"><b>Fetch </b>method</a>. If the SQL query specifies values in the predicate expression with parameter markers (?), a record must be supplied containing all of the replacement values in the exact order and of compatible data types.</p>
<p>&nbsp;</p>

<h1><a name="_msi_fetch_method"></a><a name="helpid_msiview_fetch"></a>Fetch Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Fetch</b> method of the <a href="vref_07qs.htm">MsiView object</a>. This method returns an MsiRecord object containing the requested column data if more rows are available in the result set, else returns an object of value Nothing.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Fetch</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This method must be called after the <a href="vref_2k6c.htm"><b>Execute </b>method</a>. For maximum performance, the same record object should be used for all fetches, or else it should be released by going out of scope. The returned record can be tested for the end of the result set using the syntax "If FetchRecord Is Nothing".</p>
<p>&nbsp;</p>

<h1><a name="_msi_geterror_method"></a><a name="helpid_msiview_geterror"></a>GetError Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>GetError</b> method of the <a href="vref_07qs.htm">MsiView object</a>. This method returns the Validation error and the column name for which the error occurred. In automation, the returned value is a string of the form ##ColumnName, where the ## represents a 2-digit error code. It returns the first error in the view's error array; subsequent calls return the next value in the error array. Once a value of '00' is returned, no more errors exist, and subsequent calls merely loop through the array again. See msiquery.h for error enums.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.GetError</b></p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.
</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_modify_method"></a><a name="helpid_msiview_modify"></a>Modify Method</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
This is the <b>Modify</b> method of the <a href="vref_07qs.htm">MsiView object</a>. This method modifies a database row with a modified MsiRecord object obtained by the <b>Fetch</b> method.</p>
<h4>Syntax</h4>
<p>
<i>object</i><b>.Modify </b>action<b>, </b>record</p>
<h4>Parts</h4>
<dl>
<dt>
<i>object</i></dt>
<dd>
MsiView object.</dd>
<dt>
<i>action</i></dt>
<dd>
Required action to be performed on the database row. This action is one of the following: 
<dl>
<dt>
<b>irmInsert</b></dt>
<dd>
Inserts the information into the database table. The database must not be read-only. The operation does not require a <a href="vref_2204.htm"><b>Fetch </b>method</a> to have been performed before it is called. The function fails if a row with the same primary key exists in the table.</dd>
<dt>
<b>irmInsertTemporary</b></dt>
<dd>
Temporarily inserts the information into the database table. The information is not persisted. The database can be read-only. The operation does not require a <b>Fetch </b>method to have been performed before it is called. The function fails if a row with the same primary key exists in the table.</dd>
<dt>
<b>irmUpdate</b></dt>
<dd>
Updates the information already existing in the database allowing modification of non-primary keys only. The database must not be opened read-only. The operation requires a <b>Fetch </b>method to have been performed before it is called and has to be called with the same record as that returned by the fetch. The function fails if the row has been deleted from the table.</dd>
<dt>
<b>irmDelete</b></dt>
<dd>
Deletes the information already existing in the database. The database must not be opened read-only. The operation requires a <a href="vref_2204.htm"><b>Fetch </b>method</a> to have been performed before it is called and has to be called with the same record as that returned by the fetch. The function fails if the row has been deleted from the table.</dd>
<dt>
<b>irmRefresh</b></dt>
<dd>
Refreshes the information in the record from the database. The database can be opened read-only. The operation requires a <b>Fetch</b> method to have been performed before it is called and has to be called with the same record as that returned by the fetch. The function fails if the row has been deleted from the table.</dd>
<dt>
<b>irmAssign</b></dt>
<dd>
Inserts/updates the information in the database table. The database must not be opened read-only. The operation does not require a <b>Fetch</b> method to have been performed before it is called. An update operation takes place if primary keys match an existing row. An insert operation takes place if primary keys do not match any row. In either case, the current data in the record is written to a table row.</dd>
<dt>
<b>irmMerge</b></dt>
<dd>
Inserts/validates the information in the database table. The database must not be opened read-only. The operation does not require a <b>Fetch</b> method to have been performed before it is called. An insert operation takes place if primary keys do not match any row. A validation operation takes place if primary keys match an existing row. The operation fails if the record data does not match the data in the table.</dd>
<dt>
<b>irmReplace</b></dt>
<dd>
Updates/deletes-inserts the information into the database table. The database must not be opened read-only. The operation requires a <a href="vref_2204.htm"><b>Fetch</b> method</a> to have been performed before it is called and has to be called with the same record as that returned by the fetch. If the primary key has not been changed, an update of the table row occurs. If the primary key has been changed, the old table row is deleted and a new row corresponding to the record is inserted.</dd>
<dt>
<b>irmValidate</b></dt>
<dd>
Validates a record, but will not validate across joins. The database can be opened read-only. The operation requires a <b>Fetch</b> method to have been performed before it is called and has to be called with the same record as that returned by the fetch. Validation errors can be obtained by subsequent calls to the <a href="vref_14pw.htm"><b>GetError </b>method</a>. </dd>
<dt>
<b>irmValidateNew</b></dt>
<dd>
Validates a record as a new record. The database must not be opened read-only. Will not validate across joins. This differs from irmValidate in that it checks for duplicate keys. The operation requires that the <a href="vref_5tb8.htm"><b>MsiDatabase.OpenView </b>method</a> be called with a modify value. Validation errors can be obtained by subsequent callings to the <b>GetError </b>method.</dd>
<dt>
<b>irmValidateField</b></dt>
<dd>
Validates a field of a fetched or new record. The database can be opened read-only. Will not validate across joins. The validation depends upon the number of fields in the record. If only one field exists, it validates that field. It can also validate more fields. It should be used when the fetched/new record does not represent every column of the table. Makes repeated validate calls depending upon the number of fields in the record. Validation errors can be obtained by subsequent calls to the <b>GetError </b>method. </dd>
<dt>
<b>irmValidateDelete</b></dt>
<dd>
Validates a row of a fetched record that will later be deleted. The database must not be opened read-only. Will not validate across joins. The operation requires a <b>Fetch</b> method. Validation errors can be obtained by subsequent calls to the <a href="vref_14pw.htm"><b>GetError </b>method</a>. A validation error occurs if another row of a table references the primary key fields of the record to be deleted.</dd>
</dl>
</dd>
<dt>
<i>record</i></dt>
<dd>
Required MsiRecord object obtained by the <b>Fetch</b> method with modified field data.

</dd>
</dl>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_glossary"></a>Glossary</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>&nbsp;</p>

<h1><a name="_msi_a_gly"></a>A</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_access_function_gly"></a><b>access function</b></dt>
<dd>
A function that accesses the installer database and the installation process. An access function is called by an installer package authoring tool to populate the installer database. See also custom installer action, installer database, and installer package authoring tool.</dd>
<dt>
<a name="_msi_acquisition_phase_gly"></a><b>acquisition phase</b></dt>
<dd>
The phase during which the exact installation procedure is determined. At the beginning of the acquisition phase, an application or a user instructs the installer to install a feature or an application. See also execution phase.</dd>
<dt>
<a name="_msi_advertise_gly"></a><b>advertise</b></dt>
<dd>
The mechanism whereby an application that is not installed is accessed as though it is installed. Only the registry entries and other necessary information are on the local computer. When a user opens the application, the installer automatically installs the necessary components. See also assign, just-in-time installation, and publish.</dd>
<dt>
<a name="_msi_assign_gly"></a><b>assign</b></dt>
<dd>
One of the methods of advertising. An application is assigned to a user when the <b>Start</b> menu contains the appropriate shortcuts, icons are present, files are associated with the application, and registry entries reflect the application's installation, but the application is not actually installed. When the user tries to open an assigned application, it is installed. See also advertise, just-in-time installation, and publish.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_c_gly"></a>C</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_component_gly"></a><b>component</b></dt>
<dd>
A building-block of an application from the programmer's perspective. Examples of components are a group of related files, a COM object, or a library. See also feature.</dd>
<dt>
<a name="_msi_custom_installer_action_gly"></a><b>custom installer action </b></dt>
<dd>
An action that is not built-in to the installer. A custom installer action modifies an existing database by calling an access function. See also access function and installer package authoring tool.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_e_gly"></a>E</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_execution_phase_gly"></a><b>execution phase</b></dt>
<dd>
The installation phase during which the installer passes the information to a process with elevated privileges to generate an installation script. The process with elevated privileges then runs the script. The execution phase is only run privileged with managed applications on Windows NT. See also acquisition phase.</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_f_gly"></a>F</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_feature_gly"></a><b>feature</b></dt>
<dd>
A feature is a specific capability of an application as seen from the user's perspective. Separating an application into well-defined features ensures that you take advantage of the features of the installer. An example of a feature is the spelling checker in Microsoft  Word. See also component.</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_i_gly"></a>I</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_installer_gly"></a><b>installer</b></dt>
<dd>
The new installation technology from Microsoft. See also Microsoft Windows installer.</dd>
<dt>
<a name="_msi_installer_database_gly"></a><b>installer database</b></dt>
<dd>
Contains the setup information for an application. The installer database is in the installer package. </dd>
<dt>
<a name="_msi_installer_function_gly"></a><b>installer function</b></dt>
<dd>
A function you can use to enable installer functionality. These functions can be called by any application. </dd>
<dt>
<a name="_msi_installer_package_authoring_tool_gly"></a><b>installer package authoring tool</b></dt>
<dd>
Hides the complexity of the installer database by automating the creation and population of database tables. The installer package authoring tool calls access functions. See also access function, custom installer action, and installer database.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_j_gly"></a>J</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_just_in_time_installation_gly"></a><b>just-in-time installation</b></dt>
<dd>
Keeps your application footprint small. Using this method, you can install components supporting specialized, seldom-used features only when the features are actually needed, and, in doing so, save space on most user hard disks. The feature does not have to be installed for the user interface to present it. See also advertise.</dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_m_gly"></a>M</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_merge_gly"></a><b>merge</b></dt>
<dd>
To add information from one database to another database. See also transform. </dd>
<dt>
<a name="_msi_microsoft_windows_installer_gly"></a><b>Microsoft Windows installer</b></dt>
<dd>
New installation technology from Microsoft. See also installer.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_p_gly"></a>P</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_package_gly"></a><b>package</b></dt>
<dd>
A file organized as COM structured storage with streams for each of the various parts of an installation, including a summary information stream. These streams contain the installer database and either a pointer to the files or the files themselves compressed into a single cabinet file. See also installer database and summary information stream. </dd>
<dt>
<a name="_msi_publish_gly"></a><b>publish</b></dt>
<dd>
One of the methods of advertising. Publishing does not populate the user interface. However, if another application attempts to open the published application, enough information is present to assign the published application. The published application can then be used as if it is installed. A published application can also be opened through its file association or Multipurpose Internet Mail Extension (MIME) type, or a user might instigate the installation from a list of published applications. See also advertise, assign, just-in-time installation, and publish.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_r_gly"></a>R</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_resiliency_gly"></a><b>resiliency</b></dt>
<dd>
The capability of an application to recover gracefully from errors without presenting the user with error messages. </dd>
</dl>
<p>&nbsp;</p>

<h1><a name="_msi_s_gly"></a>S</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_source_list_gly"></a><b>source list</b></dt>
<dd>
Contains the locations in which the installer searches for installation packages. </dd>
<dt>
<a name="_msi_summary_information_stream_gly"></a><b>summary information stream</b></dt>
<dd>
A convenient storage area for information that can be viewed with Microsoft  Windows  Explorer. The summary information stream uses COM to provide structured storage of databases. COM supports structured storage with the <b>IStream</b> interface. See also package.</dd>
</dl>

<p>&nbsp;</p>

<h1><a name="_msi_t_gly"></a>T</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>

<dl>
<dt>
<a name="_msi_transform_gly"></a><b>transform</b></dt>
<dd>
A transform is a set of differences between two databases. See also merge.
</dd>
</dl>
<p>
</p>
<p>
</p>
<p>&nbsp;</p>

<h1><a name="_msi_appendix"></a>Appendix</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The following topics contain additional information about the Microsoft  Windows  installer package:
<ul>
<li>
<a href="app_33n8.htm">Package Format</a> </li>
<li>
<a href="app_73eb.htm">Command Line options</a> </li>
</ul>
<p>&nbsp;</p>

<h1><a name="_msi_package_format"></a>Package Format</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
A Microsoft  Windows  installer package is a file organized as COM structured storage. Within this package are streams for each of the various parts of an installation. These streams contain the installation database and either a pointer to the files or the files themselves compressed into a single cabinet file. The package also contains a standard <a href="sovr_99yl.htm">summary information stream</a> and one or more optional streams for <a href="over_2ysz.htm">transforms</a>.</p>
<p>&nbsp;</p>

<h1><a name="_msi_command_line_options"></a>Command Line Options</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The executable program that interprets packages and installs products is Msiexec.exe. The following table describes the command-line options for this program.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=15%>Option</th>
<th align=left width=42%>Parameters</th>
<th align=left width=43%>Meaning</th>
</tr>
<tr valign=top>
<td width=15%>/i</td>
<td width=42%><i>Package|ProductCode</i></td>
<td width=43%>Installs or configures a product.</td>
</tr>
<tr valign=top>
<td width=15%>/o</td>
<td width=42%><i>Property1=Value1 Property2=Value2. . .</i></td>
<td width=43%>Sets properties. This parameter is used in conjunction with /i, /f, or /n. The /o parameter can be used with /i only if you specify the package code.</td>
</tr>
<tr valign=top>
<td width=15%>/f</td>
<td width=42%>[<i>ReinstallModes</i>] <i>Package</i>|<i>ProductCode</i></td>
<td width=43%>Repairs a product.</td>
</tr>
<tr valign=top>
<td width=15%>/n</td>
<td width=42%><i>Package</i></td>
<td width=43%>Installs an product on the network.</td>
</tr>
<tr valign=top>
<td width=15%>/x</td>
<td width=42%><i>Package|ProductCode</i></td>
<td width=43%>Uninstalls an product.</td>
</tr>
<tr valign=top>
<td width=15%>/a</td>
<td width=42%>[<i>u|m</i>]<i>Package</i></td>
<td width=43%>Advertises an product. The flag 'u' advertises to the current user, while 'm' advertises to all users of the machine.</td>
</tr>
<tr valign=top>
<td width=15%>/l</td>
<td width=42%>[<i>logmode</i>]<i>Logfile</i></td>
<td width=43%>Specifies the logfile.</td>
</tr>
<tr valign=top>
<td width=15%>/t</td>
<td width=42%><i>ProductCode</i></td>
<td width=43%>Uninstalls an product. </td>
</tr>
<tr valign=top>
<td width=15%>/q</td>
<td width=42%>n|b|r|f</td>
<td width=43%>Specifies the level of user interface to display; can be No, Basic, Reduced, or Full display.</td>
</tr>
<tr valign=top>
<td width=15%>/? or /h</td>
<td width=42%></td>
<td width=43%>Displays online Help.</td>
</tr>
</table><br>
<p>
For example, to install a product from A:\Example.msi and create a logfile using the <a href="pref_27ll.htm">LOGFILE property</a> and the <a href="pref_6y2h.htm">LOGMODE property</a>, install the product as follows:</p>
<pre><code>msiexec /i A:\Example.msi /o "LOGFILE=c:\Example.log LOGMODE=raidcupmew"
 </code></pre>
<p>
The command line for Msiexec.exe supports spaces in property values. Use single quotes (`) to delimit the values. If you want to pass a single quote in an option, escape it with a backslash (\). For example:</p>
<pre><code>msiexec /p"testdb.msi" /o"SOURCEDIR=`C:\X Y\Z`"
 </code></pre>
<p>
</p>
<p>&nbsp;</p>